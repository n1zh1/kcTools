var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(u){f(u)}}:b}var d,f,g=new e(function(a,b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};
e.prototype["catch"]=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=
e.next())c(f.value).callWhenSettled_(b,d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,c(d.value).callWhenSettled_(f(g.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype["return"]=function(a){this.abruptCompletion_={"return":a};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};$jscomp.generator.Context.prototype.yieldAll=function(a,b){var c=$jscomp.makeIterator(a),d=c.next();$jscomp.generator.ensureIteratorResultIsObject_(d);if(d.done)this.yieldResult=d.value,this.nextAddress=b;else return this.yieldAllIterator_=c,this.yield(d.value,b)};
$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){var c=this.finallyContexts_.splice(b||0)[0];if(c=this.abruptCompletion_=this.abruptCompletion_||c){if(c.isException)return this.jumpToErrorHandler_();void 0!=c.jumpTo&&this.finallyAddress_<c.jumpTo?(this.nextAddress=c.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(a){return{value:a,done:!0}},a,this.context_["return"]);this.context_["return"](a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var d=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(d);if(!d.done)return this.context_.stop_(),d;var e=d.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a["return"],done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this["throw"]=function(b){return a.throw_(b)};this["return"]=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){var c=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(c,a.prototype);return c};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(b){return a.next(b)}function c(b){return a["throw"](b)}return new Promise(function(d,e){function f(a){a.done?d(a.value):Promise.resolve(a.value).then(b,c).then(f,e)}f(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
var MAX_SLOT=99,INITIAL_MAX_LEVEL_PLANE=[1,4,5,7,8,102,103],IMAGES={},SHOOT_DOWN_TABLE,SHOOT_DOWN_TABLE_ENEMY,AIR_STATUS_TABLE,$target=null,confirmType=null,basicSortedPlanes=[],isOut=!1,isDefMode=!1,battleCount=1,displayBattle=1,timer=!1,planePreset=null,initialProf120Plane=[1,4,5,7,8,102,103,104],chartData=null,isCtrlPress=!1,presets=null,backUpPresets=null,releaseTimer=null,setting=null,usedPlane=[],chartDataSet=null;
function isContain(a,b){for(var c=$jscomp.makeIterator(a),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=$jscomp.makeIterator(b),f=e.next();!f.done;f=e.next())if(d===f.value)return!0}return!1}function shuffleArray(a){for(var b=a.length-1;0<b;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c];a[c]=d}}function castInt(a,b){b=void 0===b?0:b;var c=parseInt(a);return isNaN(c)?b:c}function castFloat(a,b){b=void 0===b?0:b;var c=parseFloat(a);return isNaN(c)?b:c}
function utf8_to_b64(a){try{return LZString.compressToEncodedURIComponent(a)}catch(b){return""}}function b64_to_utf8(a){try{return LZString.decompressFromEncodedURIComponent(a)}catch(b){return""}}function copyInputTextToClipboard(a){try{if(!a.attr("id"))return!1;document.getElementById(a.attr("id")).select();return document.execCommand("copy")}catch(b){return!1}}
function getUrlParams(){var a=location.search;if(""===a)return{};var b={};a=$jscomp.makeIterator(a.slice(1).split("&"));for(var c=a.next();!c.done;c=a.next())c=c.value.split("="),b[c[0]]=c[1];window.history.replaceState("","",location.pathname);return b}function getArraySum(a){for(var b=0,c=a.length;c--;)b+=a[c];return b}function getArrayMax(a){for(var b=-Infinity,c=a.length;c--;)a[c]>b&&(b=a[c]);return b}function getArrayMin(a){for(var b=Infinity,c=a.length;c--;)a[c]<b&&(b=a[c]);return b}
function postURLData(a){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){return 1==c.nextAddress?(b={longDynamicLink:"https://aircalc.page.link/?link="+a,suffix:{option:"SHORT"}},c.yield(fetch("https://firebasedynamiclinks.googleapis.com/v1/shortLinks?key="+xxx,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}).then(function(a){return a.json()}),2)):c["return"](c.yieldResult)})}
function setPreCalculateTable(){if(!AIR_STATUS_TABLE){AIR_STATUS_TABLE=[];for(var a=0;1E3>=a;a++){for(var b=new Uint16Array(Math.max(3*a+1,2)),c=0;c<=b.length;c++)if(0===a&&0===c)b[c]=5;else if(a>=3*c)b[c]=0;else if(2*a>=3*c)b[c]=1;else if(3*a>2*c)b[c]=2;else if(3*a>c)b[c]=3;else{b[c]=4;break}AIR_STATUS_TABLE.push(b)}}if(!SHOOT_DOWN_TABLE)for(SHOOT_DOWN_TABLE=[],a=[[7,15],[20,45],[30,75],[45,105],[65,150]],b=a.length,c=0;c<=MAX_SLOT;c++){for(var d=[],e=0;e<b;e++){for(var f=[],g=a[e][0];g<=a[e][1];g++)f.push(Math.floor(c*
g/256));shuffleArray(f);d.push(f)}SHOOT_DOWN_TABLE.push(d)}if(!SHOOT_DOWN_TABLE_ENEMY){SHOOT_DOWN_TABLE_ENEMY=[];a=0;b=ENEMY_DATA.length;for(c=0;c<b;c++)for(d=ENEMY_DATA[c].slot.length,e=0;e<d;e++)a<ENEMY_DATA[c].slot[e]&&(a=ENEMY_DATA[c].slot[e]);for(b=0;b<=a;b++){c=[];d=AIR_STATUS.length;for(e=0;e<d;e++){f=[];for(var h=g=AIR_STATUS[e].rate;0<=h;h--)for(var k=0;k<=g;k++)f.push(Math.floor(b*(.65*h+.35*k)/10));shuffleArray(f);c.push(f)}SHOOT_DOWN_TABLE_ENEMY.push(c)}}window.clearTimeout(releaseTimer);
releaseTimer=setTimeout(function(){SHOOT_DOWN_TABLE_ENEMY=SHOOT_DOWN_TABLE=AIR_STATUS_TABLE=null},18E4)}function getPlanes(a){var b=[];return b=0===a?basicSortedPlanes.concat():PLANE_DATA.filter(function(b){return Math.abs(castInt(b.type))===Math.abs(castInt(a))})}function getPlaneCss(a){var b=PLANE_TYPE.find(function(b){return b.id===castInt(a)});return b?b.css:""}
function getProfString(a){switch(a){case 1:return"|";case 2:return"||";case 3:return"|||";case 4:return"/";case 5:return"//";case 6:return"///";case 7:return">>"}return""}function replaceKnji(a){a&&(a=a.replace("601","\u516d\u3007\u4e00"),a=a.replace("634","\u516d\u4e09\u56db"),a=a.replace("931","\u4e5d\u4e09\u4e00"),a=a.replace("22","\u4e8c\u4e8c"),a=a.replace("34","\u4e09\u56db"),a=a.replace("96","\u4e5d\u516d"),a=a.replace("97","\u4e5d\u4e03"),a=a.replace("99","\u4e5d\u4e5d"));return a}
function checkInvalidPlane(a,b){if(-1===a)return!0;if(0===a&&100<Math.abs(b.type))return!1;if(0===a)return!0;var c=SHIP_DATA.find(function(b){return b.id===a}),d=LINK_SHIP_EQUIPMENT.find(function(a){return a.type===c.type}),e=SPECIAL_LINK_SHIP_EQUIPMENT.find(function(a){return a.shipId===c.id}),f=[];if(d){d=$jscomp.makeIterator(d.e_type);for(var g=d.next();!g.done;g=d.next())f.push(g.value);if(e)for(d=$jscomp.makeIterator(e.equipmentTypes),g=d.next();!g.done;g=d.next())f.push(g.value)}return f.includes(Math.abs(b.type))?
151===b.id?e?e.equipmentIds.includes(b.id):!1:!0:e&&e.equipmentIds.includes(b.id)}function validateInputNumber(a,b,c){c=void 0===c?0:c;return(new RegExp(/^[0-9]+$/)).test(a)?a>b?b:a<c?c:castInt(a):c}
function initializeSetting(){(setting=loadLocalStorage("setting"))||(setting={});setting.hasOwnProperty("version")||(setting.version="0.0.0");setting.hasOwnProperty("simulateCount")||(setting.simulateCount=5E3);setting.hasOwnProperty("autoSave")||(setting.autoSave=!0);setting.hasOwnProperty("emptySlotInvisible")||(setting.emptySlotInvisible=!1);setting.hasOwnProperty("inStockOnly")||(setting.inStockOnly=!1);setting.hasOwnProperty("visibleEquipped")||(setting.visibleEquipped=!1);setting.hasOwnProperty("visibleFinal")||
(setting.visibleFinal=!0);setting.hasOwnProperty("enemyDisplayImage")||(setting.enemyDisplayImage=!0);setting.hasOwnProperty("copyToClipboard")||(setting.copyToClipboard=!1);setting.hasOwnProperty("airRaidMax")||(setting.airRaidMax=!0);setting.hasOwnProperty("isUnion")||(setting.isUnion=!0);setting.hasOwnProperty("backUpEnabled")||(setting.backUpEnabled=!0);setting.hasOwnProperty("backUpCount")||(setting.backUpCount=10);setting.hasOwnProperty("selectedHistory")||(setting.selectedHistory=[[],[]]);
setting.hasOwnProperty("orderByFrequency")||(setting.orderByFrequency=!1);setting.hasOwnProperty("themeColor")||(setting.themeColor="#f0ebe6");setting.hasOwnProperty("contentsOrder")||(setting.contentsOrder=[]);if(!setting.hasOwnProperty("defaultProf")){setting.defaultProf=[];var a=PLANE_TYPE.filter(function(a){return 0<a.id&&104!==a.id});a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())b=b.value,b={id:b.id,prof:INITIAL_MAX_LEVEL_PLANE.includes(b.id)?7:0},setting.defaultProf.push(b)}setting.hasOwnProperty("displayMode")||
(setting.displayMode={modal_plane_select:"single",modal_ship_select:"single",modal_enemy_select:"single"});setting.hasOwnProperty("orderBy")||(setting.orderBy={modal_plane_select:["default","desc"]});setting.hasOwnProperty("copyToClipbord")&&(setting.copyToClipboard=setting.copyToClipbord,delete setting.copyToClipbord);setting.hasOwnProperty("visibleEquiped")&&(setting.visibleEquipped=setting.visibleEquiped,delete setting.visibleEquiped);saveLocalStorage("setting",setting)}
function initialize(a){var b=document.createDocumentFragment();b="";$.widget.bridge("uibutton",$.ui.button);$.widget.bridge("uitooltip",$.ui.tooltip);for(var c=0;c<PLANE_TYPE.length;c++){var d=new Image;b=PLANE_TYPE[c].id;d.src="./img/type/type"+b+".png";IMAGES["type"+b]=d;c===PLANE_TYPE.length-1&&d.addEventListener("load",function(){$("#loading_info").text("\u753b\u50cf\u30c7\u30fc\u30bf\u8aad\u307f\u8fbc\u307f\u5b8c\u4e86");setPlaneStockTable();$("#loading_text").addClass("load_end_text");$("#loading_text").text("\u5b8c\u4e86");
$("#loading_back").addClass("load_end");$("#loading_line").addClass("loading_line_expand");$("#modal_version_inform").find(".modal-body").html()&&$("#modal_version_inform").modal("show");setTimeout(function(){$("#loading_back").remove()},1E3)},!1)}for(c=0;c<SHIP_DATA.length;c++)d=new Image,b=SHIP_DATA[c].id,d.src="./img/ship/"+b+".png",IMAGES["ship"+b]=d;for(c=0;c<ENEMY_DATA.length;c++)d=new Image,b=ENEMY_DATA[c].id,d.src="./img/enemy/"+b+".png",IMAGES["enemy"+b]=d;d=getUrlParams();initializeSetting();
document.getElementById("theme_color").value=setting.themeColor;theme_color_Changed();c=CHANGE_LOG[CHANGE_LOG.length-1];document.getElementById("latest_version").textContent=c.id;if(setting.version!==c.id){b=document.createDocumentFragment();for(var e=$jscomp.makeIterator(c.changes),f=e.next();!f.done;f=e.next()){f=f.value;var g=document.createElement("div");g.className="mt-3";var h=document.createElement("div"),k=document.createElement("span");k.className="mr-1 pt-1 badge badge-pill badge-"+(0===
f.type?"success":1===f.type?"info":"danger");k.textContent=0===f.type?"\u65b0\u898f":1===f.type?"\u5909\u66f4":"\u4fee\u6b63";var l=document.createElement("span");l.innerHTML=f.title;h.appendChild(k);h.appendChild(l);g.appendChild(h);f.content&&(h=document.createElement("div"),h.className="font_size_12 pl-3",h.innerHTML=f.content,g.appendChild(h));b.appendChild(g)}document.getElementById("version").textContent=c.id;document.getElementById("version_inform_body").appendChild(b);deleteLocalStorage("version");
deleteLocalStorage("autoSave");deleteLocalStorage("simulateCount");deleteLocalStorage("emptySlotInvisible");deleteLocalStorage("modalDisplayMode");deleteLocalStorage("defaultProf");(b=loadLocalStorage("planeStock"))&&0<b.length&&!b[0].num.length&&deleteLocalStorage("planeStock")}setPlaneType($("#plane_type_select"),PLANE_TYPE.filter(function(a){return 0<a.id}).map(function(a){return a.id}));setPlaneType($("#stock_type_select"),PLANE_TYPE.filter(function(a){return 0<a.id}).map(function(a){return a.id}));
$("#plane_type_select").find("option").each(function(){var a=this;basicSortedPlanes=basicSortedPlanes.concat(PLANE_DATA.filter(function(b){return Math.abs(b.type)===castInt($(a).val())}))});setShipType(SHIP_TYPE.filter(function(a){return 15>a.id}).map(function(a){return a.id}));setEnemyType(ENEMY_TYPE.filter(function(a){return 0<a.id}).map(function(a){return a.id}));var m=[];$("#plane_type_select").find("option").each(function(){var a=this;m=m.concat(PLANE_DATA.filter(function(b){return Math.abs(b.type)===
castInt($(a).val())}))});createPlaneTable(m);$("#display_final").prop("checked",setting.visibleFinal);$("#frequent_ship").prop("checked",setting.orderByFrequency);createShipTable([0]);createEnemyTable([0]);b="";for(e=0;10>=e;e++)b+='<div class="remodel_item" data-remodel="'+e+'"><i class="fas fa-star"></i>',b=10===e?b+"max</div>":b+("+"+e+"</div>");$(".remodel_select").next().append(b);b=$(".prof_select:first").next().html();$(".prof_select").next().html(b);$(".lb_tab").html($("#lb_item1").html());
$(".baseNo").each(function(a,b){$(b).text("\u7b2c"+(a+1)+"\u57fa\u5730\u822a\u7a7a\u968a")});$(".lb_plane").html($("#lb_item1").find(".lb_plane:first").html());b=$("#lb_info_table tbody").html();for(e=0;2>e;e++)$("#lb_info_table tbody").append(b);$(".lb_info_tr").each(function(a,b){$(b).addClass("lb_info_lb_"+(Math.floor(a/4)+1));$(b).find(".info_name").text("\u7b2c"+(Math.floor(a/4)+1)+"\u57fa\u5730\u822a\u7a7a\u968a")});$(".ship_tab").html($(".ship_tab:first").html());$(".ship_plane").html($("#friendFleet_item1").find(".ship_plane:first").html());
$(".ship_tab").each(function(a,b){$(b).attr("id","shipNo_"+(a+1));$(b).find(".ship_disabled").attr("id","disabled_ship_"+(a+1));$(b).find(".ship_disabled_label").attr("for","disabled_ship_"+(a+1))});$(".display_ship_count").val(2);b=$("#battle_container").html();for(e=1;10>e;e++)$("#battle_container").append(b);$(".battle_content").each(function(a,b){$(b).find(".battle_no").text(a+1);0<a&&$(b).addClass("d-none");$(b).find(".custom-control-input").attr("id","grand_"+a);$(b).find(".custom-control-label").attr("for",
"grand_"+a)});$("#battle_count").val(1);$("#landBase_target").val(1);createMapSelect();createNodeSelect();$("#display_bar").prop("checked",!0);$("#display_land_base_result").prop("checked",!0);$("#display_fleet_result").prop("checked",!0);$("#display_enemy_table").prop("checked",!0);$(".remodel_select").prop("disabled",!0);$(".progress_area").html($(".progress_area:first").html());$(".progress_area").each(function(a,b){$(b).find(".result_bar").attr("id","result_bar_"+(a+1));6>a&&$(b).find(".progress_label").text("\u57fa\u5730"+
(Math.floor(a/2)+1)+" "+(a%2+1)+"\u6ce2\u76ee");6===a&&$(b).find(".progress_label").text("\u672c\u968a");7===a&&$(b).find(".progress_label").text("\u9632\u7a7a")});g=f=e=b="";for(h=1;10>=h;h++)b+='<td class="td_battle battle'+h+'">'+h+"\u6226\u76ee</td>",e+='<td class="td_battle battle'+h+' fap"></td>',f+='<td class="td_battle battle'+h+' eap"></td>',g+='<td class="td_battle battle'+h+' cond"></td>';$("#shoot_down_table").find(".tr_header").append(b+'<td class="td_battle battle_end">\u51fa\u6483\u5f8c</td><td class="td_battle battle_death">\u5168\u6ec5\u7387</td>');
$(".tr_fap").append(e+'<td class="td_battle battle_end fap font_size_11" colspan="2"></td>');$(".tr_eap").append(f+'<td class="td_battle battle_end eap" rowspan="2" colspan="2"></td>');$(".tr_cond").append(g);b="";for(e=1;10>=e;e++)b+='\n      <li class="nav-item '+(1===e?"":"d-none")+'">\n        <a class="nav-link '+(1===e?"active":"")+'" data-toggle="tab" data-disp="'+e+'" href="#">'+e+"\u6226\u76ee</a>\n      </li>";$("#display_battle_tab").html(b);b=$("#rate_table").find("thead").html();for(e=
0;7>=e;e++)$("#rate_table tbody").append(b);$("#rate_table tbody").find("tr").each(function(a,b){var c=Math.floor(a/2)+1,d=a%2+1;$(b).attr("id","rate_row_"+(a+1));6>a?($(b).find(".rate_td_name").html('<span class="mr-1">\u7b2c'+c+'\u57fa\u5730</span><span class="text-nowrap">'+d+"\u6ce2\u76ee</span>"),$(b)[0].dataset.base_no=c-1,$(b).addClass("cur_pointer land_base_detail")):6===a?$(b).find(".rate_td_name").text("\u672c\u968a"):7===a&&$(b).find(".rate_td_name").text("\u9632\u7a7a");0===a%2?$(b).addClass("rate_tr_border_top"):
6<=a&&$(b).addClass("rate_tr_border_top rate_tr_border_bottom")});b=$("#init_prof_parent").html();e=PLANE_TYPE.filter(function(a){return 0<a.id&&104!==a.id});e=$jscomp.makeIterator(e);for(f=e.next();!f.done;f=e.next())f=f.value,$("#init_prof_parent").append(b),g=$("#init_prof_parent").find(".type_name:last"),g.text(f.abbr),g.closest(".init_prof")[0].dataset.typeid=f.id;$("#init_prof_parent").find(".init_prof:first").remove();b=$jscomp.makeIterator(setting.defaultProf);for(f=b.next();!f.done;f=b.next())e=
f.value,proficiency_Changed($('.init_prof[data-typeid="'+e.id+'"').find('.prof_option[data-prof="'+e.prof+'"]').parent(),!0);if(setting.contentsOrder.length){b=$("#main_contents");e=$("#side_index");var n=[],r=[];$(".contents").each(function(a,b){n.push($(b))});b.empty();e.find("li").each(function(a,b){r.push($(b))});e.empty();f={};g=$jscomp.makeIterator(setting.contentsOrder);for(h=g.next();!h.done;f={$jscomp$loop$prop$id$126$275:f.$jscomp$loop$prop$id$126$275},h=g.next())f.$jscomp$loop$prop$id$126$275=
h.value,h=n.find(function(a){return function(b){return b.attr("id")===a.$jscomp$loop$prop$id$126$275}}(f)),b.append(h),h=r.find(function(a){return function(b){return b.attr("id")==="li_"+a.$jscomp$loop$prop$id$126$275}}(f)),e.append(h)}loadMainPreset();$("#stage2_detail_slot").val(18);$("#stage2_detail_avoid").val(0);setting.simulateCount?$("#calculate_count").val(setting.simulateCount):$("#calculate_count").val(5E3);setting.initialProf120&&(initialProf120Plane=setting.initialProf120);b=$jscomp.makeIterator(initialProf120Plane);
for(f=b.next();!f.done;f=b.next())$("#prof120_"+f.value).prop("checked",!0);setting.displayMode?Object.keys(setting.displayMode).forEach(function(a){$("#"+a+' .toggle_display_type[data-mode="'+setting.displayMode[a]+'"]').addClass("selected")}):$('.toggle_display_type[data-mode="single"]').addClass("selected");setting.orderBy||(setting.orderBy={modal_plane_select:["default","desc"]});Object.keys(setting.orderBy).forEach(function(a){$("#"+a+" .sort_select").val(setting.orderBy[a][0]);$("#"+a+" .order_"+
setting.orderBy[a][1]).prop("checked",!0)});$("#auto_save").prop("checked",setting.autoSave);$("#backup_enabled").prop("checked",setting.backUpEnabled);$("#suspend_backup").prop("checked",!1);$("#backup_count").prop("disabled",!setting.backUpEnabled);$("#backup_count").val(setting.backUpCount);$("#union_fleet").prop("checked",setting.isUnion);$("#clipboard_mode").prop("checked",setting.copyToClipboard);$("#air_raid_max").prop("checked",setting.airRaidMax);$("#empty_slot_invisible").prop("checked",
setting.emptySlotInvisible);$("#disp_in_stock").prop("checked",setting.inStockOnly);$("#disp_equipped").prop("checked",setting.visibleEquipped);$("#enemy_display_image").prop("checked",setting.enemyDisplayImage);$("#enemy_display_text").prop("checked",!setting.enemyDisplayImage);$("#plane_word").val("");$("#ship_word").val("");$("#enemy_word").val("");$("#stock_word").val("");$("#modal_auto_expand").find(".custom-control-input").prop("checked",!1);$("#btn_start_auto_expand").prop("disabled",!0);$("#mode_1").prop("checked",
!0);$("#dest_ap").val(100);$("#dest_range").val(6);setting.autoSave&&(b=loadLocalStorage("autoSaveData"),expandMainPreset(decodePreset(b)));if(d.hasOwnProperty("d"))decodePreset(d.d),expandMainPreset(decodePreset(d.d)),existParam=!0;else if(d.hasOwnProperty("predeck")||d.hasOwnProperty("lb"))if(d.hasOwnProperty("predeck")&&(readDeckBuilder(d.predeck),(b=readDeckBuilder(d.predeck))&&expandMainPreset(b,0<b[0][0].length,!0,!1)),d.hasOwnProperty("lb"))try{var p=JSON.parse(decodeURIComponent(d.lb));2<=
p.length&&expandMainPreset([p,[],[]],!0,!1,!1)}catch(x){}"none"===$("#lb_tab_select").css("display")||$("#lb_item1").attr("class").includes("tab-pane")||($(".lb_tab").addClass("tab-pane fade"),$(".baseNo").removeClass("cur_move sortable_handle"),$(".lb_tab:first").addClass("show active"),$("#lb_item1").addClass("active"));b=document.createDocumentFragment();p=0;d=$jscomp.makeIterator(CHANGE_LOG);for(e=d.next();!e.done;e=d.next())for(e=e.value,f=document.createElement("div"),f.className="my-3 ver_log border-bottom",
g=document.createElement("div"),g.className="py-2",g.textContent="v"+e.id,c.id===e.id&&(h=document.createElement("span"),h.className="ml-2 pt-1 badge badge-pill badge-danger",h.textContent="New",g.appendChild(h)),f.appendChild(g),g=0;g<e.changes.length;g++){h=e.changes[g];k="log_"+p++ +"_"+g;l=document.createElement("div");l.className="py-2 px-2 d-flex collapsed history_item history_item_no_content";var q=document.createElement("div");q.className="d-flex flex-nowrap align-self-center";var u=document.createElement("div");
u.className="align-self-center";var t=document.createElement("span");t.className="mr-2 pt-1 badge badge-pill badge-"+(0===h.type?"success":1===h.type?"info":"danger");t.textContent=0===h.type?"\u65b0\u898f":1===h.type?"\u5909\u66f4":"\u4fee\u6b63";var w=document.createElement("div");w.className="align-self-center";w.innerHTML=h.title;u.appendChild(t);q.appendChild(u);q.appendChild(w);l.appendChild(q);f.appendChild(l);h.content&&(l.dataset.toggle="collapse",l.dataset.target="#"+k,l.classList.remove("history_item_no_content"),
l=document.createElement("div"),l.id=k,l.className="border-top collapse history_content",k=document.createElement("div"),k.className="pl-3 py-2 font_size_12",k.innerHTML=h.content,l.appendChild(k),f.appendChild(l));b.appendChild(f)}c=document.createElement("div");c.className="mt-2 font_size_12";c.textContent=LAST_UPDATE_DATE;b.appendChild(c);document.getElementById("site_history_body").appendChild(b);$("#site_information").find(".collapse_content").collapse("hide");$('[data-toggle="tooltip"]').tooltip();
$('[data-toggle="popover"]').popover();$("#loading_info").text("\u521d\u671f\u8a08\u7b97\u4e2d");a()}
function setPlaneType(a,b){a.empty();a.append('<option value="0">\u5168\u3066</option>');for(var c=!1,d=$jscomp.makeIterator([100,101,102,103,104]),e=d.next();!e.done&&!(c=b.includes(e.value));e=d.next());c&&(a.append('<optgroup label="\u9678\u4e0a\u6a5f" id="optg_lb">'),c=!1);d=$jscomp.makeIterator([1,2,3,4,9]);for(e=d.next();!e.done&&!(c=b.includes(e.value));e=d.next());c&&(a.append('<optgroup label="\u8266\u4e0a\u6a5f" id="optg_cb">'),c=!1);d=$jscomp.makeIterator([5,6,7,8]);for(e=d.next();!e.done&&
!(c=b.includes(e.value));e=d.next());c&&a.append('<optgroup label="\u6c34\u4e0a\u6a5f" id="optg_sp">');c=$jscomp.makeIterator(PLANE_TYPE);for(e=c.next();!e.done;e=c.next())d=e.value,b.includes(d.id)&&(e='<option value="'+d.id+'">'+d.name+"</option>",a.find("#"+([1,2,3,4,9].includes(d.id)?"optg_cb":[5,6,7,8].includes(d.id)?"optg_sp":"optg_lb")).append(e))}
function setShipType(a){for(var b="",c=$jscomp.makeIterator(SHIP_TYPE),d=c.next();!d.done;d=c.next())d=d.value,a.includes(d.id)&&(b+='<option value="'+d.id+'">'+d.name+"</option>");$("#ship_type_select").append(b)}function setEnemyType(a){for(var b="",c=$jscomp.makeIterator(ENEMY_TYPE),d=c.next();!d.done;d=c.next())d=d.value,a.includes(d.id)&&(b+='<option value="'+d.id+'">'+d.name+"</option>");$("#enemy_type_select").append(b)}
function clearPlaneDiv(a){a.removeClass(getPlaneCss(a[0].dataset.type));a[0].dataset.planeid="";a[0].dataset.type="";a.find(".plane_img").attr("src","./img/type/undefined.png").attr("alt","");a.find(".cur_move").removeClass("cur_move");a.find(".drag_handle").removeClass("drag_handle");a.find(".plane_name_span").text("\u6a5f\u4f53\u3092\u9078\u629e");a.find("select").val("0").change();a.find(".remodel_select").prop("disabled",!0).addClass("remodel_disabled");a.find(".remodel_value").text(0);a.find(".prof_select").attr("src",
"./img/util/prof0.png").attr("alt","").data("prof",0);a.find(".btn_remove_plane").addClass("opacity0")}function clearPlaneDivAll(a){"landBase"===a.attr("id")?($(".lb_plane").each(function(a,c){return setLBPlaneDiv($(c))}),$("#modal_collectively_setting").modal("hide")):"friendFleet"===a.attr("id")&&$(".ship_plane").each(function(a,c){return clearPlaneDiv($(c))})}
function setLBPlaneDiv(a,b){b=void 0===b?{id:0,slot:0,remodel:0}:b;var c=castInt(b.id),d=PLANE_DATA.find(function(a){return a.id===c}),e=setPlaneDiv(a,b);b.hasOwnProperty("slot")||(b.slot=0);var f=18;e&&d&&RECONNAISSANCES.includes(d.type)&&(f=4);a.find(".slot_input").attr("max",f);a.find(".slot_range").attr("max",f);d=b.slot;if(0===d||d>f)d=f;e||(d=0);a.find(".slot").text(d)}
function setPlaneDiv(a,b,c){b=void 0===b?{id:0,remodel:0,prof:-1}:b;c=void 0===c?!1:c;if(!b.id)return clearPlaneDiv(a),!1;var d=PLANE_DATA.find(function(a){return a.id===b.id});if(!d)return clearPlaneDiv(a),!1;b.hasOwnProperty("remodel")||(b.remodel=0);b.hasOwnProperty("prof")||(b.prof=-1);if(a.closest(".ship_tab").hasClass("ship_tab")){var e=castInt(a.closest(".ship_tab")[0].dataset.shipid);if(!checkInvalidPlane(e,d))return clearPlaneDiv(a),!1;8!==d.type||1490!==e&&386!==e||(b.hasOwnProperty("slot"),
b.slot=1,c=!0)}a.removeClass(getPlaneCss(a[0].dataset.type)).addClass(getPlaneCss(d.type));a[0].dataset.planeid=d.id;a[0].dataset.type=d.type;a.find(".plane_name_span").text(d.abbr?d.abbr:d.name).attr("title",d.abbr?d.name:"");a.find(".plane_img").attr("src","./img/type/type"+d.type+".png").attr("alt",d.type);a.find(".plane_img").parent().addClass("cur_move drag_handle");a.find(".plane_name").addClass("drag_handle");a.find(".btn_remove_plane").removeClass("opacity0");e=a.find(".remodel_select");e.prop("disabled",
!d.canRemodel).removeClass("remodel_disabled");d.canRemodel?e.find(".remodel_value").text(Math.min(b.remodel,10)):(e.addClass("remodel_disabled"),e.find(".remodel_value").text(0));e=0;var f=setting.defaultProf.find(function(a){return a.id===Math.abs(d.type)});f&&(e=f.prof);312===d.id&&(e=2);0<=b.prof&&(e=b.prof);f=a.find(".prof_select");f.attr("src","./img/util/prof"+e+".png").removeClass("prof_yellow prof_blue prof_none");f[0].dataset.prof=e;3<e?a.find(".prof_select").addClass("prof_yellow"):0<e?
a.find(".prof_select").addClass("prof_blue"):a.find(".prof_select").addClass("prof_none");c&&(b.hasOwnProperty("slot")||(b.slot=0),a.find(".slot").text(b.slot));return!0}
function setShipDiv(a,b){var c=SHIP_DATA.find(function(a){return a.id===b});c&&(a[0].dataset.shipid=c.id,a.find(".ship_img").attr("src","./img/ship/"+b+".png"),a.find(".ship_img").removeClass("d-none"),a.find(".ship_name_span").text(c.name),a.find(".ship_plane").each(function(b,e){var d=$(e),g={id:castInt(d[0].dataset.planeid),remodel:castInt(d.find(".remodel_value").text()),prof:castInt(d.find(".prof_select")[0].dataset.prof)};a[0].dataset.shipid&&setPlaneDiv(d,g);d.find(".slot").text(0);d.find(".slot_ini").data("ini",
0);b<c.slot.length?(d.removeClass("d-none").addClass("d-flex"),d.find(".slot").text(c.slot[b]),d.find(".slot_ini").data("ini",c.slot[b])):(clearPlaneDiv(d),d.removeClass("d-flex").addClass("d-none"))}))}
function clearShipDiv(a){a[0].dataset.shipid="";a.find(".ship_img").addClass("d-none");a.find(".ship_img").attr("src","./img/ship/0.png");a.find(".ship_name_span").text("\u8266\u5a18\u3092\u9078\u629e");a.find(".ship_plane").each(function(a,c){var b=$(c);clearPlaneDiv(b);b.find(".slot").text(0);b.find(".slot_input").attr("max",99);b.find(".slot_range").attr("max",99);4>a?b.removeClass("d-none").addClass("d-flex"):b.removeClass("d-flex").addClass("d-none")})}
function clearShipDivAll(a){a=void 0===a?2:a;$(".ship_tab").each(function(a,c){return clearShipDiv($(c))});$(".display_ship_count").each(function(b,c){$(c).val(a);display_ship_count_Changed($(c),!0)})}
function setEnemyDiv(a,b,c){c=void 0===c?0:c;if(a){var d=a.parent(),e=createEnemyObject(b);if(0!==e.id){a[0].dataset.enemyid=e.id;a.find(".enemy_name_span").html(drawEnemyGradeColor(e.name));var f=0;-1===b&&0<c?f=c:0<e.ap?f=e.ap:0<e.lbAp&&(f="("+e.lbAp+")");a.find(".enemy_ap").text(f);a.find(".enemy_index").addClass("drag_handle cur_move");b=castInt(a.closest(".battle_content").find(".cell_type").val())===CELL_TYPE.grand?12:6;!a.next().hasClass("enemy_content")&&a.parent().find(".enemy_content").length<
b&&(b=a.clone(),clearEnemyDiv(b),a.parent().append(b));d.find(".enemy_content").each(function(a,b){$(b).find(".enemy_index").text(a+1)});isDefMode||a.draggable({delay:100,helper:"clone",handle:".drag_handle",zIndex:1E3,start:function(a,b){$(b.helper).find(".enemy_ap_select_parent").addClass("d-none");$(b.helper).removeClass("enemy_content py-1");$(b.helper).css("backgroundColor","#fff").css("border","2px solid #ccc").css("border-radius",".25rem")},stop:function(){if(isOut||!isCtrlPress&&!$("#drag_drop_copy").prop("checked"))clearEnemyDiv(a),
isOut=!1;calculate()}})}}}
function clearEnemyDiv(a){var b=a.parent();a.find(".drag_handle").removeClass("drag_handle cur_move");var c=castInt(a.closest(".battle_content").find(".cell_type").val())===CELL_TYPE.grand?12:6;a.next().attr("class")?(b.find(".enemy_content").length===c&&b.find(".enemy_content:last")[0].dataset.enemyid&&(c=a.clone(),clearEnemyDiv(c),b.append(c)),a.remove()):(a[0].dataset.enemyid="",a.find(".enemy_name_span").text("\u6575\u8266\u3092\u9078\u629e"),a.find(".enemy_ap").text(0));b.find(".enemy_content").each(function(a,
b){$(b).find(".enemy_index").text(a+1)})}function clearEnemyDivAll(a){a=void 0===a?1:a;$(".battle_content").each(function(a,c){$(c)[0].dataset.celldata="";$(c).find(".enemy_content:not(:first)").remove();clearEnemyDiv($(c).find(".enemy_content"))});$("#battle_count").val(a);createEnemyInput(a);$("#air_raid_enemies").find(".enemy_content:not(:first)").remove();clearEnemyDiv($("#air_raid_enemies").find(".enemy_content"))}
function drawChangeValue(a,b,c,d){castInt(b)!==castInt(c)&&($inline=$(a),$inline.text(c).stop(),d?$inline.css("color",c<b?"#0c5":c>b?"#f00":"#000"):$inline.css("color",c>b?"#0c5":c<b?"#f00":"#000"),$inline.delay(500).animate({color:"#000"},1E3))}
function drawEnemyGradeColor(a){a.includes("elite")?a=a.replace("elite",'<span class="text-danger">elite</span>'):a.includes("\u6539flagship")?a=a.replace("flagship",'<span class="text-primary">flagship</span>'):a.includes("flagship")&&(a=a.replace("flagship",'<span class="text-warning">flagship</span>'));return a}
function createPlaneTable(a){var b=$("#modal_plane_select").find(".modal-dialog"),c=$("#plane_tbody"),d=document.getElementById("plane_tbody"),e=document.createDocumentFragment(),f=b.find(".toggle_display_type.selected").data("mode"),g=loadPlaneStock(),h=setting.inStockOnly,k=setting.visibleEquipped,l=$("#plane_sort_select").val();"multi"===f?(b.addClass("modal-xl"),c.addClass("d-flex flex-wrap"),c.prev().addClass("d-none").removeClass("d-flex")):(b.removeClass("modal-xl"),c.removeClass("d-flex flex-wrap"),
c.prev().addClass("d-flex").removeClass("d-none"));h?($("#disp_equipped").closest("div").removeClass("d-none"),$("#disp_in_stock").prop("checked",!0)):($("#disp_equipped").closest("div").addClass("d-none"),$("#disp_in_stock").prop("checked",!1));b=a.length;for(var m=0,n=0,r=0,p=0,q={},u=0;u<b;q={$jscomp$loop$prop$plane$279:q.$jscomp$loop$prop$plane$279},u++){q.$jscomp$loop$prop$plane$279=a[u];var t=q.$jscomp$loop$prop$plane$279.antiAir+1.5*q.$jscomp$loop$prop$plane$279.interception,w=q.$jscomp$loop$prop$plane$279.antiAir+
q.$jscomp$loop$prop$plane$279.interception+2*q.$jscomp$loop$prop$plane$279.antiBomber,x=0<q.$jscomp$loop$prop$plane$279.antiBomber||0<q.$jscomp$loop$prop$plane$279.interception;if(h&&g){var v=g.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$plane$279.id}}(q)),y=usedPlane.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$plane$279.id}}(q)),A=y?getArraySum(y.num):0;p=v?getArraySum(v.num):0;if(0>=p||!k&&A>=p)continue;r=p-A;for(p=10;0<=p;p--)if(y&&(v.num[p]-=
y.num[p]),0<v.num[p]){n=p;break}}v=document.createElement("div");v.className="plane plane_tr d-flex py-2 py-lg-1"+("multi"===f?" tr_multi":"");v.dataset.planeid=q.$jscomp$loop$prop$plane$279.id;v.dataset.type=q.$jscomp$loop$prop$plane$279.type;v.dataset.remodel=n;h&&k&&0>=r&&(v.classList.remove("plane_tr","plane"),v.classList.add("plane_tr_disabled"));y=document.createElement("div");y.className="align-self-center size-25";p=document.createElement("canvas");A=p.getContext("2d");p.width=25;p.height=
25;A.drawImage(IMAGES["type"+q.$jscomp$loop$prop$plane$279.type],0,0,25,25);A=document.createElement("div");A.className="pl-1 plane_td_name align-self-center";A.textContent=q.$jscomp$loop$prop$plane$279.name;var B=document.createElement("div");B.className="ml-1 plane_td_stock align-self-center";B.textContent="\u00d7"+(0<r?r:0);var z=document.createElement("div");z.className="ml-auto plane_td_basic align-self-center "+(x?"text_existTooltip":"");x&&(z.dataset.toggle="tooltip",z.title="\u51fa\u6483\u6642:"+
t+" , \u9632\u7a7a\u6642:"+w);switch(l){case "battle_anti_air":z.textContent=t;break;case "defense_anti_air":z.textContent=w;break;default:z.textContent=q.$jscomp$loop$prop$plane$279.antiAir}t=document.createElement("div");t.className="plane_td_basic align-self-center";t.textContent=q.$jscomp$loop$prop$plane$279.radius;"multi"===f&&m!==q.$jscomp$loop$prop$plane$279.type&&"default"===l&&(m=document.createElement("div"),m.className="d-flex w-100 mt-3 mb-1",w=document.createElement("div"),w.className=
"font_size_12 font_color_777 align-self-center",w.textContent=PLANE_TYPE.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$plane$279.type}}(q)).name,x=document.createElement("div"),x.className="flex-grow-1 border-bottom align-self-center mx-2",m.appendChild(w),m.appendChild(x),e.appendChild(m));y.appendChild(p);v.appendChild(y);v.appendChild(A);(0<r||h&&k)&&v.appendChild(B);"single"===f&&(v.appendChild(z),v.appendChild(t));e.appendChild(v);m=q.$jscomp$loop$prop$plane$279.type}d.innerHTML=
"";d.appendChild(e);c.find(".text_existTooltip").tooltip()}
function setPlaneStockTable(){for(var a=document.getElementById("plane_stock_tbody"),b=document.createDocumentFragment(),c=PLANE_DATA.filter(function(a){return 0<a.id}),d=loadPlaneStock(),e=c.length,f={},g=0;g<e;f={$jscomp$loop$prop$plane$281:f.$jscomp$loop$prop$plane$281},g++){f.$jscomp$loop$prop$plane$281=c[g];var h=f.$jscomp$loop$prop$plane$281.antiAir+1.5*f.$jscomp$loop$prop$plane$281.interception,k=f.$jscomp$loop$prop$plane$281.antiAir+f.$jscomp$loop$prop$plane$281.interception+2*f.$jscomp$loop$prop$plane$281.antiBomber,
l=d.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$plane$281.id}}(f)),m=document.createElement("div");m.className="stock_tr py-1 d-flex type_"+Math.abs(f.$jscomp$loop$prop$plane$281.type);m.dataset.planeid=f.$jscomp$loop$prop$plane$281.id;var n=document.createElement("div");n.className="stock_td_type align-self-center";var r=document.createElement("canvas"),p=r.getContext("2d");r.width=24;r.height=24;p.drawImage(IMAGES["type"+f.$jscomp$loop$prop$plane$281.type],0,0,24,24);p=
document.createElement("div");p.className="stock_td_name font_size_14 text-left align-self-center";p.textContent=f.$jscomp$loop$prop$plane$281.name;var q=document.createElement("div");q.className="stock_td_aa align-self-center";q.textContent=h+(k!=h?" ( "+k+" )":"");h=document.createElement("div");h.className="stock_td_range align-self-center";h.textContent=f.$jscomp$loop$prop$plane$281.radius;k=document.createElement("div");k.className="stock_td_stock align-self-center px-2";k.textContent=l?getArraySum(l.num):
99;n.appendChild(r);m.appendChild(n);m.appendChild(p);m.appendChild(q);m.appendChild(h);m.appendChild(k);b.appendChild(m)}a.innerHTML="";a.appendChild(b);$("#stock_type_select").change()}
function createShipTable(a){var b=$("#modal_ship_select").find(".modal-dialog"),c=$("#ship_tbody"),d=document.getElementById("ship_tbody"),e=document.createDocumentFragment(),f=[],g=0,h=b.find(".toggle_display_type.selected").data("mode"),k=$("#display_final").prop("checked"),l=$("#ship_word").val().trim(),m=$("#frequent_ship").prop("checked");setting.visibleFinal=k;setting.orderByFrequency=m;saveLocalStorage("setting",setting);for(var n={},r=$jscomp.makeIterator(SHIP_TYPE),p=r.next();!p.done;n={$jscomp$loop$prop$typeObj$283:n.$jscomp$loop$prop$typeObj$283},
p=r.next())n.$jscomp$loop$prop$typeObj$283=p.value,p=SHIP_DATA.filter(function(a){return function(b){return b.type===a.$jscomp$loop$prop$typeObj$283.id}}(n)),p.sort(function(a,b){return a.orig>b.orig?1:a.orig===b.orig?a.id>b.id?1:-1:-1}),f=f.concat(p);if(m&&setting.selectedHistory[1]){var q=setting.selectedHistory[1];f.sort(function(a,b){return q.filter(function(a){return a===b.id}).length-q.filter(function(b){return b===a.id}).length})}"multi"===h?(b.addClass("modal-xl"),c.addClass("d-flex flex-wrap"),
$("#ship_thead").addClass("d-none").removeClass("d-flex")):(b.removeClass("modal-xl"),c.removeClass("d-flex flex-wrap"),$("#ship_thead").addClass("d-flex").removeClass("d-none"));b={};f=$jscomp.makeIterator(f);for(c=f.next();!c.done;b={$jscomp$loop$prop$ship$285:b.$jscomp$loop$prop$ship$285},c=f.next())if(b.$jscomp$loop$prop$ship$285=c.value,0===a[0]||a.includes(b.$jscomp$loop$prop$ship$285.type))if(!k||b.$jscomp$loop$prop$ship$285["final"])if(!l||b.$jscomp$loop$prop$ship$285.name.includes(l)){c=
document.createElement("div");c.className="ship ship_tr d-flex "+("multi"===h?"tr_multi":"py-1");c.dataset.shipid=b.$jscomp$loop$prop$ship$285.id;m=document.createElement("div");m.className="ml-1 align-self-center pt-1";n=document.createElement("canvas");r=n.getContext("2d");n.width=120;n.height=30;r.drawImage(IMAGES["ship"+b.$jscomp$loop$prop$ship$285.id],0,0,120,30);m.appendChild(n);n=document.createElement("div");n.className="ml-1 align-self-center";r=document.createElement("div");r.className=
"text-primary font_size_11";r.textContent="ID : "+(1E3<b.$jscomp$loop$prop$ship$285.id?b.$jscomp$loop$prop$ship$285.orig+"b":b.$jscomp$loop$prop$ship$285.id);p=document.createElement("div");p.textContent=b.$jscomp$loop$prop$ship$285.name;n.appendChild(r);n.appendChild(p);"multi"===h&&g!==b.$jscomp$loop$prop$ship$285.type&&(g=document.createElement("div"),g.className="w-100 d-flex mt-3",r=document.createElement("div"),r.className="font_size_12 font_color_777 align-self-center",r.textContent=SHIP_TYPE.find(function(a){return function(b){return b.id===
a.$jscomp$loop$prop$ship$285.type}}(b)).name,p=document.createElement("div"),p.className="flex-grow-1 border-bottom align-self-center mx-2",g.appendChild(r),g.appendChild(p),e.appendChild(g));c.appendChild(m);c.appendChild(n);if("single"===h)for(g=0;5>g;g++)m=document.createElement("div"),m.className="ship_td_slot font_size_12 align-self-center "+(0===g?"ml-auto":""),m.textContent=g<b.$jscomp$loop$prop$ship$285.slot.length?b.$jscomp$loop$prop$ship$285.slot[g]:"",c.appendChild(m);e.appendChild(c);
g=b.$jscomp$loop$prop$ship$285.type}d.innerHTML="";d.appendChild(e)}
function createEnemyInput(a){battleCount=a;$(".battle_content").each(function(a,c){a<battleCount?$(c).removeClass("d-none"):$(c).addClass("d-none")});$("#battle_count").val(a);$("#landBase_target").find("option").each(function(a,c){a<battleCount?$(c).prop("disabled",!1).removeClass("d-none"):$(c).prop("disabled",!0).addClass("d-none")});$("#landBase_target").val(battleCount);$("#display_battle_tab").find(".nav-link").each(function(a,c){$(c).removeClass("active");a<battleCount?$(c).parent().removeClass("d-none"):
$(c).parent().addClass("d-none")});$("#display_battle_tab").find('[data-disp="'+battleCount+'"]').addClass("active");displayBattle=battleCount}
function createEnemyTable(a){for(var b=$("#modal_enemy_select").find(".modal-dialog"),c=$("#enemy_tbody"),d=document.getElementById("enemy_tbody"),e=document.createDocumentFragment(),f=[],g=0,h=b.find(".toggle_display_type.selected").data("mode"),k=$("#enemy_word").val().trim(),l={},m=$jscomp.makeIterator(ENEMY_TYPE),n=m.next();!n.done;l={$jscomp$loop$prop$typeObject$287:l.$jscomp$loop$prop$typeObject$287},n=m.next())l.$jscomp$loop$prop$typeObject$287=n.value,1!==l.$jscomp$loop$prop$typeObject$287.id&&
(n=ENEMY_DATA.filter(function(a){return function(b){return b.type[0]===a.$jscomp$loop$prop$typeObject$287.id}}(l)),f=f.concat(n.sort(function(a,b){return a.orig>b.orig?1:a.orig<b.orig?-1:a.id-b.id})));l=ENEMY_DATA.filter(function(a){return 1===a.type[0]});f=f.concat(l.sort(function(a,b){return a.id>b.id?1:-1}));"multi"===h?(b.addClass("modal-xl"),c.addClass("d-flex flex-wrap"),$(".enemy_thead").addClass("d-none").removeClass("d-flex")):(b.removeClass("modal-xl"),c.removeClass("d-flex flex-wrap"),
$(".enemy_thead").addClass("d-flex").removeClass("d-none"));b={};f=$jscomp.makeIterator(f);for(c=f.next();!c.done;b={$jscomp$loop$prop$enemy$292:b.$jscomp$loop$prop$enemy$292},c=f.next())if(b.$jscomp$loop$prop$enemy$292=c.value,0===a[0]||isContain(a,b.$jscomp$loop$prop$enemy$292.type))if(!k||b.$jscomp$loop$prop$enemy$292.name.includes(k)){c=l=0;m=b.$jscomp$loop$prop$enemy$292.slot.length;for(n={$jscomp$loop$prop$i$291:0};n.$jscomp$loop$prop$i$291<m;n={$jscomp$loop$prop$i$291:n.$jscomp$loop$prop$i$291},
n.$jscomp$loop$prop$i$291++){var r=ENEMY_PLANE_DATA.find(function(a,b){return function(c){return c.id===a.$jscomp$loop$prop$enemy$292.eqp[b.$jscomp$loop$prop$i$291]}}(b,n));r&&(5!==r.type?l+=Math.floor(r.antiAir*Math.sqrt(b.$jscomp$loop$prop$enemy$292.slot[n.$jscomp$loop$prop$i$291])):c+=Math.floor(r.antiAir*Math.sqrt(b.$jscomp$loop$prop$enemy$292.slot[n.$jscomp$loop$prop$i$291])))}c+=l;m=document.createElement("div");m.className="enemy enemy_tr d-flex "+("multi"===h?"enemy_tr_multi":"");m.dataset.enemyid=
b.$jscomp$loop$prop$enemy$292.id;n=document.createElement("div");n.className="ml-1 align-self-center pt-1_5";r=document.createElement("canvas");var p=r.getContext("2d");r.width=128;r.height=32;p.drawImage(IMAGES["enemy"+b.$jscomp$loop$prop$enemy$292.id],0,0,128,32);n.appendChild(r);r=document.createElement("div");r.className="ml-1 align-self-center";p=document.createElement("div");p.className="text-primary font_size_11";p.textContent="ID : "+(b.$jscomp$loop$prop$enemy$292.id+1500);var q=document.createElement("div");
q.className="font_size_12";q.innerHTML=drawEnemyGradeColor(b.$jscomp$loop$prop$enemy$292.name);r.appendChild(p);r.appendChild(q);"multi"===h&&g!==b.$jscomp$loop$prop$enemy$292.type[0]&&-1!==b.$jscomp$loop$prop$enemy$292.id&&(g=document.createElement("div"),g.className="w-100 d-flex mt-3",p=document.createElement("div"),p.className="font_size_12 font_color_777 align-self-center",p.textContent=ENEMY_TYPE.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$enemy$292.type[0]}}(b)).name,
q=document.createElement("div"),q.className="flex-grow-1 border-bottom align-self-center mx-2",g.appendChild(p),g.appendChild(q),e.appendChild(g),g=b.$jscomp$loop$prop$enemy$292.type[0]);m.appendChild(n);m.appendChild(r);"single"===h&&(n=document.createElement("div"),n.className="ml-auto align-self-center enemy_td_ap",n.textContent=l,l=document.createElement("div"),l.className="enemy_td_lbAp align-self-center",l.textContent=c,m.appendChild(n),m.appendChild(l));e.appendChild(m)}d.innerHTML="";d.appendChild(e);
$("#modal_enemy_select").find(".btn_remove").prop("disabled",!0)}
function loadPlanePreset(){var a=$("#modal_plane_preset");(planePreset=loadLocalStorage("planePreset"))||(planePreset=DEFAULT_PLANE_PRESET.concat());for(var b=castInt($("#modal_plane_preset").data("parentid")),c="",d=planePreset.length,e=0;e<d;e++){for(var f=planePreset[e],g='\n      <div class="preset_td preset_td_info text-danger cur_help ml-auto" data-toggle="tooltip" data-boundary="window"\n        title="\u5168\u3066\u306e\u88c5\u5099\u304c\u5c55\u958b\u3067\u304d\u307e\u305b\u3093\u3002">\n        <i class="fas fa-exclamation-triangle"></i>\n      </div>\n    ',h=
0,k={},l=$jscomp.makeIterator(f.planes),m=l.next();!m.done;k={$jscomp$loop$prop$planeId$294:k.$jscomp$loop$prop$planeId$294},m=l.next())k.$jscomp$loop$prop$planeId$294=m.value,checkInvalidPlane(b,PLANE_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$planeId$294}}(k)))&&(g='\n        <div class="preset_td preset_td_info text-warning cur_help ml-auto" data-toggle="tooltip" data-boundary="window"\n          title="\u5c55\u958b\u3067\u304d\u306a\u3044\u88c5\u5099\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002">\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n      ',
h++),h===f.planes.length&&(g="");c+='\n      <div class="preset_tr d-flex px-1 py-2 my-1 w-100 cur_pointer" data-presetid="'+f.id+'">\n        <div class="preset_td text-primary">'+(e+1)+'.</div>\n        <div class="preset_td ml-2">'+f.name+"</div>\n          "+g+"\n      </div>\n    "}a.find(".alert").addClass("d-none");a.find(".preset_tr").removeClass("preset_selected");a.find(".preset_tbody").html(c);a.find(".preset_name").val("\u5de6\u306e\u30d7\u30ea\u30bb\u30c3\u30c8\u4e00\u89a7\u3092\u30af\u30ea\u30c3\u30af").prop("disabled",
!0);a.find(".is-invalid").removeClass("is-invalid");a.find(".is-valid").removeClass("is-valid");a.find(".preset_preview_tbody").html("");a.find(".btn:not(.btn_cancel)").prop("disabled",!0);$(".preset_td_info").tooltip()}
function drawPlanePresetPreview(a){var b="",c=[],d=$("#modal_plane_preset"),e=castInt($("#modal_plane_preset").data("parentid"));d.find(".alert").addClass("d-none");if(a){d.find(".preset_name").val(a.name);for(var f={},g=$jscomp.makeIterator(a.planes),h=g.next();!h.done;f={$jscomp$loop$prop$id$296:f.$jscomp$loop$prop$id$296},h=g.next())f.$jscomp$loop$prop$id$296=h.value,c.push(PLANE_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$id$296}}(f)))}else d.find(".preset_name").val(""),
$target.find("."+($target.attr("class").includes("lb_tab")?"lb_plane":"ship_plane")).each(function(a,b){if(!$(b).attr("class").includes("d-none")){var d=PLANE_DATA.find(function(a){return a.id===castInt($(b)[0].dataset.planeid)});d&&c.push(d)}}),0===c.length&&d.find(".alert").removeClass("d-none");f=$jscomp.makeIterator(c);for(g=f.next();!g.done;g=f.next())g=g.value,h=!checkInvalidPlane(e,g),b+='\n    <div class="preset_preview_tr d-flex justify-content-start border-bottom" data-planeid="'+g.id+'">\n      <div class="preset_preview_td_type"><img class="img-size-25" src="./img/type/type'+
g.type+'.png"></div>\n      <div class="preset_preview_td_name ml-1 py-2">'+g.name+"</div>\n      "+(h?'\n    <div class="preset_preview_td_info ml-2 text-warning cur_help" data-toggle="tooltip" title="\u5c55\u958b\u5148\u306b\u4e0d\u9069\u5408\u306a\u88c5\u5099\u3067\u3059">\n      <i class="fas fa-exclamation-triangle"></i>\n    </div>\n  ':"")+"\n    </div>\n    ";d.find(".btn_expand_preset").prop("disabled",!a);d.find(".btn_delete_preset").prop("disabled",!a);d.find(".btn_commit_preset").prop("disabled",
!0);d.find(".preset_name").prop("disabled",0===c.length);d.find(".is-invalid").removeClass("is-invalid");d.find(".is-valid").removeClass("is-valid");d.find(".preset_preview_tbody").html(b);d.find(".preset_preview_td_info").tooltip()}
function updatePlanePreset(){var a=castInt($(".preset_selected").data("presetid")),b=[];$(".preset_preview_tr").each(function(a,c){return b.push(castInt($(c)[0].dataset.planeid))});for(var c=0,d=$jscomp.makeIterator(planePreset),e=d.next();!e.done;e=d.next())e=e.value,c<e.id&&(c=e.id);c={id:-1===a?c+1:a,name:$("#modal_plane_preset").find(".preset_name").val().replace(/^\s+|\s+$/g,""),planes:b};planePreset=planePreset.filter(function(b){return b.id!==a});planePreset.push(c);planePreset.sort(function(a,
b){return a.id-b.id});saveLocalStorage("planePreset",planePreset)}function deletePlanePreset(){var a=castInt($(".preset_selected").data("presetid"));planePreset=planePreset.filter(function(b){return b.id!==a});planePreset.sort(function(a,c){return a.id-c.id});saveLocalStorage("planePreset",planePreset)}
function createMapSelect(){for(var a="",b={},c=$jscomp.makeIterator(WORLD_DATA),d=c.next();!d.done;b={$jscomp$loop$prop$world$298:b.$jscomp$loop$prop$world$298},d=c.next()){d=d.value;b.$jscomp$loop$prop$world$298=d.world;var e=MAP_DATA.filter(function(a){return function(b){return Math.floor(b.area/10)===a.$jscomp$loop$prop$world$298}}(b));a+='<optgroup label="'+d.name+'">';d=$jscomp.makeIterator(e);for(e=d.next();!e.done;e=d.next())e=e.value,a+='<option value="'+e.area+'">'+(1E3<b.$jscomp$loop$prop$world$298?
"E":b.$jscomp$loop$prop$world$298)+"-"+e.area%10+" : "+e.name+"</option>"}$("#map_select").html(a)}
function createNodeSelect(){var a=castInt($("#map_select").val()),b=-1;1E3>a?$("#select_difficulty_div").addClass("d-none"):($("#select_difficulty_div").removeClass("d-none"),b=castInt($("#select_difficulty").val()));$("#map_img").attr("src","./img/map/"+a+".png");var c=ENEMY_PATTERN.filter(function(c){return c.area===a&&c.lv===b});c=c.filter(function(a,b,c){return c.findIndex(function(b){return b.node===a.node})===b});c.sort(function(a,b){return"\u7a7a\u8972"==a.node&&"\u7a7a\u8972"==b.node?0:"\u7a7a\u8972"==
a.node?-1:"\u7a7a\u8972"==b.node?1:0});for(var d=c.length,e="",f="",g=0;g<d;g++){var h=c[g].node,k=c[g].coords;e+='\n    <div class="d-flex node_tr justify-content-center py-1 w-100 cur_pointer" data-node="'+h+'">\n      <div class="align-self-center">'+h+"</div>\n    </div>\n  ";""!==k&&(f+='<area class="node" title="'+h+'" coords="'+k+'" shape="rect">')}$("#node_tbody").html(e);$("#clickable_nodes").html(f);$("#enemy_pattern_tbody").html("");$("#enemy_pattern_select").html('<li class="nav-item"><a class="nav-link active" data-toggle="tab" href="#">\u7de8\u62101</a></li>');
$("#enemy_pattern_air_power").text("0");$("#enemy_display_mode_parent").addClass("d-none").removeClass("d-flex");$("#btn_expand_enemies").prop("disabled",!0);$("#btn_continue_expand").prop("disabled",!0)}
function createEnemyPattern(a){a=void 0===a?0:a;var b=castInt($("#map_select").val()),c=$(".node_selected").data("node"),d=-1;1E3>b?$("#select_difficulty_div").addClass("d-none"):($("#select_difficulty_div").removeClass("d-none"),d=castInt($("#select_difficulty").val()));for(var e="",f=0,g=0,h=ENEMY_PATTERN.filter(function(a){return a.area===b&&a.node===c&&a.lv===d}),k=h[a],l=k.enemies,m=l.length,n={$jscomp$loop$prop$index$300:0};n.$jscomp$loop$prop$index$300<m;n={$jscomp$loop$prop$index$300:n.$jscomp$loop$prop$index$300},
n.$jscomp$loop$prop$index$300++){var r=ENEMY_DATA.find(function(a){return function(b){return b.id===l[a.$jscomp$loop$prop$index$300]}}(n)),p=createEnemyObject(r.id);f+=p.ap;g+=p.aabo;e+='\n    <div class="enemy_pattern_tr mx-1 d-flex border-bottom" data-enemyid="'+r.id+'">\n      <div class="mr-1 align-self-center enemy_pattern_tr_image">\n        <img src="./img/enemy/'+r.id+'.png" class="enemy_img">\n      </div>\n      <div class="align-self-center enemy_pattern_tr_text">\n        <div class="font_size_11 text-primary">ID: '+
(r.id+1500)+"</div>\n        <div>"+drawEnemyGradeColor(r.name)+"</div>\n      </div>\n    </div>\n    "}n=FORMATION.find(function(a){return a.id===k.form});g=2*Math.floor(n.correction*g);$("#enemy_pattern_anti_air").text(g);$("#enemy_pattern_formation").text(n.name);if(0===a){a="";for(g=0;g<h.length;g++)a+='\n      <li class="nav-item">\n        <a class="nav-link '+(0===g?"active":"")+'" data-toggle="tab" data-disp="'+g+'" href="#">\n          '+(h[g].remarks?h[g].remarks:"\u7de8\u6210"+(g+1))+
"\n          </a>\n      </li>\n      ";$("#enemy_pattern_select").html(a)}h=getAirStatusBorder(f);$("#enemy_pattern_tbody").html(e);$("#enemy_pattern_air_power").text(f);$("#enemy_pattern_status0").text(h[0]);$("#enemy_pattern_status1").text(h[1]);$("#enemy_pattern_status2").text(h[2]);$("#enemy_pattern_status3").text(h[3]);$("#btn_expand_enemies").prop("disabled",!1);$("#btn_continue_expand").prop("disabled",!1);6<m?($("#enemy_display_mode_parent").removeClass("d-none").addClass("d-flex"),setting.enemyDisplayImage?
$("#enemy_pattern_tbody").find(".enemy_pattern_tr_text").addClass("d-none"):$("#enemy_pattern_tbody").find(".enemy_pattern_tr_image").addClass("d-none")):$("#enemy_display_mode_parent").addClass("d-none").removeClass("d-flex")}
function expandEnemy(){var a=castInt($("#map_select").val()),b=$(".node_selected").data("node"),c=castInt($("#enemy_pattern_select").find(".nav-link.active").data("disp")),d=-1;1E3<=a&&(d=castInt($("#select_difficulty").val()));c=ENEMY_PATTERN.filter(function(c){return c.area===a&&c.node===b&&c.lv===d})[c];isDefMode||"\u7a7a\u8972"!==b?isDefMode&&"\u7a7a\u8972"!==b&&(isDefMode=!1,$(".ohuda_select").each(function(a,b){0===castInt($(b).val())&&$(b).val(-1)}),$target=$(".battle_content:first")):(isDefMode=
!0,$(".ohuda_select").each(function(a,b){$(b).val(0)}),$target=$("#air_raid_enemies"));$target.find(".enemy_content:not(:first)").length&&$target.find(".enemy_content:not(:first)").remove();clearEnemyDiv($target.find(".enemy_content"));var e=isDefMode&&5!==c.type?3:c.type;$target.find(".cell_type").val(e);changeFormationSelectOption($target.find(".formation"),e);$target.find(".formation").val(c.form);e=$jscomp.makeIterator(c.enemies);for(var f=e.next();!f.done;f=e.next())f=f.value,setEnemyDiv($target.find(".enemy_content:last()"),
f);$target.find(".enemy_range").text(c.radius);$target[0].dataset.celldata=a+"_"+c.node+(c.remarks?"("+c.remarks+")":"")}
function loadMainPreset(a){a=void 0===a?!1:a;var b=$("#modal_main_preset");a=$("#main_preset_back_up").hasClass("active")||a;(presets=loadLocalStorage("presets"))||(presets=[]);(backUpPresets=loadLocalStorage("backUpPresets"))||(backUpPresets=[]);a=a?backUpPresets:presets;for(var c="",d=0;d<a.length;d++){var e=a[d];c+='\n      <div class="preset_tr d-flex px-1 py-2 my-1 w-100 cur_pointer" data-presetid="'+e[0]+'">\n        <div class="preset_td text-primary">'+(d+1)+'.</div>\n        <div class="preset_td ml-2 font_size_12">'+
e[1]+"</div>\n      </div>\n    "}b.find(".preset_selected").removeClass("preset_selected");b.find(".is-invalid").removeClass("is-invalid");b.find(".is-valid").removeClass("is-valid");b.find(".preset_tbody").html(c);b.find(".preset_name").val("").prop("disabled",!0);b.find(".btn:not(.btn_cancel)").prop("disabled",!0);b.find(".btn_commit_preset_header").addClass("d-none");b.find(".btn_commit_preset_header").tooltip("hide");b.find(".btn_output_url").prop("disabled",!1);b.find(".btn_output_deck").prop("disabled",
!1);b.find("#preset_remarks").prop("disabled",!0).val("");b.find(".preset_data").data("presetid",0);$("#main_preset_load_tab").find("input").val("")}
function drawMainPreset(a){var b=$("#modal_main_preset");b.find(".btn_expand_preset").prop("disabled",!a);b.find(".btn_delete_preset").prop("disabled",!a);if(a&&0<a[0])b.find(".preset_data").data("presetid",a[0]),b.find(".preset_name").val(a[1]),b.find("#preset_remarks").val(a[3]),b.find(".btn_commit_preset").text("\u7de8\u6210\u5909\u66f4"),b.find(".btn_commit_preset").prop("disabled",!1),b.find(".btn_commit_preset_header").removeClass("d-none"),b.find(".btn_commit_preset_header").prop("disabled",
!1);else if(a&&0>a[0]){for(var c=0,d=$jscomp.makeIterator(presets),e=d.next();!e.done;e=d.next())e=e.value,c<e[0]&&(c=e[0]);b.find(".preset_data").data("presetid",castInt(c)+1);b.find(".preset_name").val(a[1]);b.find("#preset_remarks").val(a[3]);b.find(".btn_commit_preset").text("\u30d7\u30ea\u30bb\u30c3\u30c8\u4fdd\u5b58");b.find(".btn_commit_preset").prop("disabled",!0);b.find(".btn_commit_preset_header").addClass("d-none")}else{a=0;c=$jscomp.makeIterator(presets);for(d=c.next();!d.done;d=c.next())d=
d.value,a<d[0]&&(a=d[0]);b.find(".preset_data").data("presetid",castInt(a)+1);b.find(".btn_commit_preset").text("\u65b0\u898f\u767b\u9332");b.find(".btn_commit_preset").prop("disabled",!0);b.find(".btn_commit_preset_header").addClass("d-none");b.find(".preset_name").val("");b.find("#preset_remarks").val("")}b.find(".is-invalid").removeClass("is-invalid");b.find(".is-valid").removeClass("is-valid");b.find(".preset_name").prop("disabled",!1);b.find("#preset_remarks").prop("disabled",!1);b.find(".alert").addClass("hide").removeClass("show")}
function updateMainPreset(){for(var a=createPreset(),b=!1,c=0;c<presets.length;c++)if(presets[c][0]===a[0]){presets[c]=a;b=!0;break}b||presets.push(a);saveLocalStorage("presets",presets);$("#modal_main_preset").find(".task").text(b?"\u7de8\u6210\u66f4\u65b0":"\u65b0\u898f\u767b\u9332");$("#modal_main_preset").find(".alert").removeClass("hide").addClass("show")}
function updateMainPresetName(){var a=presets.find(function(a){return a[0]===castInt($("#modal_main_preset").find(".preset_data").data("presetid"))});if(a){var b=$("#modal_main_preset").find(".preset_name").val().trim();0===b.length&&(b=new Date,b="preset-"+(b.getFullYear()+""+b.getMonth()+1+b.getDate()));a[1]=b;a[3]=$("#preset_remarks").val().trim()}saveLocalStorage("presets",presets);$("#modal_main_preset").find(".task").text("\u66f4\u65b0");$("#modal_main_preset").find(".alert").removeClass("hide").addClass("show")}
function expandMainPreset(a,b,c,d){b=void 0===b?!0:b;c=void 0===c?!0:c;d=void 0===d?!0:d;if(a)try{$(".lb_plane").each(function(c,d){var e=a[0];e&&0!==e.length&&((e=e[0].find(function(a){return a[4]===c}))&&0!==e.length?(e={id:e[0],prof:e[1],remodel:e[2],slot:e[3]},setLBPlaneDiv($(d),e)):b&&setLBPlaneDiv($(d)))});$(".ohuda_select").each(function(b,c){var d=a[0];$(c).find("option").prop("disabled",!1);d&&0!==d.length?$(c).val(castInt(d[1][b],-1)):$(c).val(-1);ohuda_Changed($(c),!0)});if(c){clearShipDivAll(6);
var e=0,f=0;$(".ship_tab").each(function(b,c){var d=a[1].find(function(a){return a[2]===b});if(d){var g=$(c);setShipDiv(g,d[0]);g.find(".ship_plane").each(function(a,b){var c=$(b),e=d[1].find(function(b){return b[4]===a});e&&!c.hasClass("d-none")&&(setPlaneDiv(c,{id:e[0],prof:e[1],remodel:e[2],slot:e[3]},!0),6<=e.length&&e[5]&&plane_unlock_Clicked(c.find(".plane_unlock")))});4<=d.length&&(g.find(".ship_disabled").prop("checked",d[3]),d[3]?g.addClass("opacity4"):g.removeClass("opacity4"));6>=b?e=b+
1:f=b+1-6}});e=Math.min(Math.max(e,2),6);$("#friendFleet_item1").find(".display_ship_count").val(1===e%2?e+1:e);display_ship_count_Changed($("#friendFleet_item1").find(".display_ship_count"),!0);f=Math.min(Math.max(f,2),6);$("#friendFleet_item2").find(".display_ship_count").val(1===f%2?f+1:f);display_ship_count_Changed($("#friendFleet_item2").find(".display_ship_count"),!0)}c=1;for(var g=0;g<a[2].length;g++)c<a[2][g][0]+1&&(c=a[2][g][0]+1);c=Math.min(c,10);if(0!==a[2].length||d)clearEnemyDivAll(c),
$("#battle_count").val(c);$(isDefMode?"#air_raid_enemies":".battle_content").each(function(b,c){var d=a[2].find(function(a){return a[0]===b});if(d){3<=d.length?$(c)[0].dataset.celldata=d[2]:$(c)[0].dataset.celldata="";if(4<=d.length)if(isDefMode){var e=castInt(d[3]);$(c).find(".cell_type").val([0,5].includes(e)?5:3)}else $(c).find(".cell_type").val(d[3]);else $(c).find(".cell_type").val(1);5<=d.length?$(c).find(".formation").val(d[4]):$(c).find(".formation").val(1);d=$jscomp.makeIterator(d[1]);for(e=
d.next();!e.done;e=d.next())e=e.value,0<e?setEnemyDiv($(c).find(".enemy_content:last()"),e):0>e&&setEnemyDiv($(c).find(".enemy_content:last()"),-1,-e)}})}catch(h){$(".ohuda_select").val(-1),$(".lb_plane").each(function(a,b){setLBPlaneDiv($(b))}),clearShipDivAll(6),clearEnemyDivAll(1),$("#battle_count").val(1),d=$("#modal_confirm"),d.find(".modal-body").html('\n      <div class="px-2">\n        <div>\u4e00\u5ea6\u3001\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3055\u308c\u305f\u672c\u30b5\u30a4\u30c8\u306e\u8a2d\u5b9a\u3092\u524a\u9664\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\u300c\u8a73\u7d30\u8a2d\u5b9a\u300d\u6b04\u306e\u6700\u4e0b\u90e8\u306e\u8a2d\u5b9a\u524a\u9664\u30dc\u30bf\u30f3\u304b\u3089\u524a\u9664\u304c\u53ef\u80fd\u3067\u3059\u3002</div>\n        <div class="h6 mt-4">\u75c7\u72b6\u304c\u6539\u5584\u3057\u306a\u3044\u5834\u5408</div>\n        <div class="px-2">\n          \u7533\u3057\u8a33\u3042\u308a\u307e\u305b\u3093\u3001\u304a\u624b\u6570\u3067\u3059\u304c\u3001\u3069\u306e\u3088\u3046\u306a\u64cd\u4f5c\u3092\u884c\u3063\u305f\u969b\u306b\u3053\u306e\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u305f\u304b\n          <a href="https://odaibako.net/u/noro_006" target="_blank">\u3053\u3061\u3089</a>\u307e\u3067\u3054\u5831\u544a\u3044\u305f\u3060\u3051\u308c\u3070\u5e78\u3044\u3067\u3059\u3002\n        </div>\n        <div class="mt-2 px-2">\u5831\u544a\u3092\u9802\u304d\u6b21\u7b2c\u3001\u53ef\u80fd\u306a\u9650\u308a\u65e9\u671f\u306e\u30d0\u30b0\u30d5\u30a3\u30c3\u30af\u30b9\u306b\u52aa\u3081\u307e\u3059\u3002</div>\n        <div class="mt-3 px-2 font_size_8 font_color_fff">message : '+
h.message+'</div>\n        <div class="px-2 font_size_8 font_color_fff">stack : '+h.stack+"</div>\n      </div>\n    "),confirmType="Error",d.modal("show")}}
function createLandBasePreset(){var a=[[],[]];$(".ohuda_select").each(function(b,c){a[1].push(castInt($(c).val()))});$(".lb_plane:not(.ui-draggable-dragging)").each(function(b,c){var d=$(c);d=[castInt(d[0].dataset.planeid),castInt(d.find(".prof_select")[0].dataset.prof),castInt(d.find(".remodel_value").text()),castInt(d.find(".slot").text()),b];0!==d[0]&&a[0].push(d)});return a}
function createFriendFleetPreset(){var a=[],b=0;$(".ship_tab").each(function(c,d){6===c&&(b=6);if(!$(d).attr("class").includes("d-none")){var e=[castInt($(d)[0].dataset.shipid),[],b,$(d).find(".ship_disabled").prop("checked")?1:0];$(d).find(".ship_plane:not(.ui-draggable-dragging)").each(function(a,b){var c=$(b);c=[castInt(c[0].dataset.planeid),castInt(c.find(".prof_select")[0].dataset.prof),castInt(c.find(".remodel_value").text()),castInt(c.find(".slot").text()),a,c.find(".plane_unlock").hasClass("d-none")?
1:0];0!==c[0]&&e[1].push(c)});if(0!==e[0]||0!==e[1].length)a.push(e),b++}});return a}
function createEnemyFleetPreset(){var a=[];$(isDefMode?"#air_raid_enemies":".battle_content").each(function(b,c){if(!$(c).attr("class").includes("d-none")){var d=[b,[],$(c)[0].dataset.celldata,castInt($(c).find(".cell_type").val()),castInt($(c).find(".formation").val())];$(c).find(".enemy_content").each(function(a,b){var c=castInt($(b)[0].dataset.enemyid),e=castInt($(b).find(".enemy_ap").text());0!==c&&(0<c?d[1].push(c):0<e&&d[1].push(-e))});0!==d[1].length&&a.push(d)}});return a}
function createPreset(){var a=$("#modal_main_preset").find(".preset_name").val().trim();0===a.length&&(a="");return[castInt($("#modal_main_preset").find(".preset_data").data("presetid")),a,encodePreset(),$("#preset_remarks").val().trim()]}function encodePreset(){try{var a=[createLandBasePreset(),createFriendFleetPreset(),createEnemyFleetPreset()],b=JSON.stringify(a),c=utf8_to_b64(b),d=b64_to_utf8(c);JSON.parse(d);return c}catch(e){return utf8_to_b64(JSON.stringify([[],[],[]]))}}
function decodePreset(a){try{var b=b64_to_utf8(a);return JSON.parse(b)}catch(c){return[[],[],[]]}}
function deleteMainPreset(a){if($("#main_preset_back_up").hasClass("active")){backUpPresets=backUpPresets.filter(function(b){return b[0]!==a});backUpPresets.sort(function(a,b){return a[0]-b[0]});for(var b=0;b<backUpPresets.length;b++)backUpPresets[b][0]=-(b+1);saveLocalStorage("backUpPresets",backUpPresets)}else presets=presets.filter(function(b){return b[0]!==a}),presets.sort(function(a,b){return a[0]-b[0]}),saveLocalStorage("presets",presets);b=$("#modal_main_preset");b.find(".alert").removeClass("hide").addClass("show");
b.find(".task").text("\u524a\u9664");loadMainPreset()}
function readDeckBuilder(a){if(!a)return null;try{a=decodeURIComponent(a).trim('"');var b=JSON.parse(a),c=[],d=[[],[-1,-1,-1]];Object.keys(b).forEach(function(a){var e=b[a];if("version"!==a&&e){if(0===a.indexOf("a")&&e.hasOwnProperty("items")){var f=castInt(a.replace("a",""))-1;d[1][f]=e.hasOwnProperty("mode")?1===e.mode?2:2===e.mode?0:-1:-1;Object.keys(e.items).forEach(function(a){var b=e.items[a];if(b&&b.hasOwnProperty("id")){var c=[0,0,0,18,castInt(a.replace("i",""))-1+4*f];Object.keys(b).forEach(function(a){"id"===
a?c[0]=castInt(b[a]):"mas"===a?c[1]=castInt(b[a]):"rf"===a&&(c[2]=castInt(b[a]))});d[0].push(c)}})}if(0===a.indexOf("f")){var g=castInt(a.replace("f",""))-1,h=[g,[]];Object.keys(e).forEach(function(a){var b=e[a];if(b&&b.hasOwnProperty("items")){var c=SHIP_DATA.find(function(a){return a.deckid===castInt(b.id)});if(c){var d=[c.id,[],castInt(a.replace("s",""))-1+6*g];Object.keys(b.items).forEach(function(a){var e=b.items[a];if(e&&e.hasOwnProperty("id")&&PLANE_DATA.find(function(a){return a.id===castInt(e.id)})){a=
castInt(a.replace("i",""))-1;var f=[0,0,0,c.slot[a],a];Object.keys(e).forEach(function(a){"id"===a?f[0]=castInt(e[a]):"mas"===a?f[1]=castInt(e[a]):"rf"===a&&(f[2]=castInt(e[a]))});d[1].push(f)}});h[1].push(d)}}});c.push(h)}}});var e=c.find(function(a){return 0===a[0]})[1];if(2<=c.length){var f=c.find(function(a){return 1===a[0]})[1],g=e.concat(f);return[d,g,[]]}return[d,e,[]]}catch(h){return null}}
function convertToDeckBuilder(){try{for(var a=createFriendFleetPreset(),b=createLandBasePreset(),c={version:4,f1:{},f2:{},a1:{mode:0,items:{}},a2:{mode:0,items:{}},a3:{mode:0,items:{}}},d=$jscomp.makeIterator(b[0]),e=d.next();!e.done;e=d.next()){var f=e.value;c["a"+(Math.floor(f[4]/4)+1)].items["i"+(Math.floor(f[4]%4)+1)]={id:f[0],rf:f[2],mas:f[1]}}for(d=0;d<b[1].length;d++){var g=b[1][d];c["a"+(d+1)].mode=0<g?1:0===g?2:0}b={};for(g=0;g<a.length;b={$jscomp$loop$prop$ship$302:b.$jscomp$loop$prop$ship$302},
g++){b.$jscomp$loop$prop$ship$302=a[g];var h=SHIP_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$ship$302[0]}}(b));if(h){d={i1:null,i2:null,i3:null,i4:null,i5:null};var k=$jscomp.makeIterator(b.$jscomp$loop$prop$ship$302[1]);for(e=k.next();!e.done;e=k.next()){var l=e.value,m={id:l[0],rf:l[2],mas:l[1]};d["i"+castInt(l[4]+1)]=m}var n={id:""+h.deckid,lv:99,luck:-1,items:d},r=b.$jscomp$loop$prop$ship$302[2];6>r?c.f1["s"+(r%6+1)]=n:c.f2["s"+(r%6+1)]=n}}return JSON.stringify(c)}catch(p){return""}}
function readEquipmentJson(a){try{for(var b=JSON.parse(a),c=loadPlaneStock(),d=$jscomp.makeIterator(c),e=d.next();!e.done;e=d.next())e.value.num=[0,0,0,0,0,0,0,0,0,0,0];a={};for(var f=$jscomp.makeIterator(b),g=f.next();!g.done;a={$jscomp$loop$prop$planeId$304:a.$jscomp$loop$prop$planeId$304},g=f.next()){var h=g.value;if(!h.hasOwnProperty("api_slotitem_id")||!h.hasOwnProperty("api_level"))return!1;a.$jscomp$loop$prop$planeId$304=h.api_slotitem_id;var k=h.api_level,l=c.find(function(a){return function(b){return b.id===
a.$jscomp$loop$prop$planeId$304}}(a));l&&l.num[k]++}c.sort(function(a,b){return a.id-b.id});saveLocalStorage("planeStock",c);setting.inStockOnly=!0;saveLocalStorage("setting",setting)}catch(m){return!1}return!0}
function loadPlaneStock(){var a=loadLocalStorage("planeStock");if(a&&a.length){var b={},c=$jscomp.makeIterator(PLANE_DATA);for(d=c.next();!d.done;b={$jscomp$loop$prop$plane$138$306:b.$jscomp$loop$prop$plane$138$306},d=c.next())b.$jscomp$loop$prop$plane$138$306=d.value,a.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$plane$138$306.id}}(b))||(a.push({id:b.$jscomp$loop$prop$plane$138$306.id,num:[0,0,0,0,0,0,0,0,0,0,0]}),saveLocalStorage("planeStock",a))}else{a=[];b=$jscomp.makeIterator(PLANE_DATA);
for(var d=b.next();!d.done;d=b.next())a.push({id:d.value.id,num:[0,0,0,0,0,0,0,0,0,0,0]});a=a.concat();saveLocalStorage("planeStock",a)}return a}function updatePlaneSelectedHistory(a){setting.selectedHistory[0].unshift(a);setting.selectedHistory[0]=setting.selectedHistory[0].splice(0,100);saveLocalStorage("setting",setting)}
function updateShipSelectedHistory(a){setting.selectedHistory[1].unshift(a);setting.selectedHistory[1]=setting.selectedHistory[1].splice(0,100);saveLocalStorage("setting",setting)}
function drawResult(){$("#rate_table tbody").find(".rate_tr").addClass("d-none disabled_tr");$(".progress_area").addClass("d-none disabled_bar").removeClass("d-flex");for(var a=Object.create(chartData),b=a.own.length,c={},d=0;d<b;c={$jscomp$loop$prop$abbr$308:c.$jscomp$loop$prop$abbr$308},d++){var e=a.own[d],f=a.enemy[d],g=a.rate[d],h=getAirStatusBorder(f),k=isDefMode?getAirStatusIndex(e,f):a.rate[d].indexOf(getArrayMax(a.rate[d])),l=0,m=!1,n=isDefMode?8:1===b?7:d+1,r=$("#result_bar_"+n),p=$("#rate_row_"+
n);4===k?l=e/h[3]*10:3===k?l=e/h[2]*20:2===k?l=e/h[1]*45:1>=k&&(l=e/h[0]*90);if(5===k&&(7>n||8===n))k=0,l=100;else if(5===k){c.$jscomp$loop$prop$abbr$308=$("#shoot_down_table").find(".cond.battle"+displayBattle).text();var q=AIR_STATUS.find(function(a){return function(b){return b.abbr===a.$jscomp$loop$prop$abbr$308}}(c));q&&(k=q.id);0===k&&(l=100)}q=r.data("airstatus");r.removeClass("bar_status"+q).addClass("bar_status"+k).css({width:(100<l?100:l)+"%"}).data("airstatus",k);p.find(".rate_td_ap").text(e);
f='<span class="mr-1">'+f+'</span><span class="text-nowrap">( ';for(l=0;l<h.length-1;l++)0!==l&&(f+=" / "),f=h[l]<=e?f+("<b>"+h[l]+"</b>"):f+h[l];p.find(".rate_td_eap").html(f+" )</span>");for(e=0;e<g.length;e++)p.find(".rate_td_status"+e).text("-"),isDefMode?p.find(".rate_td_status"+k).text("100 %"):0<g[e]&&(m=100*g[e],p.find(".rate_td_status"+e).text((100===m?100:m.toFixed(2))+" %"),m=!0);if(m||isDefMode&&8===n)p.removeClass("d-none disabled_tr"),r.closest(".progress_area").addClass("d-flex").removeClass("d-none disabled_bar")}d=
c=b=0;a=castInt($("#calculate_count").val());for(g=0;g<chartData.slots.length;g++)if(k=chartData.slots[g],n=100*k.deathRate,m=document.getElementsByClassName("slot"+k.slot+" shipNo"+k.shipNo)[0])r=castInt(m.getElementsByClassName("battle1")[0].textContent),m.getElementsByClassName("battle1")[0].textContent&&(p='\n    <div class="text-left">\n      <div>\u6700\u5927\u6b8b\u6570\uff1a'+k.max+"</div>\n      <div>\u6700\u5c0f\u6b8b\u6570\uff1a"+k.min+"</div>\n      <div>\u5168\u6ec5\u56de\u6570\uff1a"+
k.death+" / "+a+"</div>\n      <div>\u203b\u30af\u30ea\u30c3\u30af\u3067\u8a73\u7d30\u8a08\u7b97</div>\n    </div>",e=m.getElementsByClassName("battle_end")[0],e.textContent=Math.round(k.avg),e.dataset.toggle="tooltip",e.dataset.html="true",e.title=p,m=m.getElementsByClassName("battle_death")[0],m.textContent=0===k.deathRate?"-":10<=n?n.toFixed(1)+" %":n.toFixed(2)+" %",m.dataset.toggle="tooltip",m.dataset.html="true",m.title=p,0<r&&(b+=5*(r-k.avg),c+=5*(r-k.max),d+=5*(r-k.min)));$(".battle_end.fap").html('<img src="./img/util/bauxite.png" class="img-size-18" alt="\u30dc\u30fc\u30ad\u30b5\u30a4\u30c8"> \u6d88\u8cbb');
$(".battle_end.eap").html(c+" ~ "+d+" ( "+b.toFixed(1)+" )");$("#shoot_down_table_tbody .battle_end").tooltip();$("#shoot_down_table_tbody .battle_death").tooltip();for(b=0;b<chartData.enSlots.length;b++)c=chartData.enSlots[b],d=document.getElementsByClassName("enemy_no_"+c[0]+" slot_"+c[1])[0],g=c[2]/a,d.getElementsByClassName("td_avg_slot")[0].textContent=0===g?"0":g.toFixed(1),d.getElementsByClassName("td_max_slot")[0].textContent=c[3],d.getElementsByClassName("td_min_slot")[0].textContent=c[4];
display_result_Changed()}function loadLocalStorage(a){if(!window.localStorage)return null;try{return JSON.parse(window.localStorage.getItem(a))}catch(b){return null}}function saveLocalStorage(a,b){if(!window.localStorage||0===a.length)return!1;try{return window.localStorage.setItem(a,JSON.stringify(b)),!0}catch(c){return window.localStorage.removeItem(a),!1}}function deleteLocalStorage(a){if(!window.localStorage||0===a.length)return!1;window.localStorage.removeItem(a);return!0}
function getAirStatusIndex(a,b){if(1E3>=a){var c=AIR_STATUS_TABLE[a].length-1;return b<c?AIR_STATUS_TABLE[a][b]:AIR_STATUS_TABLE[a][c]}c=getAirStatusBorder(b);for(var d=c.length,e=0;e<d;e++)if(a>=c[e])return 0!==a?e:4}function getLBAirStatusIndex(a,b){return 0===a&&0===b?0:getAirStatusIndex(a,b)}function getAirStatusBorder(a){return 0===a?[0,0,0,0,0]:[3*a,Math.ceil(1.5*a),Math.floor(a/1.5)+1,Math.floor(a/3)+1,0]}
function calculate(){var a={landBaseData:[],friendFleetData:[],battleData:[]};calculateInit(a);mainCalculate(a);rateCalculate(a);drawResult()}
function calculateInit(a){document.getElementById("ship_info_table").getElementsByTagName("tbody")[0].innerHTML="";document.getElementById("shoot_down_table").getElementsByTagName("tbody")[0].innerHTML="";document.getElementById("enemy_shoot_down_table").getElementsByTagName("tbody")[0].innerHTML="";document.getElementById("input_summary").value="";for(var b=$jscomp.makeIterator(document.getElementById("shoot_down_table").getElementsByTagName("tfoot")[0].getElementsByClassName("td_battle")),c=b.next();!c.done;c=
b.next())c.value.innerHTML="";b=$jscomp.makeIterator(document.getElementById("shoot_down_table").getElementsByTagName("td"));for(c=b.next();!c.done;c=b.next())c.value.classList.remove("airStatus0","airStatus1","airStatus2","airStatus3","airStatus4");isDefMode?(document.getElementById("ship_info").classList.add("d-none"),document.getElementById("shoot_down_table_content").classList.add("d-none"),document.getElementById("friendFleet").classList.add("d-none"),document.getElementById("normal_enemies").classList.add("d-none"),
document.getElementById("display_battle_tab").classList.add("d-none"),document.getElementById("air_raid_enemies").classList.remove("d-none"),b=document.getElementById("battle_count_content"),b.classList.add("d-none"),b.classList.remove("d-flex")):(document.getElementById("ship_info").classList.remove("d-none"),document.getElementById("shoot_down_table_content").classList.remove("d-none"),document.getElementById("friendFleet").classList.remove("d-none"),document.getElementById("normal_enemies").classList.remove("d-none"),
document.getElementById("display_battle_tab").classList.remove("d-none"),document.getElementById("air_raid_enemies").classList.add("d-none"),b=document.getElementById("battle_count_content"),b.classList.add("d-flex"),b.classList.remove("d-none"));usedPlane=[];updateLandBaseInfo(a.landBaseData);updateFriendFleetInfo(a.friendFleetData);updateEnemyFleetInfo(a.battleData);if(document.getElementById("auto_save").checked){var d=encodePreset();saveLocalStorage("autoSaveData",d);setting.autoSave=!0;saveLocalStorage("setting",
setting);if(document.getElementById("backup_enabled").checked&&!document.getElementById("suspend_backup").checked){(backUpPresets=loadLocalStorage("backUpPresets"))||(backUpPresets=[]);b=new Date;a=[b.getFullYear().toString(),("0"+(b.getMonth()+1)).slice(-2),("0"+b.getDate()).slice(-2)];b=[("0"+b.getHours()).slice(-2),("0"+b.getMinutes()).slice(-2),("0"+b.getSeconds()).slice(-2)];a=[0,"backup-"+a.join("")+b.join(""),d,a.join("/")+" "+b.join(":")+"\u306e\u7de8\u6210\r\n\r\n"+$("#input_summary").val()];
backUpPresets=backUpPresets.filter(function(a){return a[2]!==d});backUpPresets.unshift(a);backUpPresets=backUpPresets.splice(0,setting.backUpCount);for(a=0;a<backUpPresets.length;a++)backUpPresets[a][0]=-(a+1);saveLocalStorage("backUpPresets",backUpPresets)}}setting.emptySlotInvisible=document.getElementById("empty_slot_invisible").checked;saveLocalStorage("setting",setting);chartData={own:[],enemy:[],rate:[],slots:[],enSlots:[]};setPreCalculateTable()}
function updateLandBaseInfo(a,b){b=void 0===b?!0:b;for(var c=0,d=0,e=0,f="",g,h=castInt(document.getElementById("landBase_target").value),k=document.getElementsByClassName("lb_tab"),l=0;l<k.length;l++){var m=k[l],n=l+1,r={baseNo:n,planes:[],ap:0,mode:-1};g="\u7b2c"+n+"\u57fa\u5730\u822a\u7a7a\u968a\uff1a";for(var p=m.getElementsByClassName("lb_plane"),q=0;q<p.length;q++){var u=q+1;if(4<=q)break;var t=createLBPlaneObject(p[q],q);r.planes.push(t);r.ap+=t.ap;if(b){u=document.getElementsByClassName("lb_info_lb_"+
n+" slot"+u)[0];var w=u.getElementsByClassName("info_plane")[0],x=(t.abbr?t.abbr:t.name)+(0!==t.remodel?"\u2605"+t.remodel:"");w.classList="info_plane "+getPlaneCss(t.type).replace("css","shoot_table");w.textContent=x?x+" "+getProfString(t.level):"-";w=u.getElementsByClassName("info_slot")[0];var v=castInt(w.textContent);drawChangeValue(w,v,t.slot);x||(w.textContent="");w=u.getElementsByClassName("info_ap")[0];v=castInt(w.textContent);drawChangeValue(w,v,t.ap);x||(w.textContent="");c+=0===t.id?0:
Math.ceil(t.slot*(101===t.type?1.5:1));d+=0===t.id?0:101===t.type?Math.floor(.7*t.slot):Math.ceil(.6*t.slot);e+=t.cost*(RECONNAISSANCES.includes(t.type)?4:18);g+=" "+(x?x+" "+getProfString(t.level):"")+","}}g+="\n";q=!0;t=$jscomp.makeIterator(r.planes);for(p=t.next();!p.done;p=t.next())0<p.value.id&&(q=!1);if(q)for(r.mode=-1,m.getElementsByClassName("ohuda_select")[0].value="-1",p=$jscomp.makeIterator(m.getElementsByClassName("ohuda_select")[0].getElementsByTagName("option")),q=p.next();!q.done;q=
p.next())q=q.value,-1!==castInt(q.value,-1)&&(q.disabled=!0);else for(p=$jscomp.makeIterator(m.getElementsByClassName("ohuda_select")[0].getElementsByTagName("option")),q=p.next();!q.done;q=p.next())q.value.disabled=!1;r.mode=castInt(m.getElementsByClassName("ohuda_select")[0].value);updateLBAirPower(r);a.push(r);if(b){t=m.getElementsByClassName("resource")[0];p=t.getElementsByClassName("bauxite")[0];q=t.getElementsByClassName("fuel")[0];t=t.getElementsByClassName("ammo")[0];1>r.mode&&(d=c=0);drawChangeValue(q,
castInt(q.textContent),c,!0);drawChangeValue(t,castInt(t.textContent),d,!0);drawChangeValue(p,castInt(p.textContent),e,!0);e=d=c=0;n=document.getElementsByClassName("lb_info_lb_"+n);q=n[0].getElementsByClassName("info_sumAp")[0];drawChangeValue(q,castInt(q.textContent),r.ap);q=m.getElementsByClassName("ap")[0];drawChangeValue(q,castInt(q.textContent),r.ap);p=getRange(r);q=n[0].getElementsByClassName("info_range")[0];drawChangeValue(q,castInt(q.textContent),p);q=m.getElementsByClassName("range")[0];
drawChangeValue(q,castInt(q.textContent),p);0<r.mode&&(m=document.getElementById("battle_container").getElementsByClassName("enemy_range"),m.length>=h-1&&castInt(m[h-1].textContent)>p&&(f+=(f.length?",":"")+(l+1)));n=$jscomp.makeIterator(n);for(m=n.next();!m.done;m=n.next())m=m.value,-1!==r.mode?m.classList.remove("d-none"):m.classList.add("d-none");-1!==r.mode&&r.planes.length&&(document.getElementById("input_summary").value+=g.trim()+"\n")}}if(b){c=0;d=document.getElementById("lb_info_table").getElementsByTagName("tbody")[0].getElementsByClassName("lb_info_tr");
d=$jscomp.makeIterator(d);for(e=d.next();!e.done;e=d.next())e.value.classList.contains("d-none")||c++;document.getElementById("lb_info").classList.remove("col-lg-8","col-xl-7");document.getElementById("lb_info").classList.add("col-lg-6");if(0<c){$("#lb_info_table tbody").find(".info_defAp").remove();d=$jscomp.makeIterator(document.getElementById("lb_info_table").getElementsByTagName("tbody")[0].getElementsByClassName("info_defAp"));for(e=d.next();!e.done;e=d.next())e.value.remove();if(isDefMode){e=
d=0;g=$jscomp.makeIterator(a);for(h=g.next();!h.done;h=g.next())if(h=h.value,-1!==h.mode)for(d+=h.ap,h=$jscomp.makeIterator(h.planes),p=h.next();!p.done;p=h.next())ROCKETS.includes(p.value.id)&&e++;g=(0===e?.5:1===e?.8:2===e?1.1:1.2)*d;document.getElementById("lb_info").classList.add("col-lg-8","col-xl-7");document.getElementById("lb_info").classList.remove("col-lg-6");h=document.getElementById("lb_info_table");k=$jscomp.makeIterator(h.getElementsByClassName("info_range"));for(e=k.next();!e.done;e=
k.next())e.value.classList.add("d-none");k=$jscomp.makeIterator(h.getElementsByClassName("info_defAp"));for(e=k.next();!e.done;e=k.next())e.value.classList.remove("d-none");e=$jscomp.makeIterator(h.getElementsByClassName("lb_info_tr"));for(m=e.next();!m.done;m=e.next())if(h=m.value,!h.classList.contains("d-none")){e=document.createElement("td");e.className="info_defAp";e.rowSpan=c;e.textContent=d;h.appendChild(e);e=document.createElement("td");e.className="info_defAp info_defApEx";e.rowSpan=c;e.textContent=
Math.floor(g);h.appendChild(e);break}}else{c=document.getElementById("lb_info_table");d=$jscomp.makeIterator(c.getElementsByClassName("info_range"));for(e=d.next();!e.done;e=d.next())e.value.classList.remove("d-none");c=$jscomp.makeIterator(c.getElementsByClassName("info_defAp"));for(e=c.next();!e.done;e=c.next())e.value.classList.add("d-none")}document.getElementById("ng_range").textContent=f;document.getElementById("lb_info_table").getElementsByClassName("info_warning")[0].classList.add("d-none");
f.length?document.getElementById("lb_range_warning").classList.remove("d-none"):document.getElementById("lb_range_warning").classList.add("d-none");document.getElementById("input_summary").value+="\n"}else document.getElementById("lb_info_table").getElementsByClassName("info_warning")[0].classList.remove("d-none"),document.getElementById("lb_range_warning").classList.add("d-none")}}
function createLBPlaneObject(a){var b=castInt(a.dataset.planeid),c=castInt(a.dataset.type),d=getPlanes(c).find(function(a){return a.id===b});c=a.getElementsByClassName("slot")[0];var e=c.textContent,f=castInt(e);0===e.length?f=0:18<f?(f=18,c.textContent=f):0>f&&(f=0,c.textContent="0");a={id:0,name:"",abbr:"",type:0,antiAir:0,antiBomber:0,interception:0,scout:0,ap:0,radius:999,cost:0,slot:f,remodel:castInt(a.getElementsByClassName("remodel_value")[0].textContent),level:castInt(a.getElementsByClassName("prof_select")[0].dataset.prof),
avoid:0,canAttack:!1,canBattle:!1};d&&(a.id=d.id,a.name=d.name,a.abbr=d.abbr,a.type=d.type,RECONNAISSANCES.includes(a.type)&&4<a.slot&&(c.textContent=4,a.slot=4),a.antiAir=d.antiAir,a.antiBomber=d.antiBomber,a.interception=d.interception,a.scout=d.scout,a.radius=d.radius,a.cost=d.cost,a.ap=getAirPower_lb(a),a.avoid=d.avoid,a.canAttack=ATTACKERS.includes(d.type),(c=usedPlane.find(function(a){return a.id===d.id}))?c.num[a.remodel]++:(c={id:d.id,num:[0,0,0,0,0,0,0,0,0,0,0]},c.num[a.remodel]++,usedPlane.push(c)));
return a}
function getAirPower_lb(a){if(0===a.id)return 0;var b=a.type,c=a.antiAir,d=a.antiBomber,e=a.interception,f=a.remodel,g=a.level;a=a.slot;if([1,-1,7,102,103].includes(b))switch(c=isDefMode?(.2*f+c+e+2*d)*Math.sqrt(a):(.2*f+c+1.5*e)*Math.sqrt(a),g){case 2:c+=2;break;case 3:c+=5;break;case 4:c+=9;break;case 5:c+=14;break;case 6:c+=14;break;case 7:c+=22}else if([6].includes(b))switch(c=1*c*Math.sqrt(a),g){case 2:c+=1;break;case 3:c+=1;break;case 4:c+=1;break;case 5:c+=3;break;case 6:c+=3;break;case 7:c+=
6}else c=[3].includes(b)?1*(.25*f+c)*Math.sqrt(a):[101].includes(b)?1*(.5*Math.sqrt(f)+c)*Math.sqrt(a):1*c*Math.sqrt(a);if(0<a)switch(g){case 1:c+=Math.sqrt(1);break;case 2:c+=Math.sqrt(2.5);break;case 3:c+=Math.sqrt(4);break;case 4:c+=Math.sqrt(5.5);break;case 5:c+=Math.sqrt(7);break;case 6:c+=Math.sqrt(8.5);break;case 7:c+=Math.sqrt((initialProf120Plane.includes(Math.abs(b))?120:100)/10)}return c=0<a?Math.floor(c):0}
function getReconnaissancesAdjust(a,b){b=void 0===b?!1:b;if(!b&&104===a.type)return 9===a.scout?1.18:8===a.scout?1.15:1;if(b){if(104===a.type)return 9===a.scout?1.24:1.18;if(4===a.type)return 8<a.scout?1.3:1.2;if([5,8].includes(a.type))return 8<a.scout?1.16:8===a.scout?1.13:1.1}return 1}
function updateLBAirPower(a){for(var b=a.ap,c=[a.ap],d=a.ap,e=$jscomp.makeIterator(a.planes),f=e.next();!f.done;f=e.next())c.push(b*getReconnaissancesAdjust(f.value,isDefMode));b=$jscomp.makeIterator(c);for(c=b.next();!c.done;c=b.next())c=c.value,d=d<c?c:d;a.ap=Math.floor(d)}
function getRange(a){for(var b=999,c=1,d=$jscomp.makeIterator(a.planes),e=d.next();!e.done;e=d.next())e=e.value,b=e.radius<b?e.radius:b;a=$jscomp.makeIterator(a.planes);for(e=a.next();!e.done;e=a.next())d=e.value,[4,5,8,104].includes(d.type)&&(c=c<d.radius?d.radius:c);return 999>c&&c>b?Math.round(b+Math.min(Math.sqrt(c-b),3)):999===b?0:b}function updateAp(a){return 0!==a.id&&a.canBattle&&0!==a.slot?0>=a.slot?a.slot=0:Math.floor(a.antiAir*Math.sqrt(a.slot)+a.bonusAp):0}
function getBonusAA(a,b){if(0===a.id)return 0;var c=a.type,d=a.remodel;return FIGHTERS.includes(Math.abs(c))?.2*d+b:3===c?.25*d+b:101===c?.5*Math.sqrt(d)+b:b}
function getBonusAp(a){if(0===a.id||0===a.slot)return 0;var b=a.type;a=a.level;var c=0;if([1,-1,7].includes(b))switch(a){case 2:c+=2;break;case 3:c+=5;break;case 4:c+=9;break;case 5:c+=14;break;case 6:c+=14;break;case 7:c+=22}else if([6].includes(b))switch(a){case 2:c+=1;break;case 3:c+=1;break;case 4:c+=1;break;case 5:c+=3;break;case 6:c+=3;break;case 7:c+=6}switch(a){case 1:c+=Math.sqrt(1);break;case 2:c+=Math.sqrt(2.5);break;case 3:c+=Math.sqrt(4);break;case 4:c+=Math.sqrt(5.5);break;case 5:c+=
Math.sqrt(7);break;case 6:c+=Math.sqrt(8.5);break;case 7:c+=Math.sqrt((initialProf120Plane.includes(Math.abs(b))?120:100)/10)}return c}
function updateFriendFleetInfo(a,b){b=void 0===b?!0:b;var c=[],d=0,e=[0,0],f="",g=null,h=$("#union_fleet").prop("checked");g=h?document.getElementsByClassName("ship_tab"):$(".friendFleet_tab.show.active")[0].getElementsByClassName("ship_tab");setting.isUnion=h;saveLocalStorage("setting",setting);for(var k={},l=0;l<g.length;k={$jscomp$loop$prop$shipId$310:k.$jscomp$loop$prop$shipId$310},l++){f=g[l];var m=l+1;if(!f.classList.contains("d-none")&&!f.getElementsByClassName("ship_disabled")[0].checked){for(var n=
c.length=0,r=$jscomp.makeIterator(f.getElementsByClassName("ship_plane")),p=r.next();!p.done;p=r.next())p=p.value,p.classList.contains("ui-draggable")||(p=createFleetPlaneObject(p,m,n++),c.push(p));p=!1;r=n=0;for(var q=$jscomp.makeIterator(c),u=q.next();!u.done;u=q.next())u=u.value,n+=u.ap,!p&&0<u.id&&(p=!0),0<u.id&&0<u.slot&&r++;p&&a.push(c.concat());if(b)if(p=f.getElementsByClassName("ap")[0],q=castInt(p.textContent),drawChangeValue(p,q,n),e[6>=m?0:1]+=n,d+=n,0<r){k.$jscomp$loop$prop$shipId$310=
castInt(f.dataset.shipid);q=k.$jscomp$loop$prop$shipId$310?SHIP_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$shipId$310}}(k)):null;u=document.createDocumentFragment();p=document.createDocumentFragment();var t=!0,w=document.getElementById("empty_slot_invisible").checked;q&&!w&&(r=q.slot.length);f=(q?q.name:"\u672a\u6307\u5b9a")+"\uff1a";for(var x=0;x<c.length;x++){var v=c[x],y=v.name;if(q||0!==v.id&&0!==v.slot){if(q&&x===q.slot.length)break;f+=" "+y+" "+getProfString(v.level)+
",";if(!q||!w||0!==v.id&&0!==v.slot){var A=getPlaneCss(v.type).replace("css","shoot_table"),B=document.createElement("tr");B.className="slot"+x+" shipNo"+m;B.dataset.shipid=q?q.id:0;B.dataset.shipindex=a.length-1;B.dataset.slotindex=x;B.dataset.css=A+"_hover";if(t){var z=document.createElement("td");z.rowSpan=r;z.className="td_name align-middle";z.textContent=q?q.name:"\u672a\u6307\u5b9a";B.appendChild(z)}z=document.createElement("td");z.className="pl-1 td_plane_name align-middle "+A;z.textContent=
y;B.appendChild(z);for(z=1;10>=z;z++){var C=document.createElement("td");C.className="td_battle battle"+z+" align-middle";B.appendChild(C)}z=document.createElement("td");z.className="td_battle battle_end align-middle";B.appendChild(z);z=document.createElement("td");z.className="td_battle battle_death align-middle";B.appendChild(z);u.appendChild(B);B=document.createElement("tr");B.className="ship_info_tr slot"+(x+1);t&&(z=document.createElement("td"),z.rowSpan=r,z.className="info_name",z.textContent=
q?q.name:"\u672a\u6307\u5b9a",B.appendChild(z));z=document.createElement("td");z.className="info_plane "+A;A=(v.abbr?v.abbr:v.name)+(0!==v.remodel?"\u2605"+v.remodel:"");z.textContent=(A?A:y)+" "+getProfString(v.level);B.appendChild(z);y=document.createElement("td");y.className="info_slot";y.textContent=v.slot;B.appendChild(y);y=document.createElement("td");y.className="info_ap";y.textContent=v.ap;B.appendChild(y);t&&(t=document.createElement("td"),t.rowSpan=r,t.className="info_sumAp",t.textContent=
n,B.appendChild(t));p.appendChild(B);t=!1}}}document.getElementById("shoot_down_table_tbody").appendChild(u);m=document.getElementById("ship_info_table").getElementsByTagName("tbody")[0];m.appendChild(p);m=m.getElementsByTagName("tr");if(0<m.length)for(m=$jscomp.makeIterator(m[m.length-1].getElementsByTagName("td")),n=m.next();!n.done;n=m.next())n.value.classList.add("last_slot");document.getElementById("input_summary").value+=f.slice(0,-1)+"\n"}else if(0===document.getElementById("shoot_down_table_tbody").getElementsByTagName("tr").length){m=
document.createElement("tr");m.className="slot0 shipNo0";n=document.createElement("td");n.className="td_name align-middle";n.textContent="\u672a\u9078\u629e";m.appendChild(n);n=document.createElement("td");n.className="td_plane_name text-nowrap align-middle text-center";n.textContent="-";m.appendChild(n);for(n=1;10>=n;n++)r=document.createElement("td"),r.className="td_battle battle"+n+" align-middle",m.appendChild(r);n=document.createElement("td");n.className="td_battle battle_end align-middle";n.textContent=
d;m.appendChild(n);document.getElementById("shoot_down_table_tbody").appendChild(m)}}}if(b){if(h)for(c=0;c<e.length;c++)document.getElementsByClassName("fleet_ap")[c].textContent=e[c];else $(".friendFleet_tab.show.active")[0].getElementsByClassName("fleet_ap")[0].textContent=e[0];e=document.getElementById("ship_info_table").getElementsByTagName("tbody")[0];(c=e.getElementsByTagName("tr").length)?(g=document.createElement("td"),g.className="info_fleetAp",g.rowSpan=c,g.textContent=d,e.getElementsByClassName("ship_info_tr")[0].appendChild(g),
$("#ship_info_table").find(".info_warning").addClass("d-none"),document.getElementById("ship_info_table").getElementsByClassName("info_warning")[0].classList.add("d-none")):document.getElementById("ship_info_table").getElementsByClassName("info_warning")[0].classList.remove("d-none");d=$("#input_summary");e=(d.val()+"\n").match(/\n/g).length;d.height(castInt(d.css("lineHeight"))*e+2);d.val(d.val().trim())}}
function createFleetPlaneObject(a,b,c){var d=castInt(a.dataset.planeid),e=castInt(a.dataset.type),f=getPlanes(e).find(function(a){return a.id===d});e=a.getElementsByClassName("slot")[0].textContent;var g=castInt(e);0===e.length?g=0:g>MAX_SLOT?(g=MAX_SLOT,a.getElementsByClassName("slot")[0].textContent=g):0>g&&(g=0,a.getElementsByClassName("slot")[0].textContent=g);a={fleetNo:b,slotNo:c,id:0,name:"-",type:0,antiAir:0,ap:0,bonusAp:0,canBattle:!1,canAttack:!1,remodel:castInt(a.getElementsByClassName("remodel_value")[0].textContent),
level:castInt(a.getElementsByClassName("prof_select")[0].dataset.prof),slot:g,origSlot:g,origAp:0,avoid:0};f&&(a.id=f.id,a.name=f.abbr?f.abbr:f.name,a.type=f.type,a.canBattle=!RECONNAISSANCES.includes(f.type),a.canAttack=ATTACKERS.includes(f.type),a.antiAir=getBonusAA(a,f.antiAir),a.bonusAp=getBonusAp(a),a.ap=updateAp(a),a.origAp=a.ap,a.avoid=f.avoid,(b=usedPlane.find(function(a){return a.id===f.id}))?b.num[a.remodel]++:(b={id:f.id,num:[0,0,0,0,0,0,0,0,0,0,0]},b.num[a.remodel]++,usedPlane.push(b)));
return a}function getFriendFleetAP(a,b){for(var c=0,d=a.length,e=0;e<d;e++){var f=a[e],g=f.length;if(!(6<f[0].fleetNo&&b!==CELL_TYPE.grand))for(var h=0;h<g;h++)c+=f[h].ap}return c}
function updateEnemyFleetInfo(a,b){b=void 0===b?!0:b;var c=null,d=0,e=0,f=0,g="999-1",h="",k=!1,l={},m=$jscomp.makeIterator(document.getElementsByClassName("battle_content"));for(d=m.next();!d.done;l={$jscomp$loop$prop$formationId$312:l.$jscomp$loop$prop$formationId$312},d=m.next()){var n=d.value;isDefMode&&(n=document.getElementById("air_raid_enemies"));if(isDefMode&&0<a.length)break;if(!n.classList.contains("d-none")){c={enemies:[],cellType:0,stage2:[]};f=e=d=0;c.cellType=castInt(n.getElementsByClassName("cell_type")[0].value);
for(var r=$jscomp.makeIterator(n.getElementsByClassName("enemy_content")),p=r.next();!p.done;p=r.next()){var q=p.value,u=castInt(q.dataset.enemyid);p=createEnemyObject(u);0===u||q.classList.contains("d-none")||(-1===u&&(q=q.getElementsByClassName("enemy_ap")[0],q=castInt(q.textContent),p.ap=q,p.lbAp=q,p.origAp=q,p.origLbAp=q),c.enemies.push(p),d+=p.ap,e+=p.lbAp,f+=p.aabo)}l.$jscomp$loop$prop$formationId$312=castInt(n.getElementsByClassName("formation")[0].value);r=(r=FORMATION.find(function(a){return function(b){return b.id===
a.$jscomp$loop$prop$formationId$312}}(l)))?r.correction:1;c.stage2=createStage2Table(c.enemies,c.cellType,l.$jscomp$loop$prop$formationId$312);a.push(c);b&&(c=n.getElementsByClassName("enemy_sum_ap")[0],drawChangeValue(c,c.textContent,d,!0),c=n.getElementsByClassName("enemy_sum_lbap")[0],drawChangeValue(c,c.textContent,e,!0),c=n.getElementsByClassName("enemy_range")[0],castInt(c.textContent)?c.parentNode.classList.remove("d-none"):c.parentNode.classList.add("d-none"),c=n.getElementsByClassName("fleet_AA")[0],
drawChangeValue(c,c.textContent,2*Math.floor(r*f),!0),d=n.dataset.celldata?n.dataset.celldata:g.replace("-","")+"_\u624b\u52d5",e=d.split("_")[0].slice(0,-1),e=1E3<e?"E-":e+"-",e+=d.split("_")[0].slice(-1),d=d.split("_")[1],"999-1"===g?g=e:k||g===e||(k=!0),h+=h?" \u2192 "+d:d)}}if(b){isDefMode||(g.includes("999-")?document.getElementById("route").value="\u6d77\u57df\u672a\u6307\u5b9a":document.getElementById("route").value=k?"\u5225\u6d77\u57df\u306e\u30bb\u30eb\u304c\u6df7\u5728\u3057\u3066\u3044\u307e\u3059\u3002":
g+"\uff1a"+h);h=a[isDefMode?0:displayBattle-1].enemies.filter(function(a){return 0<a.slots.length});g=document.createDocumentFragment();k=0;l={};for(m=0;m<h.length;l={$jscomp$loop$prop$enemy$314:l.$jscomp$loop$prop$enemy$314},m++)if(l.$jscomp$loop$prop$enemy$314=h[m],!l.$jscomp$loop$prop$enemy$314.isSpR&&l.$jscomp$loop$prop$enemy$314.slots.length){d="";e=document.createDocumentFragment();for(f={$jscomp$loop$prop$j$316:0};f.$jscomp$loop$prop$j$316<l.$jscomp$loop$prop$enemy$314.slots.length;f={$jscomp$loop$prop$j$316:f.$jscomp$loop$prop$j$316},
f.$jscomp$loop$prop$j$316++)if(p=ENEMY_PLANE_DATA.find(function(a,b){return function(c){return c.id===a.$jscomp$loop$prop$enemy$314.eqp[b.$jscomp$loop$prop$j$316]}}(l,f)))r=l.$jscomp$loop$prop$enemy$314.slots[f.$jscomp$loop$prop$j$316],q=getPlaneCss(p.type).replace("css","shoot_table"),n=f.$jscomp$loop$prop$j$316===l.$jscomp$loop$prop$enemy$314.slots.length-1?" last_slot":"",c=document.createElement("tr"),c.className="enemy_no_"+k+" slot_"+f.$jscomp$loop$prop$j$316,c.dataset.rowindex=k,c.dataset.slotindex=
f.$jscomp$loop$prop$j$316,c.dataset.css=q+"_hover",d+='<img src="./img/plane/'+p.id+'.png" class="img-size-36" title="'+p.name+'">',u=document.createElement("td"),u.className="pl-1 td_plane_name align-middle "+q+n,u.textContent=p.name,c.appendChild(u),p=document.createElement("td"),p.className="td_init_slot align-middle"+n,p.textContent=r,c.appendChild(p),p=document.createElement("td"),p.className="td_avg_slot align-middle"+n,p.textContent=r,c.appendChild(p),p=document.createElement("td"),p.className=
"td_max_slot align-middle"+n,p.textContent=r,c.appendChild(p),p=document.createElement("td"),p.className="td_min_slot align-middle"+n,p.textContent=r,c.appendChild(p),isDefMode?document.getElementsByClassName("td_detail_slot")[0].classList.add("d-none"):(r=document.createElement("td"),r.className="td_detail_slot align-middle"+n,r.innerHTML='<i class="fas fa-file-signature"></i>',c.appendChild(r),document.getElementsByClassName("td_detail_slot")[0].classList.remove("d-none")),e.appendChild(c);f=document.createElement("td");
f.rowSpan=l.$jscomp$loop$prop$enemy$314.slots.length;f.className="td_name align-middle last_slot";f.innerHTML="<div>"+drawEnemyGradeColor(l.$jscomp$loop$prop$enemy$314.name)+"</div><div>"+d+"</div>";e.firstChild.insertBefore(f,e.firstChild.firstChild);g.appendChild(e);k++}g.childNodes.length||(h=document.createElement("tr"),k=document.createElement("td"),k.colSpan=6,k.className="font_size_11",k.textContent="\u6226\u95d8\u6a5f\u3001\u653b\u6483\u6a5f\u3092\u642d\u8f09\u3057\u305f\u6575\u8266\u306e\u3044\u306a\u3044\u6226\u95d8\u3067\u3059\u3002",
h.appendChild(k),g.appendChild(h));document.getElementById("enemy_shoot_down_tbody").appendChild(g)}}
function createStage2Table(a,b,c){for(var d=[[[],[]],[[],[]],[[],[]],[[],[]],[[],[]]],e=a.length,f=[],g=0,h=0;h<e;h++){var k=a[h];f.push(k.aaw);for(var l=0;l<AVOID_TYPE.length;l++){var m=Math.floor(k.aaw*AVOID_TYPE[l].adj[0]);b===CELL_TYPE.grand?6>h?d[l][0].push(.8*m/400):d[l][0].push(.48*m/400):d[l][0].push(m/400)}g+=k.aabo}a=FORMATION.find(function(a){return a.id===c});g=Math.floor((a?a.correction:1)*g*2);for(a=0;a<e;a++)for(h=f[a],k=0;k<AVOID_TYPE.length;k++)l=Math.floor(h*AVOID_TYPE[k].adj[0]),
m=Math.floor(g*AVOID_TYPE[k].adj[1]),b===CELL_TYPE.grand?6>a?d[k][1].push(Math.floor(.8*(l+m)*.09375)):d[k][1].push(Math.floor(.045*(l+m))):d[k][1].push(Math.floor(.09375*(l+m)));return d}
function createEnemyObject(a){var b=ENEMY_DATA.find(function(b){return b.id===a}),c={id:0,type:0,name:"",slots:[],antiAir:[],eqp:[],orgSlots:[],isSpR:!1,ap:0,lbAp:0,origAp:0,origLbAp:0,aaw:0,aabo:0};if(0!==a&&b){for(var d={},e=$jscomp.makeIterator(b.eqp),f=e.next();!f.done;d={$jscomp$loop$prop$id$171$318:d.$jscomp$loop$prop$id$171$318},f=e.next())if(d.$jscomp$loop$prop$id$171$318=f.value,f=ENEMY_PLANE_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$id$171$318}}(d)))c.antiAir.push(f.antiAir),
5!==f.type||c.isSpR||(c.isSpR=!0);c.id=b.id;c.type=b.type;c.name=b.name;c.eqp=b.eqp.concat();c.slots=b.slot.concat();c.orgSlots=b.slot.concat();c.aaw=b.aaw;c.aabo=b.aabo;c.ap=0;c.lbAp=0;updateEnemyAp(c);c.origAp=c.ap;c.origLbAp=c.lbAp}return c}function getEnemyFleetLBAP(a){for(var b=0,c=a.length,d=0;d<c;d++)b+=a[d].lbAp;return b}function getEnemyFleetAP(a){for(var b=0,c=a.length,d=0;d<c;d++)b+=a[d].ap;return b}
function shootDownHalf(a,b){for(var c=$jscomp.makeIterator(b),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=0;e<d.slots.length;e++){var f=d.slots[e];d.slots[e]=f-Math.floor(getShootDownSlotHalf(a,f))}updateEnemyAp(d)}}function shootDownEnemy(a,b){for(var c=b.length,d=0;d<c;d++){for(var e=b[d],f=e.slots.length,g=0;g<f;g++)e.slots[g]-=getShootDownSlot(a,e.slots[g]);updateEnemyAp(e)}}
function getShootDownSlot(a,b){return SHOOT_DOWN_TABLE_ENEMY[b][a][Math.floor(Math.random()*SHOOT_DOWN_TABLE_ENEMY[b][a].length)]}function getShootDownSlotHalf(a,b){return AIR_STATUS[a].rate/2*b/10}function updateEnemyAp(a){if(-1!==a.id){a.ap=0;a.lbAp=0;for(var b=a.antiAir.length,c=0;c<b;c++)a.isSpR?a.lbAp+=Math.floor(a.antiAir[c]*Math.sqrt(Math.floor(a.slots[c]))):a.ap+=Math.floor(a.antiAir[c]*Math.sqrt(Math.floor(a.slots[c])));a.lbAp+=a.ap}}
function shootDownHalfFriend(a,b,c,d){var e=getFriendFleetAP(a,d.cellType);e=getAirStatusIndex(e,b);a=$jscomp.makeIterator(a);for(var f=a.next();!f.done;f=a.next()){f=$jscomp.makeIterator(f.value);for(var g=f.next();!g.done;g=f.next())if(g=g.value,$("#shoot_down_table_tbody").find(".shipNo"+g.fleetNo+".slot"+g.slotNo+" .battle"+(c+1)).text(0<g.id?Math.round(g.slot):""),0!==g.slot&&g.canBattle&&!(6<g.fleetNo&&d.cellType!==CELL_TYPE.grand)&&d.cellType!==CELL_TYPE.night){5===e&&(e=0);for(var h=d.stage2[g.avoid][0].length,
k=0,l=0;1E3>l;l++){var m=g.slot;m-=getShootDownSlotFF(e,Math.round(m));if(g.canAttack&&d.cellType<=CELL_TYPE.grand){var n=Math.floor(Math.random()*h);m-=Math.floor(d.stage2[g.avoid][0][n]*m)*Math.floor(2*Math.random());m-=d.stage2[g.avoid][1][n]*Math.floor(2*Math.random())}k+=0<m?m:0}g.slot=k/1E3;g.ap=updateAp(g)}}$("#shoot_down_table").find(".eap.battle"+(c+1)).text(b)}
function shootDownFriend(a,b,c){var d=b.length,e=c.stage2[0][0].length;if(e)for(var f=0;f<d;f++)for(var g=b[f],h=g.length,k=0;k<h;k++){var l=g[k];if(!(0>=l.slot||!l.canBattle||6<l.fleetNo&&1===c.cellType)){5===a&&(a=0);l.slot-=getShootDownSlotFF(a,l.slot);if(l.canAttack&&c.cellType<=CELL_TYPE.grand){var m=Math.floor(Math.random()*e);l.slot-=Math.floor(c.stage2[l.avoid][0][m]*l.slot)*Math.floor(2*Math.random());l.slot-=c.stage2[l.avoid][1][m]*Math.floor(2*Math.random())}l.ap=updateAp(l)}}}
function getShootDownSlotFF(a,b){var c=SHOOT_DOWN_TABLE[b][a];return c[Math.floor(Math.random()*c.length)]}function getShootDownSlotHalfFF(a,b){for(var c=SHOOT_DOWN_TABLE[Math.ceil(b)][a],d=0,e=$jscomp.makeIterator(c),f=e.next();!f.done;f=e.next())d+=f.value;return d/c.length}
function getLandBasePower(a,b,c){var d=PLANE_DATA.find(function(b){return b.id===a});if(!d)return 0;var e=Math.abs(d.type),f=0,g=0;switch(e){case 2:f=.2*c+d.torpedo;g=1;break;case 3:f=0*c+d.bomber;g=1;break;case 6:f=.2*c+d.bomber;g=1;break;case 9:f=0*c+d.bomber;g=.7071;break;case 101:f=.7*c+d.torpedo,g=.8}b=Math.floor(g*(f*Math.sqrt(1.8*b)+25));return 101===e?1.8*b:1*b}
function mainCalculate(a){var b=a.landBaseData,c=a.friendFleetData;a=a.battleData;var d=isDefMode?0:displayBattle-1,e=castInt($("#landBase_target").val())-1;d=d<a.length?d:a.length-1;if(isDefMode){for(d=c=0;3>d;d++)-1!==b[d].mode&&(c+=b[d].ap);b=!1;a=$jscomp.makeIterator(a);for(d=a.next();!d.done;d=a.next()){d=d.value;e=$jscomp.makeIterator(d.enemies);for(var f=e.next();!f.done;f=e.next())if(5===d.cellType){c=castInt($(".info_defApEx").text());b=!0;break}if(b)break}chartData.own.push(c)}else{$("#shoot_down_table").find("td").removeClass("d-none");
for(f=battleCount+1;10>=f;f++)$("#shoot_down_table").find(".battle"+f).addClass("d-none");for(f=0;f<battleCount;f++){var g=a[f].enemies,h=a[f].cellType;f===e&&calculateLandBasePhase(b,g,d===e);f===d&&(fap=getFriendFleetAP(c,h),eap=getEnemyFleetAP(g),chartData.own.push(fap),chartData.enemy.push(eap));shootDownHalfFriend(c,getEnemyFleetAP(g),f,a[f])}}}
function calculateLandBasePhase(a,b,c){for(var d=0;3>d;d++){var e=a[d].ap;if(0<a[d].mode){var f=getEnemyFleetLBAP(b);c&&(chartData.own.push(e),chartData.enemy.push(f));shootDownHalf(getLBAirStatusIndex(e,f),b)}else c&&chartData.own.push(0);2===a[d].mode?(f=getEnemyFleetLBAP(b),c&&(chartData.own.push(e),chartData.enemy.push(f)),shootDownHalf(getLBAirStatusIndex(e,f),b)):c&&chartData.own.push(0)}}
function rateCalculate(a){var b=a.landBaseData,c=a.friendFleetData,d=a.battleData,e=castInt($("#calculate_count").val());$("#calculate_count").val(0===e?++e:e);var f=isDefMode?0:castInt($("#landBase_target").val())-1,g=c.concat(),h=g.length,k=d.concat();c=isDefMode?0:displayBattle-1;var l=[0,0,0,0,0,0,0],m=[0,0,0,0,0,0],n=[],r=[],p=[];a=[];for(var q=[],u=[],t=[],w=isDefMode?1:battleCount,x=chartData.own[0],v=$jscomp.makeIterator(k),y=v.next();!y.done;y=v.next())y=y.value,y.enemies=y.enemies.filter(function(a){return 0<
a.slots.length});c=c<d.length?c:d.length-1;for(d=0;6>d;d++)p.push([0,0,0,0,0,0]);b=$jscomp.makeIterator(b);for(d=b.next();!d.done;d=b.next())d=d.value,n.push(d.ap),r.push(d.mode);for(b=0;b<h;b++)for(d=0;d<g[b].length;d++)q.push(Array(e));for(b=0;b<w;b++)u.push(0);for(b=0;b<k[c].enemies.length;b++)if(d=k[c].enemies[b],!d.isSpR)for(v=0===t.length?0:t[t.length-1][0]+1,y=0;y<d.slots.length;y++)t.push([v,y,0,0,999,[]]);b=$jscomp.makeIterator(g);for(d=b.next();!d.done;d=b.next())for(d=$jscomp.makeIterator(d.value),
v=d.next();!v.done;v=d.next())v=v.value,v.slot=v.origSlot,v.ap=v.origAp;for(b=0;b<e;b++){d=$jscomp.makeIterator(k[f].enemies);for(v=d.next();!v.done;v=d.next())v=v.value,v.slots=v.orgSlots.concat(),v.ap=v.origAp,v.lbAp=v.origLbAp;calculateLandBase(n,r,k[f].enemies,l,p);for(d=0;d<w;d++){v=k[d].enemies;y=k[d].cellType;var A=isDefMode?x:getFriendFleetAP(g,y);y=getEnemyFleetAP(v);var B=getAirStatusIndex(A,y);d===c&&m[B]++;u[d]+=A;shootDownFriend(B,g,k[d]);if(d===c)for(shootDownEnemy(B,v),B=A=0;B<v.length;B++){var z=
v[B];if(!z.isSpR){for(var C=z.slots,F=0;F<C.length;F++){var D=C[F],E=t[A++];E[2]+=D;E[3]<D&&(E[3]=D);E[4]>D&&(E[4]=D);E[5].push(y)}z.slots=z.orgSlots.concat();z.ap=z.origAp;z.lbAp=z.origLbAp}}}for(d=0;d<h;d++)for(v=g[d],y=v.length,A=0;A<y;A++)q[5*d+A][b]=v[A].slot,v[A].slot=v[A].origSlot,v[A].ap=v[A].origAp}k=l.map(function(a){return Math.round(a/e)});l=castInt($("#shoot_down_table").find(".fap.battle"+(f+1)).text());n=castInt(k[6]);if(0<l||0<n)$("#shoot_down_table").find(".eap.battle"+(f+1)).text(n),
$("#shoot_down_table").find(".cond.battle"+(f+1)).text(AIR_STATUS[getAirStatusIndex(l,n)].abbr);f===c&&(a=p.concat(),chartData.enemy=k);a.push(m);f=$jscomp.makeIterator(a);for(m=f.next();!m.done;m=f.next())for(m=m.value,p=m.length,k=0;k<p;k++)m[k]/=e;isDefMode&&(chartData.enemy[0]=chartData.enemy[6],a[0]=a[6]);for(m=f=0;m<h;m++)for(p=0;p<g[m].length;p++)k=q[f++],l={shipNo:g[m][p].fleetNo,slot:g[m][p].slotNo,max:getArrayMax(k),min:getArrayMin(k),avg:k.reduce(function(a,b){return a+b})/e,death:k.filter(function(a){return 0===
a}).length,deathRate:0},l.deathRate=l.death/k.length,chartData.slots.push(l);for(g=0;g<w;g++)h=Math.round(u[g]/e),q=castInt($("#shoot_down_table").find(".eap.battle"+(g+1)).text()),q=getAirStatusIndex(h,q),$("#shoot_down_table").find(".fap.battle"+(g+1)).text(h),$("#shoot_down_table").find(".cond.battle"+(g+1)).text(AIR_STATUS[q].abbr).addClass("airStatus"+q);isDefMode||(chartData.own[chartData.own.length-1]=Math.round(u[c]/e));chartData.rate=a.concat();chartData.enSlots=t.concat()}
function calculateLandBase(a,b,c,d,e){for(var f=0;3>f;f++){var g=a[f];if(0<b[f]){var h=2*f,k=getEnemyFleetLBAP(c);d[h]+=k;k=getLBAirStatusIndex(g,k);e[h][k]++;shootDownEnemy(k,c)}2===b[f]&&(h=2*f+1,k=getEnemyFleetLBAP(c),d[h]+=k,g=getLBAirStatusIndex(g,k),e[h][g]++,shootDownEnemy(g,c))}d[6]+=isDefMode?getEnemyFleetLBAP(c):getEnemyFleetAP(c)}
function detailCalculate(){var a=castInt($("#detail_info").data("base_no")),b=castInt($("#detail_info").data("slot_no"));switch($("#detail_info").data("mode")){case "enemy_slot_detail":enemySlotDetailCalculate(a,b);break;case "fleet_slot_detail":fleetSlotDetailCalculate(a,b,castInt($("#detail_info").data("ship_id")));break;case "land_base_detail":landBaseDetailCalculate(a,b)}}
function fleetSlotDetailCalculate(a,b,c){c=void 0===c?0:c;setPreCalculateTable();var d=[],e=[],f=[];updateLandBaseInfo(d,!1);updateFriendFleetInfo(e,!1);updateEnemyFleetInfo(f,!1);var g=castInt($("#calculate_count").val()),h=isDefMode?0:displayBattle-1,k=isDefMode?0:castInt($("#landBase_target").val())-1,l=[],m=e[a],n=PLANE_DATA.find(function(a){return a.id===m[b].id});h=h<f.length?h:f.length-1;var r=2===Math.abs(n.type)?[.8,1.5]:ATTACKERS.includes(n.type)?[1]:[0],p=.2*(3===Math.abs(n.type)?0:m[b].remodel)+
(2===Math.abs(n.type)?n.torpedo:n.bomber);n=$jscomp.makeIterator(f);for(var q=n.next();!q.done;q=n.next())q=q.value,q.enemies=q.enemies.filter(function(a){return 0<a.slots.length});n=[];q=[];d=$jscomp.makeIterator(d);for(var u=d.next();!u.done;u=d.next())u=u.value,n.push(u.ap),q.push(u.mode);for(d=0;d<g;d++){if(k<=h){u=$jscomp.makeIterator(f[k].enemies);for(var t=u.next();!t.done;t=u.next())t=t.value,t.slots=t.orgSlots.concat(),t.ap=t.origAp,t.lbAp=t.origLbAp;u=f[k].enemies;for(t=0;3>t;t++){var w=
n[t];if(0<q[t]){var x=getEnemyFleetLBAP(u);x=getLBAirStatusIndex(w,x);shootDownEnemy(x,u)}2===q[t]&&(x=getEnemyFleetLBAP(u),w=getLBAirStatusIndex(w,x),shootDownEnemy(w,u))}}for(u=0;u<battleCount;u++)t=f[u].enemies,w=f[u].cellType,w=isDefMode?defAp:getFriendFleetAP(e,w),t=getEnemyFleetAP(t),t=getAirStatusIndex(w,t),shootDownFriend(t,e,f[u]);for(u=0;u<e.length;u++)for(t=e[u],w=t.length,x=0;x<w;x++)u===a&&x===b&&l.push(t[x].slot),t[x].slot=t[x].origSlot,t[x].ap=t[x].origAp}updateDetailChart(l,"\u6b8b\u6a5f\u6570 [\u6a5f]",
{mode:"index",callbacks:{title:function(a,b){var c=a[0].xLabel;if(!c)return"\u6b8b\u6a5f\u6570\uff1a"+c+" \u6a5f\n\u822a\u7a7a\u6226\u706b\u529b\uff1a0";var d=2===r.length?Math.floor(r[1]*(p*Math.sqrt(c)+25)):0;return"\u6b8b\u6a5f\u6570\uff1a"+c+" \u6a5f\n\u822a\u7a7a\u6226\u706b\u529b\uff1a"+(Math.floor(r[0]*(p*Math.sqrt(c)+25))+(d?" or "+d:""))},label:function(a,b){return[a.yLabel+" %"]}}});e=$("#show_detail_slot .nav-item");g=SHIP_DATA.find(function(a){return a.id===c});f="";h=0;$("#land_base_detail_table").addClass("d-none");
$("#detail_fire").addClass("d-none").removeClass("d-flex");$("#detail_wave").addClass("d-none").removeClass("d-flex");$("#detail_info").data("mode","fleet_slot_detail");$("#detail_info").data("ship_id",c);$("#detail_info").data("base_no",a);$("#detail_info").data("slot_no",b);$("#detail_warning").html("\n    <div>\u203b \u822a\u7a7a\u6226\u706b\u529b\u306f\u30ad\u30e3\u30c3\u30d7\u524d\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u88dc\u6b63\u3001\u89e6\u63a5\u88dc\u6b63\u306a\u3057\u3002\u5c0f\u6570\u5207\u6368\u3066</div>\n    <div>\u203b \u6700\u7d42\u6226\u95d8\u306e\u822a\u7a7a\u6226\u7d42\u4e86\u6642\u70b9\u3067\u306e\u6b8b\u6570\u306e\u5206\u5e03\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002</div>");
e.find(".nav-link").addClass("disabled");e.addClass("d-none");a={};k=$jscomp.makeIterator(m);for(l=k.next();!l.done;a={$jscomp$loop$prop$pl$320:a.$jscomp$loop$prop$pl$320},l=k.next()){a.$jscomp$loop$prop$pl$320=l.value;(l=PLANE_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$pl$320.id}}(a)))&&l.id&&(e.eq(h).find(".nav-link").removeClass("disabled"),e.eq(h).data("slot_no",h));if(h===(g?g.slot.length:4))break;e.eq(h).removeClass("d-none");f+='\n    <div class="row">\n      <div class="col-2 align-self-center text-right font_size_12">\u88c5\u5099'+
(h+1)+':</div>\n      <div class="col d-flex align-self-end font_size_12 pl-0">\n        <img src="./img/type/'+(l?"type"+l.type:"undefined")+'.png" class="plane_img_sm align-self-center">\n        <div class="align-self-end">'+(l?l.abbr?l.abbr:l.name:"-")+'</div>\n      </div>\n      <div class="col font_size_11 align-self-end">\n        '+(l?"(\u642d\u8f09: "+m[h].slot+"\u6a5f"+(l.torpedo?"\u3000\u96f7\u88c5: "+l.torpedo:"")+(l.bomber?"\u3000\u7206\u88c5: "+l.bomber:"")+")":"")+"\n      </div>\n    </div>";
h++}a='\n    <img src="./img/ship/'+c+'.png" class="ship_img align-self-center '+(c?"":"d-none")+'">\n    <span class="ml-1 align-self-center">'+(g?g.name:"\u672a\u6307\u5b9a")+"</span>\n  ";e.eq(b).find(".nav-link").tab("show");$("#detail_legend").html(a);$("#detail_info").html(f)}
function landBaseDetailCalculate(a,b){setPreCalculateTable();var c=[],d=[];updateLandBaseInfo(c,!1);updateEnemyFleetInfo(d,!1);var e=castInt($("#calculate_count").val()),f=isDefMode?0:castInt($("#landBase_target").val())-1,g=[],h=d[f],k=h.enemies,l=c[a].planes;for(f=d=0;f<l.length;f++){var m=l[f];0===l[b].id&&0!==m.id&&(b=f);d+=m.slot}m=h.cellType<=CELL_TYPE.grand;var n=h.stage2[0][0].length,r=$("#detail_wave1").prop("checked");f=[];for(var p=$jscomp.makeIterator(c),q=p.next();!q.done;q=p.next()){q=
$jscomp.makeIterator(q.value.planes);for(var u=q.next();!u.done;u=q.next())u=u.value,u.origSlot=u.slot,u.origAp=u.ap}for(q=0;q<e;q++){p=$jscomp.makeIterator(k);for(u=p.next();!u.done;u=p.next())u=u.value,u.slots=u.orgSlots.concat(),u.ap=u.origAp,u.lbAp=u.origLbAp;for(p=0;3>p;p++){u=c[p];var t=u.ap;if(0<u.mode){var w=getEnemyFleetLBAP(k);w=getLBAirStatusIndex(t,w);shootDownEnemy(w,k);if(r&&p===a){for(var x=0,v=0;v<u.planes.length;v++){var y=u.planes[v],A=y.origSlot;5===w&&(w=0);y.slot-=getShootDownSlotFF(w,
y.slot);if(y.canAttack&&m){var B=Math.floor(Math.random()*n);y.slot-=Math.floor(h.stage2[y.avoid][0][B]*y.slot)*Math.floor(2*Math.random());y.slot-=h.stage2[y.avoid][1][B]*Math.floor(2*Math.random())}B=0>y.slot?0:y.slot;v===b&&g.push(B);x+=B;y.slot=A}f.push(x)}}if(2===u.mode&&(w=getEnemyFleetLBAP(k),t=getLBAirStatusIndex(t,w),shootDownEnemy(t,k),!r&&p===a)){for(x=w=0;x<u.planes.length;x++)v=u.planes[x],y=v.origSlot,5===t&&(t=0),v.slot-=getShootDownSlotFF(t,v.slot),v.canAttack&&m&&(A=Math.floor(Math.random()*
n),v.slot-=Math.floor(h.stage2[v.avoid][0][A]*v.slot)*Math.floor(2*Math.random()),v.slot-=h.stage2[v.avoid][1][A]*Math.floor(2*Math.random())),A=0>v.slot?0:v.slot,x===b&&g.push(A),w+=A,v.slot=y;f.push(w)}}}var z=l[b].id,C=l[b].remodel,F=l.find(function(a){return 312===a.id})?1.15:l.find(function(a){return 311===a.id})?1.125:1,D=h.cellType===CELL_TYPE.grand?1.1:1;updateDetailChart(g,"\u6b8b\u6a5f\u6570 [\u6a5f]",{mode:"index",callbacks:{title:function(a,b){var c=a[0].xLabel,d="\u822a\u7a7a\u6226\u706b\u529b\uff1a"+
(getLandBasePower(z,c,C)*F*D).toFixed(1);return c?"\u6b8b\u6a5f\u6570\uff1a"+c+" \u6a5f\n"+d:"\u6b8b\u6a5f\u6570\uff1a0 \u6a5f\n\u822a\u7a7a\u6226\u706b\u529b\uff1a0"},label:function(a,b){return[a.yLabel+" %"]}}});k=h=g=0;f=$jscomp.makeIterator(f);for(q=f.next();!q.done;q=f.next())l=q.value,m=l/d,0===l?k++:.25>m?h++:.4>m&&g++;$("#status_s").text(100*g/e+" %");$("#status_m").text(100*h/e+" %");$("#status_l").text(100*k/e+" %");e=$("#show_detail_slot .nav-item");e.eq(b).find(".nav-link").tab("show");
d="";g=0;$("#land_base_detail_table").removeClass("d-none");$("#detail_fire").addClass("d-none").removeClass("d-flex");$("#detail_wave").removeClass("d-none").addClass("d-flex");$("#detail_info").data("mode","land_base_detail");$("#detail_info").data("base_no",a);$("#detail_info").data("slot_no",b);$("#detail_warning").html("\n    <div>\u203b \u822a\u7a7a\u6226\u706b\u529b\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u88dc\u6b63\u3001\u89e6\u63a5\u88dc\u6b63\u306a\u3057\u3067\u5bfe\u6c34\u4e0a\u8266\u306e\u5834\u5408</div>\n    <div>\u203b \u5bfe\u6575\u9023\u5408\u88dc\u6b63\u3001\u9678\u5075\u88dc\u6b63\u306b\u3064\u3044\u3066\u306f\u3001\u8a72\u5f53\u3059\u308b\u6226\u95d8\u3001\u88c5\u5099\u3067\u3042\u308c\u3070\u6709\u52b9</div>");
e.find(".nav-link").addClass("disabled");e.addClass("d-none");f={};c=$jscomp.makeIterator(c[a].planes);for(h=c.next();!h.done;f={$jscomp$loop$prop$pl$322:f.$jscomp$loop$prop$pl$322},h=c.next())f.$jscomp$loop$prop$pl$322=h.value,(h=PLANE_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$pl$322.id}}(f)))&&h.id&&(e.eq(g).find(".nav-link").removeClass("disabled"),e.eq(g).data("slot_no",g)),e.eq(g).removeClass("d-none"),d+='\n    <div class="row">\n      <div class="col-2 align-self-center text-right font_size_12">\u88c5\u5099'+
(g+1)+':</div>\n      <div class="col d-flex align-self-end font_size_12 pl-0">\n        <img src="./img/type/'+(h?"type"+h.type:"undefined")+'.png" class="plane_img_sm align-self-center">\n        <div class="align-self-end">'+(h?h.abbr?h.abbr:h.name:"-")+'</div>\n      </div>\n      <div class="col font_size_11 align-self-end">\n        '+(h?"(\u642d\u8f09: "+f.$jscomp$loop$prop$pl$322.slot+"\u6a5f"+(h.torpedo?"\u3000\u96f7\u88c5: "+h.torpedo:"")+(h.bomber?"\u3000\u7206\u88c5: "+h.bomber:"")+")":
"")+"\n      </div>\n    </div>",g++;$("#detail_legend").html("<span>\u7b2c"+(a+1)+"\u57fa\u5730\u822a\u7a7a\u968a</span>");$("#detail_info").html(d)}
function enemySlotDetailCalculate(a,b){setPreCalculateTable();var c=[],d=[],e=[];updateLandBaseInfo(c,!1);updateFriendFleetInfo(d,!1);updateEnemyFleetInfo(e,!1);var f=castInt($("#calculate_count").val()),g=isDefMode?0:displayBattle-1;g=g<e.length?g:e.length-1;var h=isDefMode?0:castInt($("#landBase_target").val())-1,k=[],l=e[g].enemies.filter(function(a){return 0<a.slots.length&&!a.isSpR})[a],m=ENEMY_DATA.find(function(a){return a.id===l.id}),n=ENEMY_PLANE_DATA.find(function(a){return a.id===m.eqp[b]}),
r=2===Math.abs(n.type)?[.8,1.5]:1===Math.abs(n.type)?[0]:[1],p=2===Math.abs(n.type)?n.torpedo:n.bomber;n=$("#slot_detail").prop("checked");for(var q=$jscomp.makeIterator(e),u=q.next();!u.done;u=q.next())u=u.value,u.enemies=u.enemies.filter(function(a){return 0<a.slots.length});q=[];u=[];c=$jscomp.makeIterator(c);for(var t=c.next();!t.done;t=c.next())t=t.value,q.push(t.ap),u.push(t.mode);for(c=0;c<f;c++){if(h<=g){t=$jscomp.makeIterator(e[h].enemies);for(var w=t.next();!w.done;w=t.next())w=w.value,
w.slots=w.orgSlots.concat(),w.ap=w.origAp,w.lbAp=w.origLbAp;t=e[h].enemies;for(w=0;3>w;w++){var x=q[w];if(0<u[w]){var v=getEnemyFleetLBAP(t);v=getLBAirStatusIndex(x,v);shootDownEnemy(v,t)}2===u[w]&&(v=getEnemyFleetLBAP(t),x=getLBAirStatusIndex(x,v),shootDownEnemy(x,t))}}for(t=0;t<=g;t++)if(w=e[t].enemies,x=e[t].cellType,x=isDefMode?defAp:getFriendFleetAP(d,x),v=getEnemyFleetAP(w),x=getAirStatusIndex(x,v),t===g)for(shootDownEnemy(x,w),n?k.push(l.slots[b]):l.slots[b]?k.push(Math.floor(r[Math.floor(Math.random()*
r.length)]*(p*Math.sqrt(l.slots[b])+25))):k.push(0),x=0;x<w.length;x++)v=w[x],v.isSpR||(v.slots=v.orgSlots.concat(),v.ap=v.origAp,v.lbAp=v.origLbAp);else shootDownFriend(x,d,e[t]);for(t=0;t<d.length;t++)for(w=d[t],x=w.length,v=0;v<x;v++)w[v].slot=w[v].origSlot,w[v].ap=w[v].origAp}updateDetailChart(k,n?"\u6b8b\u6a5f\u6570 [\u6a5f]":"\u822a\u7a7a\u6226\u706b\u529b",{mode:"index",callbacks:{title:function(a,b){var c=a[0].xLabel;if($("#slot_detail").prop("checked")){if(!c)return"\u6b8b\u6a5f\u6570\uff1a"+
c+" \u6a5f\n\u822a\u7a7a\u6226\u706b\u529b\uff1a0";var d=2===r.length?Math.floor(r[1]*(p*Math.sqrt(c)+25)):0;return"\u6b8b\u6a5f\u6570\uff1a"+c+" \u6a5f\n\u822a\u7a7a\u6226\u706b\u529b\uff1a"+(Math.floor(r[0]*(p*Math.sqrt(c)+25))+(d?" or "+d:""))}return"\u822a\u7a7a\u6226\u706b\u529b\uff1a"+c},label:function(a,b){return[a.yLabel+" %"]}}});e=$("#show_detail_slot .nav-item");e.eq(b).find(".nav-link").tab("show");if("enemy_slot_detail"!==$("#detail_info").data("mode")||$("#detail_info").data("base_no")!=
a){$("#land_base_detail_table").addClass("d-none");$("#detail_fire").removeClass("d-none").addClass("d-flex");$("#detail_wave").addClass("d-none").removeClass("d-flex");$("#detail_info").data("mode","enemy_slot_detail");$("#detail_info").data("base_no",a);$("#detail_info").data("slot_no",b);$("#detail_warning").text("\u203b \u822a\u7a7a\u6226\u706b\u529b\u306f\u30ad\u30e3\u30c3\u30d7\u524d\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3001\u89e6\u63a5\u88dc\u6b63\u306a\u3057\u5c0f\u6570\u5207\u6368\u3066");
d="";f=0;e.addClass("d-none");g={};h=$jscomp.makeIterator(m.eqp);for(k=h.next();!k.done;g={$jscomp$loop$prop$id$324:g.$jscomp$loop$prop$id$324},k=h.next())g.$jscomp$loop$prop$id$324=k.value,k=ENEMY_PLANE_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$id$324}}(g)),e.eq(f).removeClass("d-none"),e.eq(f).data("slot_no",f),d+='\n      <div class="row">\n        <div class="col-2 align-self-center">\u88c5\u5099'+(f+1)+':</div>\n        <div class="col d-flex align-self-end">\n          <img src="./img/type/type'+
k.type+'.png" class="plane_img_sm align-self-center">\n          <div class="align-self-end">'+k.name+'</div>\n        </div>\n        <div class="col font_size_12 align-self-end">\n          (\u642d\u8f09: '+l.slots[f++]+"\u6a5f"+(k.torpedo?"\u3000\u96f7\u88c5: "+k.torpedo:"")+(k.bomber?"\u3000\u7206\u88c5: "+k.bomber:"")+")</span>\n        </div>\n      </div>";e='\n      <img src="./img/enemy/'+m.id+'.png" class="ship_img align-self-center">\n      <span class="ml-1 text-primary font_size_11 align-self-center">ID: '+
(m.id+1500)+'</span>\n      <span class="ml-1 align-self-center">'+m.name+"</span>\n    ";$("#detail_legend").html(e);$("#detail_info").html(d)}}
function updateDetailChart(a,b,c){for(var d=[],e=[],f=[],g=getArrayMax(a),h=getArrayMin(a),k=a.length,l=0,m=0,n=0,r=0,p=0,q={$jscomp$loop$prop$i$326:h};q.$jscomp$loop$prop$i$326<=g;q={$jscomp$loop$prop$i$326:q.$jscomp$loop$prop$i$326},q.$jscomp$loop$prop$i$326++){var u=a.filter(function(a){return function(b){return b===a.$jscomp$loop$prop$i$326}}(q)).length;u&&(d.push(q.$jscomp$loop$prop$i$326),e.push((100*u/k).toFixed(1E5<=k?5:1E4<=k?4:1E3<=k?3:2)),p+=100*u/k,f.push(p.toFixed(1)),!l&&50<=p&&(l=q.$jscomp$loop$prop$i$326),
!m&&90<=p&&(m=q.$jscomp$loop$prop$i$326),!n&&95<=p&&(n=q.$jscomp$loop$prop$i$326),!r&&99<=p&&(r=q.$jscomp$loop$prop$i$326))}$("#detail_max").text(g);$("#detail_min").text(h);$("#detail_50").text(l);$("#detail_90").text(m);$("#detail_95").text(n);$("#detail_99").text(r);chartDataSet?(chartDataSet.data.labels=d,chartDataSet.data.datasets[0].data=e,chartDataSet.data.datasets[1].data=f,chartDataSet.options.scales.xAxes[0].scaleLabel.labelString=b,chartDataSet.options.tooltips=c,chartDataSet.update()):
(a=document.getElementById("detailChart"),chartDataSet=new Chart(a,{type:"bar",data:{labels:d,datasets:[{label:"\u78ba\u7387\u5206\u5e03",data:e,borderColor:"rgb(255, 70, 100)",backgroundColor:"rgba(255, 120, 180, 0.4)",yAxisID:"y-axis-1"},{label:"\u7d2f\u7a4d\u78ba\u7387",data:f,type:"line",fill:!1,borderColor:"rgb(54, 162, 235)",yAxisID:"y-axis-2"}]},options:{responsive:!0,scales:{xAxes:[{scaleLabel:{display:!0,labelString:b},gridLines:{display:!1},ticks:{fontSize:10}}],yAxes:[{id:"y-axis-1",type:"linear",
position:"left",scaleLabel:{display:!0,labelString:"\u78ba\u7387\u5206\u5e03 [\uff05]"},ticks:{min:0}},{id:"y-axis-2",type:"linear",position:"right",scaleLabel:{display:!0,labelString:"\u7d2f\u7a4d\u78ba\u7387 [\uff05]"},ticks:{max:100,min:0,stepSize:25}}]},tooltips:c}}))}function autoExpand(){if($("#mode_1").prop("checked"))isDefMode=!1,autoExpandNormal();else if($("#mode_2").prop("checked")||$("#mode_3").prop("checked"))isDefMode=!0,autoExpandDefense();calculate()}
function autoExpandNormal(){var a=loadPlaneStock(),b=$("#allow_fighter").prop("checked"),c=$("#auto_land_base_1").prop("checked"),d=$("#auto_land_base_2").prop("checked"),e=$("#auto_land_base_3").prop("checked"),f=$("#auto_fleet").prop("checked");c||$("#lb_item1").find(".lb_plane").each(function(b,c){var d=a.find(function(a){return a.id===castInt($(c)[0].dataset.planeid)}),e=castInt($(c).find(".remodel_value").text());d&&d.num[e]--});d||$("#lb_item2").find(".lb_plane").each(function(b,c){var d=a.find(function(a){return a.id===
castInt($(c)[0].dataset.planeid)}),e=castInt($(c).find(".remodel_value").text());d&&d.num[e]--});e||$("#lb_item3").find(".lb_plane").each(function(b,c){var d=a.find(function(a){return a.id===castInt($(c)[0].dataset.planeid)}),e=castInt($(c).find(".remodel_value").text());d&&d.num[e]--});f&&autoFleetExpand(a);$(".ship_tab").find(".ship_plane").each(function(b,c){var d=a.find(function(a){return a.id===castInt($(c)[0].dataset.planeid)}),e=castInt($(c).find(".remodel_value").text());d&&d.num[e]--});if(c||
d||e){var g=[];f=castInt($("#dest_range").val());for(var h={},k=$jscomp.makeIterator(a),l=k.next();!l.done;h={$jscomp$loop$prop$stock$328:h.$jscomp$loop$prop$stock$328},l=k.next())if(h.$jscomp$loop$prop$stock$328=l.value,!(0>=getArraySum(h.$jscomp$loop$prop$stock$328.num)||(l=PLANE_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$stock$328.id}}(h)),l.radius<f||-101===l.type||!b&&1===Math.abs(l.type)))){var m="type"+Math.abs(FIGHTERS.includes(l.type)?1:l.type);g.hasOwnProperty(m)||
(g[m]=[]);for(var n=0;n<h.$jscomp$loop$prop$stock$328.num.length;n++)for(var r=0;r<h.$jscomp$loop$prop$stock$328.num[n];r++){var p={id:l.id,type:l.type,antiAir:l.antiAir+1.5*l.interception,torpedo:l.torpedo,bomber:l.bomber,remodel:n};p.antiAir=getBonusAA(p,p.antiAir);g[m].push(p)}}Object.keys(g).forEach(function(a){"type1"===a?g[a].sort(function(a,b){return a.antiAir===b.antiAir?b.radius-a.radius:b.antiAir-a.antiAir}):"type2"===a?g[a].sort(function(a,b){return a.torpedo===b.torpedo?b.radius-a.radius:
b.torpedo-a.torpedo}):"type101"===a?g[a].sort(function(a,b){return 186===a.id&&186===b.id?b.antiAir-a.antiAir:186===a.id?-1:186===b.id?1:a.torpedo===b.torpedo?b.radius-a.radius:b.torpedo-a.torpedo}):["type3","type6"].includes(a)?g[a].sort(function(a,b){return a.bomber===b.bomber?b.antiAir-a.antiAir:b.bomber-a.bomber}):["type4","type5","type8","type104"].includes(a)&&g[a].sort(function(a,b){return a.scout===b.scout?b.antiAir-a.antiAir:b.scout-a.scout})});if(c){var q=autoLandBaseExpand(g);$("#lb_item1").find(".lb_plane").each(function(a,
b){setLBPlaneDiv($(b),q[a])});$("#lb_item1").find(".ohuda_select").val(0<q.length?2:-1)}if(d){var u=autoLandBaseExpand(g);$("#lb_item2").find(".lb_plane").each(function(a,b){setLBPlaneDiv($(b),u[a])});$("#lb_item2").find(".ohuda_select").val(0<u.length?2:-1)}if(e){var t=autoLandBaseExpand(g);$("#lb_item3").find(".lb_plane").each(function(a,b){setLBPlaneDiv($(b),t[a])});$("#lb_item3").find(".ohuda_select").val(0<t.length?2:-1)}}}
function autoFleetExpand(a){var b=castInt($("#dest_ap").val()),c=$('.ship_tab[data-shipid!=""]'),d=!$("#no_FBA").prop("checked"),e=[],f={};a=$jscomp.makeIterator(a);for(var g=a.next();!g.done;f={$jscomp$loop$prop$stock$330:f.$jscomp$loop$prop$stock$330},g=a.next())if(f.$jscomp$loop$prop$stock$330=g.value,[16,19,23,26].includes(f.$jscomp$loop$prop$stock$330.id)&&(f.$jscomp$loop$prop$stock$330.num=[60,0,0,0,0,0,0,0,0,0,0]),!(0>=getArraySum(f.$jscomp$loop$prop$stock$330.num)||(g=PLANE_DATA.find(function(a){return function(b){return b.id===
a.$jscomp$loop$prop$stock$330.id}}(f)),100<g.type))){var h="type"+Math.abs(FIGHTERS.includes(g.type)?"1":g.type);e.hasOwnProperty(h)||(e[h]=[]);for(var k=0;k<f.$jscomp$loop$prop$stock$330.num.length;k++)for(var l=0;l<f.$jscomp$loop$prop$stock$330.num[k];l++){var m={id:g.id,type:g.type,antiAir:g.antiAir+1.5*g.interception,torpedo:g.torpedo,bomber:g.bomber,avoid:g.avoid,remodel:k,stock:1};m.antiAir=getBonusAA(m,m.antiAir);e[h].push(m)}}Object.keys(e).forEach(function(a){"type1"===a?e[a].sort(function(a,
b){return b.antiAir-a.antiAir}):"type2"===a?e[a].sort(function(a,b){return a.torpedo===b.torpedo?b.antiAir-a.antiAir:b.torpedo-a.torpedo}):["type3","type6"].includes(a)&&e[a].sort(function(a,b){return a.avoid===b.avoid?b.bomber-a.bomber:b.avoid-a.avoid})});var n=[],r=0;c.each(function(a,b){var c=SHIP_DATA.find(function(a){return a.id===castInt($(b)[0].dataset.shipid)});if(c){var d=[];$(b).find(".ship_plane:not(.d-none)").each(function(b,f){var g=castInt($(f).find(".slot").text()),h=$(f).find(".plane_unlock").hasClass("d-none"),
k={shipId:c.id,shipType:c.type,slotNo:b,num:g,plane:{id:0,ap:0},order:r++,num_:g,slotId:"ship"+a+"_slot"+b,isLock:h,lockedPlane:null};if(h){var n=PLANE_DATA.find(function(a){return a.id===castInt($(f)[0].dataset.planeid)});if(n){var l=castInt($(f).find(".remodel_value").text());k.lockedPlane={id:n.id,remodel:l};Object.keys(e).forEach(function(a){var b=e[a].findIndex(function(a){return a.id===n.id&&a.remodel===l});-1<b&&e[a].splice(b,1)})}}else 0===g&&(k.isLock=!0);[1,2,3].includes(c.type)?10>g&&(k.num_=
g-100):k.num_=g-100;d.push(k)});n=n.concat(d)}});g=[2,6];f=0;n.sort(function(a,b){return b.num_-a.num_});h=$jscomp.makeIterator(n);for(a=h.next();!a.done;a=h.next())for(k=a.value,m=!1,l=$jscomp.makeIterator(g),a=l.next();!a.done;a=l.next()){a=a.value;if(k.isLock){k.lockedPlane&&(a=getShipPlaneObject(k.num,k.lockedPlane),k.plane=a,f+=a.ap);m=!0;break}var p=k.shipType;d&&[1,2,3].includes(p)&&1===k.slotNo&&(a=3);p={};var q=$jscomp.makeIterator(e["type"+a]);for(a=q.next();!a.done;p={$jscomp$loop$prop$plane$235$332:p.$jscomp$loop$prop$plane$235$332},
a=q.next())if(p.$jscomp$loop$prop$plane$235$332=a.value,!(0>=p.$jscomp$loop$prop$plane$235$332.stock)){checkInvalidPlane(k.shipId,PLANE_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$plane$235$332.id}}(p)))&&(a=getShipPlaneObject(k.num,p.$jscomp$loop$prop$plane$235$332),k.plane=a,f+=a.ap,p.$jscomp$loop$prop$plane$235$332.stock--,m=!0);break}if(m)break}n.sort(function(a,b){return a.num_===b.num_?b.slotNo-a.slotNo:a.num_-b.num_});g=f;h=[];d=[];k=[];for(l=0;l<n.length&&!(f>=
b);l++)if(!n[l].isLock){d=[];k=[];f=$jscomp.makeIterator(e.type1);for(a=f.next();!a.done;a=f.next())a=a.value,k.push({id:a.id,remodel:a.remodel,antiAir:a.antiAir,stock:a.stock});f=g;h.push(n[l]);for(m=h.length-1;0<=m;m--){p=h[m];q=!1;var u={},t=$jscomp.makeIterator(k);for(a=t.next();!a.done;u={$jscomp$loop$prop$plane$242$334:u.$jscomp$loop$prop$plane$242$334},a=t.next())if(u.$jscomp$loop$prop$plane$242$334=a.value,!(0>=u.$jscomp$loop$prop$plane$242$334.stock)){if(checkInvalidPlane(p.shipId,PLANE_DATA.find(function(a){return function(b){return b.id===
a.$jscomp$loop$prop$plane$242$334.id}}(u)))){a=getShipPlaneObject(p.num,u.$jscomp$loop$prop$plane$242$334);var w=p.plane.ap;if(w<a.ap){d.push(a);f+=a.ap-w;u.$jscomp$loop$prop$plane$242$334.stock--;q=!0;break}}if(q)break}q||d.push(p.plane)}}b=0;f=d.length;for(a=0;a<n.length;a++)if(!n[a].isLock){if(b>=f)break;n[a].plane=d[f-1-b++]}n.sort(function(a,b){return a.order-b.order});r=0;c.each(function(a,b){$(b).find(".ship_plane:not(.d-none)").each(function(b,c){var d=n.find(function(c){return c.slotId===
"ship"+a+"_slot"+b});d?(setPlaneDiv($(c),d.plane),r++):setPlaneDiv($(c))})})}
function autoLandBaseExpand(a){for(var b=castInt($("#dest_ap").val()),c=[{id:0,ap:0,remodel:0},{id:0,ap:0,remodel:0},{id:0,ap:0,remodel:0},{id:0,ap:0,remodel:0}],d=c.length,e=0,f=!1,g=[],h=$jscomp.makeIterator([101,2,3,6,9]),k=h.next();!k.done;k=h.next())if((k=a["type"+k.value])&&0!==k.length){for(var l=0;l<k.length&&!(g.push(k[l]),f=g.length===d);l++);if(f)break}for(h=0;h<g.length;h++)k=getLandBasePlaneObject(g[h]),c[c.length-1-h]=k,e+=k.ap;if(f&&e>=b){b=[];e=$jscomp.makeIterator(c);for(c=e.next();!c.done;c=
e.next())for(c=c.value,b.push({id:c.id,remodel:c.remodel}),d={},f=$jscomp.makeIterator(b),c=f.next();!c.done;d={$jscomp$loop$prop$plane$249$336:d.$jscomp$loop$prop$plane$249$336},c=f.next())d.$jscomp$loop$prop$plane$249$336=c.value,Object.keys(a).forEach(function(b){return function(c){var d=a[c].findIndex(function(a){return a.id===b.$jscomp$loop$prop$plane$249$336.id&&a.remodel===b.$jscomp$loop$prop$plane$249$336.remodel});-1<d&&a[c].splice(d,1)}}(d));return b}g=[];f=!1;if(h=a.type1)for(k=0;k<h.length&&
!(g.push(h[k]),f=g.length===d);k++);for(d=0;d<g.length&&!(f=c[d].ap,h=getLandBasePlaneObject(g[d]),f<h.ap&&(c[d]=h,e+=c[d].ap-f),e>=b);d++);b=[];e=$jscomp.makeIterator(c);for(c=e.next();!c.done;c=e.next())(c=c.value)&&b.push({id:c.id,remodel:c.remodel});e={};d=$jscomp.makeIterator(b);for(c=d.next();!c.done;e={$jscomp$loop$prop$plane$254$338:e.$jscomp$loop$prop$plane$254$338},c=d.next())e.$jscomp$loop$prop$plane$254$338=c.value,Object.keys(a).forEach(function(b){return function(c){var d=a[c].findIndex(function(a){return a.id===
b.$jscomp$loop$prop$plane$254$338.id&&a.remodel===b.$jscomp$loop$prop$plane$254$338.remodel});-1<d&&a[c].splice(d,1)}}(e));return b}
function getLandBasePlaneObject(a){var b={id:0,type:0,antiAir:0,antiBomber:0,interception:0,scout:0,ap:0,slot:18,remodel:0,level:0},c=PLANE_DATA.find(function(b){return b.id===a.id});b.id=a.id;b.type=a.type;RECONNAISSANCES.includes(b.type)&&4<b.slot&&(b.slot=4);b.antiAir=c.antiAir;b.antiBomber=c.antiBomber;b.interception=c.interception;b.scout=c.scout;b.remodel=a.remodel;b.level=setting.defaultProf.find(function(b){return b.id===Math.abs(a.type)}).prof;b.ap=getAirPower_lb(b);return b}
function getShipPlaneObject(a,b){var c=PLANE_DATA.find(function(a){return a.id===b.id}),d={id:0,type:0,antiAir:0,ap:0,bonusAp:0,remodel:0,level:0,slot:a,canBattle:!0};d.id=c.id;d.name=c.name;d.type=c.type;d.canBattle=!RECONNAISSANCES.includes(c.type);d.remodel=b.remodel;d.antiAir=getBonusAA(d,c.antiAir);d.level=setting.defaultProf.find(function(a){return a.id===Math.abs(c.type)}).prof;d.bonusAp=getBonusAp(d);d.ap=updateAp(d);return{id:d.id,ap:d.ap,remodel:d.remodel,name:d.name}}
function autoExpandDefense(){var a=$("#auto_land_base_1").prop("checked"),b=$("#auto_land_base_2").prop("checked"),c=$("#auto_land_base_3").prop("checked");$(".lb_plane").each(function(a,b){setLBPlaneDiv($(b))});var d=0;a&&d++;b&&d++;c&&d++;if(0<d){d=autoLandBaseExpandDef(d);if(a){var e=d[0].planes;$("#lb_item1").find(".lb_plane").each(function(a,b){setLBPlaneDiv($(b),e[a])});$("#lb_item1").find(".ohuda_select").val(0)}if(b){var f=d[a?1:0].planes;$("#lb_item2").find(".lb_plane").each(function(a,b){setLBPlaneDiv($(b),
f[a])});$("#lb_item2").find(".ohuda_select").val(0)}if(c){var g=d[a&&b?2:a||b?1:0].planes;$("#lb_item3").find(".lb_plane").each(function(a,b){setLBPlaneDiv($(b),g[a])});$("#lb_item3").find(".ohuda_select").val(0)}}}
function autoLandBaseExpandDef(a){var b=castInt($("#dest_ap").val()),c=loadPlaneStock(),d=$("#mode_3").prop("checked"),e=[],f=[],g=4*a,h={};c=$jscomp.makeIterator(c);for(var k=c.next();!k.done;h={$jscomp$loop$prop$stock$340:h.$jscomp$loop$prop$stock$340},k=c.next()){h.$jscomp$loop$prop$stock$340=k.value;if(25===h.$jscomp$loop$prop$stock$340.id||19===h.$jscomp$loop$prop$stock$340.id)h.$jscomp$loop$prop$stock$340.num=[g,0,0,0,0,0,0,0,0,0,0];if(!(0>=getArraySum(h.$jscomp$loop$prop$stock$340.num)))if(k=
PLANE_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$stock$340.id}}(h)),RECONNAISSANCES.includes(k.type))for(var l=10;0<=l;l--){if(!(1>h.$jscomp$loop$prop$stock$340.num[l])){var m={id:k.id,antiAir:k.antiAir,type:k.type,adjust:1,scout:k.scout,remodel:l};m.adjust=getReconnaissancesAdjust(m,!0);for(var n=0;n<h.$jscomp$loop$prop$stock$340.num[l];n++)f.push(m)}}else for(l=10;0<=l;l--)if(!(1>h.$jscomp$loop$prop$stock$340.num[l])&&(m={id:k.id,type:k.type,remodel:l,antiAir:k.antiAir+
k.interception+2*k.antiBomber,interception:k.interception,antiBomber:k.antiBomber,isRocket:0},m.antiAir=getBonusAA(m,m.antiAir),0!==m.antiAir))for(n=0;n<h.$jscomp$loop$prop$stock$340.num[l];n++)e.push(Object.assign({},m))}if(d){e.sort(function(a,b){return b.antiAir-a.antiAir});for(g=0;3>g;g++)h=e.findIndex(function(a){return 0===a.isRocket&&ROCKETS.includes(a.id)}),-1<h&&(e[h].isRocket=1);e.sort(function(a,b){return b.isRocket-a.isRocket})}else e.sort(function(a,b){return a.antiAir===b.antiAir?b.radius-
a.radius:b.antiAir-a.antiAir});f.sort(function(a,b){return b.adjust===a.adjust?b.scout-a.scout:b.adjust-a.adjust});e=e.filter(function(b,c){return c<4*a});g=[];for(h=0;h<a;h++){c={ap:0,planes:[]};for(k=0;4>k;k++)c.planes.push({id:0});g.push(c)}for(k=c=h=0;k<a;k++){l={ap:0,planes:[]};m={ap:0,planes:[]};for(n=0;4>n;n++){var r=e[n],p=getLandBasePlaneObject(r);l.planes.push(p);l.ap+=p.ap;m.planes.push(p);m.ap+=p.ap;h+=p.ap;if(d){if(ROCKETS.includes(r.id)&&c++,Math.floor((0===c?.5:1===c?.8:2===c?1.1:1.2)*
h)>=b)break}else if(h>=b)break}f.length>k&&!(3>m.planes.length&&h>=b)&&(n=getLandBasePlaneObject(f[k]),r=Math.min(m.planes.length,3),(p=m.planes[r])||(p={id:0,ap:0}),p=p.ap,m.planes[r]=n,m.ap+=n.ap-p,updateLBAirPower(m));if(m.ap>=l.ap||m.ap>=b)n=l.ap,l=m,h+=m.ap-n;m=l.planes.length;if(4!==m)for(n=0;n<4-m;n++)l.planes.push({id:0,ap:0});g[k]=l;m={};l=$jscomp.makeIterator(l.planes);for(n=l.next();!n.done;m={$jscomp$loop$prop$isFirst$342:m.$jscomp$loop$prop$isFirst$342,$jscomp$loop$prop$plane$270$343:m.$jscomp$loop$prop$plane$270$343},
n=l.next())m.$jscomp$loop$prop$plane$270$343=n.value,m.$jscomp$loop$prop$isFirst$342=!0,e=e.filter(function(a){return function(b){return a.$jscomp$loop$prop$isFirst$342&&b.id===a.$jscomp$loop$prop$plane$270$343.id?a.$jscomp$loop$prop$isFirst$342=!1:!0}}(m));if(d){if(Math.floor((0===c?.5:1===c?.8:2===c?1.1:1.2)*h)>=b)break}else if(h>=b)break}return g}
function modal_Closed(a){switch(a.attr("id")){case "modal_plane_select":case "modal_ship_select":case "modal_enemy_select":case "modal_enemy_pattern":case "modal_collectively_setting":$target=null;calculate();break;case "modal_plane_preset":planePreset=$target=null;calculate();break;case "modal_main_preset":calculate();break;case "modal_result_detail":setTimeout(function(){chartDataSet.destroy();chartDataSet=null},80)}}
function sidebar_Clicked(a){a=a.attr("href");var b=$("#"===a||""===a?"html":a);"#first_time_content"===a?first_time_Clicked():"#site_manual_content"===a?site_manual_Clicked():"#site_abstract_content"===a||"#site_FAQ_content"===a||"#site_history_content"===a?scrollContent($(a)):$("body,html").animate({scrollTop:b.offset().top-60},300,"swing");return!1}
function btn_content_trade_Clicked(a){$("body,html").animate({scrollTop:0},200,"swing");$(".btn_commit_trade").addClass("d-table").removeClass("d-none");$(".round_button:not(.btn_commit_trade)").addClass("d-none").removeClass("d-table");$("#main_contents").find(".collapse_content").each(function(){$(this).parent().addClass("trade_enabled");$(this).attr("class").includes("show")&&$(this).addClass("tmpHide").collapse("hide")});a.blur()}
function main_contents_Sortable_End(){var a=[],b=$("#side_index");b.find("li").each(function(b,d){a.push($(d).clone())});b.empty();setting.contentsOrder=[];$("#main_contents > div").each(function(c,d){var e=$(d).attr("id");setting.contentsOrder.push(e);for(var f=$jscomp.makeIterator(a),g=f.next();!g.done;g=f.next())if(g=g.value,g.attr("id")==="li_"+e){b.append(g);break}});saveLocalStorage("setting",setting)}
function commit_content_order(){if($("#landBase_content").hasClass("collapsing"))return!1;$(".tmpHide").collapse("show");$(".trade_enabled").removeClass("trade_enabled");$(".btn_commit_trade").removeClass("d-table").addClass("d-none");$(".round_button:not(.btn_commit_trade)").removeClass("d-none").addClass("d-table")}
function btn_ex_setting_Clicked(a){a=a.closest(".contents").attr("id");var b=$("#modal_collectively_setting");b.find(".btn").removeClass("d-none");b.data("target",a);switch(a){case "landBase":b.find(".modal-title").text("\u4e00\u62ec\u8a2d\u5b9a\u3000-\u57fa\u5730\u822a\u7a7a\u968a-");b.find(".btn_remove_ship_all").addClass("d-none");b.find(".btn_remove_enemy_all").addClass("d-none");b.find(".btn_slot_default").addClass("d-none");b.find(".coll_slot_range").attr("max",18).data("target",a);break;case "friendFleet":b.find(".modal-title").text("\u4e00\u62ec\u8a2d\u5b9a\u3000-\u8266\u5a18-"),
b.find(".btn_remove_enemy_all").addClass("d-none"),b.find(".coll_slot_range").attr("max",99).data("target",a)}b.modal("show")}function btn_air_raid_Clicked(){$(".lb_tab").each(function(a,b){var c=!1;$(b).find(".lb_plane").each(function(a,b){var d=setting.airRaidMax?4:Math.ceil(4*Math.random()),e=castInt($(b).find(".slot").text());!c&&1<e&&($(b).find(".slot").text(1>e-d?1:e-d),c=!0)})});calculate()}
function btn_supply_Clicked(){$(".lb_tab").each(function(a,b){$(b).find(".lb_plane").each(function(a,b){$(b).find(".slot").text(18)})});calculate()}
function btn_capture_Clicked(a){var b=a.closest(".contents");b.width(1E3);b.find(".lb_tab").removeClass("tab-pane fade");var c=b.find(".no_capture:not(.d-none)");c.addClass("d-none");b.find(".round_button").addClass("d-none").removeClass("d-table");b.find(".custom-checkbox").addClass("d-none");b.find(".custom-select").addClass("pt-0");b.find(".custom-select option").addClass("d-none");b.find(".form-control").addClass("pt-0");b.find(".general_box").addClass("general_box_capture");var d=window.pageYOffset;
html2canvas(b[0],{onrendered:function(a){var e=a.toDataURL();if($("#clipboard_mode").prop("checked")&&"function"===typeof ClipboardItem)try{a.toBlob(function(a){var b={};navigator.clipboard.write([new ClipboardItem((b[a.type]=a,b))])})}catch(g){downloadImage(e)}else downloadImage(e);b.find(".custom-checkbox").removeClass("d-none");b.find(".round_button:not(.btn_commit_trade)").removeClass("d-none").addClass("d-table");c.removeClass("d-none");b.find(".custom-select").removeClass("pt-0");b.find(".custom-select option").removeClass("d-none");
b.find(".form-control").removeClass("pt-0");b.find(".general_box").removeClass("general_box_capture");b.width("");"none"===$("#lb_tab_select").css("display")||$("#lb_item1").attr("class").includes("tab-pane")||($(".lb_tab").addClass("tab-pane fade"),$(".lb_tab:first").tab("show"));window.scrollTo(0,d)}})}
function downloadImage(a){var b=new Date,c=("0"+(b.getMonth()+1)).slice(-2),d=("0"+b.getDate()).slice(-2),e=("0"+b.getHours()).slice(-2),f=("0"+b.getMinutes()).slice(-2),g=("0"+b.getSeconds()).slice(-2);b="screenshot_"+b.getFullYear()+c+d+e+f+g+".jpg";if(window.navigator.msSaveBlob){a=atob(a.replace(/^.*,/,""));c=new Uint8Array(a.length);for(d=0;d<a.length;d++)c[d]=a.charCodeAt(d);a=new Blob([c],["image/png"]);window.navigator.msSaveOrOpenBlob(a,b)}else c=document.getElementById("getImage"),c.href=
a,c.download=b,c.click()}function btn_reset_content_Clicked(a){switch(a.closest(".contents").attr("id")){case "landBase":$(".lb_plane").each(function(a,c){return setLBPlaneDiv($(c))});isDefMode=!1;break;case "friendFleet":clearShipDivAll();break;case "enemyFleet":clearEnemyDivAll()}calculate()}function btn_remove_plane_all_Clicked(a){a=$("#"+$("#modal_collectively_setting").data("target"));clearPlaneDivAll(a)}
function btn_remove_ship_all_Clicked(){clearShipDivAll();$("#modal_collectively_setting").modal("hide")}function btn_slot_max_Clicked(a){a=$("#"+$("#modal_collectively_setting").data("target"));"landBase"===a.attr("id")?$(".coll_slot_range").val(18):"friendFleet"===a.attr("id")&&$(".coll_slot_range").val(99);coll_slot_range_Changed($(".coll_slot_range"))}
function btn_slot_default_Clicked(a){a=$("#"+$("#modal_collectively_setting").data("target"));"friendFleet"===a.attr("id")&&a.find(".ship_plane").each(function(a,c){$(c).find(".slot").text($(c).find(".slot_ini").data("ini"))})}function btn_slot_min_Clicked(){$(".coll_slot_range").val(0);coll_slot_range_Changed($(".coll_slot_range"))}
function coll_slot_range_Changed(a){var b=$("#"+$("#modal_collectively_setting").data("target")),c=castInt(a.val());c=c>castInt(a.attr("max"))?castInt(a.attr("max")):c;"landBase"===b.attr("id")?b.find(".lb_plane").each(function(a,b){return $(b).find(".slot").text(c)}):"friendFleet"===b.attr("id")&&b.find(".ship_plane").each(function(a,b){return $(b).find(".slot").text(c)});$(".coll_slot_input").val(c)}
function coll_slot_input_Changed(a){var b=validateInputNumber(a.val(),castInt($(".coll_slot_range").attr("max")));a.val(b);$(".coll_slot_range").val(b);coll_slot_range_Changed($(".coll_slot_range"))}
function btn_remodel_Clicked(a){var b=$("#"+$("#modal_collectively_setting").data("target")),c=castInt(a[0].dataset.remodel);"landBase"===b.attr("id")?b.find(".lb_plane").each(function(a,b){return $(b).find(".remodel_select:not(.remodel_disabled)").find(".remodel_value").text(c)}):"friendFleet"===b.attr("id")&&b.find(".ship_plane").each(function(a,b){return $(b).find(".remodel_select:not(.remodel_disabled)").find(".remodel_value").text(c)})}
function btn_fighter_prof_max_Clicked(){var a=$("#"+$("#modal_collectively_setting").data("target"));"landBase"===a.attr("id")?a.find(".lb_plane").each(function(a,c){FIGHTERS.includes(Math.abs(castInt($(c)[0].dataset.type)))&&proficiency_Changed($(c).find('.prof_option[data-prof="7"]').parent(),!0)}):"friendFleet"===a.attr("id")&&a.find(".ship_plane").each(function(a,c){FIGHTERS.includes(Math.abs(castInt($(c)[0].dataset.type)))&&proficiency_Changed($(c).find('.prof_option[data-prof="7"]').parent(),
!0)})}function btn_prof_Clicked(a){var b=$("#"+$("#modal_collectively_setting").data("target")),c=a[0].dataset.prof;"landBase"===b.attr("id")?b.find(".lb_plane").each(function(a,b){proficiency_Changed($(b).find('.prof_option[data-prof="'+c+'"]').parent(),!0)}):"friendFleet"===b.attr("id")&&b.find(".ship_plane").each(function(a,b){proficiency_Changed($(b).find('.prof_option[data-prof="'+c+'"]').parent(),!0)})}
function ohuda_Changed(a,b){b=void 0===b?!1:b;var c=castInt(a.val(),-1);if(0===c)isDefMode=!0,$(".ohuda_select").each(function(a,b){0<castInt($(b).val())&&$(b).val(-1)});else if(-1===c){var d=!1;$(".ohuda_select").each(function(a,b){0===castInt($(b).val())&&(d=!0)});isDefMode=d}else isDefMode=!1,$(".ohuda_select").each(function(a,b){0===castInt($(b).val())&&$(b).val(-1)});b||calculate()}
function plane_lock_Clicked(a){a.addClass("d-none");a.closest(".ship_plane").find(".plane_unlock").removeClass("d-none")}function plane_unlock_Clicked(a){a.addClass("d-none");a.closest(".ship_plane").find(".plane_lock").removeClass("d-none")}function remodelSelect_Changed(a){var b=Math.min(castInt(a.find(".remodel_item_selected").data("remodel")),10);a.removeClass("remodel_item_selected");a.find(".remodel_value").text(b);calculate()}
function proficiency_Changed(a,b){b=void 0===b?!1:b;var c=a.find(".prof_option"),d=a.parent().prev(),e=c[0].dataset.prof;d.attr("src",c.attr("src")).attr("alt",c.attr("alt")).removeClass("prof_yellow prof_blue prof_none");d[0].dataset.prof=e;3<e?d.addClass("prof_yellow"):0<e?d.addClass("prof_blue"):d.addClass("prof_none");b||calculate()}
function init_proficiency_Changed(a){proficiency_Changed(a,!0);var b=castInt(a.find(".prof_option")[0].dataset.prof);setting.defaultProf.find(function(b){return b.id===castInt(a.closest(".init_prof")[0].dataset.typeid)}).prof=b;saveLocalStorage("setting",setting)}
function backup_enabled_Clicked(){setting.backUpEnabled=document.getElementById("backup_enabled").checked;setting.backUpCount=castInt(document.getElementById("backup_count").value);document.getElementById("backup_count").disabled=!setting.backUpEnabled;saveLocalStorage("setting",setting)}function slot_select_parent_Show(a){var b=castInt(a.find(".slot").text());a.find(".slot_input").val(b);a.find(".slot_range").val(b)}
function slot_range_Changed(a){var b=a.closest(".slot_select_parent");b.find(".slot").text(a.val());b.find(".slot_input").val(a.val())}function slot_input_Changed(a){var b=validateInputNumber(a.val(),castInt(a.attr("max")));a.val(b);a.closest(".slot_select_parent").find(".slot").text(b);a.next().val(b)}function slot_ini_Clicked(a){var b=a.closest(".slot_select_parent");a=a.data("ini");b.find(".slot").text(a);b.find(".slot_input").val(a);b.find(".slot_range").val(a)}
function slot_select_parent_Close(a){var b=castInt(a.find(".slot_input").val()),c=castInt(a.find(".slot_input").attr("max"));a.find(".slot").text(b>c?c:b);calculate()}function btn_reset_landBase_Clicked(a){a.closest(".lb_tab").find(".lb_plane").each(function(a,c){$(c).find(".slot").text(0);setLBPlaneDiv($(c))});a.blur();calculate()}function lb_plane_DragEnd(a){a=a.closest(".lb_plane");isOut&&(clearPlaneDiv(a),a.css("opacity","0.0"),isOut=!1);a.animate({opacity:"1.0"},500);calculate()}
function lb_plane_Drop(a,b){var c=b.draggable,d={id:castInt(c[0].dataset.planeid),remodel:castInt(c.find(".remodel_value")[0].textContent),prof:castInt(c.find(".prof_select")[0].dataset.prof),slot:castInt(c.find(".slot").text())},e={id:castInt(a[0].dataset.planeid),remodel:castInt(a.find(".remodel_value")[0].textContent),prof:castInt(a.find(".prof_select")[0].dataset.prof),slot:castInt(a.find(".slot").text())};setLBPlaneDiv(a,d);isCtrlPress||$("#drag_drop_copy").prop("checked")||setLBPlaneDiv(c,e)}
function btn_reset_ship_plane_Clicked(a){a.closest(".ship_tab").find(".ship_plane").each(function(a,c){clearPlaneDiv($(c))});calculate()}
function ship_plane_DragStart(a){$(a.helper).addClass("ship_plane "+getPlaneCss(castInt($(a.helper).find(".plane_img").attr("alt")))).css("width",320);$(a.helper).find(".slot_select_parent").remove();$(a.helper).find(".btn_remove_plane").remove();$(a.helper).find(".plane_lock").remove();$(a.helper).find(".plane_unlock").remove();$(a.helper).find(".prof_select_parent").addClass("mr-2")}
function ship_plane_DragEnd(a){a=a.closest(".ship_plane");isOut&&(clearPlaneDiv(a),a.css("opacity","0.0"),isOut=!1);a.animate({opacity:"1.0"},500);calculate()}
function ship_plane_DragOver(a,b){var c=b.draggable.closest(".ship_plane"),d=castInt(a.closest(".ship_tab")[0].dataset.shipid),e=castInt(c[0].dataset.planeid);c=castInt(c[0].dataset.type);checkInvalidPlane(d,getPlanes(c).find(function(a){return a.id===e}))?(b.helper.stop().animate({opacity:"1.0"},100),isOut=!1):(b.helper.stop().animate({opacity:"0.2"},100),a.removeClass("plane_draggable_hover"),isOut=!0)}
function ship_plane_Drop(a,b){if(b.draggable.closest(".ship_plane")[0].dataset.planeid){var c=b.draggable.closest(".ship_plane"),d={id:castInt(c[0].dataset.planeid),remodel:castInt(c.find(".remodel_value")[0].textContent),prof:castInt(c.find(".prof_select")[0].dataset.prof)},e={id:castInt(a[0].dataset.planeid),remodel:castInt(a.find(".remodel_value")[0].textContent),prof:castInt(a.find(".prof_select")[0].dataset.prof)},f=castInt(a.closest(".ship_tab")[0].dataset.shipid);checkInvalidPlane(f,PLANE_DATA.find(function(a){return a.id===
d.id}))&&(setPlaneDiv(a,d),isCtrlPress||$("#drag_drop_copy").prop("checked")||setPlaneDiv(c,e))}}
function cell_type_Changed(a){var b=a.closest(".battle_content"),c=castInt(a.val());b.find(".enemy_content").each(function(a,b){c!==CELL_TYPE.grand&&5<a?$(b).addClass("d-none").removeClass("d-flex"):$(b).removeClass("d-none").addClass("d-flex")});a=b.find(".enemy_content:last");if(a.hasClass("ui-draggable")){var d=castInt(a[0].dataset.enemyid),e=castInt(a.text());setEnemyDiv(a,d,e)}b=b.find(".formation");changeFormationSelectOption(b,c);calculate()}
function changeFormationSelectOption(a,b){var c=castInt(a.val());a.find("option").each(function(d,e){b!==CELL_TYPE.grand&&(10>$(e).val()&&$(e).removeClass("d-none"),10<$(e).val()&&$(e).addClass("d-none"),10<c&&a.val(c-10));b===CELL_TYPE.grand&&(10>$(e).val()&&$(e).addClass("d-none"),10<$(e).val()&&$(e).removeClass("d-none"),1===c||2===c||3===c?a.val(c+10):4===c&&a.val(14))})}
function enemy_ap_select_parent_Show(a){var b=castInt(a.closest(".enemy_content")[0].dataset.enemyid);a.find(".dropdown-header").text(-1!==b?"\u6575\u8266\u306b\u300c\u76f4\u63a5\u5165\u529b\u300d\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u7de8\u96c6\u3067\u304d\u307e\u3059\u3002":"\u5236\u7a7a\u5024\u3092\u5165\u529b");a.find(".enemy_ap_input").prop("disabled",-1!==b)}
function enemy_ap_input_Changed(a){var b=validateInputNumber(a.val(),castInt(a.attr("max")));a.val(b);a.closest(".enemy_ap_select_parent").find(".enemy_ap").text(b)}function enemy_ap_select_parent_Close(a){a.find(".enemy_ap").text(a.find(".enemy_ap_input").val());calculate()}
function plane_type_select_Changed(){var a=$("#plane_type_select"),b=castInt(a.val()),c=getPlanes(b),d=$("#plane_word").val().trim(),e=[];a.find("option").each(function(){e.push(castInt($(this).val()))});if($target&&$target.attr("class").includes("ship_plane")&&$target.closest(".ship_tab")[0].dataset.shipid){var f=SHIP_DATA.find(function(a){return a.id===castInt($target.closest(".ship_tab")[0].dataset.shipid)}),g=LINK_SHIP_EQUIPMENT.find(function(a){return a.type===f.type}),h=SPECIAL_LINK_SHIP_EQUIPMENT.find(function(a){return a.shipId===
f.id});e=g.e_type.concat();h&&(e=e.concat(h.equipmentTypes));e&&e.includes(b)||(b=0,c=getPlanes(b));c=c.filter(function(a){return 151!==a.id});h&&0<h.equipmentTypes.length&&(e=e.concat(h.equipmentTypes));e=e.filter(function(a,b,c){return c.indexOf(a)===b});e.sort(function(a,b){return a-b});c=c.filter(function(a){return e.includes(Math.abs(a.type))});if(h&&0<h.equipmentIds.length){g={};h=$jscomp.makeIterator(h.equipmentIds);for(var k=h.next();!k.done;g={$jscomp$loop$prop$id$346:g.$jscomp$loop$prop$id$346},
k=h.next())g.$jscomp$loop$prop$id$346=k.value,k=PLANE_DATA.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$id$346}}(g)),e.push(k.type),c.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$id$346}}(g))||0!==b&&b!==k.type||c.push(k)}setPlaneType(a,e);a.val(b)}else c=c.filter(function(a){return e.includes(Math.abs(a.type))});d&&(d=replaceKnji(d),c=c.filter(function(a){return a.name.includes(d)||a.abbr.includes(d)}));var l=$("#plane_sort_select").val();a=$("#plane_asc").prop("checked");
$("#plane_asc").prop("disabled",!1);$("#plane_desc").prop("disabled",!1);switch(l){case "battle_anti_air":a?c.sort(function(a,b){return a.antiAir+1.5*a.interception-(b.antiAir+1.5*b.interception)}):c.sort(function(a,b){return b.antiAir+1.5*b.interception-(a.antiAir+1.5*a.interception)});break;case "defense_anti_air":a?c.sort(function(a,b){return a.antiAir+a.interception+2*a.antiBomber-(b.antiAir+b.interception+2*b.antiBomber)}):c.sort(function(a,b){return b.antiAir+b.interception+2*b.antiBomber-(a.antiAir+
a.interception+2*a.antiBomber)});break;case "land_base_power":a?c.sort(function(a,b){return getLandBasePower(a.id,18,0)-getLandBasePower(b.id,18,0)}):c.sort(function(a,b){return getLandBasePower(b.id,18,0)-getLandBasePower(a.id,18,0)});break;case "radius":a?c.sort(function(a,b){return a.radius-b.radius}):c.sort(function(a,b){return b.radius-a.radius});break;case "history":if(setting.selectedHistory[0]){var m=setting.selectedHistory[0];c.sort(function(a,b){return m.filter(function(a){return a===b.id}).length-
m.filter(function(b){return b===a.id}).length})}case "default":$("#plane_asc").prop("disabled",!0);$("#plane_desc").prop("disabled",!0);break;default:a?c.sort(function(a,b){return a[l]-b[l]}):c.sort(function(a,b){return b[l]-a[l]})}createPlaneTable(c)}function plane_word_TextChanged(){!1!==timer&&clearTimeout(timer);timer=setTimeout(function(){plane_type_select_Changed()},250)}
function disp_in_stock_Checked_Chenged(){setting.inStockOnly=$("#disp_in_stock").prop("checked");saveLocalStorage("setting",setting);plane_type_select_Changed()}function disp_equipped_Checked_Chenged(){setting.visibleEquipped=$("#disp_equipped").prop("checked");saveLocalStorage("setting",setting);plane_type_select_Changed()}
function btn_remove_lb_plane_Clicked(a){a=a.closest(".lb_plane");clearPlaneDiv(a);a.find(".slot").text(0);a.find(".slot_input").attr("max",0);a.find(".slot_range").attr("max",0);calculate()}function toggle_display_type_Clicked(a){var b=a.closest(".modal");b.find(".toggle_display_type").removeClass("selected");a.addClass("selected");setting.displayMode[b.attr("id")]=a.data("mode");saveLocalStorage("setting",setting);b.find("select").change()}
function sort_Changed(a){a=a.closest(".modal");var b=a.find(".sort_select").val(),c=a.find(".order_asc").prop("checked");setting.orderBy[a.attr("id")]=[b,c?"asc":"desc"];saveLocalStorage("setting",setting);a.find("select:first").change()}
function plane_name_Clicked(a){$target=a.closest(".lb_plane");$target.attr("class")||($target=a.closest(".ship_plane"));a=castInt($target[0].dataset.planeid);castInt($target[0].dataset.type);var b=$("#modal_plane_select").find(".modal-body"),c=$("#plane_type_select").val();$target.attr("class").includes("ship_plane")?(b.find("#optg_lb").remove(),100<c&&(c=0)):setPlaneType($("#plane_type_select"),PLANE_TYPE.filter(function(a){return 0<a.id}).map(function(a){return a.id}));$("#plane_type_select").val(c).change();
$("#modal_plane_select").find(".btn_remove").prop("disabled",0===a);$("#modal_plane_select").modal("show")}function modal_plane_Selected(a){a={id:castInt(a[0].dataset.planeid),remodel:castInt(a[0].dataset.remodel)};$target.attr("class").includes("lb_plane")?(setLBPlaneDiv($target,a),$target.closest(".lb_tab").find(".ohuda_select").val(isDefMode?0:2)):$target.attr("class").includes("ship_plane")&&setPlaneDiv($target,a);a.id&&updatePlaneSelectedHistory(a.id);$("#modal_plane_select").modal("hide")}
function modal_plane_select_btn_remove_Clicked(a){if(a.prop("disabled"))return!1;clearPlaneDiv($target);$("#modal_plane_select").modal("hide")}function btn_plane_preset_Clicked(a){var b=-1;$target=a.closest(".lb_tab");$target.attr("class")||($target=a.closest(".ship_tab"),b=castInt($target[0].dataset.shipid));$("#modal_plane_preset").data("parentid",b);loadPlanePreset();$("#modal_plane_preset").modal("show");a.blur()}
function plane_preset_tr_Clicked(a){var b=planePreset.find(function(b){return b.id===castInt(a.data("presetid"))});$(".preset_tr").removeClass("preset_selected");a.addClass("preset_selected");drawPlanePresetPreview(b)}
function preset_name_Changed(a){var b=a.val().trim(),c=a.closest(".modal-body").find(".btn_commit_preset"),d=a.closest(".modal-body").find(".btn_commit_preset_header");40<b.length?(a.addClass("is-invalid"),c.prop("disabled",!0),d.prop("disabled",!0)):0===b.length?(a.addClass("is-invalid"),c.prop("disabled",!0),d.prop("disabled",!0)):(a.removeClass("is-invalid"),a.addClass("is-valid"),c.prop("disabled",!1),d.prop("disabled",!1));$("#modal_main_preset").find(".btn_commit_preset_header").tooltip("hide")}
function btn_commit_plane_preset_Clicked(a){a.prop("disabled",!0);updatePlanePreset();loadPlanePreset()}function btn_delete_plane_preset_Clicked(a){a.prop("disabled",!0);deletePlanePreset();loadPlanePreset()}
function btn_expand_plane_preset_Clicked(){var a=castInt($(".preset_selected").data("presetid")),b=planePreset.find(function(b){return b.id===a});b&&($target.attr("class").includes("lb_tab")?($target.find(".lb_plane").each(function(a,d){var c={};c.id=b.planes[a];setLBPlaneDiv($(d),c)}),$target.find(".ohuda_select").val(isDefMode?0:2)):$target.find(".ship_plane").each(function(a,d){var c={};c.id=b.planes[a];setPlaneDiv($(d),c)}));$("#modal_plane_preset").modal("hide")}
function display_ship_count_Changed(a,b){b=void 0===b?!1:b;var c=a.val();a.closest(".friendFleet_tab").find(".ship_tab").each(function(a,b){a<c?$(b).removeClass("d-none"):$(b).addClass("d-none")});b||calculate()}function btn_remove_ship_plane_Clicked(a){clearPlaneDiv(a.closest(".ship_plane"));calculate()}function fleet_select_tab_Clicked(){$("#union_fleet").prop("checked")||calculate()}
function ship_disabled_Changed(a){a.prop("checked")?a.closest(".ship_tab").addClass("opacity4"):a.closest(".ship_tab").removeClass("opacity4");calculate()}function ship_name_span_Clicked(a){$target=a.closest(".ship_tab");castInt($target[0].dataset.shipid)?$("#modal_ship_select").find(".btn_remove").prop("disabled",!1):$("#modal_ship_select").find(".btn_remove").prop("disabled",!0);$("#ship_type_select").change();$("#modal_ship_select").modal("show")}
function btn_remove_ship_Clicked(a){clearShipDiv(a.closest(".ship_tab"));calculate()}function ship_word_TextChanged(){!1!==timer&&clearTimeout(timer);timer=setTimeout(function(){createShipTable([castInt($("#ship_type_select").val())])},250)}function modal_ship_Selected(a){a=castFloat(a[0].dataset.shipid);setShipDiv($target,a);updateShipSelectedHistory(a);$("#modal_ship_select").modal("hide")}
function modal_ship_select_btn_remove_Clicked(a){if(a.prop("disabled"))return!1;clearShipDiv($target);$("#modal_ship_select").modal("hide")}function battle_count_Changed(a){createEnemyInput(castInt(a.val()));calculate()}function btn_reset_battle_Clicked(a){var b=isDefMode?$("#air_raid_enemies"):a.closest(".battle_content");b[0].dataset.celldata="";b.find(".enemy_content:not(:first)").remove();clearEnemyDiv(b.find(".enemy_content"));a.blur();calculate()}
function enemy_word_TextChanged(){!1!==timer&&clearTimeout(timer);timer=setTimeout(function(){createEnemyTable([castInt($("#enemy_type_select").val())])},250)}function enemy_name_Clicked(a){$target=a.closest(".enemy_content");a=castInt($target[0].dataset.enemyid);$("#enemy_type_select").change();0!==a?$("#modal_enemy_select").find(".btn_remove").prop("disabled",!1):$("#modal_enemy_select").find(".btn_remove").prop("disabled",!0);$("#modal_enemy_select").modal("show")}
function modal_enemy_Selected(a){setEnemyDiv($target,castInt(a[0].dataset.enemyid));$("#modal_enemy_select").modal("hide")}function modal_enemy_select_btn_remove(a){if(a.prop("disabled"))return!1;clearEnemyDiv($target);$("#modal_enemy_select").modal("hide")}
function btn_world_expand_Clicked(){$target=$(".battle_content:first");$("#expand_target").text(1);$("#btn_expand_enemies").addClass("d-none");$("#btn_continue_expand").prop("disabled",!0);$("#btn_continue_expand").removeClass("d-none");$("#expand_target_parent").removeClass("d-none");$("#enemy_pattern_tbody").html("");$("#modal_enemy_pattern").modal("show")}
function btn_enemy_preset_Clicked(a){$target=a.closest(".battle_content");isDefMode&&($target=$("#air_raid_enemies"));$("#btn_expand_enemies").removeClass("d-none");$("#btn_expand_enemies").prop("disabled",!0);$("#btn_continue_expand").addClass("d-none");$("#expand_target_parent").addClass("d-none");$("#modal_enemy_pattern").modal("show")}
function btn_stage2_Clicked(a){var b=a.closest(".battle_content");a=castInt(b.find(".battle_no").text())-1;b=castInt(b.find(".formation").val());$("#modal_stage2_detail").data("battleno",a);$("#modal_stage2_detail").data("formationid",b);calculateStage2Detail();$("#modal_stage2_detail").modal("show")}function stage2_slot_input_Changed(){var a=$("#stage2_detail_slot"),b=validateInputNumber(a.val(),castInt(a.attr("max")));a.val(b);calculateStage2Detail()}
function calculateStage2Detail(){var a=castInt($("#modal_stage2_detail").data("battleno")),b=castInt($("#modal_stage2_detail").data("formationid")),c=[];updateEnemyFleetInfo(c,!1);a=c[a];var d=castInt($("#stage2_detail_slot").val()),e=castInt($("#stage2_detail_avoid").val()),f=0;c="";for(var g=!1,h=[166,167,409,410,411,412,413,414],k=0;k<a.enemies.length;k++){var l=a.enemies[k],m=Math.floor(d*a.stage2[e][0][k]),n=a.stage2[e][1][k],r=m+n;h.includes(l.id)&&(g=!0);f+=l.aabo;c+='\n    <tr class="'+(r>=
d?"stage2_table_death":r>=d/2?"stage2_table_half":"")+'">\n      <td class="font_size_12 text-left td_enm_name" data-toggle="tooltip" data-html="true"\n        data-title="<div><div>\u52a0\u91cd\u5bfe\u7a7a\u5024\uff1a'+l.aaw+"</div><div>\u9632\u7a7a\u30dc\u30fc\u30ca\u30b9\uff1a"+l.aabo+'</div></div>">\n        <span class="ml-2">\n          '+drawEnemyGradeColor(l.name)+'\n        </span>\n      </td>\n      <td>\n        <span class="text-right">\n          '+(100*a.stage2[e][0][k]).toFixed(1)+
"% ("+m+"\u6a5f)</span>\n      </td>\n      <td>"+n+"\u6a5f</td>\n      <td>"+r+"\u6a5f</td>\n    </tr>\n    "}d=FORMATION.find(function(a){return a.id===b});f=2*Math.floor((d?d.correction:1)*f);a.cellType<=CELL_TYPE.grand?$("#is_air_raid").addClass("d-none"):$("#is_air_raid").removeClass("d-none");a.cellType<=CELL_TYPE.grand&&g?$("#stage2_warning").removeClass("d-none"):$("#stage2_warning").addClass("d-none");$("#stage2_table tbody").html(c);$(".td_enm_name").tooltip();$("#stage2_detail_formation").text(d.name);
$("#sumfleetAntiAir").text(f)}function node_tr_Clicked(a){$(".node_tr").removeClass("node_selected");a.addClass("node_selected");createEnemyPattern()}function pattern_Changed(a){a=castInt(a.data("disp"),-1);0>a||createEnemyPattern(a)}
function enemy_display_mode_Changed(a){setting.enemyDisplayImage=a.attr("id").includes("enemy_display_image");saveLocalStorage("setting",setting);a=castInt($("#enemy_pattern_select").find(".nav-link.active").data("disp"));0<a?createEnemyPattern(a):createEnemyPattern()}function node_Clicked(a){$(".node_tr").removeClass("node_selected");$('.node_tr[data-node="'+a.attr("title")+'"').addClass("node_selected");createEnemyPattern()}
function node_DoubleClicked(){$(".node_tr").hasClass("node_selected")&&($("#btn_expand_enemies").hasClass("d-none")?(btn_continue_expand_Clicked(),$(".node_tr").removeClass("node_selected")):btn_expand_enemies())}function btn_expand_enemies(){expandEnemy();$("#modal_enemy_pattern").modal("hide")}
function btn_continue_expand_Clicked(){var a=castInt($("#expand_target").text());1===a&&clearEnemyDivAll();createEnemyInput(a);$("#expand_target").text(a+1);$target=$(document.getElementsByClassName("battle_content")[a-1]);expandEnemy();$("#enemy_pattern_tbody").html("<div>"+a+" \u6226\u76ee\u306e\u6575\u8266\u968a\u304c\u633f\u5165\u3055\u308c\u307e\u3057\u305f\u3002</div><div>\u7d9a\u3051\u308b\u5834\u5408\u306f\u518d\u5ea6\u6226\u95d8\u30de\u30b9\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002<div>");
$("#enemy_pattern_select").html('<li class="nav-item"><a class="nav-link active" data-toggle="tab" href="#">\u7de8\u62101</a></li>');$("#enemy_pattern_air_power").text("0");$("#enemy_display_mode_parent").addClass("d-none").removeClass("d-flex");$(".node_selected").removeClass("node_selected");$("#btn_continue_expand").prop("disabled",!0);(isDefMode||10===a)&&$("#modal_enemy_pattern").modal("hide")}
function shoot_down_table_tbody_MouseEnter(a){a=a.closest("tr");var b=castInt(a[0].dataset.shipindex),c=a[0].dataset.css;a.addClass("bg-light");a.find(".td_plane_name").addClass(c);$("#shoot_down_table_tbody").find(".shipNo"+b+":first").find(".td_name").addClass("bg-light")}
function shoot_down_table_tbody_MouseLeave(a){a=a.closest("tr");var b=castInt(a[0].dataset.shipindex),c=a[0].dataset.css;a.removeClass("bg-light");a.find(".td_plane_name").removeClass(c);$("#shoot_down_table_tbody").find(".shipNo"+b+":first").find(".td_name").removeClass("bg-light")}
function progress_area_MouseEnter(a){a=a.find(".result_bar");var b=castInt(a.data("airstatus")),c=castInt(a.attr("id").replace("result_bar_",""));a.addClass("bar_ex_status"+b);$("#rate_row_"+c).addClass("bg_status"+b)}function progress_area_MouseLeave(a){a=a.find(".result_bar");var b=castInt(a.data("airstatus")),c=castInt(a.attr("id").replace("result_bar_",""));a.removeClass("bar_ex_status"+b);$("#rate_row_"+c).removeClass("bg_status"+b)}
function rate_table_MouseEnter(a){a=castInt(a.closest("tr").attr("id").replace("rate_row_",""));var b=$("#result_bar_"+a),c=castInt(b.data("airstatus"));b.addClass("bar_ex_status"+c);$("#rate_row_"+a).addClass("bg_status"+c)}function rate_table_MouseLeave(a){a=castInt(a.closest("tr").attr("id").replace("rate_row_",""));var b=$("#result_bar_"+a),c=castInt(b.data("airstatus"));b.removeClass("bar_ex_status"+c);$("#rate_row_"+a).removeClass("bg_status"+c)}
function enemy_shoot_down_table_tbody_MouseEnter(a){a=a.closest("tr");var b=castInt(a[0].dataset.rowindex),c=a[0].dataset.css;a.addClass("bg-light");a.find(".td_plane_name").addClass(c);$("#enemy_shoot_down_tbody").find(".enemy_no_"+b+":first").find(".td_name").addClass("bg-light")}
function enemy_shoot_down_table_tbody_MouseLeave(a){a=a.closest("tr");var b=castInt(a[0].dataset.rowindex),c=a[0].dataset.css;a.removeClass("bg-light");a.find(".td_plane_name").removeClass(c);$("#enemy_shoot_down_tbody").find(".enemy_no_"+b+":first").find(".td_name").removeClass("bg-light")}function display_battle_tab_Changed(a){displayBattle=castInt(a.find(".nav-link").data("disp"));calculate()}
function display_result_Changed(){if($("#display_land_base_result").prop("checked"))for(var a=1;7>a;a++)$("#rate_row_"+a+":not(.disabled_tr)").removeClass("d-none"),$("#result_bar_"+a).closest(".progress_area:not(.disabled_bar)").removeClass("d-none").addClass("d-flex");else for(a=1;7>a;a++)$("#rate_row_"+a).addClass("d-none"),$("#result_bar_"+a).closest(".progress_area").addClass("d-none").removeClass("d-flex");$("#display_fleet_result").prop("checked")?($("#rate_row_7:not(.disabled_tr)").removeClass("d-none"),
$("#result_bar_7").closest(".progress_area:not(.disabled_bar)").removeClass("d-none").addClass("d-flex")):($("#rate_row_7").addClass("d-none"),$("#result_bar_7").closest(".progress_area").addClass("d-none").removeClass("d-flex"));$("#display_bar").prop("checked")?$("#result_bar_parent").removeClass("d-none"):$("#result_bar_parent").addClass("d-none");$("#display_enemy_table").prop("checked")?$("#enemy_shoot_down_table_parent").removeClass("d-none"):$("#enemy_shoot_down_table_parent").addClass("d-none")}
function land_base_detail_Clicked(a){landBaseDetailCalculate(castInt(a.data("base_no")),0);$("#modal_result_detail").modal("show")}function fleet_slot_Clicked(a){var b=castInt(a[0].dataset.shipid),c=castInt(a[0].dataset.shipindex),d=castInt(a[0].dataset.slotindex);"-"!==a.find(".td_plane_name").text()&&""!==a.find(".td_plane_name").text()&&(fleetSlotDetailCalculate(c,d,b),$("#modal_result_detail").modal("show"))}
function enemy_slot_Clicked(a){var b=castInt(a.closest("tr")[0].dataset.rowindex);a=castInt(a.closest("tr")[0].dataset.slotindex);enemySlotDetailCalculate(b,a);$("#modal_result_detail").modal("show")}
function innerProfSetting_Clicked(a){var b=castInt(a.attr("id").replace("prof120_",""));a.prop("checked")&&!initialProf120Plane.includes(b)?initialProf120Plane.push(b):!a.prop("checked")&&initialProf120Plane.includes(b)&&(initialProf120Plane=initialProf120Plane.filter(function(a){return a!==b}));setting.initialProf120=initialProf120Plane.sort(function(a,b){return a-b});saveLocalStorage("setting",setting);calculate()}
function calculate_count_Changed(a){var b=validateInputNumber(a.val(),1E5);a.val(b);setting.simulateCount=b;saveLocalStorage("setting",setting)}function auto_save_Clicked(){setting.autoSave=$("#auto_save").prop("checked");saveLocalStorage("setting",setting);setting.autoSave||deleteLocalStorage("autoSaveData")}
function clipboard_mode_Clicked(){"function"!==typeof ClipboardItem&&($("#clipboard_mode").prop("checked",!1),$("#cant_use_clipboard").removeClass("d-none"));setting.copyToClipboard=$("#clipboard_mode").prop("checked");saveLocalStorage("setting",setting)}function air_raid_max_Clicked(){setting.airRaidMax=$("#air_raid_max").prop("checked");saveLocalStorage("setting",setting)}
function btn_reset_localStorage_Clicked(){var a=$("#modal_confirm");a.find(".modal-body").html('\n    <div>\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3055\u308c\u305f\u5165\u529b\u30fb\u8a2d\u5b9a\u30c7\u30fc\u30bf\u3092\u524a\u9664\u3057\u307e\u3059\u3002</div>\n    <div class="mt-3">\u767b\u9332\u30fb\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u7de8\u6210\u30c7\u30fc\u30bf\u3084\u88c5\u5099\u30d7\u30ea\u30bb\u30c3\u30c8\u3001\u6240\u6301\u88c5\u5099\u60c5\u5831\u3084\u5404\u7a2e\u8a73\u7d30\u8a2d\u5b9a\u5024\u306a\u3069\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u524a\u9664\u3055\u308c\u307e\u3059\u3002</div>\n    <div>\u524a\u9664\u3057\u305f\u30c7\u30fc\u30bf\u306f\u5143\u306b\u623b\u305b\u307e\u305b\u3093\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002</div>\n    <div class="mt-3">\u672c\u30b5\u30a4\u30c8\u306e\u5229\u7528\u3092\u4e2d\u6b62\u3059\u308b\u5834\u5408\u3001\u524a\u9664\u5f8c\u306b\u30da\u30fc\u30b8\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u3066\u3057\u307e\u3046\u3068\u518d\u5ea6\u8a2d\u5b9a\u30c7\u30fc\u30bf\u304c\u751f\u6210\u3055\u308c\u308b\u305f\u3081\u3001\u524a\u9664\u5f8c\u306f\u76f4\u3061\u306b\u30b5\u30a4\u30c8\u3092\u9589\u3058\u3066\u304f\u3060\u3055\u3044\u3002</div>\n    <div class="mt-3">\u3088\u308d\u3057\u3051\u308c\u3070\u3001OK\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002</div>\n  ');confirmType=
"deleteLocalStorageAll";a.modal("show")}
function btn_reset_selected_plane_history_Clicked(){var a=$("#modal_confirm");a.find(".modal-body").html('\n    <div>\u3088\u304f\u4f7f\u3046\u3068\u3057\u3066\u767b\u9332\u3055\u308c\u305f\u6a5f\u4f53\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3059\u3002</div>\n    <div class="mt-3">\u3088\u308d\u3057\u3051\u308c\u3070\u3001OK\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002</div>\n  ');confirmType="deleteSelectedPlaneHistory";a.modal("show")}
function btn_reset_selected_ship_history_Clicked(){var a=$("#modal_confirm");a.find(".modal-body").html('\n    <div>\u3088\u304f\u4f7f\u3046\u3068\u3057\u3066\u767b\u9332\u3055\u308c\u305f\u8266\u5a18\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3059\u3002</div>\n    <div class="mt-3">\u3088\u308d\u3057\u3051\u308c\u3070\u3001OK\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002</div>\n  ');confirmType="deleteSelectedShipHistory";a.modal("show")}
function theme_color_Changed(){var a=document.getElementById("theme_color").value,b="0 .5rem 1rem rgba(0, 0, 0, 0.4), 0 0 .75rem "+a+"cc inset";document.body.style.backgroundColor=a;var c=document.getElementsByClassName("contents");c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next())d.value.style.boxShadow=b;setting.themeColor=a;saveLocalStorage("setting",setting)}
function btn_random_theme_color_Clicked(){for(var a=[],b=180;256>b;b++)a.push(b.toString(16));var c=a.length;b=a[Math.floor(c*Math.random())];var d=a[Math.floor(c*Math.random())];a=a[Math.floor(c*Math.random())];document.getElementById("theme_color").value="#"+b+d+a;theme_color_Changed()}function btn_reset_theme_color_Clicked(){document.getElementById("theme_color").value="#f0ebe6";theme_color_Changed()}
function stock_type_select_Changed(){var a=Math.abs(castInt($("#stock_type_select").val())),b=$("#stock_word").val().trim();b&&(b=replaceKnji(b));$(".stock_tr").each(function(c,d){0<a&&!$(d).hasClass("type_"+a)?$(d).addClass("d-none").removeClass("d-flex"):b&&!$(d).find(".stock_td_name").text().includes(b)?$(d).addClass("d-none").removeClass("d-flex"):$(d).addClass("d-flex").removeClass("d-none")})}
function btn_load_equipment_json_Clicked(){var a=$("#input_equipment_json").val().trim();readEquipmentJson(a)?(setPlaneStockTable(),$("#input_equipment_json").val(""),$("#input_equipment_json").removeClass("is-invalid").addClass("is-valid")):($("#input_equipment_json").addClass("is-invalid").removeClass("is-valid"),$("#input_equipment_json").nextAll(".invalid-feedback").text("\u88c5\u5099\u60c5\u5831\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u5165\u529b\u3055\u308c\u305f\u30c7\u30fc\u30bf\u5f62\u5f0f\u304c\u6b63\u3057\u304f\u306a\u3044\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002"))}
function input_equipment_json_Changed(a){var b=a.val().trim(),c=$("#btn_load_equipment_json");0===b.length?(a.addClass("is-invalid").removeClass("is-valid"),a.nextAll(".invalid-feedback").text("\u30c7\u30fc\u30bf\u304c\u5165\u529b\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),c.prop("disabled",!0)):(a.removeClass("is-invalid"),c.prop("disabled",!1))}
function btn_stock_all_clear_Clicked(){var a=$("#modal_confirm");a.find(".modal-body").html('\n    <div>\u6240\u6301\u6a5f\u4f53\u60c5\u5831\u3092\u30ea\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002</div>\n    <div class="mt-3">\u73fe\u5728\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u6240\u6301\u88c5\u5099\u60c5\u5831\u304c\u524a\u9664\u3055\u308c\u3001\u5168\u3066\u306e\u6a5f\u4f53\u306e\u6240\u6301\u6570\u304c0\u3068\u306a\u308a\u307e\u3059\u3002</div>\n    <div class="mt-3">\u3088\u308d\u3057\u3051\u308c\u3070\u3001OK\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002</div>\n  ');confirmType=
"resetStock";a.modal("show")}function stock_word_TextChanged(){!1!==timer&&clearTimeout(timer);timer=setTimeout(function(){stock_type_select_Changed()},250)}
function stock_tr_Clicked(a){var b=$("#modal_plane_stock"),c=b.find(".plane_status_tr"),d=PLANE_DATA.find(function(b){return b.id===castInt(a.data("planeid"))}),e=loadPlaneStock().find(function(a){return a.id===d.id});b.find(".stock_num").each(function(a,b){$(b).val(e.num[a]);0<a&&$(b).prop("disabled",!d.canRemodel)});c.find(".plane_status_anti_air").text(d.antiAir);c.find(".plane_status_torpedo").text(d.torpedo);c.find(".plane_status_bomber").text(d.bomber);c.find(".plane_status_radius").text(d.radius);
c.find(".plane_status_interception").text(d.interception);c.find(".plane_status_anti_bomber").text(d.antiBomber);c=c.find(".plane_status_avoid");var f=AVOID_TYPE.find(function(a){return a.id===d.avoid});f?(c.text(f.name),c.attr("title","\u5272\u5408\u6483\u589c\u88dc\u6b63\uff1a"+f.adj[0]+", \u56fa\u5b9a\u6483\u589c\u88dc\u6b63\uff1a"+f.adj[1])):(c.text("\u306a\u3057"),c.attr("title","\u5272\u5408\u6483\u589c\u88dc\u6b63\uff1a1.0, \u56fa\u5b9a\u6483\u589c\u88dc\u6b63\uff1a1.0"));b.find("#edit_id").text(d.id);
b.find(".plane_status_name").text(d.name);b.find("#stock_sum").val(getArraySum(e.num));b.find(".img_plane_card").attr("src","img/plane/"+d.id+".png");b.modal("show")}function stock_Changed(a){var b=castInt(a.val()),c=0;$(".stock_num").each(function(a,b){c+=castInt($(b).val())});99<c&&(b-=c-99,c=99);a.val(validateInputNumber(b,99));$("#stock_sum").val(c)}
function btn_save_stock_Clicked(){var a=loadPlaneStock(),b=castInt($("#edit_id").text()),c=[0,0,0,0,0,0,0,0,0,0,0];$(".stock_num").each(function(a,b){c[a]=castInt($(b).val())});a.find(function(a){return a.id===b}).num=c;saveLocalStorage("planeStock",a);$("#modal_plane_stock").modal("hide");setPlaneStockTable()}function btn_stock_reset_Clicked(){$("#modal_plane_stock").find(".stock_num").val("0");$("#modal_plane_stock").find("#stock_sum").val("0")}
function btn_calculate_detail(){var a=$("#calculate_count").val();$("#calculate_count").val($("#detail_calculate_count").val());detailCalculate();$("#btn_calculate_detail").prop("disabled",!0);$("#calculate_count").val(a)}function detail_slot_tab_Changed(a){a.find(".nav-link").hasClass("disabled")||($("#detail_info").data("slot_no",castInt(a.data("slot_no"))),detailCalculate())}
function modal_confirm_ok_Clicked(){switch(confirmType){case "deleteLocalStorageAll":window.localStorage.clear();break;case "resetStock":deleteLocalStorage("planeStock");setPlaneStockTable();break;case "deleteSelectedPlaneHistory":setting.selectedHistory[0]=[];saveLocalStorage("setting",setting);break;case "deleteSelectedShipHistory":setting.selectedHistory[1]=[],saveLocalStorage("setting",setting)}confirmType=null;$("#modal_confirm").modal("hide")}
function btn_preset_all_Clicked(){loadMainPreset();$("#modal_main_preset").modal("show")}function btn_auto_expand_Clicked(){$("#alert_auto_expand").addClass("d-none");$("#modal_auto_expand").modal("show")}
function btn_twitter_Clicked(){var a,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return b=a="https://noro6.github.io/kcTools/?d="+encodePreset(),c.yield(postURLData(a).then(function(a){a.error||!a.shortLink?console.log(a):b=a.shortLink})["catch"](function(a){return console.error(a)}),2);window.open("https://twitter.com/share?url="+b);c.jumpToEnd()})}
function getShortURL(a){return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){return b.yield(postURLData(a).then(function(a){a.error||!a.shortLink?console.log(a):console.log(a.shortLink)})["catch"](function(a){return console.error(a)}),0)})}function btn_deckBuilder_Clicked(){window.open("http://kancolle-calc.net/deckbuilder.html?predeck="+convertToDeckBuilder())}
function main_preset_tab_Changed(a){"main_preset_back_up"===a.relatedTarget.id?($("#modal_main_preset").find(".preset_thead").addClass("d-none"),$(".back_up_text").removeClass("d-none"),loadMainPreset(!0)):($("#modal_main_preset").find(".preset_thead").removeClass("d-none"),$(".back_up_text").addClass("d-none"),loadMainPreset(!1))}
function main_preset_tr_Clicked(a){var b=$("#main_preset_back_up").hasClass("active");$(".preset_tr").removeClass("preset_selected");a.addClass("preset_selected");drawMainPreset((b?backUpPresets:presets).find(function(b){return b[0]===castInt(a.data("presetid"))}))}
function preset_remarks_Changed(a){var b=a.val().trim(),c=a.closest(".modal-body").find(".btn_commit_preset"),d=a.closest(".modal-body").find(".btn_commit_preset_header");400<b.length?(a.addClass("is-invalid"),c.prop("disabled",!0),d.prop("disabled",!0)):(a.removeClass("is-invalid"),a.addClass("is-valid"),c.prop("disabled",!1),d.prop("disabled",!1))}
function input_deck_Changed(a){var b=a.val().trim(),c=a.closest(".modal-body").find(".btn_load_deck");0===b.length?(a.addClass("is-invalid").removeClass("is-valid"),a.nextAll(".invalid-feedback").text("\u30c7\u30fc\u30bf\u304c\u5165\u529b\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),c.prop("disabled",!0)):(a.removeClass("is-invalid"),c.prop("disabled",!1))}
function output_data_Clicked(a){a.hasClass("is-valid")&&copyInputTextToClipboard(a)&&a.nextAll(".valid-feedback").text("\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002")}function output_data_Changed(a){a.removeClass("is-valid")}function btn_commit_main_preset_Clicked(){updateMainPreset();loadMainPreset()}function btn_commit_preset_header_Clicked(){updateMainPresetName();loadMainPreset()}
function btn_delete_main_preset_Clicked(){var a=castInt($("#modal_main_preset").find(".preset_selected").data("presetid"));deleteMainPreset(a)}
function btn_load_deck_Clicked(){var a=$("#input_deck").val().trim();(a=readDeckBuilder(a))?(expandMainPreset(a,0<a[0][0].length,!0,!1),$("#input_deck").removeClass("is-invalid").addClass("is-valid")):($("#input_deck").addClass("is-invalid").removeClass("is-valid"),$("#input_deck").nextAll(".invalid-feedback").text("\u7de8\u6210\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u5165\u529b\u3055\u308c\u305f\u30c7\u30fc\u30bf\u306e\u5f62\u5f0f\u304c\u6b63\u3057\u304f\u306a\u3044\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002"))}
function btn_output_url_Clicked(){var a,b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.setCatchFinallyBlocks(2),a=$("#output_url"),c=b="https://noro6.github.io/kcTools/?d="+encodePreset(),d.yield(postURLData(b).then(function(a){a.error||!a.shortLink?console.log(a):c=a.shortLink})["catch"](function(a){return console.error(a)}),4);if(2!=d.nextAddress)return a.val(c),a.nextAll(".valid-feedback").text("\u751f\u6210\u3057\u307e\u3057\u305f\u3002\u4e0a\u8a18URL\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3055\u308c\u307e\u3059\u3002"),
a.removeClass("is-invalid").addClass("is-valid"),d.leaveTryBlock(0);d.enterCatchBlock();$("#output_url").addClass("is-invalid").removeClass("is-valid");return d["return"]()})}var xxx="AIzaSyC_rEnvKFFlZv54xvxP8MXPht081xYol4s";
function btn_output_deck_Clicked(){var a=convertToDeckBuilder(),b=$("#output_deck");$("#output_deck").val(a);a?(b.nextAll(".valid-feedback").text("\u751f\u6210\u3057\u307e\u3057\u305f\u3002\u4e0a\u8a18\u6587\u5b57\u5217\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3055\u308c\u307e\u3059\u3002"),b.removeClass("is-invalid").addClass("is-valid")):b.addClass("is-invalid").removeClass("is-valid")}
function btn_expand_main_preset_Clicked(){var a=($("#main_preset_back_up").hasClass("active")?backUpPresets:presets).find(function(a){return a[0]===castInt($("#modal_main_preset").find(".preset_selected")[0].dataset.presetid)});expandMainPreset(decodePreset(a[2]));$("#modal_main_preset").modal("hide")}
function btn_start_auto_expand_Clicked(){$("#auto_land_base_1").prop("checked")||$("#auto_land_base_2").prop("checked")||$("#auto_land_base_3").prop("checked")||$("#auto_fleet").prop("checked")?(autoExpand(),$("#alert_auto_expand").text("\u304a\u307e\u304b\u305b\u8266\u8f09\u6a5f\u914d\u5099\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002"),$("#alert_auto_expand").addClass("alert-success").removeClass("alert-danger d-none")):($("#alert_auto_expand").text("\u914d\u5099\u5bfe\u8c61\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),
$("#alert_auto_expand").removeClass("alert-success d-none").addClass("alert-danger"))}function battle_mode_Clicked(){$("#mode_1").prop("checked")?($("#auto_fleet").closest("div").removeClass("d-none"),$("#dest_range_parent").removeClass("d-none"),$("#details_parent").removeClass("d-none")):($("#auto_fleet").prop("checked",!1),$("#auto_fleet").closest("div").addClass("d-none"),$("#dest_range_parent").addClass("d-none"),$("#details_parent").addClass("d-none"))}
function expand_target_Clicked(){$("#alert_auto_expand").addClass("d-none");$("#btn_start_auto_expand").prop("disabled",!1);$("#auto_land_base_1").prop("checked")||$("#auto_land_base_2").prop("checked")||$("#auto_land_base_3").prop("checked")?$("#dest_range").prop("disabled",!1):($("#dest_range").prop("disabled",!0),$("#auto_fleet").prop("checked")||$("#btn_start_auto_expand").prop("disabled",!0))}function dest_ap_Changed(a){a.val(validateInputNumber(a.val(),castInt(a.attr("max"))))}
function simple_enemy_ap_Changed(a){var b=validateInputNumber(a.val(),castInt(a.attr("max")));a.val(b);a=getAirStatusBorder(b);for(b=0;b<a.length;b++)$("#border_"+b).text(a[b])}function menu_small_Clicked(){$("#modal_smart_menu").find(".modal-body").html($("#Navbar").html());$("#modal_smart_menu").find(".mt-5").removeClass("mt-5").addClass("mt-3");$("#modal_smart_menu").modal("show")}
function smart_menu_modal_link_Clicked(a){sidebar_Clicked(a);setTimeout(function(){$("#modal_smart_menu").modal("hide")},220);return!1}function varsion_Closed(){$("#alreadyRead").prop("checked")&&(setting.version=$("#version").text(),saveLocalStorage("setting",setting))}function first_time_Clicked(){$("#site_abstract_content").collapse("show");setTimeout(function(){$("body,html").animate({scrollTop:$("#first_time_content").offset().top-80},300,"swing")},200);return!1}
function site_manual_Clicked(){$("#site_abstract_content").collapse("show");setTimeout(function(){$("body,html").animate({scrollTop:$("#site_manual_content").offset().top-80},300,"swing")},200);return!1}function scrollContent(a){a.collapse("show");setTimeout(function(){$("body,html").animate({scrollTop:a.offset().top-80},300,"swing")},250);return!1}
$(function(){initialize(function(){calculate()});$(document).keyup(function(a){isCtrlPress&&17===a.keyCode&&(isCtrlPress=!1)});$(document).keydown(function(a){isCtrlPress||17!==a.keyCode||(isCtrlPress=!0)});$("#modal_version_inform").on("hide.bs.modal",varsion_Closed);$(".modal").on("hide.bs.modal",function(){modal_Closed($(this))});$(".modal").on("show.bs.modal",function(){$(".btn_preset").tooltip("hide")});$(".modal").on("click",".toggle_display_type",function(){toggle_display_type_Clicked($(this))});
$(".modal").on("input",".preset_name",function(){preset_name_Changed($(this))});$(".modal").on("blur",".preset_name",function(){preset_name_Changed($(this))});$(".slot_select_parent").on("show.bs.dropdown",function(){slot_select_parent_Show($(this))});$(".slot_select_parent").on("hide.bs.dropdown",function(){slot_select_parent_Close($(this))});$(".remodel_select_parent").on("hide.bs.dropdown",function(){remodelSelect_Changed($(this))});$(".remodel_select_parent").on("show.bs.dropdown",function(){$(this).find(".remodel_item_selected").removeClass("remodel_item_selected")});
$(".main_preset_select").on("hidden.bs.tab",function(a){main_preset_tab_Changed(a)});$("#main").on("show.bs.dropdown",".enemy_ap_select_parent",function(){enemy_ap_select_parent_Show($(this))});$("#main").on("hide.bs.dropdown",".enemy_ap_select_parent",function(){enemy_ap_select_parent_Close($(this))});$("#main").on("show.bs.collapse",".collapse",function(){$(this).prev().find(".fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down")});$("#main").on("hide.bs.collapse",".collapse",
function(){$(this).prev().find(".fa-chevron-down").removeClass("fa-chevron-down").addClass("fa-chevron-up")});$("#main").on("shown.bs.collapse",".collapse",function(){$(this).removeClass("tmpHide")});$("#main").on("focus",".slot_input",function(){$(this).select()});$("#main").on("input",".slot_input",function(){slot_input_Changed($(this))});$("#main").on("input",".slot_range",function(){slot_range_Changed($(this))});$("#main").on("click",".remodel_item",function(){$(this).addClass("remodel_item_selected")});
$("#main").on("click",".plane_name",function(){plane_name_Clicked($(this))});$("#main").on("click",".btn_plane_preset",function(){btn_plane_preset_Clicked($(this))});$("#main").on("click",".btn_capture",function(){btn_capture_Clicked($(this))});$("#main").on("click",".btn_reset_content",function(){btn_reset_content_Clicked($(this))});$("#main").on("click",".btn_content_trade",function(){btn_content_trade_Clicked($(this))});$("#main").on("click",".btn_commit_trade",commit_content_order);$("#main").on("click",
".btn_ex_setting",function(){btn_ex_setting_Clicked($(this))});$("#landBase").on("click",".btn_air_raid",function(){btn_air_raid_Clicked($(this))});$("#landBase").on("click",".btn_supply",function(){btn_supply_Clicked($(this))});$("#landBase_content").on("change",".ohuda_select",function(){ohuda_Changed($(this))});$("#landBase_content").on("click",".btn_remove_plane",function(){btn_remove_lb_plane_Clicked($(this))});$("#landBase_content").on("click",".btn_reset_landBase",function(){btn_reset_landBase_Clicked($(this))});
$("#landBase_content").on("click",".prof_item",function(){proficiency_Changed($(this))});$("#friendFleet_content").on("change",".display_ship_count",function(){display_ship_count_Changed($(this))});$("#friendFleet_content").on("click",".btn_reset_ship_plane",function(){btn_reset_ship_plane_Clicked($(this))});$("#friendFleet_content").on("click",".ship_name_span",function(){ship_name_span_Clicked($(this))});$("#friendFleet_content").on("click",".btn_remove_ship",function(){btn_remove_ship_Clicked($(this))});
$("#friendFleet_content").on("click",".btn_remove_plane",function(){btn_remove_ship_plane_Clicked($(this))});$("#friendFleet_content").on({mouseenter:function(){$(this).closest(".ship_tab").find(".remove_line").addClass("ready")},mouseleave:function(){$(this).closest(".ship_tab").find(".remove_line").removeClass("ready")}},".btn_reset_ship_plane");$("#friendFleet_content").on("click",".prof_item",function(){proficiency_Changed($(this))});$("#friendFleet_content").on("click",".ship_disabled",function(){ship_disabled_Changed($(this))});
$("#friendFleet_content").on("click","#union_fleet",calculate);$('#friendFleet_content .nav-link[data-toggle="tab"]').on("shown.bs.tab",fleet_select_tab_Clicked);$("#friendFleet_content").on("click",".plane_lock",function(){plane_lock_Clicked($(this))});$("#friendFleet_content").on("click",".plane_unlock",function(){plane_unlock_Clicked($(this))});$("#friendFleet_content").on("click",".slot_ini",function(){slot_ini_Clicked($(this))});$("#enemyFleet_content").on("change",".cell_type",function(){cell_type_Changed($(this))});
$("#enemyFleet_content").on("change",".formation",calculate);$("#enemyFleet_content").on("focus",".enemy_ap_input",function(){$(this).select()});$("#enemyFleet_content").on("input",".enemy_ap_input",function(){enemy_ap_input_Changed($(this))});$("#enemyFleet_content").on("input",".enemy_ap_range",function(){enemy_ap_range_Changed($(this))});$("#enemyFleet_content").on("click",".enemy_name",function(){enemy_name_Clicked($(this))});$("#enemyFleet_content").on("click",".btn_reset_battle",function(){btn_reset_battle_Clicked($(this))});
$("#enemyFleet_content").on("click","#btn_world_expand",btn_world_expand_Clicked);$("#enemyFleet_content").on("click",".btn_enemy_preset",function(){btn_enemy_preset_Clicked($(this))});$("#enemyFleet_content").on("click",".btn_stage2",function(){btn_stage2_Clicked($(this))});$("#enemyFleet_content").on("change","#battle_count",function(){battle_count_Changed($(this))});$("#enemyFleet_content").on("change","#landBase_target",calculate);$("#result").on("click","#btn_calculate",calculate);$("#result_content").on("click",
"#display_battle_tab .nav-item",function(){display_battle_tab_Changed($(this))});$("#result_content").on("click","#empty_slot_invisible",calculate);$("#result_content").on("click","#display_setting .custom-control-input",display_result_Changed);$("#result_content").on("click","#shoot_down_table_tbody tr",function(){fleet_slot_Clicked($(this))});$("#result_content").on("click","#rate_table .land_base_detail",function(){land_base_detail_Clicked($(this))});$("#result_content").on("click","#enemy_shoot_down_tbody .td_detail_slot",
function(){enemy_slot_Clicked($(this))});$("#config_content").on("focus","#calculate_count",function(){$(this).select()});$("#config_content").on("input","#calculate_count",function(){calculate_count_Changed($(this))});$("#config_content").on("click","#btn_reset_localStorage",btn_reset_localStorage_Clicked);$("#config_content").on("click","#innerProfSetting .custom-control-input",function(){innerProfSetting_Clicked($(this))});$("#config_content").on("click","#auto_save",auto_save_Clicked);$("#config_content").on("click",
"#clipboard_mode",clipboard_mode_Clicked);$("#config_content").on("click","#air_raid_max",air_raid_max_Clicked);$("#config_content").on("click",".dropdown-item",function(){init_proficiency_Changed($(this))});$("#config_content").on("click","#backup_enabled",backup_enabled_Clicked);$("#config_content").on("click","#backup_enabled",backup_enabled_Clicked);$("#config_content").on("change","#backup_count",backup_enabled_Clicked);$("#config_content").on("click","#btn_reset_selected_plane_history",btn_reset_selected_plane_history_Clicked);
$("#config_content").on("click","#btn_reset_selected_ship_history",btn_reset_selected_ship_history_Clicked);$("#config_content").on("change","#theme_color",theme_color_Changed);$("#config_content").on("click","#btn_random_theme_color",btn_random_theme_color_Clicked);$("#config_content").on("click","#btn_reset_theme_color",btn_reset_theme_color_Clicked);$("#plane_stock").on("change","#stock_type_select",function(){stock_type_select_Changed($(this))});$("#plane_stock").on("click",".stock_tr",function(){stock_tr_Clicked($(this))});
$("#plane_stock").on("click","#btn_load_equipment_json",btn_load_equipment_json_Clicked);$("#plane_stock").on("input","#input_equipment_json",function(){input_equipment_json_Changed($(this))});$("#plane_stock").on("focus","#input_equipment_json",function(){$(this).select()});$("#plane_stock").on("click","#btn_stock_all_clear",btn_stock_all_clear_Clicked);$("#plane_stock").on("input","#stock_word",stock_word_TextChanged);$("#modal_plane_select").on("click",".plane",function(){modal_plane_Selected($(this))});
$("#modal_plane_select").on("click",".btn_remove",function(){modal_plane_select_btn_remove_Clicked($(this))});$("#modal_plane_select").on("change","#plane_type_select",plane_type_select_Changed);$("#modal_plane_select").on("click","#disp_in_stock",disp_in_stock_Checked_Chenged);$("#modal_plane_select").on("click","#disp_equipped",disp_equipped_Checked_Chenged);$("#modal_plane_select").on("input","#plane_word",plane_word_TextChanged);$("#modal_plane_select").on("change","#plane_sort_select",function(){sort_Changed($(this))});
$("#modal_plane_select").on("click","#plane_asc",function(){sort_Changed($(this))});$("#modal_plane_select").on("click","#plane_desc",function(){sort_Changed($(this))});$("#modal_plane_preset").on("click",".preset_tr",function(){plane_preset_tr_Clicked($(this))});$("#modal_plane_preset").on("click",".btn_commit_preset",function(){btn_commit_plane_preset_Clicked($(this))});$("#modal_plane_preset").on("click",".btn_delete_preset",function(){btn_delete_plane_preset_Clicked($(this))});$("#modal_plane_preset").on("click",
".btn_expand_preset",btn_expand_plane_preset_Clicked);$("#modal_ship_select").on("change","#ship_type_select",function(){createShipTable([castInt($(this).val())])});$("#modal_ship_select").on("click",".ship",function(){modal_ship_Selected($(this))});$("#modal_ship_select").on("click",".btn_remove",function(){modal_ship_select_btn_remove_Clicked($(this))});$("#modal_ship_select").on("click","#display_final",function(){createShipTable([castInt($("#ship_type_select").val())])});$("#modal_ship_select").on("click",
"#frequent_ship",function(){createShipTable([castInt($("#ship_type_select").val())])});$("#modal_ship_select").on("input","#ship_word",ship_word_TextChanged);$("#modal_enemy_select").on("click",".modal-body .enemy",function(){modal_enemy_Selected($(this))});$("#modal_enemy_select").on("click",".btn_remove",function(){modal_enemy_select_btn_remove($(this))});$("#modal_enemy_select").on("change","#enemy_type_select",function(){createEnemyTable([castInt($(this).val())])});$("#modal_enemy_select").on("input",
"#enemy_word",enemy_word_TextChanged);$("#modal_enemy_pattern").on("click",".node_tr",function(){node_tr_Clicked($(this))});$("#modal_enemy_pattern").on("change","#map_select",createNodeSelect);$("#modal_enemy_pattern").on("change","#node_select",createEnemyPattern);$("#modal_enemy_pattern").on("change","#select_difficulty",createNodeSelect);$("#modal_enemy_pattern").on("click","#btn_expand_enemies",btn_expand_enemies);$("#modal_enemy_pattern").on("click","#btn_continue_expand",btn_continue_expand_Clicked);
$("#modal_enemy_pattern").on("click",".node",function(){node_Clicked($(this))});$("#modal_enemy_pattern").on("click","#enemy_pattern_select .nav-link:not(.active)",function(){pattern_Changed($(this))});$("#modal_enemy_pattern").on("click",'input[name="enemy_display_mode"]',function(){enemy_display_mode_Changed($(this))});$("#modal_enemy_pattern").on("dblclick",".node",node_DoubleClicked);$("#modal_enemy_pattern").on("dblclick",".node_tr",node_DoubleClicked);$("#modal_enemy_pattern").on("dblclick",
"#enemy_pattern_select .nav-link.active",node_DoubleClicked);$("#modal_main_preset").on("click",".preset_tr",function(){main_preset_tr_Clicked($(this))});$("#modal_main_preset").on("click",".btn_commit_preset",btn_commit_main_preset_Clicked);$("#modal_main_preset").on("click",".btn_commit_preset_header",btn_commit_preset_header_Clicked);$("#modal_main_preset").on("click",".btn_delete_preset",btn_delete_main_preset_Clicked);$("#modal_main_preset").on("click",".btn_load_deck",btn_load_deck_Clicked);
$("#modal_main_preset").on("input","#preset_remarks",function(){preset_remarks_Changed($(this))});$("#modal_main_preset").on("input","#input_deck",function(){input_deck_Changed($(this))});$("#modal_main_preset").on("focus","#input_deck",function(){$(this).select()});$("#modal_main_preset").on("click",".btn_output_url",btn_output_url_Clicked);$("#modal_main_preset").on("click",".btn_output_deck",btn_output_deck_Clicked);$("#modal_main_preset").on("focus","#output_url",function(){$(this).select()});
$("#modal_main_preset").on("focus","#output_deck",function(){$(this).select()});$("#modal_main_preset").on("input","#output_url",function(){output_data_Changed($(this))});$("#modal_main_preset").on("input","#output_deck",function(){output_data_Changed($(this))});$("#modal_main_preset").on("click","#output_url",function(){output_data_Clicked($(this))});$("#modal_main_preset").on("click","#output_deck",function(){output_data_Clicked($(this))});$("#modal_main_preset").on("click",".btn_expand_preset",
btn_expand_main_preset_Clicked);$("#modal_auto_expand").on("click","#btn_start_auto_expand",btn_start_auto_expand_Clicked);$("#modal_auto_expand").on("click","#expand_target .custom-control-input",expand_target_Clicked);$("#modal_auto_expand").on("click","#auto_battle_mode .custom-control-input",battle_mode_Clicked);$("#modal_auto_expand").on("input","#simple_enemy_ap",function(){simple_enemy_ap_Changed($(this))});$("#modal_auto_expand").on("input","#dest_ap",function(){dest_ap_Changed($(this))});
$("#modal_auto_expand").on("input","#dest_range",function(){dest_ap_Changed($(this))});$("#modal_plane_stock").on("input",".stock_num",function(){stock_Changed($(this))});$("#modal_plane_stock").on("click","#btn_save_stock",btn_save_stock_Clicked);$("#modal_plane_stock").on("click","#btn_stock_reset",btn_stock_reset_Clicked);$("#modal_result_detail").on("click","#btn_calculate_detail",btn_calculate_detail);$("#modal_result_detail").on("change","#detail_calculate_count",function(){return $("#btn_calculate_detail").prop("disabled",
!1)});$("#modal_result_detail").on("change",".custom-radio",btn_calculate_detail);$("#modal_result_detail").on("click","#show_detail_slot .nav-item",function(){detail_slot_tab_Changed($(this))});$("#modal_collectively_setting").on("click",".btn_remove_plane_all",function(){btn_remove_plane_all_Clicked($(this))});$("#modal_collectively_setting").on("click",".btn_remove_ship_all",btn_remove_ship_all_Clicked);$("#modal_collectively_setting").on("click",".btn_slot_max",function(){btn_slot_max_Clicked($(this))});
$("#modal_collectively_setting").on("click",".btn_slot_min",btn_slot_min_Clicked);$("#modal_collectively_setting").on("click",".btn_slot_default",function(){btn_slot_default_Clicked($(this))});$("#modal_collectively_setting").on("input",".coll_slot_range",function(){coll_slot_range_Changed($(this))});$("#modal_collectively_setting").on("input",".coll_slot_input",function(){coll_slot_input_Changed($(this))});$("#modal_collectively_setting").on("focus",".coll_slot_input",function(){$(this).select()});
$("#modal_collectively_setting").on("click",".btn_remodel",function(){btn_remodel_Clicked($(this))});$("#modal_collectively_setting").on("click",".btn_fighter_prof_max",btn_fighter_prof_max_Clicked);$("#modal_collectively_setting").on("click",".btn_prof",function(){btn_prof_Clicked($(this))});$("#modal_stage2_detail").on("input","#stage2_detail_slot",stage2_slot_input_Changed);$("#modal_stage2_detail").on("change","#stage2_detail_avoid",calculateStage2Detail);$("#modal_confirm").on("click",".btn_ok",
modal_confirm_ok_Clicked);$("#btn_preset_all").click(btn_preset_all_Clicked);$("#btn_auto_expand").click(btn_auto_expand_Clicked);$("#btn_twitter").click(btn_twitter_Clicked);$("#btn_deckBuilder").click(btn_deckBuilder_Clicked);$("#smart_menu").click(menu_small_Clicked);$("#main").on("click",".btn_first_time",first_time_Clicked);$("#main").on("click",".btn_site_manual",site_manual_Clicked);$("#Navbar").on("click",'a[href^="#"]',function(){return sidebar_Clicked($(this))});$("#site_information").on("click",
'a[href^="#"]',function(){return sidebar_Clicked($(this))});$("#modal_smart_menu").on("click",'a[href^="#"]',function(){return smart_menu_modal_link_Clicked($(this))});$("#result_content").on({mouseenter:function(){shoot_down_table_tbody_MouseEnter($(this))},mouseleave:function(){shoot_down_table_tbody_MouseLeave($(this))}},"#shoot_down_table_tbody td");$("#result_content").on({mouseenter:function(){progress_area_MouseEnter($(this))},mouseleave:function(){progress_area_MouseLeave($(this))}},".progress_area");
$("#result_content").on({mouseenter:function(){rate_table_MouseEnter($(this))},mouseleave:function(){rate_table_MouseLeave($(this))}},"#rate_table tbody td");$("#result_content").on({mouseenter:function(){enemy_shoot_down_table_tbody_MouseEnter($(this))},mouseleave:function(){enemy_shoot_down_table_tbody_MouseLeave($(this))}},"#enemy_shoot_down_tbody td");$(window).resize(function(){!1!==timer&&clearTimeout(timer);timer=setTimeout(function(){"none"===$("#lb_tab_select").css("display")||$("#lb_item1").attr("class").includes("tab-pane")?
"none"===$("#lb_tab_select").css("display")&&$("#lb_item1").attr("class").includes("tab-pane")&&($(".lb_tab").removeClass("tab-pane fade").show().fadeIn(),$(".baseNo").addClass("sortable_handle cur_move")):($(".lb_tab").addClass("tab-pane fade"),$(".lb_tab:first").tab("show"),$(".baseNo").removeClass("sortable_handle cur_move"))},50)});Sortable.create($("#main_contents")[0],{handle:".trade_enabled",animation:200,scroll:!0,onEnd:main_contents_Sortable_End});Sortable.create($("#battle_result")[0],{handle:".drag_handle",
animation:200,scroll:!0});Sortable.create($("#lb_tab_parent")[0],{handle:".sortable_handle",animation:200,onEnd:function(){$(".lb_tab").each(function(a,b){$(b).attr("id","lb_item"+(a+1));$(b).find(".baseNo").text("\u7b2c"+(a+1)+"\u57fa\u5730\u822a\u7a7a\u968a")});calculate()}});$(".fleet_tab").each(function(a,b){Sortable.create($(b)[0],{handle:".sortable_handle",animation:200,scroll:!0,onEnd:function(){$(".ship_tab").each(function(a,b){$(b).attr("id","shipNo_"+(a+1))});calculate()}})});$(".lb_plane").draggable({delay:100,
helper:"clone",handle:".drag_handle",zIndex:1E3,start:function(a,b){$(b.helper).css("width",320);$(b.helper).find(".dropdown-menu").remove()},stop:function(){lb_plane_DragEnd($(this))}});$(".lb_plane").droppable({accept:".lb_plane",hoverClass:"plane_draggable_hover",tolerance:"pointer",drop:function(a,b){lb_plane_Drop($(this),b)}});$("#landBase_content_main").droppable({accept:".lb_plane",tolerance:"pointer",over:function(a,b){b.helper.animate({opacity:"1.0"},100);isOut=!1},out:function(a,b){b.helper.animate({opacity:"0.2"},
100);isOut=!0}});$(".ship_plane_draggable").draggable({delay:100,helper:"clone",handle:".drag_handle",zIndex:1E3,cursorAt:{left:55},start:function(a,b){ship_plane_DragStart(b)},stop:function(){ship_plane_DragEnd($(this))}});$(".ship_plane").droppable({accept:".ship_plane_draggable",hoverClass:"plane_draggable_hover",tolerance:"pointer",over:function(a,b){ship_plane_DragOver($(this),b)},drop:function(a,b){ship_plane_Drop($(this),b)}});$(".friendFleet_tab").droppable({accept:".ship_plane_draggable",
tolerance:"pointer",over:function(a,b){isOut=!1;b.helper.stop().animate({opacity:"1.0"},100)},out:function(a,b){isOut=!0;b.helper.stop().animate({opacity:"0.2"},100)}});Sortable.create($("#battle_container")[0],{handle:".sortable_handle",animation:150,onEnd:function(){$(".battle_content").each(function(a,b){$(b).find(".battle_no").text(a+1)});calculate()}});$(".battle_content").droppable({accept:".enemy_content",hoverClass:"hover_enemy_content",tolerance:"pointer",drop:function(a,b){var c=castInt(b.draggable[0].dataset.enemyid),
d=castInt(b.draggable.find(".enemy_ap").text());setEnemyDiv($(this).find(".enemy_content:last"),c,d)}});$("#enemyFleet_content").droppable({accept:".enemy_content",tolerance:"pointer",over:function(a,b){isOut=!1;b.helper.stop().animate({opacity:"1.0"},100)},out:function(a,b){isOut=!0;b.helper.stop().animate({opacity:"0.2"},100)}});$(".sample_plane").draggable({delay:100,scroll:!1,handle:".drag_handle",zIndex:1E3,revert:!0,cursorAt:{top:10}})});