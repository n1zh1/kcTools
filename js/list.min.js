var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,c){a.raw=c;return a};$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};
$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]};$jscomp.polyfill=function(a,c,b,e){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,e):$jscomp.polyfillUnisolated(a,c,b,e))};
$jscomp.polyfillUnisolated=function(a,c,b,e){b=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];if(!(d in b))return;b=b[d]}a=a[a.length-1];e=b[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,e){var d=a.split(".");a=1===d.length;e=d[0];e=!a&&e in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<d.length-1;f++){var g=d[f];if(!(g in e))return;e=e[g]}d=d[d.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?e[d]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,d,{configurable:!0,writable:!0,value:c}):c!==b&&($jscomp.propertyToPolyfillSymbol[d]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(d):$jscomp.POLYFILL_PREFIX+d,d=
$jscomp.propertyToPolyfillSymbol[d],$jscomp.defineProperty(e,d,{configurable:!0,writable:!0,value:c})))};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},c={};try{return c.__proto__=a,c.a}catch(b){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,c){a.__proto__=c;if(a.__proto__!==c)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype["return"]=function(a){this.abruptCompletion_={"return":a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,c){this.nextAddress=c;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,c){var b=$jscomp.makeIterator(a),e=b.next();$jscomp.generator.ensureIteratorResultIsObject_(e);if(e.done)this.yieldResult=e.value,this.nextAddress=c;else return this.yieldAllIterator_=b,this.yield(e.value,c)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,c){this.catchAddress_=a;void 0!=c&&(this.finallyAddress_=c)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,c){this.nextAddress=a;this.catchAddress_=c||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,c,b){b?this.finallyContexts_[b]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=c||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,c){var b=this.finallyContexts_.splice(c||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var c in a)this.properties_.push(c);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var c=this.context_.yieldAllIterator_;if(c)return this.yieldAllStep_("return"in c?c["return"]:function(b){return{value:b,done:!0}},a,this.context_["return"]);this.context_["return"](a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,c,b){try{var e=a.call(this.context_.yieldAllIterator_,c);$jscomp.generator.ensureIteratorResultIsObject_(e);if(!e.done)return this.context_.stop_(),e;var d=e.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;b.call(this.context_,d);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(c){this.context_.yieldResult=void 0,this.context_.throw_(c)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a["return"],done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(c){return a.next_(c)};this["throw"]=function(c){return a.throw_(c)};this["return"]=function(c){return a.return_(c)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,c){var b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(c));$jscomp.setPrototypeOf&&a.prototype&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function c(e){return a.next(e)}function b(e){return a["throw"](e)}return new Promise(function(e,d){function f(g){g.done?e(g.value):Promise.resolve(g.value).then(c,b).then(f,d)}f(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
function initialize(){location.search&&(window.location.href="../simulator/"+location.search);document.getElementById("confirm_tab_close").checked=setting.confirmTabClosing;$(".fleet_tab.active").removeClass("active");setPresets()}
function setPresets(){var a=loadLocalStorage("presets");a||(a=[]);var c=document.createDocumentFragment(),b=createDiv("preset_container new d-flex "+(a.length?"":"border_delete")),e=createDiv("new_body mx-auto my-auto","",a.length?"\u65b0\u898f\u4f5c\u6210":"\u7de8\u6210\u3092\u65b0\u898f\u4f5c\u6210");b.appendChild(e);c.appendChild(b);b=createDiv("","preset_sortable_container");a=$jscomp.makeIterator(a);for(e=a.next();!e.done;e=a.next()){var d=e.value;e=document.createElement("div");var f=createDiv("d-flex preset_container sortable_handle");
f.dataset.presetid=d[0];var g=createDiv("mx-2 preset_abstract flex-grow-1");g.appendChild(createDiv("preset_name","",d[1]));var h=document.createElement("input");h.type="text";h.maxLength=50;h.className="form-control form-control-sm preset_name_edit mb-1 d-none";h.value=d[1];g.appendChild(h);var k=decodePreset(d[2]);h=k[0];k=k[1];for(var l=createDiv("d-flex land_base_status"),m=1;3>=m;m++)l.appendChild(createDiv("land_base_state no_"+m+" mr-1 "+(1<=h.length&&h[1].length>=m&&0<=h[1][m-1]?"":"disabled"),
"","\u7b2c"+m+"\u57fa\u5730\u822a\u7a7a\u968a"));g.appendChild(l);h=createDiv("d-flex ships flex-wrap");k=$jscomp.makeIterator(k);for(l=k.next();!l.done;l=k.next()){l=l.value;if(5<h.childNodes.length)break;0>=l[0]||(m=document.createElement("img"),m.className="ship_image",m.width=100,m.height=25,m.src="../img/ship/"+l[0]+".png",h.appendChild(m))}g.appendChild(h);h=createDiv("preset_memo_view border mt-1 px-1 py-1 "+(d[3]?"":"d-none"),"",d[3].replace(/\r?\n/g," "));g.appendChild(h);h=document.createElement("textarea");
h.className="form-control preset_memo mt-1 w-100 d-none";h.value=d[3]?d[3]:"";d=h.value.match(/\n/g);h.rows=d&&d.length?d.length+2:2;g.appendChild(h);f.appendChild(g);g=createDiv("d-flex ml-auto btns_container");d=createDiv("ml-auto r_btn btn_commit d-none");d.dataset.toggle="tooltip";d.dataset.offset="-50%";d.title="\u7de8\u96c6\u5185\u5bb9\u3092\u78ba\u5b9a\u3057\u307e\u3059\u3002";d.innerHTML='<i class="fas fa-save"></i>';g.appendChild(d);d=createDiv("ml-2 r_btn btn_rollback d-none");d.dataset.toggle=
"tooltip";d.dataset.offset="-50%";d.title="\u7de8\u96c6\u5185\u5bb9\u3092\u53d6\u308a\u6d88\u3057\u307e\u3059\u3002";d.innerHTML='<i class="fas fa-undo"></i>';g.appendChild(d);d=createDiv("ml-auto r_btn btn_edit_start");d.dataset.toggle="tooltip";d.dataset.offset="-50%";d.title="\u7de8\u6210\u540d\u3084\u7de8\u6210\u30e1\u30e2\u306e\u5909\u66f4\u3092\u884c\u3044\u307e\u3059\u3002";d.innerHTML='<i class="fas fa-pencil"></i>';g.appendChild(d);d=createDiv("ml-2 r_btn btn_copy");d.dataset.toggle="tooltip";
d.dataset.offset="-50%";d.title="\u3053\u306e\u7de8\u6210\u5185\u5bb9\u304c\u8907\u88fd\u3055\u308c\u305f\u65b0\u3057\u3044\u7de8\u6210\u30bf\u30d6\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002";d.innerHTML='<i class="fas fa-copy"></i>';g.appendChild(d);d=createDiv("ml-2 r_btn btn_delete");d.dataset.toggle="tooltip";d.dataset.offset="-50%";d.title="\u7de8\u6210\u3092\u524a\u9664\u3057\u307e\u3059\u3002";d.innerHTML='<i class="fas fa-trash-o"></i>';g.appendChild(d);f.appendChild(g);e.appendChild(f);b.appendChild(e)}c.appendChild(b);
document.getElementById("presets_container").innerHTML="";document.getElementById("presets_container").appendChild(c);$("#presets_container .r_btn").tooltip();Sortable.create(document.getElementById("preset_sortable_container"),{delay:50,animation:200,handle:".sortable_handle",onEnd:function(){for(var n=loadLocalStorage("presets"),q=[],p={},t=$jscomp.makeIterator(document.getElementsByClassName("preset_container")),r=t.next();!r.done;p={$jscomp$loop$prop$c$7:p.$jscomp$loop$prop$c$7},r=t.next())p.$jscomp$loop$prop$c$7=
r.value,(r=n.find(function(u){return function(v){return v[0]===u.$jscomp$loop$prop$c$7.dataset.presetid}}(p)))&&q.push(r);q.length&&(saveLocalStorage("presets",q),inform_success("\u7de8\u6210\u30c7\u30fc\u30bf\u306e\u9806\u5e8f\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002"))}})}
function btn_edit_start_Clicked(a,c){c.stopPropagation();$(".preset_container.editting").each(function(e,d){btn_rollback_Clicked($(d).find(".btn_rollback"));inform_warning($(d).find(".preset_name").text()+"\u306e\u7de8\u96c6\u306f\u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u307e\u3057\u305f\u3002")});var b=a.closest(".preset_container");b.addClass("editting");b.removeClass("sortable_handle");b.find(".preset_name").addClass("d-none");b.find(".preset_name_edit").removeClass("d-none");b.find(".preset_memo").removeClass("d-none");
b.find(".preset_memo_view").addClass("d-none");b.find(".btn_commit").removeClass("d-none");b.find(".btn_rollback").removeClass("d-none");b.find(".btn_copy").addClass("d-none");b.find(".btn_edit_start").addClass("d-none")}
function btn_rollback_Clicked(a,c){(c=void 0===c?null:c)&&c.stopPropagation();var b=a.closest(".preset_container");b.find(".preset_name").removeClass("d-none");b.find(".preset_name_edit").addClass("d-none");b.find(".preset_memo").addClass("d-none");b.find(".preset_memo_view").text()&&b.find(".preset_memo_view").removeClass("d-none");b.find(".btn_commit").addClass("d-none");b.find(".btn_rollback").addClass("d-none");b.find(".btn_copy").removeClass("d-none");b.find(".btn_edit_start").removeClass("d-none");
b.removeClass("editting");b.addClass("sortable_handle")}
function btn_commit_Clicked(a,c){c=void 0===c?null:c;var b=a.closest(".preset_container"),e=b[0].dataset.presetid,d=loadLocalStorage("presets");d||(d=[]);var f=d.findIndex(function(k){return k[0]===e});if(0<=f){var g=b.find(".preset_name_edit").val().trim(),h=b.find(".preset_memo").val().trim();g&&(50<g.length&&(g=g.slice(0,50),b.find(".preset_name_edit").val(g)),d[f][1]=g,b.find(".preset_name").text(g));400<h.length&&(h=h.slice(0,400),b.find(".preset_memo").val(h));d[f][3]=h;f=h.replace(/\r?\n/g,
" ");b.find(".preset_memo_view").text(f);f.trim().length?b.find(".preset_memo_view").removeClass("d-none"):b.find(".preset_memo_view").addClass("d-none");saveLocalStorage("presets",d)}btn_rollback_Clicked(a,c);setTab();$(".fleet_tab.active").removeClass("active");inform_success("\u7de8\u6210\u60c5\u5831\u306e\u66f4\u65b0\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002")}
function btn_delete_Clicked(a,c){c.stopPropagation();var b=$("#modal_confirm");b.find(".modal-body").html('<div class="mt-2">\u7de8\u6210\u3092\u524a\u9664\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f</div>');b[0].dataset.target=a.closest(".preset_container")[0].dataset.presetid;confirmType="deletePreset";b.modal("show")}
function preset_Clicked(a){var c=loadLocalStorage("presets"),b=a[0].dataset.presetid;c=c?c.find(function(d){return d[0]===b}):null;var e={id:getUniqueId(),name:"\u7121\u984c",history:{index:0,histories:["Noi6BpgWgRnX41BYLgAZKe-H6IBEB4cSaA3gQMYCuALgJYB2AkgCYEBcmBATgIZ0AplxjoedfgCMANiM6pwBKQHtebIb1HiAvhBwAzfjIDOQ8EdPnFZIA"]}};c&&(e.id=c[0],e.name=a.find(".preset_name").text(),e.history.histories[0]=c[2]);(a=loadLocalStorage("activePresets"))||(a={activeId:"",presets:[]});(c=a.presets.find(function(d){return d.id===
e.id}))?e=c:a.presets.push(e);a.activeId=e.id;saveLocalStorage("activePresets",a);window.location.href="../simulator/?p="+e.history.histories[e.history.index]}
function btn_copy_Clicked(a,c){c.stopPropagation();var b=loadLocalStorage("presets"),e=a.closest(".preset_container")[0].dataset.presetid;if(b=b?b.find(function(f){return f[0]===e}):null){b={id:getUniqueId(),name:b[1]+"_\u30b3\u30d4\u30fc",history:{index:0,histories:[b[2]]}};var d=loadLocalStorage("activePresets");d||(d={activeId:"",presets:[]});d.presets.push(b);d.activeId=b.id;saveLocalStorage("activePresets",d);window.location.href="../simulator/?p="+b.history.histories[b.history.index]}else inform_danger("\u8907\u88fd\u5bfe\u8c61\u306e\u7de8\u6210\u30c7\u30fc\u30bf\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}
function topTab_Clicked(){var a=getActivePreset();window.location.href="../simulator/?p="+a.history.histories[a.history.index]}
function version_detail_Clicked(){if(!document.getElementById("version_inform_body").innerHTML){for(var a=CHANGE_LOG.find(function(k){return k.id===LATEST_VERSION}),c=document.createDocumentFragment(),b=$jscomp.makeIterator(a.changes),e=b.next();!e.done;e=b.next()){e=e.value;var d=createDiv("mt-3"),f=document.createElement("div"),g=document.createElement("span");g.className="mr-1 pt-1 badge badge-pill badge-"+(0===e.type?"success":1===e.type?"info":"danger");g.textContent=0===e.type?"\u65b0\u898f":
1===e.type?"\u5909\u66f4":"\u4fee\u6b63";var h=document.createElement("span");h.innerHTML=e.title;f.appendChild(g);f.appendChild(h);d.appendChild(f);e.content&&(f=createDiv("font_size_12 pl-3"),f.innerHTML=e.content,d.appendChild(f));c.appendChild(d)}document.getElementById("version").textContent=a.id;document.getElementById("version_inform_body").appendChild(c);setting.version=a.id;saveSetting();document.getElementsByClassName("version_detail")[0].classList.remove("unread")}$("#modal_version_inform").modal("show")}
function loadSiteHistory(){if(!document.getElementById("site_history_body").innerHTML){for(var a=document.createDocumentFragment(),c=0,b=LATEST_VERSION,e=$jscomp.makeIterator(CHANGE_LOG),d=e.next();!d.done;d=e.next()){d=d.value;var f=createDiv("my-3 ver_log border-bottom"),g=createDiv("py-2","","v"+d.id);if(b===d.id){var h=document.createElement("span");h.className="ml-2 pt-1 badge badge-pill badge-danger";h.textContent="New";g.appendChild(h)}f.appendChild(g);for(g=0;g<d.changes.length;g++){h=d.changes[g];
var k="log_"+c++ +"_"+g,l=document.createElement("div");l.className="py-2 px-2 d-flex collapsed history_item history_item_no_content";var m=document.createElement("div");m.className="d-flex flex-nowrap align-self-center";var n=document.createElement("div");n.className="align-self-center";var q=document.createElement("span");q.className="mr-2 pt-1 badge badge-pill badge-"+(0===h.type?"success":1===h.type?"info":"danger");q.textContent=0===h.type?"\u65b0\u898f":1===h.type?"\u5909\u66f4":"\u4fee\u6b63";
var p=document.createElement("div");p.className="align-self-center";p.innerHTML=h.title;n.appendChild(q);m.appendChild(n);m.appendChild(p);l.appendChild(m);f.appendChild(l);h.content&&(l.dataset.toggle="collapse",l.dataset.target="#"+k,l.classList.remove("history_item_no_content"),l=document.createElement("div"),l.id=k,l.className="border-top collapse history_content",k=document.createElement("div"),k.className="pl-3 py-2 font_size_12",k.innerHTML=h.content,l.appendChild(k),f.appendChild(l));a.appendChild(f)}}c=
document.createElement("div");c.className="mt-2 font_size_12";c.textContent=LAST_UPDATE_DATE;a.appendChild(c);document.getElementById("site_history_body").appendChild(a)}}
function modal_confirm_ok_Clicked(){var a=$("#modal_confirm");if("deletePreset"===confirmType){var c=loadLocalStorage("presets");c=c.filter(function(b){return b[0]!==a[0].dataset.target});saveLocalStorage("presets",c);c=loadLocalStorage("activePresets");c.presets=c.presets.filter(function(b){return b.id!==a[0].dataset.target});saveLocalStorage("activePresets",c);setPresets();setTab();a.modal("hide")}else"deleteLocalStorageAll"===confirmType&&(window.localStorage.clear(),setPresets(),setTab(),a.modal("hide"));
$(".fleet_tab.active").removeClass("active")}function first_time_Clicked(){$("#abstract").collapse("show");setTimeout(function(){$("body,html").animate({scrollTop:$("#first_time").offset().top-80},300,"swing")},200);return!1}function site_manual_Clicked(){$("#abstract").collapse("show");setTimeout(function(){$("body,html").animate({scrollTop:$("#manual").offset().top-80},300,"swing")},200);return!1}
function initializeBoard(){fb||(firebase.initializeApp({apiKey:xxx,projectId:"development-74af0"}),fb=firebase.firestore(),fb.collection("comments").orderBy("createdAt","desc").limit(30).onSnapshot(function(a){var c=document.createDocumentFragment();a.forEach(function(b){var e=document.createElement("div");e.className="general_box my-3 px-3 pt-3 pb-1 comment";var d=document.createElement("div");d.className="d-flex mb-1";var f=document.createElement("div");f.className="comment_index text-primary";
f.dataset.number=b.data().number;f.textContent=b.data().number+":";var g=document.createElement("div");g.className="comment_writer ml-1 mr-2";g.textContent=b.data().author;var h=b.data().createdAt?b.data().createdAt.toDate():new Date,k=document.createElement("div");k.className="comment_date opacity6 font_size_11 align-self-center";k.textContent=" -- "+formatDate(h,"yyyy/MM/dd HH:mm:ss");d.appendChild(f);d.appendChild(g);d.appendChild(k);f=new Date;f.setDate(f.getDate()-7);h>f&&(f.setDate(f.getDate()+
4),g=document.createElement("div"),g.className="font_size_11 align-self-center ml-1 "+(h>f?"text-danger":"text-success"),g.textContent="New",d.appendChild(g));h=document.createElement("div");h.className="comment_content align-self-center";h.textContent=b.data().content;e.appendChild(d);e.appendChild(h);c.appendChild(e)});document.getElementById("coment_board").innerHTML="";document.getElementById("coment_board").appendChild(c)}));comment_text_Changed()}
function comment_index_Clicked(a){a=castInt(a[0].dataset.number);document.getElementById("comment_text").value.trim().length?document.getElementById("comment_text").value+=">>"+a+"\n":document.getElementById("comment_text").value=">>"+a+"\n";setTimeout(function(){$("body,html").animate({scrollTop:$("#comments").offset().top-20},20,"swing")},20);document.getElementById("comment_text").focus()}
function comment_text_Changed(){var a=document.getElementById("comment_author"),c=document.getElementById("comment_text"),b=c.value,e=b.match(/\n/g),d=!0;"noro"===a.value.trim()?(document.getElementById("author_validate").textContent="\u4f7f\u7528\u3067\u304d\u306a\u3044\u540d\u524d\u3067\u3059\u3002",a.classList.add("is-invalid"),d=!1):20<a.value.trim().length?(document.getElementById("author_validate").textContent="20\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u4e0b\u3055\u3044\u3002",
a.classList.add("is-invalid"),d=!1):a.classList.remove("is-invalid");0===b.trim().length?(document.getElementById("comment_validate").textContent="",c.classList.remove("is-invalid"),d=!1):1E3<b.length?(document.getElementById("comment_validate").textContent="1000\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",c.classList.add("is-invalid"),d=!1):e&&15<=e.length?(document.getElementById("comment_validate").textContent="\u898f\u5b9a\u884c\u6570\u3092\u8d85\u3048\u307e\u3057\u305f\u3002\u884c\u6570\u3092\u6e1b\u3089\u3057\u3066\u4e0b\u3055\u3044\u3002",
c.classList.add("is-invalid"),d=!1):c.classList.remove("is-invalid");document.getElementById("btn_send_comment").disabled=!d;d&&(a.classList.remove("is-invalid"),c.classList.remove("is-invalid"))}
function btn_send_comment_Clicked(){var a=$("#modal_confirm");a.find(".modal-body").html('\n\t\t<div>\u30b3\u30e1\u30f3\u30c8\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002</div>\n\t\t<div class="mt-3 font_size_12">\u30fb\u516c\u5e8f\u826f\u4fd7\u306b\u53cd\u3059\u308b\u66f8\u304d\u8fbc\u307f\u306f\u3054\u9060\u616e\u304f\u3060\u3055\u3044\u3002</div>\n\t\t<div class="font_size_12">\u30fb\u9001\u4fe1\u3057\u305f\u5185\u5bb9\u306f\u3001\u539f\u5247\u3042\u3068\u304b\u3089\u5909\u66f4/\u524a\u9664\u306f\u3067\u304d\u307e\u305b\u3093\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002</div>\n\t\t<div class="font_size_12">\u30fb\u3069\u3046\u3057\u3066\u3082\u5909\u66f4\u30fb\u524a\u9664\u3057\u305f\u3044\u5834\u5408\u306f\u3054\u9023\u7d61\u304f\u3060\u3055\u3044\u3002</div>\n\t\t<div class="mt-3">\u3088\u308d\u3057\u3051\u308c\u3070\u3001OK\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002</div>\n\t');confirmType=
"sendComment";a.modal("show")}
function send_comment(){if(fb){var a=document.getElementById("comment_author").value.trim(),c=document.getElementById("comment_text").value.trim();a||(a="\u540d\u7121\u3057\u3055\u3093");fb.runTransaction(function(b){var e=fb.collection("comments"),d=e.doc();return b.get(d).then(function(){var f,g,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){switch(k.nextAddress){case 1:return k.yield(e.orderBy("createdAt","desc").limit(1).get(),2);case 2:f=k.yieldResult;if(!f){k.jumpTo(0);break}g=
0;return k.yield(Promise.all(f.docs.map(function(l){var m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==n.nextAddress)return n.yield(l.data(),2);if(3!=n.nextAddress)return m=n.yieldResult,n.yield(m.number,3);g=n.yieldResult;n.jumpToEnd()})})),4);case 4:if(!(0<=castInt(g,-1)))return k["return"](Promise.reject("ID\u63a1\u756a\u30a8\u30e9\u30fc :",g));h={number:castInt(g)+1,author:a,content:c,createdAt:firebase.firestore.FieldValue.serverTimestamp()};return k.yield(b.set(d,h),
6);case 6:return k["return"](h)}})})}).then(function(b){document.getElementById("comment_text").value="";document.getElementById("btn_send_comment").disabled=!0})["catch"](function(b){console.error(b);alert("\u30b3\u30e1\u30f3\u30c8\u306e\u6295\u7a3f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002")})}else alert("\u8b0e\u306e\u7406\u7531\u306b\u3088\u308a\u3001\u30b3\u30e1\u30f3\u30c8\u306e\u6295\u7a3f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}
var fb=null;
function btn_url_shorten_Clicked(){var a,c,b,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress){a=document.getElementById("btn_url_shorten");c=document.getElementById("input_url");b=c.value.trim();if(a.classList.contains("shortening"))return d["return"]();a.classList.add("shortening");a.textContent="\u77ed\u7e2e\u4e2d";return b?b.match(/^(https?|ftp)(:\/\/[-_.!~*'()a-zA-Z0-9;\/?:@&=+\$,%#]+)$/)?b.match(/^(https:\/\/aircalc.page.link\/)([.!~*'()a-zA-Z0-9;\/?:@&=+\$,%#]+)$/)?d.jumpTo(2):
d.yield(postURLData(b).then(function(f){f.error||!f.shortLink?(c.value="",inform_danger("\u5165\u529b\u3055\u308c\u305fURL\u306e\u77ed\u7e2e\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")):(c.value=f.shortLink,inform_success("URL\u306e\u77ed\u7e2e\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002"))})["catch"](function(f){c.value="";inform_danger("\u5165\u529b\u3055\u308c\u305fURL\u306e\u77ed\u7e2e\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}),2):(c.value="",(e=readDeckBuilder(b))?window.location.href=
"../simulator/?predeck="+b:readEquipmentJson(b)?inform_success("\u6240\u6301\u88c5\u5099\u306e\u53cd\u6620\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002"):readShipJson(b)?inform_success("\u6240\u6301\u8266\u5a18\u306e\u53cd\u6620\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002"):inform_danger("\u5165\u529b\u3055\u308c\u305fURL\u306e\u77ed\u7e2e\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002"),d.jumpTo(2)):(c.value="",inform_warning("URL\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),
d.jumpTo(2))}a.textContent="URL\u77ed\u7e2e";a.classList.remove("shortening");d.jumpToEnd()})}
function site_theme_Changed(a){a=a.attr("id");document.body.classList.remove(setting.themeColor);document.body.classList.add(a);"dark_theme"===a||"dark_gradient_theme"===a||"deep_blue_theme"===a?(mainColor="#e0e0e0",document.body.classList.add("dark-theme")):(mainColor="#000000",document.body.classList.remove("dark-theme"));document.getElementById("input_url").classList.add("form-control-dark");setting.themeColor=a;saveSetting();document.body.style.color=mainColor}
function confirm_tab_close_Clicked(){setting.confirmTabClosing=document.getElementById("confirm_tab_close").checked;saveSetting()}
document.addEventListener("DOMContentLoaded",function(){initialize();document.getElementById("btn_top").addEventListener("click",function(){window.location.href="../list/"});$("#header").on("click",".fleet_tab",topTab_Clicked);$("#main").on("click",".version_detail",version_detail_Clicked);$("#main").on("click",".preset_container:not(.editting)",function(){preset_Clicked($(this))});$("#main").on("click",".btn_edit_start",function(a){btn_edit_start_Clicked($(this),a)});$("#main").on("click",".btn_commit",
function(a){btn_commit_Clicked($(this),a)});$("#main").on("click",".btn_rollback",function(a){btn_rollback_Clicked($(this),a)});$("#main").on("click",".btn_copy",function(a){btn_copy_Clicked($(this),a)});$("#main").on("click",".btn_delete",function(a){btn_delete_Clicked($(this),a)});$("#main").on("click",".btn_first_time",first_time_Clicked);$("#main").on("click",".btn_site_manual",site_manual_Clicked);$("#main").on("click",".theme_select",function(){site_theme_Changed($(this))});$("#site_history").on("show.bs.collapse",
".collapse",loadSiteHistory);$("#site_board").on("show.bs.collapse",".collapse",initializeBoard);$("#site_board").on("click","#btn_send_comment",btn_send_comment_Clicked);$("#site_board").on("input","#comment_author",comment_text_Changed);$("#site_board").on("input","#comment_text",comment_text_Changed);$("#site_board").on("click",".comment_index",function(){comment_index_Clicked($(this))});$("#config_content").on("click","#confirm_tab_close",confirm_tab_close_Clicked);$("#config_content").on("click",
"#btn_reset_localStorage",btn_reset_localStorage_Clicked);$("#btn_url_shorten").click(btn_url_shorten_Clicked);$("#modal_confirm").on("click",".btn_ok",modal_confirm_ok_Clicked)});