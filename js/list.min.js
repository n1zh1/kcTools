var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,c){a.raw=c;return a};$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};
$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]};$jscomp.polyfill=function(a,c,b,d){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,d):$jscomp.polyfillUnisolated(a,c,b,d))};
$jscomp.polyfillUnisolated=function(a,c,b,d){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in b))return;b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var h=e[f];if(!(h in d))return;d=d[h]}e=e[e.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?d[e]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:c}):c!==b&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(b=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+b+"$"+e),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:c})))};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},c={};try{return c.__proto__=a,c.a}catch(b){}return!1};
$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,c){a.__proto__=c;if(a.__proto__!==c)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype["return"]=function(a){this.abruptCompletion_={"return":a};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,c){this.nextAddress=c;return{value:a}};$jscomp.generator.Context.prototype.yieldAll=function(a,c){var b=$jscomp.makeIterator(a),d=b.next();$jscomp.generator.ensureIteratorResultIsObject_(d);if(d.done)this.yieldResult=d.value,this.nextAddress=c;else return this.yieldAllIterator_=b,this.yield(d.value,c)};
$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,c){this.catchAddress_=a;void 0!=c&&(this.finallyAddress_=c)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,c){this.nextAddress=a;this.catchAddress_=c||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,c,b){b?this.finallyContexts_[b]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=c||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,c){var b=this.finallyContexts_.splice(c||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var c in a)this.properties_.push(c);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var c=this.context_.yieldAllIterator_;if(c)return this.yieldAllStep_("return"in c?c["return"]:function(b){return{value:b,done:!0}},a,this.context_["return"]);this.context_["return"](a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,c,b){try{var d=a.call(this.context_.yieldAllIterator_,c);$jscomp.generator.ensureIteratorResultIsObject_(d);if(!d.done)return this.context_.stop_(),d;var e=d.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;b.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(c){this.context_.yieldResult=void 0,this.context_.throw_(c)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a["return"],done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(c){return a.next_(c)};this["throw"]=function(c){return a.throw_(c)};this["return"]=function(c){return a.return_(c)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,c){var b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(c));$jscomp.setPrototypeOf&&a.prototype&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function c(d){return a.next(d)}function b(d){return a["throw"](d)}return new Promise(function(d,e){function f(h){h.done?d(h.value):Promise.resolve(h.value).then(c,b).then(f,e)}f(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
function initialize(){location.search&&(window.location.href="../simulator/"+location.search);document.getElementById("confirm_tab_close").checked=setting.confirmTabClosing;document.getElementById("presets_order").value=setting.presetsOrder;document.getElementById("empty_folder_visible").checked=setting.visibleEmptyFolder;$(".fleet_tab.active").removeClass("active");setLocalPresets();loadSessionStorage("display_public")&&$("#public_preset_tab").tab("show")}
function setLocalPresets(){var a=loadLocalStorage("presets");a||(a=[]);$("#btn_search_preset").prop("disabled",!1);setPresets(a);$(".folder_content").on("show.bs.collapse",function(){folder_content_Show($(this))});$(".folder_content").on("hide.bs.collapse",function(){folder_content_Hide($(this))})}
function setPresets(a,c){var b=(c=void 0===c?!0:c)?"presets_container":"public_presets_container",d=castInt(document.getElementById("presets_order").value),e=document.getElementById("search_preset").value.trim(),f=document.getElementById("empty_folder_visible").checked;setting.visibleEmptyFolder=f;c&&e&&(a=a.filter(function(w){return 0<=w[1].indexOf(e)}));if(c)switch(d){case 1:a.sort(function(w,q){return w[4]<q[4]?1:-1});break;case 2:a.sort(function(w,q){return w[4]>q[4]?1:-1});break;case 3:a.sort(function(w,
q){return w[1]<q[1]?1:-1});break;case 4:a.sort(function(w,q){return w[1]>q[1]?1:-1})}setting.presetsOrder=d;saveSetting();var h=0===d&&!e&&c,n=document.createDocumentFragment();if(c){var l=createDiv("preset_container new d-flex "+(a.length?"":"border_delete")),k=createDiv("new_body mx-auto my-auto","",a.length?"\u65b0\u898f\u4f5c\u6210":"\u7de8\u6210\u3092\u65b0\u898f\u4f5c\u6210");l.appendChild(k);n.appendChild(l)}else c||0!==a.length||(l=createDiv("d-flex empty_container"),k=createDiv("mx-auto my-auto",
"","\u30c7\u30fc\u30bf\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002"),l.appendChild(k),n.appendChild(l));k=setting.presetFolders;l=[];for(var t={},r=0;r<k.length;t={$jscomp$loop$prop$folder$31:t.$jscomp$loop$prop$folder$31},r++){t.$jscomp$loop$prop$folder$31=k[r];var y=createDiv(),v=a.filter(function(w){return function(q){return 6<=q.length&&q[5]===w.$jscomp$loop$prop$folder$31.id}}(t)).length,u=createDiv("preset_container folder_header "+(0!==v||f?"":"d-none"));v&&(u.dataset.toggle=
"collapse",u.dataset.target="#folder"+t.$jscomp$loop$prop$folder$31.id);u.dataset.folderid=t.$jscomp$loop$prop$folder$31.id;var g=createDiv("d-flex my-auto ml-3 mr-2"),p=createDiv("preset_name align-self-center");p.innerHTML='<i class="fas fa-folder'+(v?"-open":" opacity4")+' mr-2 cur_move handle"></i>'+t.$jscomp$loop$prop$folder$31.name;g.appendChild(p);p=createDiv("ml-3 font_size_12 align-self-center font_color_half preset_count");p.textContent="( "+v+"\u4ef6 )";v&&g.appendChild(p);p=document.createElement("input");
p.type="text";p.maxLength=50;p.className="form-control form-control-sm preset_name_edit mb-1 mr-3 d-none";p.value=t.$jscomp$loop$prop$folder$31.name;g.appendChild(p);p=createDiv("d-flex ml-auto btns_container");var m=createDiv("ml-auto r_btn btn_commit_folder d-none");m.dataset.toggle="tooltip";m.dataset.offset="-50%";m.title="\u9078\u629e\u3057\u305f\u7de8\u6210\u3092\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u30fc\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002";m.innerHTML='<i class="fas fa-save"></i>';p.appendChild(m);
m=createDiv("ml-2 r_btn btn_rollback_folder d-none");m.dataset.toggle="tooltip";m.dataset.offset="-50%";m.title="\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u307e\u3059\u3002";m.innerHTML='<i class="fas fa-undo"></i>';p.appendChild(m);m=createDiv("ml-auto r_btn btn_add_preset");m.dataset.toggle="tooltip";m.dataset.offset="-50%";m.title="\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u30fc\u306b\u79fb\u52d5\u3055\u305b\u308b\u7de8\u6210\u3092\u4e00\u62ec\u3067\u9078\u629e\u3057\u307e\u3059\u3002";m.innerHTML='<i class="fas fa-folder-download"></i>';
p.appendChild(m);m=createDiv("ml-auto r_btn btn_commit d-none");m.dataset.toggle="tooltip";m.dataset.offset="-50%";m.title="\u7de8\u96c6\u5185\u5bb9\u3092\u78ba\u5b9a\u3057\u307e\u3059\u3002";m.innerHTML='<i class="fas fa-save"></i>';p.appendChild(m);m=createDiv("ml-2 r_btn btn_rollback d-none");m.dataset.toggle="tooltip";m.dataset.offset="-50%";m.title="\u7de8\u96c6\u5185\u5bb9\u3092\u53d6\u308a\u6d88\u3057\u307e\u3059\u3002";m.innerHTML='<i class="fas fa-undo"></i>';p.appendChild(m);m=createDiv("ml-2 r_btn btn_edit_start");
m.dataset.toggle="tooltip";m.dataset.offset="-50%";m.title="\u30d5\u30a9\u30eb\u30c0\u30fc\u540d\u306e\u5909\u66f4\u3092\u884c\u3044\u307e\u3059\u3002";m.innerHTML='<i class="fas fa-pencil"></i>';p.appendChild(m);g.appendChild(p);u.appendChild(g);g=document.createElement("div");g.id="folder"+t.$jscomp$loop$prop$folder$31.id;g.dataset.folderid=t.$jscomp$loop$prop$folder$31.id;g.className="folder_content pl-5";v&&(g.classList.add("collapse"),t.$jscomp$loop$prop$folder$31.isOpen&&g.classList.add("show"));
y.appendChild(g);l.push({id:t.$jscomp$loop$prop$folder$31.id,header:u,container:g})}f=createDiv("","preset_sortable_container");k={};t=$jscomp.makeIterator(a);for(r=t.next();!r.done;k={$jscomp$loop$prop$preset$33:k.$jscomp$loop$prop$preset$33},r=t.next())if(k.$jscomp$loop$prop$preset$33=r.value,k.$jscomp$loop$prop$preset$33[1]&&!(c&&e&&0>k.$jscomp$loop$prop$preset$33[1].indexOf(e))){r=createDiv();y=createDiv("preset_container");y.dataset.presetid=k.$jscomp$loop$prop$preset$33[0];c||(y.dataset.presetdata=
k.$jscomp$loop$prop$preset$33[2]);v=createDiv("preset_header "+(h?"sortable_handle":""));y.appendChild(v);v=createDiv("preset_body d-flex mx-2");u=createDiv("mr-2 preset_abstract flex-grow-1");u.appendChild(createDiv("preset_name","",k.$jscomp$loop$prop$preset$33[1]));g=document.createElement("input");g.type="text";g.maxLength=50;g.className="form-control form-control-sm preset_name_edit mb-1 d-none";g.value=k.$jscomp$loop$prop$preset$33[1];u.appendChild(g);m=decodePreset(k.$jscomp$loop$prop$preset$33[2])[1];
g=createDiv("d-flex ships flex-wrap");p=5;m.length&&6<=m[0].length&&2===m[0][5]&&(p=6);m=$jscomp.makeIterator(m);for(var B=m.next();!B.done;B=m.next()){B=B.value;if(g.childNodes.length>p)break;if(!(0>=B[0])){var C=document.createElement("img");C.className="ship_image";C.width=100;C.height=25;C.src="../img/ship/"+B[0]+".png";g.appendChild(C)}}u.appendChild(g);g=createDiv("preset_memo_view border mt-1 px-1 py-1 "+(k.$jscomp$loop$prop$preset$33[3]?"":"d-none"),"");g.innerHTML=AutoLink(k.$jscomp$loop$prop$preset$33[3]);
u.appendChild(g);g=document.createElement("textarea");g.className="form-control preset_memo mt-1 w-100 d-none";g.value=k.$jscomp$loop$prop$preset$33[3]?k.$jscomp$loop$prop$preset$33[3]:"";p=g.value.match(/\n/g);g.rows=p&&p.length?p.length+2:2;u.appendChild(g);v.appendChild(u);u=createDiv("d-flex ml-auto pt-2 btns_container");c?(g=createDiv("ml-auto r_btn btn_commit d-none"),g.dataset.toggle="tooltip",g.dataset.offset="-50%",g.title="\u7de8\u96c6\u5185\u5bb9\u3092\u78ba\u5b9a\u3057\u307e\u3059\u3002",
g.innerHTML='<i class="fas fa-save"></i>',u.appendChild(g),g=createDiv("ml-2 r_btn btn_rollback d-none"),g.dataset.toggle="tooltip",g.dataset.offset="-50%",g.title="\u7de8\u96c6\u5185\u5bb9\u3092\u53d6\u308a\u6d88\u3057\u307e\u3059\u3002",g.innerHTML='<i class="fas fa-undo"></i>',u.appendChild(g),g=createDiv("ml-auto r_btn btn_edit_start"),g.dataset.toggle="tooltip",g.dataset.offset="-50%",g.title="\u7de8\u6210\u540d\u3084\u7de8\u6210\u30e1\u30e2\u306e\u5909\u66f4\u3092\u884c\u3044\u307e\u3059\u3002",
g.innerHTML='<i class="fas fa-pencil"></i>',u.appendChild(g),g=createDiv("ml-2 r_btn btn_copy"),g.dataset.toggle="tooltip",g.dataset.offset="-50%",g.title="\u7de8\u6210\u3092\u8907\u88fd\u3057\u3066\u65b0\u3057\u3044\u7de8\u6210\u30bf\u30d6\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002",g.innerHTML='<i class="fas fa-copy"></i>',u.appendChild(g),g=createDiv("ml-2 r_btn btn_move_folder"),g.dataset.toggle="tooltip",g.dataset.offset="-50%",g.title="\u6240\u5c5e\u30d5\u30a9\u30eb\u30c0\u30fc\u3092\u5909\u66f4\u3057\u307e\u3059\u3002",
g.innerHTML='<i class="fas fa-folder-upload"></i>',u.appendChild(g),g=createDiv("ml-2 r_btn btn_delete"),g.dataset.toggle="tooltip",g.dataset.offset="-50%",g.title="\u7de8\u6210\u3092\u524a\u9664\u3057\u307e\u3059\u3002",g.innerHTML='<i class="fas fa-trash-o"></i>',u.appendChild(g)):(g=createDiv("ml-2 r_btn btn_open"),g.dataset.toggle="tooltip",g.dataset.offset="-50%",g.title="\u7de8\u6210\u3092\u5c55\u958b\u3057\u307e\u3059\u3002",g.innerHTML='<i class="fas fa-folder-open-o"></i>',u.appendChild(g));
v.appendChild(u);y.appendChild(v);c?(v=createDiv("update_date mr-1","","\u66f4\u65b0\u65e5\u6642: "+(k.$jscomp$loop$prop$preset$33[4]?k.$jscomp$loop$prop$preset$33[4].split(".")[0]:"-")),y.appendChild(v)):(v=createDiv("update_date mr-3","",(k.$jscomp$loop$prop$preset$33[5]?"\u4f5c\u6210\u8005: "+k.$jscomp$loop$prop$preset$33[5]+"\u3000":"")+" "+(k.$jscomp$loop$prop$preset$33[4]?k.$jscomp$loop$prop$preset$33[4].split(".")[0]:"-")),y.appendChild(v));r.appendChild(y);c&&6<=k.$jscomp$loop$prop$preset$33.length?
(y=l.find(function(w){return function(q){return q.id===w.$jscomp$loop$prop$preset$33[5]}}(k)))?y.container.appendChild(r):f.appendChild(r):f.appendChild(r)}n.appendChild(f);if(c){h=createDiv("","foldersParent");l=$jscomp.makeIterator(l);for(f=l.next();!f.done;f=l.next())f=f.value,k=createDiv(),k.appendChild(f.header),k.appendChild(f.container),h.appendChild(k);n.appendChild(h)}!c&&prevSnapShot&&(h=createDiv("d-flex preset_container more_load"),l=createDiv("mx-auto my-auto","","\u3082\u3063\u3068\u8aad\u307f\u8fbc\u3080"),
h.appendChild(l),n.appendChild(h));document.getElementById(b).innerHTML="";document.getElementById(b).appendChild(n);$("#"+b+" .r_btn").tooltip();if(0===d&&!e&&c)for(Sortable.create(document.getElementById("preset_sortable_container"),{animation:200,handle:".sortable_handle",onEnd:function(){for(var w=loadLocalStorage("presets"),q=[],z={},A=$jscomp.makeIterator(document.getElementsByClassName("preset_container")),x=A.next();!x.done;z={$jscomp$loop$prop$c$35:z.$jscomp$loop$prop$c$35},x=A.next())z.$jscomp$loop$prop$c$35=
x.value,(x=w.find(function(D){return function(E){return E[0]===D.$jscomp$loop$prop$c$35.dataset.presetid}}(z)))&&q.push(x);q.length&&(saveLocalStorage("presets",q),inform_success("\u7de8\u6210\u30c7\u30fc\u30bf\u306e\u9806\u5e8f\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002"))}}),b=setting.presetFolders,d=0;d<b.length;d++)Sortable.create(document.getElementById("folder"+b[d].id),{animation:200,handle:".sortable_handle",onEnd:function(){for(var w=loadLocalStorage("presets"),q=[],z={},A=$jscomp.makeIterator(document.getElementsByClassName("preset_container")),
x=A.next();!x.done;z={$jscomp$loop$prop$c$37:z.$jscomp$loop$prop$c$37},x=A.next())z.$jscomp$loop$prop$c$37=x.value,(x=w.find(function(D){return function(E){return E[0]===D.$jscomp$loop$prop$c$37.dataset.presetid}}(z)))&&q.push(x);q.length&&(saveLocalStorage("presets",q),inform_success("\u7de8\u6210\u30c7\u30fc\u30bf\u306e\u9806\u5e8f\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002"))}});c&&document.getElementById("foldersParent")&&Sortable.create(document.getElementById("foldersParent"),{animation:200,
handle:".handle",onEnd:function(){for(var w=setting.presetFolders,q=[],z={},A=$jscomp.makeIterator(document.getElementsByClassName("folder_header")),x=A.next();!x.done;z={$jscomp$loop$prop$c$39:z.$jscomp$loop$prop$c$39},x=A.next())z.$jscomp$loop$prop$c$39=x.value,(x=w.find(function(D){return function(E){return E.id===castInt(D.$jscomp$loop$prop$c$39.dataset.folderid)}}(z)))&&q.push(x);q.length&&(setting.presetFolders=q,saveSetting(),inform_success("\u30d5\u30a9\u30eb\u30c0\u30fc\u306e\u9806\u5e8f\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002"))}})}
function map_select_Changed(){var a=castInt($("#map_select").val());$("#btn_search_preset").prop("disabled",!1);$("#presets_order").removeClass("d-none");400<a?($("#select_preset_level").parent().removeClass("d-none"),$("#select_preset_level").val(4)):0===a?($("#presets_order").val(1),$("#presets_order").change(),$("#presets_order").addClass("d-none")):($("#select_preset_level").parent().addClass("d-none"),$("#select_preset_level").val(0))}var prevSnapShot=null,STEP=20;
function searchUploadedPreset(){var a=getPublicPresetsQuery(),c=[];fb||initializeFB();if(fb){var b=null;b=a.map?fb.collection("presets").where("map","==",a.map).where("level","==",a.level).orderBy(a.sortKey,a.order).limit(STEP):fb.collection("presets").orderBy(a.sortKey,a.order).limit(STEP);b.get().then(function(d){prevSnapShot=d.docs[d.docs.length-1];d.forEach(function(e){var f=e.data();e=e.data().createdAt?e.data().createdAt.toDate():new Date;e=["",f.name+(0===a.map&&0<f.level?"\u3010"+DIFFICULTY.find(function(h){return h.id===
f.level}).name+"\u3011":""),f.data,f.memo,formatDate(e,"yyyy/MM/dd HH:mm"),f.user];c.push(e)});if(c.length<STEP||!a.map)prevSnapShot=null;setPresets(c,!1);saveSessionStorage("search_result",{map:a.map,level:a.level,sortKey:a.sortKey,order:a.order,presets:c})})["catch"](function(d){console.error(d);inform_danger("\u7de8\u6210\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")})}}
function getPublicPresetsQuery(){$("#btn_search_preset").prop("disabled",!0);var a=castInt($("#map_select").val()),c=400<a?castInt($("#select_preset_level").val()):0,b="createdAt",d="desc";switch(castInt(document.getElementById("presets_order").value)){case 2:d="asc";break;case 3:b="name";break;case 4:b="name",d="asc"}return{map:a,level:c,sortKey:b,order:d}}
function more_load_presets(){var a=$(".more_load");a.html('<div class="w-100 text-center py-3"><div class="spinner-border" role="status"><span class="sr-only"></span></div></div>');a.removeClass("more_load");var c=getPublicPresetsQuery();if((a=loadSessionStorage("search_result"))&&prevSnapShot)if(a.map!==c.map||a.level!==c.level||a.sortKey!==c.sortKey||a.order!==c.order)searchUploadedPreset();else{var b=a.presets;fb||initializeFB();fb&&fb.collection("presets").where("map","==",c.map).where("level",
"==",c.level).orderBy(c.sortKey,c.order).startAfter(prevSnapShot).limit(STEP).get().then(function(d){prevSnapShot=d.docs[d.docs.length-1];d.forEach(function(e){var f=e.data();e=e.data().createdAt?e.data().createdAt.toDate():new Date;f=["",f.name,f.data,f.memo,formatDate(e,"yyyy/MM/dd HH:mm"),f.user];b.push(f)});d.docs.length<STEP&&(prevSnapShot=null);setPresets(b,!1);saveSessionStorage("search_result",{map:c.map,level:c.level,sortKey:c.sortKey,order:c.order,presets:b})})["catch"](function(d){console.error(d);
inform_danger("\u7de8\u6210\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")})}else searchUploadedPreset()}
function btn_add_preset_Clicked(a,c){c.stopPropagation();var b=a.closest(".preset_container");b.find(".btn_edit_start").addClass("d-none");b.find(".btn_add_preset").addClass("d-none");b.find(".btn_commit_folder").removeClass("d-none");b.find(".btn_rollback_folder").removeClass("d-none");$(".preset_container:not(.folder_header)").addClass("folder_selectable");$(".btns_container").addClass("d-none").removeClass("d-flex");b.find(".btns_container").removeClass("d-none").addClass("d-flex");inform_success("\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u79fb\u52d5\u3055\u305b\u308b\u7de8\u6210\u3092\u9078\u629e\u3057\u3001\u4fdd\u5b58\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}
function btn_commit_folder_Clicked(a,c){c.stopPropagation();var b=a.closest(".preset_container");b.find(".btn_commit_folder").tooltip("hide");var d=castInt(b[0].dataset.folderid);if(b=setting.presetFolders.find(function(f){return f.id===d})){var e=loadLocalStorage("presets");$(".folder_selectable.selected").each(function(f,h){var n=$(h)[0].dataset.presetid,l=e?e.find(function(k){return k[0]===n}):null;l&&6<=l.length?l[5]=d:l&&5===l.length&&l.push(d)});saveLocalStorage("presets",e);setLocalPresets();
inform_success("\u9078\u629e\u3055\u308c\u305f\u7de8\u6210\u3092\u30d5\u30a9\u30eb\u30c0\u30fc\u300e"+b.name+"\u300f\u306b\u79fb\u52d5\u3057\u307e\u3057\u305f\u3002")}else inform_danger("\u30d5\u30a9\u30eb\u30c0\u30fc\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002"),btn_rollback_folder_Clicked(a,c)}
function btn_rollback_folder_Clicked(a,c){c.stopPropagation();var b=a.closest(".preset_container");b.find(".btn_edit_start").removeClass("d-none");b.find(".btn_add_preset").removeClass("d-none");b.find(".btn_commit_folder").addClass("d-none");b.find(".btn_rollback_folder").addClass("d-none");$(".folder_selectable").removeClass("folder_selectable");$(".btns_container").removeClass("d-none").addClass("d-flex")}
function folder_selectable_Clicked(a){a.hasClass("selected")?a.removeClass("selected"):a.addClass("selected")}function folder_content_Show(a){var c=castInt(a[0].dataset.folderid);if(a=setting.presetFolders.find(function(b){return b.id===c}))a.isOpen=!0,saveSetting()}function folder_content_Hide(a){var c=castInt(a[0].dataset.folderid);if(a=setting.presetFolders.find(function(b){return b.id===c}))a.isOpen=!1,saveSetting()}
function btn_edit_start_Clicked(a,c){c.stopPropagation();$(".preset_container.editting").each(function(d,e){btn_rollback_Clicked($(e).find(".btn_rollback"));inform_warning($(e).find(".preset_name").text()+"\u306e\u7de8\u96c6\u306f\u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u307e\u3057\u305f\u3002")});var b=a.closest(".preset_container");b.addClass("editting");b.removeClass("sortable_handle");b.find(".preset_name").addClass("d-none");b.find(".preset_count").addClass("d-none");b.find(".preset_name_edit").removeClass("d-none");
b.find(".preset_memo").removeClass("d-none");b.find(".preset_memo_view").addClass("d-none");b.find(".btn_commit").removeClass("d-none");b.find(".btn_rollback").removeClass("d-none");b.find(".btn_copy").addClass("d-none");b.find(".btn_move_folder").addClass("d-none");b.find(".btn_edit_start").addClass("d-none");b.find(".btn_add_preset").addClass("d-none")}
function btn_rollback_Clicked(a,c){(c=void 0===c?null:c)&&c.stopPropagation();var b=a.closest(".preset_container");b.find(".preset_name").removeClass("d-none");b.find(".preset_count").removeClass("d-none");b.find(".preset_name_edit").addClass("d-none");b.find(".preset_memo").addClass("d-none");b.find(".preset_memo_view").text()&&b.find(".preset_memo_view").removeClass("d-none");b.find(".btn_commit").addClass("d-none");b.find(".btn_rollback").addClass("d-none");b.find(".btn_copy").removeClass("d-none");
b.find(".btn_move_folder").removeClass("d-none");b.find(".btn_edit_start").removeClass("d-none");b.find(".btn_add_preset").removeClass("d-none");b.removeClass("editting");b.addClass("sortable_handle")}
function btn_commit_Clicked(a,c){c=void 0===c?null:c;var b=a.closest(".preset_container");if(b.hasClass("folder_header")){var d=setting.presetFolders,e=castInt(b[0].dataset.folderid),f=d.findIndex(function(k){return k.id===e});if(0<=f){var h=b.find(".preset_name_edit").val().trim();80<h.length&&(h=h.slice(0,80),b.find(".preset_name_edit").val(h));b.find(".preset_name").find(".fas").hasClass("opacity4")?b.find(".preset_name").html('<i class="fas fa-folder mr-2 opacity4"></i>'+h):b.find(".preset_name").html('<i class="fas fa-folder-open mr-2"></i>'+
h);d[f].name=h;saveSetting();inform_success("\u30d5\u30a9\u30eb\u30c0\u540d\u306e\u66f4\u65b0\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002")}}else{var n=b[0].dataset.presetid;(d=loadLocalStorage("presets"))||(d=[]);f=d.findIndex(function(k){return k[0]===n});if(0<=f){h=b.find(".preset_name_edit").val().trim();var l=b.find(".preset_memo").val().trim();h&&(50<h.length&&(h=h.slice(0,50),b.find(".preset_name_edit").val(h)),d[f][1]=h,b.find(".preset_name").text(h));400<l.length&&(l=l.slice(0,400),b.find(".preset_memo").val(l));
d[f][3]=l;f=l.replace(/\r?\n/g," ");b.find(".preset_memo_view").text(f);f.trim().length?b.find(".preset_memo_view").removeClass("d-none"):b.find(".preset_memo_view").addClass("d-none");saveLocalStorage("presets",d);inform_success("\u7de8\u6210\u60c5\u5831\u306e\u66f4\u65b0\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002")}}btn_rollback_Clicked(a,c);setTab();$(".fleet_tab.active").removeClass("active")}
function btn_delete_Clicked(a,c){c.stopPropagation();var b=$("#modal_confirm");b.find(".modal-body").html('<div class="mt-2">\u7de8\u6210\u3092\u524a\u9664\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f</div>');b[0].dataset.target=a.closest(".preset_container")[0].dataset.presetid;confirmType="deletePreset";b.modal("show")}
function preset_Clicked(a){var c=loadLocalStorage("presets"),b=a[0].dataset.presetid;c=c?c.find(function(e){return e[0]===b}):null;var d={id:getUniqueId(),name:getMaxUntitled(),history:{index:0,histories:["Noi6BpgWgRnX4wtOC2o6ZzgAZL6HhG4QBEZ4ccpEcAZgIYA2AzgKaR7E8kQDMxLEA"]},memo:""};c&&(d.id=c[0],d.name=a.find(".preset_name").text(),d.history.histories[0]=c[2],d.memo=c[3]);(a=loadLocalStorage("activePresets"))||(a={activeId:"",presets:[]});(c=a.presets.find(function(e){return e.id===d.id}))?d=c:a.presets.push(d);
a.activeId=d.id;saveLocalStorage("activePresets",a);window.location.href="../simulator/?p="+d.history.histories[d.history.index]}
function public_preset_Clicked(a){var c=a.closest(".preset_container");a=c[0].dataset.presetdata;var b=c.find(".preset_name").text();c={id:getUniqueId(),name:b,history:{index:0,histories:[a]},memo:c.find(".preset_memo").val()};(b=loadLocalStorage("activePresets"))||(b={activeId:"",presets:[]});b.presets.push(c);b.activeId=c.id;saveLocalStorage("activePresets",b);window.location.href="../simulator/?p="+a}
function btn_copy_Clicked(a,c){c.stopPropagation();var b=loadLocalStorage("presets"),d=a.closest(".preset_container")[0].dataset.presetid;if(b=b?b.find(function(f){return f[0]===d}):null){b={id:getUniqueId(),name:b[1]+"_\u30b3\u30d4\u30fc",history:{index:0,histories:[b[2]]},memo:b[3]};var e=loadLocalStorage("activePresets");e||(e={activeId:"",presets:[]});e.presets.push(b);e.activeId=b.id;saveLocalStorage("activePresets",e);window.location.href="../simulator/?p="+b.history.histories[b.history.index]}else inform_danger("\u8907\u88fd\u5bfe\u8c61\u306e\u7de8\u6210\u30c7\u30fc\u30bf\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}
function btn_move_folder_Clicked(a,c){c.stopPropagation();var b=loadLocalStorage("presets"),d=a.closest(".preset_container")[0].dataset.presetid;if(b=b?b.find(function(n){return n[0]===d}):null){for(var e='<option value="0">\u6307\u5b9a\u306a\u3057</option>',f=$jscomp.makeIterator(setting.presetFolders),h=f.next();!h.done;h=f.next())h=h.value,e+='<option value="'+h.id+'">'+h.name+"</option>";$("#preset_folder").html(e);$("#modal_folder_confirm")[0].dataset.target=b[0];$("#modal_folder_confirm").modal("show")}else inform_danger("\u79fb\u52d5\u5bfe\u8c61\u306e\u30d7\u30ea\u30bb\u30c3\u30c8\u30c7\u30fc\u30bf\u304c\u8aad\u307f\u8fbc\u3081\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}
function modal_folder_confirm_ok_Clicked(){var a=loadLocalStorage("presets"),c=$("#modal_folder_confirm")[0].dataset.target,b=a?a.find(function(f){return f[0]===c}):null;if(b){var d=castInt($("#preset_folder").val()),e=setting.presetFolders.find(function(f){return f.id===d});6<=b.length?b[5]=d:5===b.length&&b.push(d);saveLocalStorage("presets",a);inform_success("\u30d7\u30ea\u30bb\u30c3\u30c8\u300e"+b[1]+"\u300f\u3092\u30d5\u30a9\u30eb\u30c0\u30fc\u300e"+(e?e.name:"\u672a\u6307\u5b9a")+"\u300f\u306b\u79fb\u52d5\u3057\u307e\u3057\u305f");
setLocalPresets()}else inform_danger("\u79fb\u52d5\u5bfe\u8c61\u306e\u30d7\u30ea\u30bb\u30c3\u30c8\u30c7\u30fc\u30bf\u304c\u8aad\u307f\u8fbc\u3081\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}function topTab_Clicked(){var a=getActivePreset();a.id?window.location.href="../simulator/?p="+a.history.histories[a.history.index]:preset_Clicked($("#add_new_tab"))}
function version_detail_Clicked(){if(!document.getElementById("version_inform_body").innerHTML){for(var a=CHANGE_LOG.find(function(l){return l.id===LATEST_VERSION}),c=document.createDocumentFragment(),b=$jscomp.makeIterator(a.changes),d=b.next();!d.done;d=b.next()){d=d.value;var e=createDiv("mt-3"),f=document.createElement("div"),h=document.createElement("span");h.className="mr-1 pt-1 badge badge-pill badge-"+(0===d.type?"success":1===d.type?"info":"danger");h.textContent=0===d.type?"\u65b0\u898f":
1===d.type?"\u5909\u66f4":"\u4fee\u6b63";var n=document.createElement("span");n.innerHTML=d.title;f.appendChild(h);f.appendChild(n);e.appendChild(f);d.content&&(f=createDiv("font_size_12 pl-3"),f.innerHTML=d.content,e.appendChild(f));c.appendChild(e)}document.getElementById("version").textContent=a.id;document.getElementById("version_inform_body").appendChild(c);setting.version=a.id;saveSetting();document.getElementsByClassName("version_detail")[0].classList.remove("unread")}$("#modal_version_inform").modal("show")}
function loadSiteHistory(){if(!document.getElementById("site_history_body").innerHTML){for(var a=document.createDocumentFragment(),c=0,b=LATEST_VERSION,d=$jscomp.makeIterator(CHANGE_LOG),e=d.next();!e.done;e=d.next()){e=e.value;var f=createDiv("my-3 ver_log border-bottom"),h=createDiv("py-2","","v"+e.id);if(b===e.id){var n=document.createElement("span");n.className="ml-2 pt-1 badge badge-pill badge-danger";n.textContent="New";h.appendChild(n)}f.appendChild(h);for(h=0;h<e.changes.length;h++){n=e.changes[h];
var l="log_"+c++ +"_"+h,k=document.createElement("div");k.className="py-2 px-2 d-flex collapsed history_item history_item_no_content";var t=document.createElement("div");t.className="d-flex flex-nowrap align-self-center";var r=document.createElement("div");r.className="align-self-center";var y=document.createElement("span");y.className="mr-2 pt-1 badge badge-pill badge-"+(0===n.type?"success":1===n.type?"info":"danger");y.textContent=0===n.type?"\u65b0\u898f":1===n.type?"\u5909\u66f4":"\u4fee\u6b63";
var v=document.createElement("div");v.className="align-self-center";v.innerHTML=n.title;r.appendChild(y);t.appendChild(r);t.appendChild(v);k.appendChild(t);f.appendChild(k);n.content&&(k.dataset.toggle="collapse",k.dataset.target="#"+l,k.classList.remove("history_item_no_content"),k=document.createElement("div"),k.id=l,k.className="border-top collapse history_content",l=document.createElement("div"),l.className="pl-3 py-2 font_size_12",l.innerHTML=n.content,k.appendChild(l),f.appendChild(k));a.appendChild(f)}}c=
document.createElement("div");c.className="mt-2 font_size_12";c.textContent=LAST_UPDATE_DATE;a.appendChild(c);document.getElementById("site_history_body").appendChild(a)}}
function modal_confirm_ok_Clicked(){var a=$("#modal_confirm");if("deletePreset"===confirmType){var c=loadLocalStorage("presets");c=c.filter(function(b){return b[0]!==a[0].dataset.target});saveLocalStorage("presets",c);c=loadLocalStorage("activePresets");c.presets=c.presets.filter(function(b){return b.id!==a[0].dataset.target});saveLocalStorage("activePresets",c);setLocalPresets();inform_success("\u524a\u9664\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002");setTab();a.modal("hide")}else"deleteLocalStorageAll"===
confirmType?(window.localStorage.clear(),setLocalPresets(),setTab(),window.localStorage.clear(),a.modal("hide")):"sendComment"===confirmType&&(send_comment(),a.modal("hide"));$(".fleet_tab.active").removeClass("active")}function first_time_Clicked(){$("#abstract").collapse("show");setTimeout(function(){$("body,html").animate({scrollTop:$("#first_time").offset().top-80},300,"swing")},200);return!1}
function site_manual_Clicked(){$("#abstract").collapse("show");setTimeout(function(){$("body,html").animate({scrollTop:$("#manual").offset().top-80},300,"swing")},200);return!1}
function initializeBoard(){fb||initializeFB();if(fb)fb.collection("comments").orderBy("createdAt","desc").limit(30).onSnapshot(function(a){var c=document.createDocumentFragment();a.forEach(function(b){var d=document.createElement("div");d.className="general_box my-3 px-3 pt-3 pb-1 comment";var e=document.createElement("div");e.className="d-flex mb-1";var f=document.createElement("div");f.className="comment_index text-primary";f.dataset.number=b.data().number;f.textContent=b.data().number+":";var h=
document.createElement("div");h.className="comment_writer ml-1 mr-2";h.textContent=b.data().author;var n=b.data().createdAt?b.data().createdAt.toDate():new Date,l=document.createElement("div");l.className="comment_date opacity6 font_size_11 align-self-center";l.textContent=" -- "+formatDate(n,"yyyy/MM/dd HH:mm:ss");e.appendChild(f);e.appendChild(h);e.appendChild(l);f=new Date;f.setDate(f.getDate()-7);n>f&&(f.setDate(f.getDate()+4),h=document.createElement("div"),h.className="font_size_11 align-self-center ml-1 "+
(n>f?"text-danger":"text-success"),h.textContent="New",e.appendChild(h));n=document.createElement("div");n.className="comment_content align-self-center";n.textContent=b.data().content;d.appendChild(e);d.appendChild(n);c.appendChild(d)});document.getElementById("coment_board").innerHTML="";document.getElementById("coment_board").appendChild(c)});comment_text_Changed()}
function comment_index_Clicked(a){a=castInt(a[0].dataset.number);document.getElementById("comment_text").value.trim().length?document.getElementById("comment_text").value+=">>"+a+"\n":document.getElementById("comment_text").value=">>"+a+"\n";setTimeout(function(){$("body,html").animate({scrollTop:$("#comments").offset().top-20},20,"swing")},20);document.getElementById("comment_text").focus()}
function comment_text_Changed(){var a=document.getElementById("comment_author"),c=document.getElementById("comment_text"),b=c.value,d=b.match(/\n/g),e=!0;"noro"===a.value.trim()?(document.getElementById("author_validate").textContent="\u4f7f\u7528\u3067\u304d\u306a\u3044\u540d\u524d\u3067\u3059\u3002",a.classList.add("is-invalid"),e=!1):20<a.value.trim().length?(document.getElementById("author_validate").textContent="20\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u4e0b\u3055\u3044\u3002",
a.classList.add("is-invalid"),e=!1):a.classList.remove("is-invalid");0===b.trim().length?(document.getElementById("comment_validate").textContent="",c.classList.remove("is-invalid"),e=!1):1E3<b.length?(document.getElementById("comment_validate").textContent="1000\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",c.classList.add("is-invalid"),e=!1):d&&15<=d.length?(document.getElementById("comment_validate").textContent="\u898f\u5b9a\u884c\u6570\u3092\u8d85\u3048\u307e\u3057\u305f\u3002\u884c\u6570\u3092\u6e1b\u3089\u3057\u3066\u4e0b\u3055\u3044\u3002",
c.classList.add("is-invalid"),e=!1):c.classList.remove("is-invalid");document.getElementById("btn_send_comment").disabled=!e;e&&(a.classList.remove("is-invalid"),c.classList.remove("is-invalid"))}
function btn_send_comment_Clicked(){var a=$("#modal_confirm");a.find(".modal-body").html('\n\t\t<div>\u30b3\u30e1\u30f3\u30c8\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002</div>\n\t\t<div class="mt-3 font_size_12">\u30fb\u516c\u5e8f\u826f\u4fd7\u306b\u53cd\u3059\u308b\u66f8\u304d\u8fbc\u307f\u306f\u3054\u9060\u616e\u304f\u3060\u3055\u3044\u3002</div>\n\t\t<div class="font_size_12">\u30fb\u9001\u4fe1\u3057\u305f\u5185\u5bb9\u306f\u3001\u539f\u5247\u3042\u3068\u304b\u3089\u5909\u66f4/\u524a\u9664\u306f\u3067\u304d\u307e\u305b\u3093\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002</div>\n\t\t<div class="font_size_12">\u30fb\u3069\u3046\u3057\u3066\u3082\u5909\u66f4\u30fb\u524a\u9664\u3057\u305f\u3044\u5834\u5408\u306f\u3054\u9023\u7d61\u304f\u3060\u3055\u3044\u3002</div>\n\t\t<div class="mt-3">\u3088\u308d\u3057\u3051\u308c\u3070\u3001OK\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002</div>\n\t');confirmType=
"sendComment";a.modal("show")}
function send_comment(){if(fb){var a=document.getElementById("comment_author").value.trim(),c=document.getElementById("comment_text").value.trim();a||(a="\u540d\u7121\u3057\u3055\u3093");fb.runTransaction(function(b){var d=fb.collection("comments"),e=d.doc();return b.get(e).then(function(){var f,h,n;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){switch(l.nextAddress){case 1:return l.yield(d.orderBy("createdAt","desc").limit(1).get(),2);case 2:f=l.yieldResult;if(!f){l.jumpTo(0);break}h=
0;return l.yield(Promise.all(f.docs.map(function(k){var t;return $jscomp.asyncExecutePromiseGeneratorProgram(function(r){if(1==r.nextAddress)return r.yield(k.data(),2);if(3!=r.nextAddress)return t=r.yieldResult,r.yield(t.number,3);h=r.yieldResult;r.jumpToEnd()})})),4);case 4:if(!(0<=castInt(h,-1)))return l["return"](Promise.reject("ID\u63a1\u756a\u30a8\u30e9\u30fc :",h));n={number:castInt(h)+1,author:a,content:c,createdAt:firebase.firestore.FieldValue.serverTimestamp()};return l.yield(b.set(e,n),
6);case 6:return l["return"](n)}})})}).then(function(b){document.getElementById("comment_text").value="";document.getElementById("btn_send_comment").disabled=!0})["catch"](function(b){console.error(b);alert("\u30b3\u30e1\u30f3\u30c8\u306e\u6295\u7a3f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002")})}else alert("\u8b0e\u306e\u7406\u7531\u306b\u3088\u308a\u3001\u30b3\u30e1\u30f3\u30c8\u306e\u6295\u7a3f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}
function btn_url_shorten_Clicked(){var a,c,b,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress){a=document.getElementById("btn_url_shorten");c=document.getElementById("input_url");b=c.value.trim();if(a.classList.contains("shortening"))return e["return"]();a.classList.add("shortening");a.textContent="\u77ed\u7e2e\u4e2d";return b?b.match(/^(https?|ftp)(:\/\/[-_.!~*'()a-zA-Z0-9;\/?:@&=+\$,%#]+)$/)?b.match(/^(https:\/\/aircalc.page.link\/)([.!~*'()a-zA-Z0-9;\/?:@&=+\$,%#]+)$/)?
e.jumpTo(2):e.yield(postURLData(b).then(function(f){f.error||!f.shortLink?(c.value="",inform_danger("\u5165\u529b\u3055\u308c\u305fURL\u306e\u77ed\u7e2e\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")):(c.value=f.shortLink,inform_success("URL\u306e\u77ed\u7e2e\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002"))})["catch"](function(f){c.value="";inform_danger("\u5165\u529b\u5024\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}),2):(c.value="",(d=readDeckBuilder(b))?
window.location.href="../simulator/?predeck="+b:readEquipmentJson(b)?inform_success("\u6240\u6301\u88c5\u5099\u306e\u53cd\u6620\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002"):readShipJson(b)?inform_success("\u6240\u6301\u8266\u5a18\u306e\u53cd\u6620\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002"):readKantaiBunsekiJson(b)?inform_success("\u6240\u6301\u8266\u5a18\u306e\u53cd\u6620\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002"):inform_danger("\u5165\u529b\u5024\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002"),
e.jumpTo(2)):(c.value="",inform_warning("URL\u3084\u30c7\u30c3\u30ad\u30d3\u30eb\u30c0\u30fc\u5f62\u5f0f\u306e\u6587\u5b57\u5217\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.jumpTo(2))}a.textContent="URL\u77ed\u7e2e";a.classList.remove("shortening");e.jumpToEnd()})}
function public_preset_tab_Shown(){$("#btn_search_preset").parent().removeClass("d-none");$("#map_select").parent().removeClass("d-none");$("#search_preset_parent").addClass("d-none");$("#empty_folder_visible_parent").addClass("d-none");0===castInt($("#presets_order").val())&&($("#presets_order").val(1),$("#presets_order").change(),$("#presets_order").addClass("d-none"));$("#presets_order").find('option[value="0"]').prop("disabled",!0);saveSessionStorage("display_public",!0);if(!$("#map_select").html()){for(var a=
'<option value="0">\u5168\u3066\u306e\u6d77\u57df\uff08\u6700\u65b0\u306e20\u4ef6\uff09</option>',c={},b=$jscomp.makeIterator(WORLD_DATA),d=b.next();!d.done;c={$jscomp$loop$prop$world$41:c.$jscomp$loop$prop$world$41},d=b.next()){d=d.value;c.$jscomp$loop$prop$world$41=d.world;var e=MAP_DATA.filter(function(f){return function(h){return Math.floor(h.area/10)===f.$jscomp$loop$prop$world$41}}(c));a+='<optgroup label="'+d.name+'">';d=$jscomp.makeIterator(e);for(e=d.next();!e.done;e=d.next())e=e.value,a+=
'<option value="'+e.area+'">'+(20<c.$jscomp$loop$prop$world$41?"E":c.$jscomp$loop$prop$world$41)+"-"+e.area%10+" : "+e.name+"</option>"}$("#map_select").html(a);if(a=loadSessionStorage("search_result"))$("#map_select").val(a.map),setPresets(a.presets,!1)}map_select_Changed()}
function public_preset_tab_Hidden(){$("#btn_search_preset").parent().addClass("d-none");$("#map_select").parent().addClass("d-none");$("#search_preset_parent").removeClass("d-none");$("#empty_folder_visible_parent").removeClass("d-none");$("#presets_order").find('option[value="0"]').prop("disabled",!1);$("#presets_order").removeClass("d-none");saveSessionStorage("display_public",!1)}
function site_theme_Changed(a){a=a.attr("id");document.body.classList.remove(setting.themeColor);document.body.classList.add(a);"dark_theme"===a||"dark_gradient_theme"===a||"deep_blue_theme"===a?(mainColor="#e0e0e0",document.body.classList.add("dark-theme")):(mainColor="#000000",document.body.classList.remove("dark-theme"));document.getElementById("input_url").classList.add("form-control-dark");setting.themeColor=a;saveSetting();document.body.style.color=mainColor}
function confirm_tab_close_Clicked(){setting.confirmTabClosing=document.getElementById("confirm_tab_close").checked;saveSetting()}
document.addEventListener("DOMContentLoaded",function(){initialize();document.getElementById("btn_top").addEventListener("click",function(){window.location.href="../list/"});$("#header").on("click",".fleet_tab",topTab_Clicked);$("#main").on("click",".version_detail",version_detail_Clicked);$("#main").on("click",".btn_first_time",first_time_Clicked);$("#main").on("click",".btn_site_manual",site_manual_Clicked);$("#main").on("click",".theme_select",function(){site_theme_Changed($(this))});$("#main").on("input",
"#search_preset",setLocalPresets);$("#main").on("change","#presets_order",setLocalPresets);$("#main").on("click","#btn_search_preset",searchUploadedPreset);$("#main").on("change","#map_select",map_select_Changed);$("#main").on("click","#empty_folder_visible",setLocalPresets);$("#main").on("change","#select_preset_level",function(){$("#btn_search_preset").prop("disabled",!1)});$("#public_presets_container").on("click",".preset_container .btn_open",function(){public_preset_Clicked($(this))});$("#public_presets_container").on("click",
".preset_container.more_load",more_load_presets);$("#presets_container").on("click",".preset_container:not(.editting, .folder_header, .folder_selectable)",function(){preset_Clicked($(this))});$("#presets_container").on("click",".btn_edit_start",function(a){btn_edit_start_Clicked($(this),a)});$("#presets_container").on("click",".btn_commit",function(a){btn_commit_Clicked($(this),a)});$("#presets_container").on("click",".btn_rollback",function(a){btn_rollback_Clicked($(this),a)});$("#presets_container").on("click",
".btn_copy",function(a){btn_copy_Clicked($(this),a)});$("#presets_container").on("click",".btn_move_folder",function(a){btn_move_folder_Clicked($(this),a)});$("#presets_container").on("click",".btn_delete",function(a){btn_delete_Clicked($(this),a)});$("#presets_container").on("click",".folder_header.editting",function(a){a.stopPropagation()});$("#presets_container").on("click",".btn_add_preset",function(a){btn_add_preset_Clicked($(this),a)});$("#presets_container").on("click",".btn_commit_folder",
function(a){btn_commit_folder_Clicked($(this),a)});$("#presets_container").on("click",".btn_rollback_folder",function(a){btn_rollback_folder_Clicked($(this),a)});$("#presets_container").on("click",".preset_container.folder_selectable",function(){folder_selectable_Clicked($(this))});$("#public_preset_tab").on("shown.bs.tab",public_preset_tab_Shown);$("#public_preset_tab").on("hidden.bs.tab",public_preset_tab_Hidden);$("#site_history").on("show.bs.collapse",".collapse",loadSiteHistory);$("#site_board").on("show.bs.collapse",
".collapse",initializeBoard);$("#site_board").on("click","#btn_send_comment",btn_send_comment_Clicked);$("#site_board").on("input","#comment_author",comment_text_Changed);$("#site_board").on("input","#comment_text",comment_text_Changed);$("#site_board").on("click",".comment_index",function(){comment_index_Clicked($(this))});$("#config_content").on("click","#confirm_tab_close",confirm_tab_close_Clicked);$("#config_content").on("click","#btn_reset_localStorage",btn_reset_localStorage_Clicked);$("#btn_url_shorten").click(btn_url_shorten_Clicked);
$("#modal_confirm").on("click",".btn_ok",modal_confirm_ok_Clicked);$("#modal_folder_confirm").on("click",".btn_ok",modal_folder_confirm_ok_Clicked)});