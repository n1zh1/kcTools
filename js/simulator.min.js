var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};
$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(c=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+c+"$"+e),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:b})))};
$jscomp.getConstructImplementation=function(){function a(){function c(){}new c;Reflect.construct(c,[],function(){});return new c instanceof c}if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(a())return Reflect.construct;var b=Reflect.construct;return function(c,d,e){c=b(c,d);e&&Reflect.setPrototypeOf(c,e.prototype);return c}}return function(c,d,e){void 0===e&&(e=c);e=$jscomp.objectCreate(e.prototype||Object.prototype);return Function.prototype.apply.call(c,e,d)||
e}};$jscomp.construct={valueOf:$jscomp.getConstructImplementation}.valueOf();$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(c){return{value:c,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var d=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(d);if(!d.done)return this.context_.stop_(),d;var e=d.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&a.prototype&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,e){function f(g){g.done?d(g.value):Promise.resolve(g.value).then(b,c).then(f,e)}f(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
$jscomp.polyfill("Reflect",function(a){return a?a:{}},"es6","es3");$jscomp.polyfill("Reflect.construct",function(a){return $jscomp.construct},"es6","es3");$jscomp.polyfill("Reflect.setPrototypeOf",function(a){if(a)return a;if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;return function(c,d){try{return b(c,d),!0}catch(e){return!1}}}return null},"es6","es5");$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(f,g){this.$jscomp$symbol$id_=f;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",d=0,e=function(f){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new b(c+(f||"")+"_"+d++,f)};return e},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(g){return g instanceof e?g:new e(function(h,l){h(g)})}if(a&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return a;b.prototype.asyncExecute=function(g){if(null==this.batch_){this.batch_=[];var h=this;this.asyncExecuteFunction(function(){h.executeBatch_()})}this.batch_.push(g)};
var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(g){d(g,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var g=this.batch_;this.batch_=[];for(var h=0;h<g.length;++h){var l=g[h];g[h]=null;try{l()}catch(k){this.asyncThrow_(k)}}}this.batch_=null};b.prototype.asyncThrow_=function(g){this.asyncExecuteFunction(function(){throw g;})};var e=function(g){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=!1;var h=this.createResolveAndReject_();
try{g(h.resolve,h.reject)}catch(l){h.reject(l)}};e.prototype.createResolveAndReject_=function(){function g(k){return function(n){l||(l=!0,k.call(h,n))}}var h=this,l=!1;return{resolve:g(this.resolveTo_),reject:g(this.reject_)}};e.prototype.resolveTo_=function(g){if(g===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(g instanceof e)this.settleSameAsPromise_(g);else{a:switch(typeof g){case "object":var h=null!=g;break a;case "function":h=!0;break a;default:h=!1}h?this.resolveToNonPromiseObj_(g):
this.fulfill_(g)}};e.prototype.resolveToNonPromiseObj_=function(g){var h=void 0;try{h=g.then}catch(l){this.reject_(l);return}"function"==typeof h?this.settleSameAsThenable_(h,g):this.fulfill_(g)};e.prototype.reject_=function(g){this.settle_(2,g)};e.prototype.fulfill_=function(g){this.settle_(1,g)};e.prototype.settle_=function(g,h){if(0!=this.state_)throw Error("Cannot settle("+g+", "+h+"): Promise already settled in state"+this.state_);this.state_=g;this.result_=h;2===this.state_&&this.scheduleUnhandledRejectionCheck_();
this.executeOnSettledCallbacks_()};e.prototype.scheduleUnhandledRejectionCheck_=function(){var g=this;d(function(){if(g.notifyUnhandledRejection_()){var h=$jscomp.global.console;"undefined"!==typeof h&&h.error(g.result_)}},1)};e.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var g=$jscomp.global.CustomEvent,h=$jscomp.global.Event,l=$jscomp.global.dispatchEvent;if("undefined"===typeof l)return!0;"function"===typeof g?g=new g("unhandledrejection",{cancelable:!0}):
"function"===typeof h?g=new h("unhandledrejection",{cancelable:!0}):(g=$jscomp.global.document.createEvent("CustomEvent"),g.initCustomEvent("unhandledrejection",!1,!0,g));g.promise=this;g.reason=this.result_;return l(g)};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var g=0;g<this.onSettledCallbacks_.length;++g)f.asyncExecute(this.onSettledCallbacks_[g]);this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(g){var h=this.createResolveAndReject_();
g.callWhenSettled_(h.resolve,h.reject)};e.prototype.settleSameAsThenable_=function(g,h){var l=this.createResolveAndReject_();try{g.call(h,l.resolve,l.reject)}catch(k){l.reject(k)}};e.prototype.then=function(g,h){function l(p,q){return"function"==typeof p?function(v){try{k(p(v))}catch(t){n(t)}}:q}var k,n,m=new e(function(p,q){k=p;n=q});this.callWhenSettled_(l(g,k),l(h,n));return m};e.prototype.catch=function(g){return this.then(void 0,g)};e.prototype.callWhenSettled_=function(g,h){function l(){switch(k.state_){case 1:g(k.result_);
break;case 2:h(k.result_);break;default:throw Error("Unexpected state: "+k.state_);}}var k=this;null==this.onSettledCallbacks_?f.asyncExecute(l):this.onSettledCallbacks_.push(l);this.isRejectionHandled_=!0};e.resolve=c;e.reject=function(g){return new e(function(h,l){l(g)})};e.race=function(g){return new e(function(h,l){for(var k=$jscomp.makeIterator(g),n=k.next();!n.done;n=k.next())c(n.value).callWhenSettled_(h,l)})};e.all=function(g){var h=$jscomp.makeIterator(g),l=h.next();return l.done?c([]):new e(function(k,
n){function m(v){return function(t){p[v]=t;q--;0==q&&k(p)}}var p=[],q=0;do p.push(void 0),q++,c(l.value).callWhenSettled_(m(p.length-1),n),l=h.next();while(!l.done)})};return e},"es6","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6","es3");
$jscomp.polyfill("Object.is",function(a){return a?a:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(b,c){var d=this;d instanceof String&&(d=String(d));var e=d.length;c=c||0;for(0>c&&(c=Math.max(c+e,0));c<e;c++){var f=d[c];if(f===b||Object.is(f,b))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(b,c){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,c||0)}},"es6","es3");
$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(b,c){return $jscomp.findInternal(this,b,c).i}},"es6","es3");$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)$jscomp.owns(d,e)&&(a[e]=d[e])}return a};
$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");
var MAX_SLOT=99,IMAGES={},ITEM_LIST=[],AS_CAP=170,ST3_MAX_SLOT=999,SHOOT_DOWN_TABLE_ENEMY,AIR_STATUS_TABLE,$target=null,isOut=!1,isDefMode=!1,battleCount=1,displayBattle=0,timer=!1,planePreset=null,initialProf120Plane=[],isCtrlPress=!1,releaseTimer=null,usedItems=[],usedShip=[],selectedFormations=[],needAirRaidAlert=!1,chartInstance=null,subChartInstance=null,chartSlotDistribution=null,resultData={enemyAirPowers:[],enemyAirPowerResults:[],enemySlots:[],enemySlotAllDead:[],landBaseAirPowers:[],landBaseAirStatus:[],
fleetAirPower:0,fleetAirStatus:[],fleetSlots:[],defenseAirPower:0,usedSteels:0},aerialSetting={item:null,a11:1,contactBonus:1,isUnion:!1,unionBonus:1,nishikiBonus:1,isCritical:!1,levelCriticalBonus:1,ammoBonus:1,isAllSlot:!1,manualSlot:-1,manualRemodel:0,targetEnemies:[]},errorInfo=null,ENEMY_PATTERN=[],reserveList=null,currentReserved=null,InputData=function(){this.battleInfo=this.fleet=this.landBase=null},inputItems=new InputData,SpecialOperator=function(){this.selectedMode="";this.specialInfo=
[];this.enabled=!1};SpecialOperator.prototype.update=function(a){this.selectedMode=a;this.specialInfo=[];this.enabled=!1;var b=SPECIAL_DATA.find(function(d){return d.mode===a});if(b){this.enabled=!0;b=$jscomp.makeIterator(b.special);for(var c=b.next();!c.done;c=b.next())c=c.value,this.specialInfo.push(new SpecialItemInfo(c.name,c.remarks,c.items))}};
var SpecialItemInfo=function(a,b,c){this.name=a;this.remarks=b;this.items=c},specialOperator=new SpecialOperator,Fleet=function(){this.ships=[];this.fullEscortAirPower=this.escortAirPower=this.fullUnionAirPower=this.unionAirPower=this.fullAirPower=this.airPower=0;this.isUnion=this.hasJet=!1;this.scoutScores=[];this.adminLevel=120;this.allStage2=[];this.tp=this.antiAirBonus=0};
Fleet.prototype.updateAirPower=function(){this.escortAirPower=this.airPower=this.unionAirPower=0;for(var a=$jscomp.makeIterator(this.ships),b=a.next();!b.done;b=a.next())b=b.value,this.unionAirPower+=b.airPower,b.isEscort?this.escortAirPower+=b.airPower:this.airPower+=b.airPower};Fleet.prototype.initFullAirPower=function(){this.fullAirPower=this.airPower;this.fullEscortAirPower=this.escortAirPower;this.fullUnionAirPower=this.unionAirPower};
Fleet.prototype.nightContactRate=function(){for(var a=1,b=$jscomp.makeIterator(this.ships),c=b.next();!c.done;c=b.next())if(c=c.value,!this.isUnion||this.isUnion&&c.isEscort)for(var d=$jscomp.makeIterator(c.items.filter(function(f){return 102===f.id&&0<f.slot})),e=d.next();!e.done;e=d.next())a*=1-Math.floor(Math.sqrt(c.level)*Math.sqrt(e.value.scout))/25;return 1-a};
Fleet.prototype.clearResult=function(){for(var a=$jscomp.makeIterator(this.ships),b=a.next();!b.done;b=a.next()){b=$jscomp.makeIterator(b.value.items);for(var c=b.next();!c.done;c=b.next())c.value.results=[0,0,0,0,0,0,0,0,0,0]}};
Fleet.prototype.updateStage2All=function(a,b){a=void 0===a?1:a;b=void 0===b?!1:b;this.allStage2=[];for(var c=[],d=[],e=$jscomp.makeIterator(this.ships),f=e.next();!f.done;f=e.next()){var g=$jscomp.makeIterator(f.value.antiAirCutIn);for(f=g.next();!f.done;f=g.next())f=f.value,34<=f.id&&36!==f.id?d.push(f):c.push(f)}d.sort(function(k,n){return k.rateCorr!==n.rateCorr?n.rateCorr-k.rateCorr:n.fixCorr-k.fixCorr});c.sort(function(k,n){return n.id-k.id});e=d.concat(c);c=1;d=0;e=$jscomp.makeIterator(e);for(f=
e.next();!f.done;f=e.next()){g=f.value;var h=c*g.rate;c-=h;d+=h;this.updateStage2(a,g,b);f=new FleetStage2;f.cutin=g;f.rate=h;f.border=d;for(g=0;g<this.ships.length;g++){h=this.ships[g];var l=new ShootDownStatus;l.rateDown=h.rateDown;l.fixDown=h.fixDown;l.minimumDown=h.minimumDown;f.table.push(l)}this.allStage2.push(f)}if(100>d){d=new AntiAirCutIn;this.updateStage2(a,d,b);a=new FleetStage2;a.cutin=d;a.rate=c;a.border=1;for(b=0;b<this.ships.length;b++)c=this.ships[b],d=new ShootDownStatus,d.rateDown=
c.rateDown,d.fixDown=c.fixDown,d.minimumDown=c.minimumDown,a.table.push(d);this.allStage2.push(a)}};
Fleet.prototype.updateStage2=function(a,b,c){a=void 0===a?1:a;b=void 0===b?null:b;c=void 0===c?!1:c;for(var d=0,e=$jscomp.makeIterator(this.ships),f=e.next();!f.done;f=e.next())d+=f.value.antiAirBonus;f=FORMATION.find(function(l){return l.id===a});e=b?b.rateCorr:1;b=b?b.fixCorr:0;this.antiAirBonus=2/1.3*Math.floor((f?f.correction:1)*d);d=$jscomp.makeIterator(this.ships);for(f=d.next();!f.done;f=d.next()){f=f.value;var g=1;this.isUnion&&!f.isEscort?g=c?.72:.8:this.isUnion&&f.isEscort&&(g=.48);var h=
f.antiAirWeight*g/400;f.fixDown=Math.floor((f.antiAirWeight+this.antiAirBonus)*g*e/10);f.rateDown=h;f.minimumDown=1+b}};
Fleet.prototype.updateScoutScores=function(){this.scoutScores=[];for(var a=1;4>=a;a++){for(var b=this.ships.filter(function(h){return!h.isEscort}),c=this.ships.filter(function(h){return h.isEscort}),d=0,e=0,f=$jscomp.makeIterator(b),g=f.next();!g.done;g=f.next())g=g.value,d+=Math.sqrt(g.scout+g.bonusScout),e+=g.getEquipmentsScout(a);b=d+e-Math.ceil(.4*this.adminLevel)+2*(6-b.length);e=d=0;f=$jscomp.makeIterator(c);for(g=f.next();!g.done;g=f.next())g=g.value,d+=Math.sqrt(g.scout+g.bonusScout),e+=g.getEquipmentsScout(a);
c=d+e-Math.ceil(.4*this.adminLevel)+2*(6-c.length);this.scoutScores.push(Math.floor(100*(this.isUnion?b+c:b))/100)}};Fleet.prototype.updateBonusTorpedo=function(){for(var a=$jscomp.makeIterator(this.ships),b=a.next();!b.done;b=a.next())b.value.updateAttackerBonus()};Fleet.prototype.updateTransportPower=function(){this.tp=0;for(var a=$jscomp.makeIterator(this.ships),b=a.next();!b.done;b=a.next())this.tp+=b.value.tp};
var Ship=function(a){this.type2=this.type=this.id=0;this.name="";this.shipNo=a;this.items=[];this.isEscort=!1;this.fullAirPower=this.airPower=0;this.ignoreSlot=!0;this.level=99;this.rateDown=this.fixDown=this.antiAirBonus=this.antiAirWeight=this.antiAir=this.range=0;this.minimumDown=1;this.antiAirCutIn=[];this.sumItemArmor=this.armor=this.hp=this.luck=this.hunshinRate=0;this.drawTabId="";this.bonusTorpedo=this.bonusScout=this.scout=0;this.warningText="";this.tp=0};
Ship.prototype.updateAirPower=function(){for(var a=0,b=$jscomp.makeIterator(this.items),c=b.next();!c.done;c=b.next())a+=c.value.airPower;this.airPower=a};Ship.prototype.initFullAirPower=function(){this.fullAirPower=this.airPower};Ship.prototype.getEquipmentsScout=function(a){for(var b=0,c=$jscomp.makeIterator(this.items),d=c.next();!d.done;d=c.next()){d=d.value;var e=d.scout+Item.getBonusScout(d.type,d.remodel);b+=e*Item.getItemScoutCoefficient(d.type)}return b*a};
Ship.prototype.updateEquipmentBonusScout=function(){var a=this.bonusScout=0,b=this.items,c=isUSA(this.type2),d=isJPN(this.type2);b.some(function(f){return 278===f.id})&&c&&(a+=1);b.some(function(f){return 279===f.id})&&(c&&(a+=2),isGBR(this.type2)&&(a+=1));!b.some(function(f){return 30===f.id})||54!==this.type2&&301!==this.id&&306!==this.id||(a+=2);!b.some(function(f){return 410===f.id})||54!==this.type2&&301!==this.id&&306!==this.id||(a+=2);if(b.some(function(f){return 171===f.id})&&[8,9,10].includes(this.type)&&
c){var e=getArrayMax(b.filter(function(f){return 171===f.id}).map(function(f){return f.remodel}));a=8<=e?a+3:3<=e?a+2:a+1}b.some(function(f){return 414===f.id})&&c&&(a=[8,9,10].includes(this.type)?a+1:4<=getArrayMax(b.filter(function(f){return 414===f.id}).map(function(f){return f.remodel}))?a+3:a+2);b.some(function(f){return 370===f.id})&&(67===this.type2?a+=3:89===this.type2||isGBR(this.type2)?a+=2:[62,70,72].includes(this.type2)&&(a+=1));if(b.some(function(f){return 371===f.id}))if(430===this.id)a+=
9;else if(89===this.type2)a+=6;else if(88===this.type2)a+=5;else if(70===this.type2)a+=4;else if(67===this.type2||79===this.type2||108===this.type2)a+=3;430===this.id&&b.some(function(f){return 368===f.id})&&(a+=1);430===this.id&&b.some(function(f){return 369===f.id})&&(a+=2);b.some(function(f){return 61===f.id})&&(c=getArrayMax(b.filter(function(f){return 61===f.id}).map(function(f){return f.remodel})),10===c?a+=3:6<=c?a+=2:2<=c&&(a+=1),17===this.type2?8<=c?a+=4:1<=c&&(a+=3):25===this.type2?1<=c&&
(a+=2):[308,309,360].includes(this.id)&&1<=c&&(a+=1));b.some(function(f){return 54===f.id&&2<=f.remodel})&&(a+=1);b.some(function(f){return 273===f.id&&2<=f.remodel})&&(a+=1);b.some(function(f){return 151===f.id&&2<=f.remodel})&&(b=getArrayMax(b.filter(function(f){return 151===f.id}).map(function(f){return f.remodel})),10===b?a+=3:6<=b?a+=2:2<=b&&(a+=1));b=$jscomp.makeIterator(this.items);for(c=b.next();!c.done;c=b.next()){c=c.value;118===c.id&&52===this.type2&&(a=10===c.remodel?a+3:a+2);194===c.id&&
[62,70,72,79].includes(this.type2)&&(a+=2);367===c.id&&[62,70,72,89].includes(this.type2)&&(a+=1);368===c.id&&(89===this.type2?a+=3:[62,70,72].includes(this.type2)&&(a+=2));369===c.id&&([70,89].includes(this.type2)?a+=3:[62,72].includes(this.type2)&&(a+=2));if(408===c.id)if(97===this.type2)a+=2;else if(45===this.type2||2===this.type)a+=1;d&&129===c.id&&([3,4,5,6].includes(this.type)?a+=3:2===this.type&&(a+=1));d&&412===c.id&&([3,4].includes(this.type)?a+=3:[2,5,6].includes(this.type)&&(a+=1))}this.bonusScout=
a};Ship.prototype.updateAttackerBonus=function(){this.warningText="";if(!this.ignoreSlot){for(var a=[],b=$jscomp.makeIterator(this.items),c=b.next();!c.done;c=b.next())c=c.value,c.isAttacker&&(c=ShipItem.getAttackerBonus(c,this))&&a.push(c);this.bonusTorpedo=getArrayMin(a);this.bonusTorpedo<getArrayMax(a)&&(this.warningText="\u96f7\u88c5\u30dc\u30fc\u30ca\u30b9\u5024\u304c\u4f4e\u4e0b\u3059\u308b\u8266\u8f09\u6a5f\u69cb\u6210\u3067\u3059\u3002\u88c5\u5099\u69cb\u6210\u306e\u898b\u76f4\u3057\u3092\u691c\u8a0e\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}};
Ship.prototype.updateAntiAirStatus=function(){for(var a=0,b=0,c=$jscomp.makeIterator(this.items),d=c.next();!d.done;d=c.next())d=d.value,a+=d.antiAirWeight,b+=d.antiAirBonus;this.antiAirWeight=0<this.items.length?2*Math.floor((this.antiAir+a)/2):Math.floor(this.antiAir+a);this.antiAirBonus=Math.floor(b);this.setAntiAirCutIn();this.setHunshinRate()};
Ship.prototype.setAntiAirCutIn=function(){var a=[],b=this.id,c=this.items,d=c.filter(function(p){return 16===p.itype&&7<p.antiAir}).length,e=c.filter(function(p){return 16===p.itype&&7>=p.antiAir}).length,f=c.filter(function(p){return 11===p.itype&&0<p.antiAir}).length,g=c.filter(function(p){return 11===p.itype}).length,h=c.filter(function(p){return 21===p.type&&8<p.antiAir}).length,l=c.filter(function(p){return 21===p.type&&8>=p.antiAir}).length,k=0<d+e,n=hasTypeItem(c,36),m=c.some(function(p){return 307===
p.id});if(54===this.type2&&k)2<=d+e&&0<g?a.push(1):k&&0<g?a.push(2):2<=d+e&&a.push(3);else if(397===b||1496===b?(2<=c.filter(function(p){return 363===p.id}).length&&(a.push(38),m&&a.push(40),a.push(41)),c.some(function(p){return 363===p.id})&&c.some(function(p){return 362===p.id})&&(a.push(39),m&&!a.includes(40)&&a.push(40),a.includes(41)||a.push(41)),2<=c.filter(function(p){return 362===p.id}).length&&(m&&!a.includes(40)&&a.push(40),a.includes(41)||a.push(41))):[362,396,428,429,1489,1492].includes(b)?
(2<=c.filter(function(p){return 308===p.id}).length&&a.push(34),c.some(function(p){return 308===p.id})&&c.some(function(p){return 284===p.id||313===p.id})&&a.push(35),2<=c.filter(function(p){return 284===p.id||313===p.id}).length&&m&&a.push(36),2<=c.filter(function(p){return 313===p.id}).length&&a.push(37)):228===b?(k&&0<h&&0<f&&a.push(10),k&&0<h&&a.push(11)):141===b?(k&&(0<l||0<h)&&0<f&&a.push(14),k&&(0<l||0<h)&&a.push(15)):270===b||422===b?(k&&(0<l||0<h)&&0<f&&a.push(16),k&&(0<l||0<h)&&a.push(17)):
287===b?0<e&&0<h&&a.push(19):288===b?k&&0<f&&a.push(21):[102,103,353,354].includes(b)&&0<f&&hasTypeItem(c,18)&&c.some(function(p){return 274===p.id})&&a.push(25),hasTypeItem(c,3)&&hasTypeItem(c,18)&&n&&0<f&&a.push(4),2<=d&&0<f&&a.push(5),hasTypeItem(c,3)&&hasTypeItem(c,18)&&n&&a.push(6),1<=d&&0<f&&a.push(8),k&&n&&0<f&&a.push(7),148===b||346===b?(346===b&&0<f&&c.some(function(p){return 275===p.id})&&a.push(26),0<f&&c.some(function(p){return 274===p.id})&&a.push(28)):[102,103,353,354].includes(b)?0<
f&&c.some(function(p){return 274===p.id})&&a.push(28):(357===b||358===b)&&k&&0<f&&a.push(29),k&&n&&a.push(9),(379===b||430===b)&&k&&0<l&&a.push(33),0<h&&2<=c.filter(function(p){return 21===p.type&&3<=p.antiAir}).length&&0<f&&a.push(12),218===b)0<h&&a.push(18);else if(287===b)0<h&&a.push(20);else if(348===b)0<h&&a.push(22);else if(329===b||330===b)0<l&&a.push(23);else if(278===b)0<e&&0<l&&a.push(24);else if(277===b)0<e&&0<l&&a.push(24),3<=d+e&&a.push(30),2<=d+e&&a.push(31);else if(379===b||430===b)3<=
d+e&&a.push(30);else if(isGBR(this.type2)||[149,150,151,152,391,392].includes(this.id))c.some(function(p){return 300===p.id})&&c.some(function(p){return 191===p.id})?a.push(32):c.some(function(p){return 301===p.id})&&c.some(function(p){return 191===p.id})?a.push(32):2<=c.filter(function(p){return 301===p.id}).length&&a.push(32);b=0;c={};a=$jscomp.makeIterator(a);for(d=a.next();!d.done;c={$jscomp$loop$prop$id$287:c.$jscomp$loop$prop$id$287},d=a.next())if(c.$jscomp$loop$prop$id$287=d.value,d=ANTIAIR_CUTIN.find(function(p){return function(q){return q.id===
p.$jscomp$loop$prop$id$287}}(c)))e=new AntiAirCutIn,e.id=d.id,e.rateCorr=d.adj[0],e.fixCorr=d.adj[1],f=d.rate/101,34<=d.id?e.rate=f:b<f&&(e.rate=f-b,b=f),e.rate&&this.antiAirCutIn.push(e)};Ship.prototype.getProfCriticalBonus=function(){for(var a=0,b=$jscomp.makeIterator(this.items),c=b.next();!c.done;c=b.next())if(c=c.value,0<c.slot&&(c.isAttacker||41===c.type)){var d=getInnerProficiency(c.level,c.type);a+=Math.floor(Math.sqrt(d)+[0,1,2,3,4,5,7,10][c.level])/(0===c.slotNo?100:200)}return 1+a};
Ship.prototype.setHunshinRate=function(){var a=this.items.filter(function(b){return 274===b.id}).length;a&&(this.hunshinRate=(.9*Math.min(this.luck,50)+this.antiAirWeight)/281,2===a?this.hunshinRate+=.15:3===a&&(this.hunshinRate+=.3),[102,103,353,354].includes(this.id)&&(this.hunshinRate+=.25))};
Ship.prototype.getTransportPower=function(){for(var a=0,b=$jscomp.makeIterator(this.items),c=b.next();!c.done;c=b.next())a+=c.value.tp;switch(this.type){case 2:a+=5;break;case 3:if(287===this.id){a+=10;break}a+=2;break;case 21:a+=6;break;case 6:a+=4;break;case 10:a+=7;break;case 22:case 15:a+=15;break;case 16:a+=9;break;case 17:a+=12;break;case 14:a+=1;break;case 20:a+=7;break;default:a+=0}return a};
var AntiAirCutIn=function(){this.fixCorr=this.id=0;this.rateCorr=1;this.rate=0},FleetStage2=function(){this.cutin=null;this.border=this.rate=0;this.table=[]},ShootDownStatus=function(){this.minimumDown=this.fixDown=this.rateDown=0},LandBaseAll=function(){this.landBases=[];this.rocketBonus=this.defense2AirPower=this.defenseAirPower=0;this.manualCorr=1};
LandBaseAll.prototype.updateDefenseAirPower=function(){for(var a=0,b=0,c=$jscomp.makeIterator(this.landBases),d=c.next();!d.done;d=c.next())if(d=d.value,0===d.mode){b+=d.defenseAirPower;d=$jscomp.makeIterator(d.planes);for(var e=d.next();!e.done;e=d.next())ROCKETS.includes(e.value.id)&&(a+=1)}this.rocketBonus=0===a?.5:1===a?.8:2===a?1.1:1.2;this.defenseAirPower=Math.floor(this.manualCorr*b);this.defense2AirPower=Math.floor(this.rocketBonus*b)};
LandBaseAll.prototype.clearResult=function(){for(var a=$jscomp.makeIterator(this.landBases),b=a.next();!b.done;b=a.next()){b=b.value;b.results=[];for(var c=0;c<battleCount;c++)b.results.push(new AirStatusResult)}};var LandBase=function(a,b){this.baseNo=a;this.planes=[];this.mode=b;this.target=[-1,-1];this.reconCorr=this.defenseAirPower=this.fullAirPower=this.airPower=0;this.defenseCorr=1;this.results=[];this.isSeparate=this.hasJet=!1;for(a=0;a<battleCount;a++)this.results.push(new AirStatusResult)};
LandBase.prototype.updateAirPower=function(){for(var a=0,b=$jscomp.makeIterator(this.planes),c=b.next();!c.done;c=b.next())a+=c.value.airPower;b=a;if(1>this.reconCorr){this.reconCorr=1;c=this.planes.filter(function(f){return f.isRecon});var d=$jscomp.makeIterator(c);for(c=d.next();!c.done;c=d.next()){c=getReconnaissancesAdjust(c.value,!1);var e=a*c;e>b&&(b=e,this.reconCorr=c)}}else b=a*this.reconCorr;this.airPower=Math.floor(b)};
LandBase.prototype.updateDefenseAirPower=function(){var a=getArraySum(this.planes.map(function(f){return f.defenseAirPower})),b=a,c=this.planes.filter(function(f){return f.isRecon});c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next()){d=getReconnaissancesAdjust(d.value,!0);var e=a*d;e>b&&(b=e,this.reconCorr=d)}this.defenseAirPower=Math.floor(b)};
LandBase.prototype.getRange=function(){for(var a=999,b=1,c=$jscomp.makeIterator(this.planes),d=c.next();!d.done;d=c.next())d=d.value,d.id&&(a=d.radius<a?d.radius:a,d.isRecon&&(b=b<d.radius?d.radius:b));return 999>b&&b>a?Math.round(a+Math.min(Math.sqrt(b-a),3)):999===a?0:a};LandBase.prototype.getSumFuel=function(){return getArraySum(this.planes.map(function(a){return a.fuel}))};LandBase.prototype.getSumAmmo=function(){return getArraySum(this.planes.map(function(a){return a.ammo}))};
LandBase.prototype.getSumBauxite=function(){return getArraySum(this.planes.map(function(a){return a.bauxite}))};LandBase.prototype.getSumSteel=function(){return getArraySum(this.planes.map(function(a){return a.steel}))};
var Item=function(a,b,c,d){b=void 0===b?0:b;c=void 0===c?0:c;d=void 0===d?0:d;this.id=0;this.name="-";this.armor=this.asw=this.bomber=this.torpedo=this.fire=this.range=this.avoid=this.accuracy=this.cost=this.radius=this.fullAirPower=this.airPower=this.scout=this.interception=this.antiBomber=this.actualAntiAir=this.bonusAntiAir=this.antiAir=this.itype=this.type=0;this.isExpanded=this.isJet=this.isPlane=this.canBattle=this.isAttacker=this.isRecon=this.isFighter=!1;this.contact=0;this.selectRate=[];
this.fullSlot=0;this.slot=b;this.slotNo=this.bonusAirPower=this.steel=this.bauxite=this.ammo=this.fuel=this.level=this.remodel=0;var e=ITEM_DATA.find(function(f){return f.id===a});e&&(this.id=e.id,this.name=e.name,this.type=e.type,this.itype=e.itype,this.antiAir=e.antiAir,this.antiBomber=e.antiBomber,this.interception=e.interception,this.scout=e.scout,this.radius=e.radius,this.cost=e.cost,this.accuracy=e.accuracy,this.avoid=e.avoid,this.range=e.range2,this.fire=e.fire,this.torpedo=e.torpedo,this.bomber=
e.bomber,this.asw=e.asw,this.armor=e.armor,this.isFighter=FIGHTERS.includes(e.type),this.isAttacker=ATTACKERS.includes(e.type),this.isRecon=RECONNAISSANCES.includes(e.type),this.isJet=57===e.type,this.isPlane=(this.canBattle=this.isFighter||this.isAttacker)||this.isRecon,this.remodel=c,this.level=d,this.isPlane&&(this.validateSlot(b),this.calcBonusAirPower(),this.bonusAntiAir=Item.getBonusAntiAir(this.id,this.type,this.remodel,this.antiAir),this.antiAir+=this.bonusAntiAir,this.actualAntiAir=this.isFighter?
this.antiAir+1.5*this.interception:this.antiAir,this.updateAirPower(),0<this.slot&&(this.contact=this.isRecon?Math.floor(this.scout*Math.sqrt(this.slot)):0,this.selectRate=getContactSelectRate(this)),b=LB_ATTACKERS.includes(this.type),this.fuel=Math.ceil(this.slot*(b?1.5:53===this.type?2:1)),this.ammo=b?Math.floor(.7*this.slot):53===this.type?2*this.slot:Math.ceil(.6*this.slot),41===this.type&&(this.fuel=3*this.slot,this.ammo=this.slot),this.bauxite=this.cost*(this.isRecon?4:53===this.type?9:18),
this.steel=this.isJet?Math.round(this.slot*this.cost*.2):0,this.fullAirPower=this.airPower))};Item.prototype.updateAirPower=function(){this.isRecon||0>=this.slot||0===this.id?(this.airPower=0,0>this.slot&&(this.slot=0)):this.airPower=Math.floor(this.antiAir*Math.sqrt(this.slot)+this.bonusAirPower)};
Item.prototype.calcBonusAirPower=function(){if(0===this.id||0===this.slot)return 0;var a=this.type,b=this.level,c=0;if(this.isFighter)switch(b){case 7:c+=22;break;case 2:c+=2;break;case 3:c+=5;break;case 4:c+=9;break;case 5:c+=14;break;case 6:c+=14}else if(11===a)switch(b){case 2:c+=1;break;case 3:c+=1;break;case 4:c+=1;break;case 5:c+=3;break;case 6:c+=3;break;case 7:c+=6}c+=Math.sqrt(getInnerProficiency(b,a)/10);49===a?c+=2<=this.remodel&&4===this.slot?1:0:138===this.id&&(c+=4<=this.remodel&&4===
this.slot?1:0);this.bonusAirPower=c};Item.getBonusAntiAir=function(a,b,c,d){var e=0;FIGHTERS.includes(b)?e=.2*c:7===b&&2<d&&277!==a&&316!==a?e=.25*c:LB_ATTACKERS.includes(b)&&(e=.5*Math.sqrt(c));return e};Item.getBonusFire=function(a,b,c){var d=0;3===b?d=1.5*Math.sqrt(c):[1,2,4,19,21,24,29,36,42].includes(b)?d=[10,66,220,275].includes(a)?.2*c:[12,234,247].includes(a)?.3*c:Math.sqrt(c):[14,15].includes(b)&&(d=.75*Math.sqrt(c));return d};
Item.getBonusTorpedo=function(a,b){var c=0;if(8===a)c=.2*b;else if(LB_ATTACKERS.includes(a))c=.7*Math.sqrt(b);else if(5===a||21===a)c=1.2*Math.sqrt(b);return c};Item.getBonusBomber=function(a,b,c){var d=0;7===b&&60!==a&&154!==a&&219!==a&&447!==a?d=.2*c:11===b&&(d=.2*c);return d};Item.getBonusAccuracy=function(a,b,c){var d=0;[28,29,31,32,88,89,141,240,278,279,307,315].includes(a)?d=1.7*Math.sqrt(c):[1,2,3,4,12,13,19,29,36,42].includes(b)&&(d=Math.sqrt(c));return d};
Item.getBonusASW=function(a,b,c,d){var e=0;[14,15].includes(b)?e=Math.sqrt(c):8===b?e=.2*c:7===b&&(2>=d||277===a||316===a)&&(e=.2*c);return e};Item.getBonusScout=function(a,b){var c=0;12===a?c=1.25*Math.sqrt(b):13===a?c=1.4*Math.sqrt(b):[9,10,41].includes(a)?c=1.2*Math.sqrt(b):11===a&&(c=1.15*Math.sqrt(b));return c};Item.getItemScoutCoefficient=function(a){var b=.6;8===a?b=.8:9===a?b=1:10===a?b=1.2:11===a&&(b=1.1);return b};
Item.getAntiAirWeight=function(a,b,c,d){var e=0;16===b||36===a?e=4*d:11===b?e=3*d:21===a&&(e=6*d);7>=d&&(16===b||36===a)?e+=2*Math.sqrt(c):7<d&&(16===b||36===a)?e+=3*Math.sqrt(c):7>=d&&21===a?e+=4*Math.sqrt(c):7<d&&21===a&&(e+=6*Math.sqrt(c));return e};Item.getAntiAirBonus=function(a,b,c,d,e){a=16===c||36===b?.35*e:11===c?.4*e:18===b?.6*e:9===a?.25*e:.2*e;7>=e&&(16===c||36===b)?a+=2*Math.sqrt(d):7<e&&(16===c||36===b)?a+=3*Math.sqrt(d):11===c&&1<e&&(a+=1.5*Math.sqrt(d));return a};
Item.prototype.validateSlot=function(a){a=castInt(a);this.fullSlot=a>MAX_SLOT?this.slot=MAX_SLOT:this.slot=a};
var ShipItem=function(a,b,c,d){Item.call(this,a,void 0===b?0:b,void 0===c?0:c,void 0===d?0:d);this.results=[0,0,0,0,0,0,0,0,0,0];this.antiAirBonus=this.antiAirWeight=0;this.tp=this.getTransportPower();a=this.antiAir-this.bonusAntiAir;0<a&&(this.antiAirWeight=Item.getAntiAirWeight(this.type,this.itype,this.remodel,a),this.antiAirBonus=Item.getAntiAirBonus(this.id,this.type,this.itype,this.remodel,a))};$jscomp.inherits(ShipItem,Item);
ShipItem.getFirePower=function(a,b,c,d,e){e=void 0===e?!1:e;if(!a.isAttacker||1>b)return[0];c=25+((void 0===c?0:c)?(void 0===d?0:d)?-20:-10:0);var f=0;f=0;d=[];switch(a.type){case 8:f=Item.getBonusTorpedo(a.type,a.remodel)+a.torpedo;f=f*Math.sqrt(b)+c;d.push(.8*f);d.push(1.5*f);break;case 7:case 11:f=Item.getBonusBomber(a.id,a.type,a.remodel)+a.bomber;f=f*Math.sqrt(b)+c;d.push(f);break;case 57:f=Item.getBonusBomber(a.type,a.remodel)+a.bomber;f=f*Math.sqrt(b)+c;e?d.push(f):d.push(f/Math.SQRT2);break;
default:d.push(0)}return d.map(function(g){return Math.floor(softCap(g,AS_CAP))})};
ShipItem.getAttackerBonus=function(a,b){if(372===a.id){if(483===b.id||488===b.id)return 2;if([33,43].includes(b.type2))return 1}else if(373===a.id){if(483===b.id)return 3;if(488===b.id||[9,33,43].includes(b.type2))return 2;if([24,51].includes(b.type2)||[1391,1392,121,122,1382,355,360].includes(b.id))return 1}else if(374===a.id){if([261,262,266,267,156,153].includes(b.id))return 3;if([483,488,308,309,1383,208].includes(b.id))return 2;if([121,122,1382,355,360,190].includes(b.id))return 1}else if(424===
a.id){if([315,1473,485,1713].includes(b.id))return 3}else if(425===a.id){if([315,1473,485,1713].includes(b.id))return 1}else if(368===a.id){if(430===b.id)return 2}else if(369===a.id&&430===b.id)return 3;return 0};ShipItem.prototype.getTransportPower=function(){switch(this.type){case 24:return 8;case 30:return 5;case 43:return 1;case 46:return 2;default:return 0}};var LandBaseItem=function(a,b,c,d){Item.call(this,a,void 0===b?0:b,void 0===c?0:c,void 0===d?0:d);this.defenseAirPower=0;this.updateDefenseAirPower()};
$jscomp.inherits(LandBaseItem,Item);LandBaseItem.prototype.updateAirPower=function(){0>=this.slot?this.slot=this.airPower=0:this.airPower=Math.floor(this.bonusAirPower+this.actualAntiAir*Math.sqrt(this.slot))};
LandBaseItem.prototype.updateDefenseAirPower=function(){if(0===this.id||0>=this.slot)this.slot=this.defenseAirPower=0;else{var a=this.bonusAirPower;a=this.isFighter?a+(this.antiAir+this.interception+2*this.antiBomber)*Math.sqrt(this.slot):a+this.antiAir*Math.sqrt(this.slot);this.defenseAirPower=Math.floor(a)}};LandBaseItem.prototype.validateSlot=function(a){a=castInt(a);this.fullSlot=0===a?this.slot=0:this.isRecon&&4<a?this.slot=4:53===this.type&&9<a?this.slot=9:18<a?this.slot=18:this.slot=a};
LandBaseItem.getFirePower=function(a,b,c,d,e,f,g){d=void 0===d?!1:d;e=void 0===e?1:e;f=void 0===f?1:f;g=void 0===g?1:g;var h=ITEM_DATA.find(function(p){return p.id===a});if(!h||0>=b)return 0;var l=Math.abs(h.type),k=0,n=0,m=1.8;switch(l){case 8:k=Item.getBonusTorpedo(l,c)+h.torpedo*g;n=1;break;case 7:case 11:k=Item.getBonusBomber(a,l,c)+h.bomber*g;n=1;break;case 57:k=Item.getBonusBomber(a,l,c)+h.bomber*g;n=.7071;break;case 47:k=Item.getBonusTorpedo(l,c)+h.torpedo*g;n=.8;break;case 53:k=Item.getBonusTorpedo(l,
c)+h.torpedo*g,m=n=1}b=Math.floor(n*(k*Math.sqrt(m*b)+25)*f);b=softCap(b,AS_CAP);d&&(b=Math.floor(1.5*b*e));return b*(47===l?1.8:1)};
LandBaseItem.getFirePowerLandBase=function(a,b,c,d,e){if(0>=b)return 0;var f=Math.abs(a.type),g=0,h=0;switch(f){case 8:g=Item.getBonusTorpedo(f,a.remodel)+a.torpedo;h=1;break;case 7:case 11:g=Item.getBonusBomber(a.id,f,a.remodel)+a.bomber;h=1;break;case 57:g=Item.getBonusBomber(a.id,f,a.remodel)+a.bomber;h=.7071;break;case 47:g=a.bomber,h=.8}b=h*(g*Math.sqrt(1.8*b)+25);a=[7,11,47,53,57].includes(a.type);[165,166,167].includes(e.id)?b=Math.floor(Math.floor(softCap(1.6*b,AS_CAP))*(a?1.55:1)):[168,169,
171,172].includes(e.id)?b=Math.floor(Math.floor(softCap(1.18*b,AS_CAP))*(a?1.7:1)):0<=e.name.indexOf("\u96c6\u7a4d\u5730")&&(b=Math.floor(softCap(b,AS_CAP)*(a?2.1:1)+100));c&&(b=Math.floor(1.5*b*d));return b*(47===f?1.8:1)};LandBaseItem.getFirePower_SP=function(a,b,c,d){if(0>=b)return 0;var e=0;224===a.id&&(a=25+Item.getBonusTorpedo(a.type,a.remodel),e=Math.floor(.8*(a*Math.sqrt(1.8*b)+25)));e=softCap(e,AS_CAP);c&&(e=Math.floor(1.5*e*d));return 1.8*e};
var ItemDetail=function(a,b,c){c=void 0===c?0:c;Item.call(this,a,0,void 0===b?0:b);this.range2=this.avoid2=this.asw=this.armor=this.bomber=this.torpedo=this.fire=0;this.stock=c;this.grow=this.antiAirBonus=this.antiAirWeight=this.defenseAntiAir=this.battleAntiAir=0};$jscomp.inherits(ItemDetail,Item);
ItemDetail.prototype.setAllStatus=function(){this.antiAirWeight=Item.getAntiAirWeight(this.type,this.itype,this.remodel,this.antiAir);this.antiAirBonus=Item.getAntiAirBonus(this.id,this.type,this.itype,this.remodel,this.antiAir);this.remodel&&(this.fire+=Item.getBonusFire(this.id,this.type,this.remodel),this.torpedo+=Item.getBonusTorpedo(this.type,this.remodel),this.bomber+=Item.getBonusBomber(this.id,this.type,this.remodel),this.asw+=Item.getBonusASW(this.id,this.type,this.remodel,this.antiAir),
this.scout+=Item.getBonusScout(this.type,this.remodel),this.accuracy+=Item.getBonusAccuracy(this.id,this.type,this.remodel),this.antiAir+=Item.getBonusAntiAir(this.id,this.type,this.remodel,this.antiAir));this.battleAntiAir=this.antiAir+1.5*this.interception;this.defenseAntiAir=this.antiAir+this.interception+2*this.antiBomber};
var AirStatusResult=function(){this.mainAirPower=[0,0];this.enemyAirPower=[0,0];this.airStatusIndex=[[0,0,0,0,0,0],[0,0,0,0,0,0]]},BattleData=function(){this.battles=[]},Battle=function(){this.enemies=[];this.cellType=0;this.stage2=[];this.isAllSubmarine=!1;this.formation=0;this.containUnknown=this.hasAntiAirCI=this.isUnion=this.enabledStage2=!1};Battle.prototype.getLandBaseAirPower=function(){for(var a=0,b=this.enemies.length,c=0;c<b;c++)a+=this.enemies[c].landBaseAirPower;return a};
Battle.prototype.getAirPower=function(){for(var a=0,b=this.enemies.length,c=0;c<b;c++)a+=this.enemies[c].airPower;return a};
Battle.prototype.createStage2Table=function(){var a=this,b=[[[],[]],[[],[]],[[],[]],[[],[]],[[],[]],[[],[]]],c=this.enemies.length;if(0!==c){AVOID_TYPE[5].adj[0]=castFloat($("#free_anti_air_weight").val());AVOID_TYPE[5].adj[1]=castFloat($("#free_anti_air_bornus").val());var d=FORMATION.find(function(m){return m.id===a.formation});d=d?d.correction:1;var e=Math.floor(getArraySum(this.enemies.map(function(m){return m.antiAirBonus})));d=Math.floor(e*d);for(e=0;e<c;e++){var f=this.enemies[e];if(0!==f.id&&
!f.isDead)for(var g=this.isUnion&&f.isEscort?.48:this.isUnion&&!f.isEscort?.8:1,h=0;h<AVOID_TYPE.length;h++){var l=AVOID_TYPE[h].adj[0],k=AVOID_TYPE[h].adj[1],n=0;n=1===l?Math.floor(Math.sqrt(f.antiAir+f.sumItemAntiAir))+f.equipmentsAAWeight:Math.floor((Math.floor(Math.sqrt(f.antiAir+f.sumItemAntiAir))+f.equipmentsAAWeight)*l);l=0;l=1===k?d:Math.floor(d*k);b[h][0].push(.005*n*g);b[h][1].push(Math.floor(.1875*(n+l)*g))}}this.stage2=b}};
var Enemy=function(a){this.id=0;this.type=[];this.name="";this.antiAirs=[];this.slots=[];this.fullSlots=[];this.rawSlots=[];this.antiAirBonus=this.antiAirWeight=this.fullLandBaseAirPower=this.landBaseAirPower=this.fullAirPower=this.airPower=0;this.attackers=[];this.equipments=[];this.onlyScout=!1;this.equipmentsAAWeight=this.sumItemAntiAir=this.sumItemArmor=this.armor=this.hp=this.antiAir=0;this.isDead=this.isEscort=!1;var b=ENEMY_DATA.find(function(f){return f.id===a});if(b){for(var c=0;c<b.eqp.length;c++){var d=
new EnemyItem(b.eqp[c]);this.sumItemArmor+=d.armor;this.sumItemAntiAir+=d.antiAir;this.equipmentsAAWeight+=d.antiAirWeight;this.antiAirBonus+=d.antiAirBonus;this.equipments.push(d);if(d&&d.isPlane){var e=0<b.slot[c]?b.slot[c]:0;this.antiAirs.push(d.antiAir);this.attackers.push(ATTACKERS.includes(d.type));this.slots.push(e);this.fullSlots.push(e);!this.onlyScout&&d.isScout&&(this.onlyScout=!0)}}this.id=b.id;this.type=b.type;this.name=b.name;this.antiAir=b.aa;this.hp=b.hp;this.armor=b.armor;this.landBaseAirPower=
this.airPower=0;this.rawSlots=b.slot.concat();this.updateAirPower();this.fullAirPower=this.airPower;this.fullLandBaseAirPower=this.landBaseAirPower;this.antiAirWeight=2*Math.floor(Math.sqrt(this.antiAir+this.sumItemAntiAir))+2*this.equipmentsAAWeight;this.antiAirBonus=Math.floor(this.antiAirBonus)}};
Enemy.prototype.updateAirPower=function(){if(!(0>this.id)){this.landBaseAirPower=this.airPower=0;for(var a=this.antiAirs.length,b=0,c=0;c<a;c++)b+=Math.floor(this.antiAirs[c]*Math.sqrt(Math.floor(this.slots[c])));this.landBaseAirPower=b;if(!this.onlyScout||isDefMode)this.airPower=b}};
var EnemyItem=function(a){this.type=this.id=0;this.name="";this.antiAirBonus=this.antiAirWeight=this.antiAir=0;this.isScout=this.isAttacker=this.isPlane=!1;this.bomber=this.torpedo=this.armor=0;var b=ENEMY_ITEM.find(function(c){return c.id===a});b&&(this.id=b.id,this.name=b.name,this.type=b.type,this.itype=b.itype,this.antiAir=b.antiAir,this.armor=b.armor,this.torpedo=b.torpedo,this.bomber=b.bomber,this.isPlane=PLANE_TYPE.includes(b.type),this.isAttacker=ATTACKERS.includes(b.type),this.isScout=RECONNAISSANCES.includes(b.type),
LB_ATTACKERS.includes(b.type)&&(this.isScout=!0),16===this.itype?this.antiAirWeight=2*this.antiAir:11===this.itype?this.antiAirWeight=1.5*this.antiAir:21===this.type&&(this.antiAirWeight=3*this.antiAir),this.antiAirBonus=16===this.itype?.35*this.antiAir:11===this.itype?.4*this.antiAir:18===this.type?.6*this.antiAir:.2*this.antiAir)};
EnemyItem.prototype.getFirePower=function(a,b,c){if(!this.isAttacker)return[0];b=25+((void 0===b?0:b)?(void 0===c?0:c)?-20:-10:0);var d=0;d=0;c=[];switch(this.type){case 8:if(0>=a)return[0,0];d=this.torpedo;d=d*Math.sqrt(a)+b;c.push(.8*d);c.push(1.5*d);break;case 7:case 11:if(0>=a)return[0];d=this.bomber;d=d*Math.sqrt(a)+b;c.push(d);break;default:c.push(0)}return c.map(function(e){return Math.floor(softCap(e,AS_CAP))})};
function isContain(a,b){a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;for(var d=$jscomp.makeIterator(b),e=d.next();!e.done;e=d.next())if(c===e.value)return!0}return!1}function shuffleArray(a){for(var b=a.length-1;0<b;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c];a[c]=d}}function getArraySum(a){for(var b=0,c=a.length;c--;)b+=a[c];return b}function getArrayMax(a){for(var b=-Infinity,c=a.length;c--;)a[c]>b&&(b=a[c]);return b}
function getArrayMin(a){for(var b=Infinity,c=a.length;c--;)a[c]<b&&(b=a[c]);return b}function sFormat(a,b){return a?"avoid"===(void 0===b?"":b)?(b=AVOID_TYPE.find(function(c){return c.id===a}))?b.name:"":a%1?Math.floor(10*a)/10:a.toString():""}function softCap(a,b){return a>b?b+Math.sqrt(a-b):a}function isUSA(a){return USA.includes(a)}function isITA(a){return ITA.includes(a)}function isGBR(a){return GBR.includes(a)}function isDEU(a){return DEU.includes(a)}
function isFRA(a){return FRA.includes(a)}function isRUS(a){return RUS.includes(a)}function isSWE(a){return SWE.includes(a)}function isAUS(a){return AUS.includes(a)}function isNLD(a){return NLD.includes(a)}function isJPN(a){return!isUSA(a)&&!isITA(a)&&!isGBR(a)&&!isDEU(a)&&!isFRA(a)&&!isRUS(a)&&!isSWE(a)&&!isAUS(a)&&!isNLD(a)}
function setPreCalculateTable(){if(!AIR_STATUS_TABLE){AIR_STATUS_TABLE=[];for(var a=0;1E3>=a;a++){for(var b=new Uint16Array(Math.max(3*a+1,2)),c=0;c<=b.length;c++)if(0===a&&0===c)b[c]=5;else if(a>=3*c)b[c]=0;else if(2*a>=3*c)b[c]=1;else if(3*a>2*c)b[c]=2;else if(3*a>c)b[c]=3;else{b[c]=4;break}AIR_STATUS_TABLE.push(b)}}if(!SHOOT_DOWN_TABLE_ENEMY){SHOOT_DOWN_TABLE_ENEMY=[];a=0;b=ENEMY_DATA.length;for(c=0;c<b;c++)for(var d=ENEMY_DATA[c].slot.length,e=0;e<d;e++)a<ENEMY_DATA[c].slot[e]&&(a=ENEMY_DATA[c].slot[e]);
for(b=0;b<=a;b++){c=[];d=AIR_STATUS.length;for(e=0;e<d;e++){for(var f=[],g=AIR_STATUS[e].rate,h=g;0<=h;h--)for(var l=0;l<=g;l++)f.push(Math.floor(b*(.65*h+.35*l)/10));shuffleArray(f);c.push(f)}SHOOT_DOWN_TABLE_ENEMY.push(c)}}window.clearTimeout(releaseTimer);releaseTimer=setTimeout(function(){SHOOT_DOWN_TABLE_ENEMY=AIR_STATUS_TABLE=null},18E4)}
function updateItemList(){ITEM_LIST.splice(0);for(var a=loadPlaneStock(),b={},c=$jscomp.makeIterator(ITEM_DATA),d=c.next();!d.done;b={$jscomp$loop$prop$item$289:b.$jscomp$loop$prop$item$289},d=c.next()){b.$jscomp$loop$prop$item$289=d.value;if((d=a.find(function(g){return function(h){return h.id===g.$jscomp$loop$prop$item$289.id}}(b)))&&d.num.some(function(g){return 0<g}))for(var e=0;10>=e;e++){var f=d.num[e];0!==f&&(f=new ItemDetail(b.$jscomp$loop$prop$item$289.id,e,f),f.fire=b.$jscomp$loop$prop$item$289.fire,
f.antiAir=b.$jscomp$loop$prop$item$289.antiAir,f.torpedo=b.$jscomp$loop$prop$item$289.torpedo,f.bomber=b.$jscomp$loop$prop$item$289.bomber,f.accuracy=b.$jscomp$loop$prop$item$289.accuracy,f.scout=b.$jscomp$loop$prop$item$289.scout,f.avoid2=b.$jscomp$loop$prop$item$289.avoid2,f.asw=b.$jscomp$loop$prop$item$289.asw,f.armor=b.$jscomp$loop$prop$item$289.armor,f.range2=b.$jscomp$loop$prop$item$289.range2,f.grow=b.$jscomp$loop$prop$item$289.grow,f.setAllStatus(),ITEM_LIST.push(f))}d=new ItemDetail(b.$jscomp$loop$prop$item$289.id,
0,-1);d.fire=b.$jscomp$loop$prop$item$289.fire;d.antiAir=b.$jscomp$loop$prop$item$289.antiAir;d.torpedo=b.$jscomp$loop$prop$item$289.torpedo;d.bomber=b.$jscomp$loop$prop$item$289.bomber;d.accuracy=b.$jscomp$loop$prop$item$289.accuracy;d.scout=b.$jscomp$loop$prop$item$289.scout;d.avoid2=b.$jscomp$loop$prop$item$289.avoid2;d.asw=b.$jscomp$loop$prop$item$289.asw;d.armor=b.$jscomp$loop$prop$item$289.armor;d.range2=b.$jscomp$loop$prop$item$289.range2;d.grow=b.$jscomp$loop$prop$item$289.grow;d.setAllStatus();
ITEM_LIST.push(d)}}
function getItemsForIcon(a){var b=[];return b=0===a?ITEM_LIST.concat():10===a?ITEM_LIST.filter(function(c){return 10===c.type||11===c.type}):47===a?ITEM_LIST.filter(function(c){return 47===c.type||53===c.type}):12===a?ITEM_LIST.filter(function(c){return 12===c.type||13===c.type}):5===a?ITEM_LIST.filter(function(c){return 5===c.type||22===c.type||32===c.type}):14===a?ITEM_LIST.filter(function(c){return 14===c.type||15===c.type||40===c.type}):24===a?ITEM_LIST.filter(function(c){return[24,30,46].includes(c.type)}):
17===a?ITEM_LIST.filter(function(c){return[17,18,19,23,25,26,27,28,29,31,33,34,35,36,37,39,42,43,44,50,51].includes(c.type)}):ITEM_LIST.filter(function(c){return c.type===a})}function convertItemType(a){switch(a){case 10:case 11:return 10;case 47:case 53:return 47;case 12:case 13:return 12;case 5:case 22:case 32:return 5;case 14:case 15:case 40:return 14;case 24:case 30:case 46:return 24;default:return[17,18,19,23,25,26,27,28,29,30,31,33,34,35,36,37,39,42,43,44,50,51].includes(a)?17:a}}
function getItemCss(a){var b=ITEM_ICON_TYPE.find(function(c){return c.id===castInt(a)});return b?b.css:""}function getProfString(a){switch(a){case 1:return"|";case 2:return"||";case 3:return"|||";case 4:return"/";case 5:return"//";case 6:return"///";case 7:return">>"}return""}
function getRequiredgBattleCountString(a){switch(a){case 1:return"-";case 2:return"100\u6226";case 3:return"57 ~ 75\u6226";case 4:return"39 ~ 47\u6226";case 5:return"31 ~ 40\u6226";case 6:return"25 ~ 31\u6226";case 7:return"20 ~ 28\u6226";case 8:return"18 ~ 23\u6226";case 9:return"16 ~ 20\u6226";default:return"\u4e0d\u660e"}}
function replaceKnji(a){a&&(a=a.replace("601","\u516d\u3007\u4e00"),a=a.replace("634","\u516d\u4e09\u56db"),a=a.replace("931","\u4e5d\u4e09\u4e00"),a=a.replace("22","\u4e8c\u4e8c"),a=a.replace("34","\u4e09\u56db"),a=a.replace("96","\u4e5d\u516d"),a=a.replace("97","\u4e5d\u4e03"),a=a.replace("99","\u4e5d\u4e5d"));return a}
function checkInvalidItem(a,b,c){c=void 0===c?-1:c;if(-1===a)return!0;if(0===a&&LB_PLANE_TYPE.includes(b.type))return!1;if(0===a)return!0;var d=[],e=SHIP_DATA.find(function(g){return g.id===a}),f=c>=e.slot.length;if(f){if(34===b.id||87===b.id)return!1;if((d=EXPANDED_SPECIAL_ITEM.find(function(g){return g.itemId===b.id}))&&d.shipApiIds.includes(e.api)||[442,443].includes(b.id)&&(13===e.type||14===e.type))return!0}else{if(151===b.id)return 18===e.type;if(142===b.id)return 8===e.type||9===e.type||10===
e.type;if(128===b.id||281===b.id)return 37===e.type2||19===e.type2&&0<e.ver}(d=SPECIAL_LINK_SHIP_ITEM.find(function(g){return g.apiShip===e.api}))?(d=d.itemType,f&&(d=d.filter(function(g){return EXPANDED_ITEM_TYPE.includes(g)}))):(d=LINK_SHIP_ITEM.find(function(g){return g.type===e.type}).e_type,f&&(d=d.filter(function(g){return EXPANDED_ITEM_TYPE.includes(g)})));return 0<=c&&(f=FORBIDDEN_LINK_SHIP_ITEM.find(function(g){return g.shipId===a&&g.index.includes(c+1)}))&&(f.itemType.includes(b.type)||
f.itemIDs.includes(b.id))?!1:d.includes(b.type)}function validateInputNumber(a,b,c){c=void 0===c?0:c;return(new RegExp(/^[0-9]+$/)).test(a)?a>b?b:a<c?c:castInt(a):c}function validateInputNumberFloat(a,b,c){c=void 0===c?0:c;var d=new RegExp(/^\d+(\.\d+)?$/);5<a.length?a=a.slice(0,5):0===a.length&&(a="0");return d.test(a)?a>b?b:a<c?c:castFloat(a):c}
function initialize(a){for(var b="",c=0;c<ITEM_ICON_TYPE.length;c++){var d=ITEM_ICON_TYPE[c].id,e=new Image;e.src="../img/type/icon"+d+".png";IMAGES["type"+d]=e}if(d=loadLocalStorage("manual_enemies"))for(d=d.filter(function(n){return UNKNOWN_ENEMY.includes(n.id)}),saveLocalStorage("manual_enemies",d),c={},d=$jscomp.makeIterator(d),e=d.next();!e.done;c={$jscomp$loop$prop$enemy$291:c.$jscomp$loop$prop$enemy$291},e=d.next())c.$jscomp$loop$prop$enemy$291=e.value,UNKNOWN_ENEMY.includes(c.$jscomp$loop$prop$enemy$291.id)&&
(e=ENEMY_DATA.findIndex(function(n){return function(m){return m.id===n.$jscomp$loop$prop$enemy$291.id}}(c)),ENEMY_DATA[e].aa=c.$jscomp$loop$prop$enemy$291.aa,ENEMY_DATA[e].eqp=c.$jscomp$loop$prop$enemy$291.eqp,ENEMY_DATA[e].slot=c.$jscomp$loop$prop$enemy$291.slot);(reserveList=loadSessionStorage("reserve_list"))||(reserveList=[]);updateItemList();setPlaneTypeIconSelect(document.getElementById("plane_type_select"));$("#plane_filter_key_select").val("radius");$("#plane_filter_value").val(0);$("#defense_ap_c").val(1);
setShipType();setEnemyType(ENEMY_TYPE.filter(function(n){return 0<n.id}).map(function(n){return n.id}));document.getElementById("display_final").checked=setting.visibleFinal;document.getElementById("frequent_ship").checked=setting.orderByFrequency;b=$("#shipNo_1").html();$(".ship_tab").each(function(n,m){0<n&&$(m).html(b)});b=$("#battle_container").html();for(c=1;10>c;c++)$("#battle_container").append(b);$(".battle_content").each(function(n,m){$(m).find(".battle_no").text(n+1);0<n&&$(m).addClass("d-none")});
$("#battle_count").val(1);$("#display_bar").prop("checked",!0);$("#display_land_base_result").prop("checked",!0);$("#display_fleet_result").prop("checked",!0);$("#display_enemy_table").prop("checked",!0);$(".remodel_select").prop("disabled",!0);$(".progress_area").html($(".progress_area:first").html());$(".progress_area").each(function(n,m){$(m).find(".result_bar").attr("id","result_bar_"+(n+1));6>n&&$(m).find(".progress_label").text("\u57fa\u5730"+(Math.floor(n/2)+1)+" "+(n%2+1)+"\u6ce2\u76ee");
6===n&&$(m).find(".progress_label").text("\u672c\u968a");7===n&&$(m).find(".progress_label").text("\u9632\u7a7a")});e=d=c=b="";for(var f=1;10>=f;f++)b+='<td class="td_battle battle'+f+'">'+f+"\u6226\u76ee</td>",c+='<td class="td_battle battle'+f+' fap"></td>',d+='<td class="td_battle battle'+f+' eap"></td>',e+='<td class="td_battle battle'+f+' cond"></td>';$("#shoot_down_table").find(".tr_header").append(b+'<td class="td_battle battle_end">\u51fa\u6483\u5f8c</td><td class="td_battle battle_death">\u5168\u6ec5\u7387</td>');
$(".tr_fap").append(c+'<td class="td_battle battle_end fap font_size_11" colspan="2"></td>');$(".tr_eap").append(d+'<td class="td_battle battle_end eap" rowspan="2" colspan="2"></td>');$(".tr_cond").append(e);b="";for(c=1;10>=c;c++)b+='\n\t\t\t<li class="nav-item '+(1===c?"":"d-none")+'">\n\t\t\t\t<a class="nav-link '+("#000000"===mainColor?"":"nav-link-dark")+" "+(1===c?"active":"")+'" data-toggle="tab" data-disp="'+c+'" href="#">'+c+"\u6226\u76ee</a>\n\t\t\t</li>";$("#display_battle_tab").html(b);
b=$("#rate_table").find("thead").html();for(c=0;7>=c;c++)$("#rate_table tbody").append(b);$("#rate_table tbody").find("tr").each(function(n,m){var p=Math.floor(n/2)+1,q=n%2+1;$(m).attr("id","rate_row_"+(n+1));6>n?($(m).find(".rate_td_name").html('<span class="mr-1">\u57fa\u5730'+p+'</span><span class="text-nowrap">'+q+"\u6ce2\u76ee</span>"),$(m)[0].dataset.base_no=p-1,$(m).addClass("cur_pointer land_base_detail")):6===n?$(m).find(".rate_td_name").text("\u672c\u968a"):7===n&&$(m).find(".rate_td_name").text("\u9632\u7a7a");
0===n%2?$(m).addClass("rate_tr_border_top"):6<=n&&$(m).addClass("rate_tr_border_top rate_tr_border_bottom")});b=$("#init_prof_parent").html();c=ITEM_API_TYPE.filter(function(n){return PLANE_TYPE.includes(n.id)&&49!==n.id});c=$jscomp.makeIterator(c);for(d=c.next();!d.done;d=c.next())d=d.value,$("#init_prof_parent").append(b),e=$("#init_prof_parent").find(".type_name:last"),e.text(d.name),e.closest(".init_prof")[0].dataset.typeid=d.id;$("#init_prof_parent").find(".init_prof:first").remove();c=$jscomp.makeIterator(setting.defaultProf);
for(d=c.next();!d.done;d=c.next())d=d.value,proficiency_Changed($('.init_prof[data-typeid="'+d.id+'"').find('.prof_opt[data-prof="'+d.prof+'"]').parent(),!0);if(setting.contentsOrder.length){c=$("#main");var g=[];d=[];var h=[];f=$("#main_header_info");e=$("#footer_info");c.find(".contents").each(function(n,m){g.push($(m).attr("id"));h.push($(m))});c.empty();c.append(f);var l={},k=$jscomp.makeIterator(setting.contentsOrder);for(f=k.next();!f.done;l={$jscomp$loop$prop$id$160$293:l.$jscomp$loop$prop$id$160$293},
f=k.next())l.$jscomp$loop$prop$id$160$293=f.value,g.includes(l.$jscomp$loop$prop$id$160$293)&&(f=h.find(function(n){return function(m){return m.attr("id")===n.$jscomp$loop$prop$id$160$293}}(l)),c.append(f),d.push(l.$jscomp$loop$prop$id$160$293));c.append(e);if(g.length!==d.length){e={};l=$jscomp.makeIterator(g);for(f=l.next();!f.done;e={$jscomp$loop$prop$id$161$295:e.$jscomp$loop$prop$id$161$295},f=l.next())e.$jscomp$loop$prop$id$161$295=f.value,d.includes(e.$jscomp$loop$prop$id$161$295)||(f=h.find(function(n){return function(m){return m.attr("id")===
n.$jscomp$loop$prop$id$161$295}}(e)),c.append(f),d.push(e.$jscomp$loop$prop$id$161$295));setting.contentsOrder=d.concat();saveSetting()}}$("#stage2_detail_slot").val(18);$("#stage2_detail_avoid").val(0);setting.simulateCount?$("#calculate_count").val(setting.simulateCount):$("#calculate_count").val(5E3);setting.initialProf120&&(initialProf120Plane=setting.initialProf120);c=$jscomp.makeIterator(initialProf120Plane);for(d=c.next();!d.done;d=c.next())$("#prof120_"+d.value).prop("checked",!0);setting.displayMode?
Object.keys(setting.displayMode).forEach(function(n){$("#"+n+' .toggle_display_type[data-mode="'+setting.displayMode[n]+'"]').addClass("selected")}):$('.toggle_display_type[data-mode="single"]').addClass("selected");$("#union_fleet").prop("checked",!1);$("#yugeki_fleet").prop("checked",!1);$("#visible_anti_air_status").prop("checked",setting.visibleAntiAirStatus);$("#clipboard_mode").prop("checked",setting.copyToClipboard);$("#empty_slot_invisible").prop("checked",setting.emptySlotInvisible);$("#fav_only").prop("checked",
setting.favoriteOnly);$("#fav_only_ship").prop("checked",setting.favoriteOnlyShip);$("#disp_in_stock").prop("checked",setting.inStockOnly);$("#divide_stock").prop("checked",setting.isDivideStock);$("#disp_in_stock_ship").prop("checked",setting.inStockOnlyShip);$("#disp_equipped").prop("checked",setting.visibleEquipped);$("#disp_equipped_ship").prop("checked",setting.visibleEquippedShip);$("#enemy_display_image").prop("checked",setting.enemyDisplayImage);$("#enemy_display_text").prop("checked",!setting.enemyDisplayImage);
$("#enemy_fleet_display_image").prop("checked",setting.enemyFleetDisplayImage);$("#enemy_fleet_display_text").prop("checked",!setting.enemyFleetDisplayImage);$("#select_difficulty").val(4);$("#plane_word").val("");$("#ship_word").val("");$("#enemy_word").val("");$("#stock_word").val("");"none"===$("#lb_tab_select").css("display")||$("#lb_item1").attr("class").includes("tab-pane")||($(".lb_tab").addClass("tab-pane fade"),$(".baseNo").removeClass("cur_move sortable_handle"),$(".lb_tab:first").addClass("show active"),
$("#lb_item1").addClass("active"));setting.visibleFixedMenu&&($("#footer_menu").collapse("show"),fixedMenuShown());$('[data-toggle="tooltip"]').tooltip();Chart.plugins.unregister(ChartDataLabels);a()}
function TradeHTMLWithAnimation(a,b,c,d){d=void 0===d?300:d;if(isCtrlPress)c();else{var e=a.style.transitionDuration;a.style.transitionDuration=d+"ms";b.style.transitionDuration=d+"ms";var f=b.offsetLeft-a.offsetLeft,g=b.offsetTop-a.offsetTop;a.style.transform="translate("+f+"px, "+g+"px)";b.style.transform="translate("+-f+"px, "+-g+"px)";setTimeout(function(){a.style.transitionDuration=e;b.style.transitionDuration=e;a.style.transform="";b.style.transform="";c()},d)}}
function setPlaneTypeIconSelect(a,b){a.innerHTML=(void 0===b?0:b)?"":'\n\t\t<div class="general_tr item_type active p-2" data-type="0">\n\t\t\t<img src="../img/type/all.png" class="img-size-32" alt="\u5168\u3066">\n\t\t</div>';b=document.createDocumentFragment();for(var c={},d=$jscomp.makeIterator([6,7,8,9,57,10,45,41,1,2,3,4,5,12,14,21,24,47,48,49,17]),e=d.next();!e.done;c={$jscomp$loop$prop$typeId$297:c.$jscomp$loop$prop$typeId$297},e=d.next()){c.$jscomp$loop$prop$typeId$297=e.value;e=ITEM_API_TYPE.find(function(l){return function(k){return k.id===
l.$jscomp$loop$prop$typeId$297}}(c));var f=document.createElement("div");f.className="general_tr item_type p-2";f.dataset.type=e.id;var g=e.name;switch(c.$jscomp$loop$prop$typeId$297){case 10:g="\u6c34\u4e0a\u5075\u5bdf\u6a5f / \u6c34\u4e0a\u7206\u6483\u6a5f";break;case 12:g="\u96fb\u63a2";break;case 14:g="\u5bfe\u6f5c\u88c5\u5099";break;case 24:g="\u8f38\u9001 / \u4e0a\u9678\u7528\u5175\u88c5";break;case 48:g="\u5c40\u5730\u6226\u95d8\u6a5f / \u9678\u8ecd\u6226\u95d8\u6a5f";break;case 17:g="\u305d\u306e\u4ed6"}var h=
document.createElement("img");h.classList="img-size-32";h.src="../img/type/type"+e.id+".png";h.alt=g;f.appendChild(h);b.appendChild(f)}a.appendChild(b)}function getMaxShipCount(){return $("#yugeki_fleet").prop("checked")?7:6}
function setShipType(){for(var a=document.createDocumentFragment(),b=$jscomp.makeIterator(SHIP_TYPE),c=b.next();!c.done;c=b.next()){c=c.value;var d=document.createElement("div");d.className="general_tr ship_type p-2 d-lg-none";d.dataset.type=c.id;d.textContent=c.name;a.appendChild(d)}b=$jscomp.makeIterator(SHIP_TYPE_RE);for(c=b.next();!c.done;c=b.next())c=c.value,d=document.createElement("div"),d.className="general_tr ship_type p-2 d-none d-lg-block",d.dataset.type=c.id,d.textContent=c.name,a.appendChild(d);
document.getElementById("ship_type_select").appendChild(a)}
function setEnemyType(a){for(var b=document.getElementById("enemy_type_select"),c=document.getElementById("manual_enemy_type"),d=$jscomp.makeIterator(ENEMY_TYPE),e=d.next();!e.done;e=d.next())if(e=e.value,a.includes(e.id)){var f=document.createElement("option");f.value=e.id;f.textContent=e.name;b.appendChild(f.cloneNode(!0));var g=document.createElement("option");g.value=e.id;g.textContent=e.name;c.appendChild(f.cloneNode(!0))}b.options[2].selected=!0;b.options[0].selected=!0;var h=castInt(document.getElementById("manual_enemy_type").value);
a=document.getElementById("manual_enemy_id");b=ENEMY_DATA.filter(function(l){return l.type.includes(h)});b=$jscomp.makeIterator(b);for(c=b.next();!c.done;c=b.next())c=c.value,d=document.createElement("option"),d.value=c.id,d.textContent="id: "+(c.id+1500)+" "+c.name,a.appendChild(d);a.options[0].selected=!0}
function clearPlaneDiv(a){a.removeClass(getItemCss(a[0].dataset.type));a[0].dataset.planeid="";a[0].dataset.type="";a.find(".plane_img").attr("src","../img/type/undefined.png").attr("alt","");a.find(".plane_name_span").text("\u88c5\u5099\u3092\u9078\u629e");a.find(".remodel_select").prop("disabled",!0).addClass("remodel_disabled zero");a.find(".remodel_value").text(0);a.find(".btn_remove_plane").addClass("opacity0");a.find(".item_special").addClass("d-none");a.hasClass("expanded_slot")&&a.find(".plane_name_span").text("\u88dc\u5f37\u5897\u8a2d");
a=a.find(".prof_select");a.attr("src","../img/util/prof0.png").attr("alt","");a[0].dataset.prof=0}function clearPlaneDivAll(a){"landBase"===a.attr("id")?($(".lb_plane").each(function(b,c){return setLBPlaneDiv($(c))}),$("#modal_collectively_setting").modal("hide")):"friendFleet"===a.attr("id")&&$(".ship_plane").each(function(b,c){return clearPlaneDiv($(c))})}
function setLBPlaneDiv(a,b){b=void 0===b?{id:0,slot:0,remodel:0}:b;var c=castInt(b.id),d=ITEM_DATA.find(function(g){return g.id===c}),e=setPlaneDiv(a,b);b.hasOwnProperty("slot")||(b.slot=0);var f=18;e&&d&&(RECONNAISSANCES.includes(d.type)?f=4:53===d.type&&(f=9));a.find(".slot_input").attr("max",f);a.find(".slot_range").attr("max",f);b=b.slot;if(0===b||b>f)b=f;e||(b=0);a.find(".slot").text(b)}
function setPlaneDiv(a,b,c){b=void 0===b?{id:0,remodel:0,prof:-1}:b;c=void 0===c?!1:c;if(!b.id)return clearPlaneDiv(a),!1;var d=ITEM_DATA.find(function(h){return h.id===b.id});if(!d)return clearPlaneDiv(a),!1;b.hasOwnProperty("remodel")||(b.remodel=0);b.hasOwnProperty("prof")||(b.prof=-1);if(0<a.closest(".ship_tab").length){var e=castInt(a.closest(".ship_tab")[0].dataset.shipid);if(!checkInvalidItem(e,d,castInt(a.index())))return clearPlaneDiv(a),!1;41!==d.type||1490!==e&&386!==e||(b.hasOwnProperty("slot"),
b.slot=1,c=!0)}a.removeClass(getItemCss(a[0].dataset.type)).addClass(getItemCss(d.itype));a[0].dataset.planeid=d.id;a[0].dataset.type=d.itype;a[0].dataset.type2=d.type;a.find(".plane_name_span").text(d.name).attr("title",d.name);a.find(".plane_img").attr("src","../img/type/icon"+d.itype+".png").attr("alt",d.itype);a.find(".btn_remove_plane").removeClass("opacity0");e=a.find(".remodel_select");e.prop("disabled",!1);d.canRemodel?e.removeClass("remodel_disabled"):e.addClass("remodel_disabled");var f=
Math.min(b.remodel,10);f?e.removeClass("zero"):e.addClass("zero");e.find(".remodel_value").text(f);e=a.find(".item_special");e.addClass("d-none");if(specialOperator.enabled){f=$jscomp.makeIterator(specialOperator.specialInfo);for(var g=f.next();!g.done;g=f.next())if(g=g.value,g.items.includes(d.id)){e.removeClass("d-none");e.html(g.name+'<span class="font_size_12">'+g.remarks+"</span>");break}}e=0;if(f=setting.defaultProf.find(function(h){return h.id===d.type}))e=f.prof;312===d.id&&(e=2);0<=b.prof&&
(e=b.prof);f=a.find(".prof_select");f.attr("src","../img/util/prof"+e+".png");f[0].dataset.prof=e;c&&(b.hasOwnProperty("slot")||(b.slot=0),a.find(".slot").text(b.slot));return!0}
function setShipDiv(a,b,c,d,e){c=void 0===c?99:c;d=void 0===d?0:d;e=void 0===e?0:e;var f=SHIP_DATA.find(function(g){return g.id===b});f&&(a[0].dataset.shipid=f.id,a[0].dataset.shiptype=f.type,a[0].dataset.shiptype2=f.type2,a.find(".ship_img").attr("src","../img/ship/"+b+".png"),0<d&&d<=MAX_AREA?(a.find(".ship_area_img").attr("src","../img/util/area"+d+".png"),a.find(".ship_area_img").removeClass("d-none"),a.find(".area").text(d)):(a.find(".ship_area_img").addClass("d-none"),a.find(".area").text(-1)),
a.find(".sortable_handle").removeClass("d-none"),a.find(".ship_name_span").text(f.name),a.find(".ship_plane").each(function(g,h){h=$(h);var l={id:castInt(h[0].dataset.planeid),remodel:castInt(h.find(".remodel_value").text()),prof:castInt(h.find(".prof_select")[0].dataset.prof)};a[0].dataset.shipid&&setPlaneDiv(h,l);g<f.slot.length?(h.removeClass("d-none").addClass("d-flex"),h.find(".slot").text(f.slot[g]),h.find(".slot_select_parent").data("ini",f.slot[g])):(clearPlaneDiv(h),h.removeClass("d-flex").addClass("d-none"),
h.find(".slot").text(0),h.find(".slot_select_parent").data("ini",0))}),a.find(".ship_level").text(c),a.find(".expanded_slot").removeClass("d-none"),a.find(".aa").text(f.max_aa),0<f.max_scout?(a.find(".max_scout").text(f.max_scout),a.find(".min_scout").text(f.scout)):(a.find(".max_scout").text(-1),a.find(".min_scout").text(-1)),a.find(".scout").text(0),0<e?a.find(".ship_luck").text(e):a.find(".ship_luck").text(f.luck),[6,7,10,11,16,18].includes(f.type)?a.find(".hunshin").removeClass("disabled"):a.find(".hunshin").addClass("disabled"),
a.removeClass("no_ship"))}
function clearShipDiv(a){a[0].dataset.shipid="";a[0].dataset.shiptype="";a[0].dataset.shiptype2="";a.find(".sortable_handle").addClass("d-none");a.find(".ship_img").attr("src","../img/ship/0.png");a.find(".ship_name_span").text("\u8266\u5a18\u3092\u9078\u629e");a.find(".ship_plane").each(function(b,c){c=$(c);clearPlaneDiv(c);c.find(".slot").text(0);c.find(".slot_input").attr("max",99);c.find(".slot_range").attr("max",99);4>b?c.removeClass("d-none").addClass("d-flex"):c.removeClass("d-flex").addClass("d-none")});a.find(".aa").text(0);
a.find(".scout").text(0);a.find(".ship_luck").text(0);a.find(".plane_lock").addClass("d-none");a.find(".plane_unlock").addClass("d-none");a.find(".ship_level").text(99);a.find(".hunshin").addClass("d-none");a.addClass("no_ship")}function clearShipDivAll(a){a=void 0===a?2:a;$(".ship_tab").each(function(b,c){return clearShipDiv($(c))});display_ship_count_Changed($("#friendFleet_item1"),a,!0);display_ship_count_Changed($("#friendFleet_item2"),a,!0)}
function setEnemyDiv(a,b,c){c=void 0===c?0:c;if(a){var d=new Enemy(b),e=!setting.enemyFleetDisplayImage;0!==d.id&&(a[0].dataset.enemyid=d.id,a.removeClass("d-none no_enemy is_dead").addClass("d-flex"),a.find(".enemy_name_text").html(drawEnemyGradeColor(d.name)),a.find(".enemy_name_img").attr("src","../img/enemy/"+d.id+".png"),e?(a.addClass("py-0_5").removeClass("pb-0_1 min-h-31px"),a.find(".enemy_name_img_parent").addClass("d-none").removeClass("d-flex"),a.find(".enemy_name_text").removeClass("d-none")):
(a.removeClass("py-0_5").addClass("pb-0_1 min-h-31px"),a.find(".enemy_name_img_parent").addClass("d-flex").removeClass("d-none"),a.find(".enemy_name_text").addClass("d-none")),e=0,-1===b&&0<c?e=c:0<d.airPower?e=d.airPower:0<d.landBaseAirPower&&(e="("+d.landBaseAirPower+")"),a.find(".enemy_ap").text(e))}}
function clearEnemyDiv(a){a[0].dataset.enemyid=0;a.addClass("no_enemy");a.addClass("py-0_5").removeClass("pb-0_1 min-h-31px is_dead");a.find(".enemy_name_img_parent").addClass("d-none").removeClass("d-flex");a.find(".enemy_name_img").attr("src","../img/enemy/-1.png");a.find(".enemy_name_text").removeClass("d-none");a.find(".enemy_name_text").text("\u6575\u8266\u3092\u9078\u629e");a.find(".enemy_ap").text(0)}
function clearEnemyDivAll(a){a=void 0===a?1:a;$(".battle_content").each(function(b,c){$(c)[0].dataset.celldata="";$(c).find(".enemy_content").each(function(d,e){return clearEnemyDiv($(e))})});$("#battle_count").val(a);createEnemyInput(a);clearEnemyDiv($("#air_raid_enemies").find(".enemy_content"))}
function drawChangeValue(a,b,c,d){d=void 0===d?!1:d;castInt(b)!==castInt(c)?(a=$(a),a.text(c).stop(),d?a.css("color",c<b?"#0c5":c>b?"#f00":mainColor):a.css("color",c>b?"#0c5":c<b?"#f00":mainColor),a.delay(500).animate({color:mainColor},1E3)):$(a).css("color",mainColor)}
function drawEnemyGradeColor(a){a.includes("elite")?a=a.replace("elite",'<span class="text-danger">elite</span>'):a.includes("\u6539flagship")?a=a.replace("flagship",'<span class="text-primary">flagship</span>'):a.includes("flagship")&&(a=a.replace("flagship",'<span class="text-warning">flagship</span>'));return a}
function createItemTable(a,b){var c=$("#modal_plane_select").find(".modal-dialog"),d=$("#plane_tbody"),e=document.getElementById("plane_tbody"),f=document.createDocumentFragment(),g=c.find(".toggle_display_type.selected").data("mode"),h=loadPlaneStock(),l=setting.inStockOnly,k=setting.isDivideStock,n=setting.visibleEquipped,m=setting.favoriteOnly,p=$("#plane_sort_select").val(),q=usedItems.concat(),v=document.getElementById("disp_special").checked,t=["antiAir","antiAirWeight","antiAirBonus","fire",
"accuracy"];6===b||45===b?t=["antiAir","accuracy","fire","avoid2","scout"]:8===b?t=["torpedo","accuracy","antiAir","avoid","asw"]:7===b||57===b?t=["bomber","accuracy","antiAir","avoid","asw"]:10===b||11===b?t=["bomber","scout","antiAir","avoid","accuracy"]:RECONNAISSANCES.includes(b)?t=["scout","radius","accuracy","antiAir","cost"]:[1,2,3,4].includes(b)?t=["fire","accuracy","antiAir","antiAirWeight","antiAirBonus"]:[12,13].includes(b)?t=["antiAir","accuracy","antiAirWeight","antiAirBonus","scout"]:
[14,15].includes(b)?t=["asw","fire","accuracy","avoid2","armor"]:[5,22,32].includes(b)?t=["torpedo","fire","accuracy","avoid2","armor"]:21===b?t=["antiAir","antiAirWeight","antiAirBonus","fire","torpedo"]:LB_ATTACKERS.includes(b)?t=["antiAir","radius","torpedo","avoid","cost"]:48===b&&(t=["antiAir","radius","battleAntiAir","defenseAntiAir","cost"]);$target&&!$target.hasClass("ship_plane")&&(t[1]="radius",t[4]="cost",0===b&&(t=["antiAir","radius","battleAntiAir","cost","avoid"]));var x=0;$("#plane_table_thead").find(".plane_td_basic").each(function(H,
I){$(I).text(convertHeaderText(t[x]));$(I)[0].dataset.sortkey=t[x++];p===$(I)[0].dataset.sortkey?$(I).addClass("active"):$(I).removeClass("active")});"multi"===g?(c.addClass("modal-xl"),c.removeClass("modal-lg"),d.addClass("multi_mode"),c.find(".scroll_thead").addClass("d-none").removeClass("d-flex")):(c.addClass("modal-lg"),c.removeClass("modal-xl"),d.removeClass("multi_mode"),c.find(".scroll_thead").addClass("d-flex").removeClass("d-none"));l?($("#divide_stock").closest("div").removeClass("d-none"),
$("#disp_equipped").closest("div").removeClass("d-none"),$("#disp_in_stock").prop("checked",!0)):($("#divide_stock").closest("div").addClass("d-none"),$("#disp_equipped").closest("div").addClass("d-none"),$("#disp_in_stock").prop("checked",!1));b=a.length;var u=0;c=0;d=-1;for(var r=0,w={},y=0;y<b;w={$jscomp$loop$prop$item$301:w.$jscomp$loop$prop$item$301},y++)if(w.$jscomp$loop$prop$item$301=a[y],!m||setting.favoritePlane.includes(w.$jscomp$loop$prop$item$301.id)){if(l&&h){var C=q.find(function(H){return function(I){return I.id===
H.$jscomp$loop$prop$item$301.id}}(w));if(k){if(-1===w.$jscomp$loop$prop$item$301.stock)continue;d=w.$jscomp$loop$prop$item$301.stock-(C?C.num[w.$jscomp$loop$prop$item$301.remodel]:0);if(!n&&1>d)continue;c=w.$jscomp$loop$prop$item$301.remodel}else{if(0<=w.$jscomp$loop$prop$item$301.stock)continue;var z=h.find(function(H){return function(I){return I.id===H.$jscomp$loop$prop$item$301.id}}(w)),A=C?getArraySum(C.num):0;r=z?getArraySum(z.num):0;if(0===r||!n&&A>=r)continue;d=r-A;for(r=10;0<=r;r--)if(C&&
(z.num[r]-=C.num[r]),0<z.num[r]){c=r;break}}}else if(0<w.$jscomp$loop$prop$item$301.remodel||0<=w.$jscomp$loop$prop$item$301.stock)continue;z="";z="multi"===g?"tr_multi px-1":"px-2";C=document.createElement("div");C.className="plane plane_tr general_tr d-flex py-2 py-lg-1 "+z;C.dataset.planeid=w.$jscomp$loop$prop$item$301.id;C.dataset.type=w.$jscomp$loop$prop$item$301.type;C.dataset.remodel=c;l&&n&&0>=d&&(C.classList.remove("plane_tr","plane","general_tr"),C.classList.add("plane_tr_disabled"));z=
document.createElement("div");z.className="align-self-center size-25 relative";r=document.createElement("canvas");A=r.getContext("2d");r.width=25;r.height=25;A.drawImage(IMAGES["type"+w.$jscomp$loop$prop$item$301.itype],0,0,25,25);if(specialOperator.enabled){A=!1;for(var B=$jscomp.makeIterator(specialOperator.specialInfo),D=B.next();!D.done;D=B.next())if(D=D.value,D.items.includes(w.$jscomp$loop$prop$item$301.id)){A=document.createElement("div");A.className="item_special flash";A.innerHTML=D.name+
'<span class="font_size_12">'+D.remarks+"</span>";z.appendChild(A);A=!0;break}if(v&&!A)continue}A=document.createElement("div");A.className="pl-1 d-flex align-self-center flex-grow-1";B=!1;16===w.$jscomp$loop$prop$item$301.itype&&8<=w.$jscomp$loop$prop$item$301.antiAir?B=!0:21===w.$jscomp$loop$prop$item$301.type&&9<=w.$jscomp$loop$prop$item$301.antiAir?B=!0:ROCKETS.includes(w.$jscomp$loop$prop$item$301.id)?B=!0:TAICHI.includes(w.$jscomp$loop$prop$item$301.id)&&(B=!0);D=document.createElement("div");
D.className="pl-1 plane_td_name align-self-center"+(B?" special_item":"");D.textContent=w.$jscomp$loop$prop$item$301.name;A.appendChild(D);B=document.createElement("div");B.className="ml-2 plane_td_stock align-self-center";B.textContent="\u00d7"+(0<d?d:0);D=document.createDocumentFragment();var E=document.createElement("div");E.className="ml-auto plane_td_basic align-self-center";var F=document.createElement("div");F.className="plane_td_basic align-self-center";var G=document.createElement("div");
G.className="plane_td_basic align-self-center d-none d-lg-block";var J=document.createElement("div");J.className="plane_td_basic align-self-center d-none d-lg-block";var M=document.createElement("div");M.className="plane_td_basic align-self-center d-none d-lg-block";E.textContent=sFormat(w.$jscomp$loop$prop$item$301[t[0]],t[0]);F.textContent=sFormat(w.$jscomp$loop$prop$item$301[t[1]],t[1]);G.textContent=sFormat(w.$jscomp$loop$prop$item$301[t[2]],t[2]);J.textContent=sFormat(w.$jscomp$loop$prop$item$301[t[3]],
t[3]);M.textContent=sFormat(w.$jscomp$loop$prop$item$301[t[4]],t[4]);if("multi"===g&&u!==w.$jscomp$loop$prop$item$301.type&&"default"===p){u=document.createElement("div");u.className="type_divider mt-3 mb-1";var K=document.createElement("div");K.className="font_size_12 font_color_half align-self-center";K.textContent=ITEM_API_TYPE.find(function(H){return function(I){return I.id===H.$jscomp$loop$prop$item$301.type}}(w)).name;var L=document.createElement("div");L.className="flex-grow-1 border-bottom align-self-center mx-2";
u.appendChild(K);u.appendChild(L);f.appendChild(u)}z.appendChild(r);C.appendChild(z);k&&0<w.$jscomp$loop$prop$item$301.remodel&&(u=document.createElement("div"),u.className="plane_td_remodel text_remodel align-self-center",u.dataset.remodel=w.$jscomp$loop$prop$item$301.remodel,z="",z="multi"===g?"\u2605"+w.$jscomp$loop$prop$item$301.remodel:10>w.$jscomp$loop$prop$item$301.remodel?"\u2605+"+w.$jscomp$loop$prop$item$301.remodel:"\u2605MAX",u.textContent=z,A.appendChild(u),A.appendChild(B));0<d&&A.appendChild(B);
C.appendChild(A);"single"===g&&(D.appendChild(E),D.appendChild(F),D.appendChild(G),D.appendChild(J),D.appendChild(M),C.appendChild(D));f.appendChild(C);u=w.$jscomp$loop$prop$item$301.type}f.childNodes.length||(a=document.createElement("div"),a.className="text-center",l&&!n&&(a.textContent+="\u88c5\u5099\u6240\u6301\u6570\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001\u5168\u3066\u306e\u88c5\u5099\u304c\u914d\u5099\u6e08\u307f\u3067\u3059\u3002"),l&&!n&&(a.textContent+="\u88c5\u5099\u6240\u6301\u6570\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001\u5168\u3066\u306e\u88c5\u5099\u304c\u914d\u5099\u6e08\u307f\u3067\u3059\u3002"));
e.innerHTML="";e.appendChild(f)}
function createShipTable(){var a=document.getElementById("modal_ship_select").getElementsByClassName("modal-dialog")[0],b=document.getElementById("ship_tbody"),c=a.querySelector(".toggle_display_type.selected").dataset.mode,d=document.getElementById("display_final").checked,e=document.getElementById("ship_word").value.trim(),f=document.getElementById("frequent_ship").checked,g=document.getElementById("disp_in_stock_ship").checked,h=document.getElementById("disp_equipped_ship").checked,l=document.getElementById("disp_daihatsu_ship").checked,
k=document.getElementById("disp_kamisha_ship").checked,n=document.getElementById("disp_slot_ex_ship").checked,m=document.getElementById("fav_only_ship").checked,p=loadShipStock(),q=0;q=$("#ship_type_select .ship_type.active");q=q.length?castInt(q[0].dataset.type):111;var v=[];switch(q){case 103:v=[3,4];break;case 105:v=[5,6];break;case 108:v=[8,9,10];break;case 111:v=[7,11,18];break;case 114:v=[13,14];break;case 116:v=[1,16,17,19,20,21,22];break;case 11:v=[11,18];break;case 8:v=[8,9];break;case 117:v=
[1,17,19,20,21,22];break;default:v.push(q)}setting.visibleFinal=d;setting.orderByFrequency=f;setting.inStockOnlyShip=g;setting.visibleEquippedShip=h;setting.favoriteOnlyShip=m;saveSetting();g?($("#disp_equipped_ship").closest("div").removeClass("d-none"),$("#disp_slot_ex_ship").closest("div").removeClass("d-none")):($("#disp_equipped_ship").closest("div").addClass("d-none"),$("#disp_slot_ex_ship").closest("div").addClass("d-none"));q=SHIP_DATA.filter(function(E){return e?E.id==e||E.name.includes(e):
v.includes(E.type)&&(d?0<E.final:!0)});if(m){var t=setting.favoriteShip;q=q.filter(function(E){return t.includes(E.id)})}if(g){m={};for(var x=$jscomp.makeIterator(p),u=x.next();!u.done;m={$jscomp$loop$prop$stock$304:m.$jscomp$loop$prop$stock$304,$jscomp$loop$prop$baseLv$305:m.$jscomp$loop$prop$baseLv$305,$jscomp$loop$prop$baseArea$306:m.$jscomp$loop$prop$baseArea$306},u=x.next())if(m.$jscomp$loop$prop$stock$304=u.value,u=n?m.$jscomp$loop$prop$stock$304.details.filter(function(E){return 1===E.ex||
-1===E.ex}):m.$jscomp$loop$prop$stock$304.details,0>=u.length)q=q.filter(function(E){return function(F){return F.id!==E.$jscomp$loop$prop$stock$304.id}}(m));else{u.sort(function(E,F){return E.lv-F.lv});var r=q.findIndex(function(E){return function(F){return F.id===E.$jscomp$loop$prop$stock$304.id}}(m));if(!(0>r)){var w=q[r];m.$jscomp$loop$prop$baseLv$305=u[0].lv;var y=u[0].st[4];m.$jscomp$loop$prop$baseArea$306=u[0].area<=MAX_AREA&&0<u[0].area?u[0].area:-1;w.lv=m.$jscomp$loop$prop$baseLv$305;w.area=
m.$jscomp$loop$prop$baseArea$306;w.upLuck=y;w.stock=u.filter(function(E){return function(F){return F.lv===E.$jscomp$loop$prop$baseLv$305&&(F.area===E.$jscomp$loop$prop$baseArea$306||1>E.$jscomp$loop$prop$baseArea$306&&1>F.area)}}(m)).length;w.ex=u[0].ex;y=[{lv:m.$jscomp$loop$prop$baseLv$305,area:m.$jscomp$loop$prop$baseArea$306}];if(2<=u.length)for(var C={},z=1;z<u.length;C={$jscomp$loop$prop$lv$310:C.$jscomp$loop$prop$lv$310,$jscomp$loop$prop$area$311:C.$jscomp$loop$prop$area$311},z++){C.$jscomp$loop$prop$lv$310=
u[z].lv;var A=u[z].st[4];C.$jscomp$loop$prop$area$311=u[z].area<=MAX_AREA&&0<u[z].area?u[z].area:-1;if(!y.find(function(E){return function(F){return F.lv===E.$jscomp$loop$prop$lv$310&&F.area===E.$jscomp$loop$prop$area$311}}(C))){var B=Object.assign({},w);B.lv=C.$jscomp$loop$prop$lv$310;B.area=C.$jscomp$loop$prop$area$311;B.stock=u.filter(function(E){return function(F){return F.lv===E.$jscomp$loop$prop$lv$310&&(F.area===E.$jscomp$loop$prop$area$311||1>E.$jscomp$loop$prop$area$311&&1>F.area)}}(C)).length;
B.upLuck=A;B.ex=u[z].ex;q.splice(r,0,B);y.push({lv:C.$jscomp$loop$prop$lv$310,area:C.$jscomp$loop$prop$area$311})}}}}}if(f&&setting.selectedHistory[1]){var D=setting.selectedHistory[1];q.sort(function(E,F){return D.filter(function(G){return G===F.id}).length-D.filter(function(G){return G===E.id}).length})}q.sort(function(E,F){return 7===E.type&&7!==F.type||7===F.type&&7!==E.type?F.type-E.type:6===E.type&&6!==F.type||6===F.type&&6!==E.type?F.type-E.type:10===E.type&&10!==F.type||10===F.type&&10!==
E.type?F.type-E.type:E.type-F.type});n=document.createDocumentFragment();x=r=0;m={};q=$jscomp.makeIterator(q);for(u=q.next();!u.done;m={$jscomp$loop$prop$ship$315:m.$jscomp$loop$prop$ship$315},u=q.next())if(m.$jscomp$loop$prop$ship$315=u.value,!l||OK_DAIHATSU_TYPE.includes(m.$jscomp$loop$prop$ship$315.type)||OK_DAIHATSU_SHIP.includes(m.$jscomp$loop$prop$ship$315.api))if(!k||OK_NAIKATEI_TYPE.includes(m.$jscomp$loop$prop$ship$315.type)||OK_NAIKATEI_SHIP.includes(m.$jscomp$loop$prop$ship$315.api)){w=
1;if(g&&p){if(!m.$jscomp$loop$prop$ship$315.lv)continue;m.$jscomp$loop$prop$ship$315.stock&&(w=m.$jscomp$loop$prop$ship$315.stock);u=usedShip.filter(function(E){return function(F){return F.id===E.$jscomp$loop$prop$ship$315.id&&F.lv===E.$jscomp$loop$prop$ship$315.lv&&F.area===E.$jscomp$loop$prop$ship$315.area}}(m)).length;w-=u;if(0>=w&&!h)continue}u=document.createElement("div");u.className=g&&h&&!w?"ship_tr ship_tr_disabled d-flex "+("multi"===c?"tr_multi":""):"ship_tr general_tr d-flex "+("multi"===
c?"tr_multi":"");u.dataset.shipid=m.$jscomp$loop$prop$ship$315.id;u.dataset.level=m.$jscomp$loop$prop$ship$315.lv?m.$jscomp$loop$prop$ship$315.lv:99;u.dataset.area=0<m.$jscomp$loop$prop$ship$315.area?m.$jscomp$loop$prop$ship$315.area:0;u.dataset.luck=m.$jscomp$loop$prop$ship$315.luck+m.$jscomp$loop$prop$ship$315.upLuck;u.id="ship_tr_"+m.$jscomp$loop$prop$ship$315.id;y=document.createElement("div");y.className="ml-1 align-self-center pt-1";C=document.createElement("img");C.width=120;C.height=30;C.src=
"../img/ship/"+m.$jscomp$loop$prop$ship$315.id+".png";y.appendChild(C);g&&0<m.$jscomp$loop$prop$ship$315.area&&(y.classList.add("exist_area"),C=document.createElement("img"),C.className="area_banner",C.src="../img/util/area"+m.$jscomp$loop$prop$ship$315.area+".png",y.appendChild(C));C=document.createElement("div");C.className="ml-1 align-self-center";z=document.createElement("div");z.className="text-primary font_size_11";z.textContent=g?"Lv : "+m.$jscomp$loop$prop$ship$315.lv:"ID : "+m.$jscomp$loop$prop$ship$315.id;
A=document.createElement("div");A.className="d-flex";A.textContent=m.$jscomp$loop$prop$ship$315.name;B=document.createElement("div");B.className="ml-1 ship_td_stock align-self-center "+(g?"":"d-none");B.textContent="\u00d7"+w;A.appendChild(B);C.appendChild(z);C.appendChild(A);u.appendChild(y);u.appendChild(C);if("multi"!==c)for(w=0;5>w;w++)y=document.createElement("div"),y.className="ship_td_slot font_size_12 align-self-center "+(0===w?"ml-auto":""),y.textContent=w<m.$jscomp$loop$prop$ship$315.slot.length?
m.$jscomp$loop$prop$ship$315.slot[w]:"",u.appendChild(y);r!==m.$jscomp$loop$prop$ship$315.type&&(r=document.createElement("div"),r.className="type_divider mt-4",w=document.createElement("div"),w.className="align-self-center font_size_16",w.textContent=API_SHIP_TYPE.find(function(E){return function(F){return F.id===E.$jscomp$loop$prop$ship$315.type}}(m)).name,y=document.createElement("div"),y.className="flex-grow-1 border-bottom align-self-center mx-2",r.appendChild(w),r.appendChild(y),n.appendChild(r));
f||x===m.$jscomp$loop$prop$ship$315.type2||(x=document.createElement("div"),x.className="type_divider mt-2 ml-1",r=document.createElement("div"),r.className="font_size_12 font_color_half align-self-center",w=API_CTYPE.find(function(E){return function(F){return F.id===E.$jscomp$loop$prop$ship$315.type2}}(m))||{name:""},r.textContent=w.name,x.appendChild(r),n.appendChild(x));r=m.$jscomp$loop$prop$ship$315.type;x=m.$jscomp$loop$prop$ship$315.type2;n.appendChild(u)}"multi"===c?(a.classList.add("modal-xl"),
b.classList.add("multi_mode"),a=a.getElementsByClassName("scroll_thead")[0],a.classList.add("d-none"),a.classList.remove("d-flex")):(a.classList.remove("modal-xl"),b.classList.remove("multi_mode"),a=a.getElementsByClassName("scroll_thead")[0],a.classList.add("d-flex"),a.classList.remove("d-none"));b.innerHTML="";b.appendChild(n)}
function createEnemyInput(a){$(".battle_content").each(function(d,e){d<a?$(e).removeClass("d-none"):$(e).addClass("d-none")});$("#battle_count").val(a);$("#land_base_target_buttons").find(".btn-group").each(function(d,e){$(e).find(".btn").each(function(f,g){f<a?$(g).removeClass("disabled btn-outline-secondary").addClass("btn-outline-info"):$(g).addClass("disabled btn-outline-secondary").removeClass("btn-outline-info")})});$("#display_battle_tab").find(".nav-link").each(function(d,e){$(e).removeClass("active");
d<a?$(e).parent().removeClass("d-none"):$(e).parent().addClass("d-none")});$("#display_battle_tab").find('[data-disp="'+a+'"]').addClass("active");battleCount=a;displayBattle=a-1;var b=selectedFormations.length;if(b<=battleCount)for(var c=0;c<battleCount-b;c++)selectedFormations.push(1);else selectedFormations=selectedFormations.slice(0,battleCount)}
function initializeEnemyTable(){for(var a=document.createDocumentFragment(),b=[],c=0,d={},e=$jscomp.makeIterator(ENEMY_TYPE),f=e.next();!f.done;d={$jscomp$loop$prop$typeObject$317:d.$jscomp$loop$prop$typeObject$317},f=e.next())d.$jscomp$loop$prop$typeObject$317=f.value,1!==d.$jscomp$loop$prop$typeObject$317.id&&(f=ENEMY_DATA.filter(function(k){return function(n){return n.type[0]===k.$jscomp$loop$prop$typeObject$317.id}}(d)),b=b.concat(f.sort(function(k,n){return k.orig>n.orig?1:k.orig<n.orig?-1:k.id-
n.id})));d=ENEMY_DATA.filter(function(k){return 1===k.type[0]});b=b.concat(d.sort(function(k,n){return k.id>n.id?1:-1}));d={};b=$jscomp.makeIterator(b);for(e=b.next();!e.done;d={$jscomp$loop$prop$enemy$319:d.$jscomp$loop$prop$enemy$319},e=b.next()){d.$jscomp$loop$prop$enemy$319=new Enemy(e.value.id);e=document.createElement("div");e.className="enemy enemy_tr general_tr d-flex";e.dataset.enemyid=d.$jscomp$loop$prop$enemy$319.id;e.id="enemy_tr_"+d.$jscomp$loop$prop$enemy$319.id;f=document.createElement("div");
f.className="ml-1 align-self-center";var g=document.createElement("img");g.width=128;g.height=32;g.src="../img/enemy/"+d.$jscomp$loop$prop$enemy$319.id+".png";f.appendChild(g);g=document.createElement("div");g.className="ml-1 align-self-center";var h=document.createElement("div");h.className="text-primary font_size_11";h.textContent="ID : "+(d.$jscomp$loop$prop$enemy$319.id+1500);var l=document.createElement("div");l.className="font_size_12";l.innerHTML=drawEnemyGradeColor(d.$jscomp$loop$prop$enemy$319.name);
g.appendChild(h);g.appendChild(l);c!==d.$jscomp$loop$prop$enemy$319.type[0]&&-1!==d.$jscomp$loop$prop$enemy$319.id&&(c=document.createElement("div"),c.className="w-100 d-flex mt-3 divide_line",h=document.createElement("div"),h.className="font_size_12 font_color_half align-self-center",h.textContent=ENEMY_TYPE.find(function(k){return function(n){return n.id===k.$jscomp$loop$prop$enemy$319.type[0]}}(d)).name,l=document.createElement("div"),l.className="flex-grow-1 border-bottom align-self-center mx-2",
c.appendChild(h),c.appendChild(l),a.appendChild(c),c=d.$jscomp$loop$prop$enemy$319.type[0]);e.appendChild(f);e.appendChild(g);f=document.createElement("div");f.className="ml-auto align-self-center enemy_td_ap";f.textContent=d.$jscomp$loop$prop$enemy$319.landBaseAirPower>d.$jscomp$loop$prop$enemy$319.airPower?d.$jscomp$loop$prop$enemy$319.airPower+" ("+d.$jscomp$loop$prop$enemy$319.landBaseAirPower+")":d.$jscomp$loop$prop$enemy$319.airPower;e.appendChild(f);a.appendChild(e)}document.getElementById("enemy_tbody").appendChild(a)}
function createEnemyTable(){var a=castInt($("#enemy_type_select").val()),b=document.getElementById("modal_enemy_select").getElementsByClassName("modal-dialog")[0],c=document.getElementById("enemy_tbody"),d=b.querySelector(".toggle_display_type.selected").dataset.mode,e=$("#enemy_word").val().trim();c.childElementCount||initializeEnemyTable();"multi"===d?(b.classList.add("modal-xl"),c.classList.add("d-flex","flex-wrap"),b=b.getElementsByClassName("scroll_thead")[0],b.classList.add("d-none"),b.classList.remove("d-flex")):
(b.classList.remove("modal-xl"),c.classList.remove("d-flex","flex-wrap"),b=b.getElementsByClassName("scroll_thead")[0],b.classList.add("d-flex"),b.classList.remove("d-none"));b=$jscomp.makeIterator(ENEMY_DATA);for(var f=b.next();!f.done;f=b.next()){f=f.value;var g=document.getElementById("enemy_tr_"+f.id);"multi"===d?g.classList.add("enemy_tr_multi"):g.classList.remove("enemy_tr_multi");e?f.id+1500==e||f.name.includes(e)?(g.classList.add("d-flex"),g.classList.remove("d-none")):(g.classList.add("d-none"),
g.classList.remove("d-flex")):0===a||f.type.includes(a)?(g.classList.add("d-flex"),g.classList.remove("d-none")):(g.classList.add("d-none"),g.classList.remove("d-flex"))}if("multi"===d){if(0===a)for(d=$jscomp.makeIterator(c.getElementsByClassName("divide_line")),a=d.next();!a.done;a=d.next())a=a.value,a.classList.add("d-flex"),a.classList.remove("d-none");else for(d=$jscomp.makeIterator(c.getElementsByClassName("divide_line")),a=d.next();!a.done;a=d.next())a=a.value,a.classList.remove("d-flex"),a.classList.add("d-none");
c=$jscomp.makeIterator(c.getElementsByClassName("enemy_td_ap"));for(a=c.next();!a.done;a=c.next())a.value.classList.add("d-none")}else{d=$jscomp.makeIterator(c.getElementsByClassName("divide_line"));for(a=d.next();!a.done;a=d.next())a=a.value,a.classList.add("d-none"),a.classList.remove("d-flex");c=$jscomp.makeIterator(c.getElementsByClassName("enemy_td_ap"));for(a=c.next();!a.done;a=c.next())a.value.classList.remove("d-none")}$("#modal_enemy_select").find(".btn_remove").prop("disabled",!0)}
function loadPlanePreset(){var a=$("#modal_plane_preset");(planePreset=loadLocalStorage("planePreset"))||(planePreset=DEFAULT_PLANE_PRESET.concat());for(var b=castInt($("#modal_plane_preset").data("parentid")),c="",d=planePreset.length,e=0;e<d;e++){for(var f=planePreset[e],g='\n\t\t\t<div class="preset_td preset_td_info text-danger cur_help ml-auto" data-toggle="tooltip" data-boundary="window"\n\t\t\t\ttitle="\u5168\u3066\u306e\u88c5\u5099\u304c\u5c55\u958b\u3067\u304d\u307e\u305b\u3093\u3002">\n\t\t\t\t<i class="fas fa-exclamation-triangle"></i>\n\t\t\t</div>\n\t\t',
h=0,l={},k=$jscomp.makeIterator(f.planes),n=k.next();!n.done;l={$jscomp$loop$prop$plane$321:l.$jscomp$loop$prop$plane$321},n=k.next())l.$jscomp$loop$prop$plane$321=n.value,0>=l.$jscomp$loop$prop$plane$321.id?h+=1:checkInvalidItem(b,ITEM_DATA.find(function(m){return function(p){return p.id===m.$jscomp$loop$prop$plane$321.id}}(l)),h)&&(g='\n\t\t\t\t<div class="preset_td preset_td_info text-warning cur_help ml-auto" data-toggle="tooltip" data-boundary="window"\n\t\t\t\t\ttitle="\u5c55\u958b\u3067\u304d\u306a\u3044\u88c5\u5099\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002">\n\t\t\t\t\t<i class="fas fa-exclamation-triangle"></i>\n\t\t\t\t</div>',
h+=1),h===f.planes.length&&(g="");c+='\n\t\t\t<div class="preset_tr general_tr d-flex px-1 py-1_5 my-1 w-100 cur_pointer" data-presetid="'+f.id+'">\n\t\t\t\t<div class="preset_td text-primary">'+(e+1)+'.</div>\n\t\t\t\t<div class="preset_td ml-2">'+f.name+"</div>\n\t\t\t\t\t"+g+"\n\t\t\t</div>\n\t\t"}a.find(".alert").addClass("d-none");a.find(".preset_tr").removeClass("preset_selected");a.find(".preset_tbody").html(c);a.find(".preset_name").val("\u5de6\u306e\u30d7\u30ea\u30bb\u30c3\u30c8\u4e00\u89a7\u3092\u30af\u30ea\u30c3\u30af").prop("disabled",
!0);a.find(".is-invalid").removeClass("is-invalid");a.find(".is-valid").removeClass("is-valid");a.find(".preset_preview_tbody").html("");a.find(".btn:not(.btn_cancel)").prop("disabled",!0);$(".preset_td_info").tooltip()}
function drawPlanePresetPreview(a){var b="",c=[],d=$("#modal_plane_preset"),e=castInt($("#modal_plane_preset").data("parentid"));d.find(".alert").addClass("d-none");if(a){d.find(".preset_name").val(a.name);for(var f={},g=$jscomp.makeIterator(a.planes),h=g.next();!h.done;f={$jscomp$loop$prop$plane$323:f.$jscomp$loop$prop$plane$323},h=g.next()){f.$jscomp$loop$prop$plane$323=h.value;h=ITEM_DATA.find(function(k){return function(n){return n.id===k.$jscomp$loop$prop$plane$323.id}}(f));var l={id:0,type:0,
itype:0,name:"",remodel:0};h&&(l.id=f.$jscomp$loop$prop$plane$323.id,l.type=h.type,l.itype=h.itype,l.name=h.name,l.remodel=f.$jscomp$loop$prop$plane$323.remodel);c.push(l)}}else d.find(".preset_name").val(""),$target.find("."+($target.attr("class").includes("lb_tab")?"lb_plane":"ship_plane")).each(function(k,n){if(k=ITEM_DATA.find(function(m){return m.id===castInt($(n)[0].dataset.planeid)}))k={id:k.id,type:k.type,itype:k.itype,name:k.name,remodel:castInt($(n).find(".remodel_value").text())},c.push(k)}),
0===c.length&&d.find(".alert").removeClass("d-none");f=0;g=$jscomp.makeIterator(c);for(h=g.next();!h.done;h=g.next())h=h.value,h.id?(l=!checkInvalidItem(e,h,f++),b+='\n\t\t\t<div class="preset_preview_tr d-flex justify-content-start border-bottom" data-planeid="'+h.id+'" data-remodel="'+h.remodel+'">\n\t\t\t\t<div class="preset_preview_td_type"><img class="img-size-25" src="../img/type/icon'+h.itype+'.png"></div>\n\t\t\t\t<div class="preset_preview_td_name ml-1 py-2">'+h.name+'</div>\n\t\t\t\t<div class="text_remodel">'+
(h.remodel?"\u2605"+h.remodel:"")+"</div>\n\t\t\t\t"+(l?'\n\t\t<div class="preset_preview_td_info ml-2 text-warning cur_help" data-toggle="tooltip" title="\u5c55\u958b\u5148\u306b\u4e0d\u9069\u5408\u306a\u88c5\u5099\u3067\u3059">\n\t\t\t<i class="fas fa-exclamation-triangle"></i>\n\t\t</div>\n\t':"")+"\n\t\t\t</div>"):b+='\n\t\t\t<div class="preset_preview_tr d-flex justify-content-start border-bottom" data-planeid="0" data-remodel="0">\n\t\t\t\t<div class="preset_preview_td_type"><img class="img-size-25" src="../img/type/undefined.png"></div>\n\t\t\t\t<div class="preset_preview_td_name ml-1 py-2">\u672a\u88c5\u5099</div>\n\t\t\t</div>';
d.find(".btn_expand_preset").prop("disabled",!a);d.find(".btn_delete_preset").prop("disabled",!a);d.find(".btn_commit_preset").prop("disabled",!0);d.find(".preset_name").prop("disabled",0===c.length);d.find(".is-invalid").removeClass("is-invalid");d.find(".is-valid").removeClass("is-valid");d.find(".preset_preview_tbody").html(b);d.find(".preset_preview_td_info").tooltip()}
function updatePlanePreset(){var a=castInt($(".preset_selected").data("presetid")),b=[];$(".preset_preview_tr").each(function(f,g){b.push({id:castInt($(g)[0].dataset.planeid),remodel:castInt($(g)[0].dataset.remodel)})});for(var c=0,d=$jscomp.makeIterator(planePreset),e=d.next();!e.done;e=d.next())e=e.value,c<e.id&&(c=e.id);c={id:-1===a?c+1:a,name:$("#modal_plane_preset").find(".preset_name").val().replace(/^\s+|\s+$/g,""),planes:b};planePreset=planePreset.filter(function(f){return f.id!==a});planePreset.push(c);
planePreset.sort(function(f,g){return f.id-g.id});saveLocalStorage("planePreset",planePreset)}function deletePlanePreset(){var a=castInt($(".preset_selected").data("presetid"));planePreset=planePreset.filter(function(b){return b.id!==a});planePreset.sort(function(b,c){return b.id-c.id});saveLocalStorage("planePreset",planePreset)}
function loadMapData(){fetch("../js/map_data.json",{method:"GET"}).then(function(a){a.ok?a.json().then(function(b){ENEMY_PATTERN=b.ENEMY_PATTERN;createMapSelect();createNodeSelect()}):inform_danger(a.statusText)}).catch(function(a){sendErrorLog(a)})}function modal_enemy_pattern_Shown(){$("#map_select").html()||($("#map_select").html('<option value="1">\u6d77\u57df\u30c7\u30fc\u30bf\u8aad\u8fbc\u4e2d</option>'),loadMapData())}
function createMapSelect(){for(var a="",b={},c=$jscomp.makeIterator(WORLD_DATA),d=c.next();!d.done;b={$jscomp$loop$prop$world$325:b.$jscomp$loop$prop$world$325},d=c.next()){d=d.value;b.$jscomp$loop$prop$world$325=d.world;var e=MAP_DATA.filter(function(f){return function(g){return Math.floor(g.area/10)===f.$jscomp$loop$prop$world$325}}(b));a+='<optgroup label="'+d.name+'">';d=$jscomp.makeIterator(e);for(e=d.next();!e.done;e=d.next())e=e.value,a+='<option value="'+e.area+'">'+(20<b.$jscomp$loop$prop$world$325?
"E":b.$jscomp$loop$prop$world$325)+"-"+e.area%10+" : "+e.name+"</option>"}$("#map_select").html(a);$("#select_preset_category").html(a)}function btn_zoom_map_Clicked(){var a=castInt($("#map_select").val());document.getElementById("big_map_img").src="../img/map/detail/"+a+".png";$("#modal_big_map").modal("show")}
function createNodeSelect(){var a=castInt($("#map_select").val()),b=0;200>a?$("#select_difficulty_div").addClass("d-none"):($("#select_difficulty_div").removeClass("d-none"),b=castInt($("#select_difficulty").val()));$("#map_img").attr("src","../img/map/"+a+".png");510<a||[11,65,74].includes(a)?document.getElementById("btn_zoom_map").classList.remove("d-none"):document.getElementById("btn_zoom_map").classList.add("d-none");var c=ENEMY_PATTERN.filter(function(n){return n.a===a&&n.l===b});c=c.filter(function(n,
m,p){return p.findIndex(function(q){return q.n===n.n})===m});c.sort(function(n,m){return"\u7a7a\u8972"==n.n&&"\u7a7a\u8972"==m.n?0:"\u7a7a\u8972"==n.n?-1:"\u7a7a\u8972"==m.n?1:0});for(var d=c.length,e="",f="",g=0;g<d;g++){var h=c[g].n,l=c[g].c;e+='\n\t\t<div class="d-flex node_tr general_tr justify-content-center py-1 w-100 cur_pointer" data-node="'+h+'">\n\t\t\t<div class="align-self-center">'+h+"</div>\n\t\t</div>\n\t";if(""!==l)if(2===l.split(",").length){var k=castInt(l.split(",")[0]);l=castInt(l.split(",")[1]);
f+='<area class="node" title="'+h+'" coords="'+k+","+l+","+(k+20)+","+(l+20)+'" shape="rect">'}else f+='<area class="node" title="'+h+'" coords="'+l+'" shape="rect">'}$("#node_tbody").html(e);$("#clickable_nodes").html(f);$("#enemy_pattern_tbody").html("");$("#enemy_pattern_select").html('<li class="nav-item"><a class="nav-link '+("#000000"===mainColor?"":"nav-link-dark")+' active" data-toggle="tab" href="#">\u7de8\u62101</a></li>');$("#enemy_pattern_air_power").text("0");$("#enemy_display_mode_parent").addClass("d-none").removeClass("d-flex");
$("#btn_expand_enemies").prop("disabled",!0);$("#btn_continue_expand").prop("disabled",!0)}
function createEnemyPattern(a){a=void 0===a?0:a;var b=castInt($("#map_select").val()),c=$(".node_selected").data("node"),d=0;100>b?$("#select_difficulty_div").addClass("d-none"):($("#select_difficulty_div").removeClass("d-none"),d=castInt($("#select_difficulty").val()));for(var e="",f=0,g=0,h=ENEMY_PATTERN.filter(function(v){return v.a===b&&v.n===c&&v.l===d}),l=h[a],k=l.e,n=k.length,m={$jscomp$loop$prop$index$327:0};m.$jscomp$loop$prop$index$327<n;m={$jscomp$loop$prop$index$327:m.$jscomp$loop$prop$index$327},
m.$jscomp$loop$prop$index$327++){var p=ENEMY_DATA.find(function(v){return function(t){return t.id===k[v.$jscomp$loop$prop$index$327]}}(m));if(p){var q=new Enemy(p.id);f+=q.airPower;g+=q.antiAirBonus;e+='\n\t\t<div class="enemy_pattern_tr mx-1 d-flex border-bottom" data-enemyid="'+p.id+'">\n\t\t\t<div class="enemy_pattern_tr_image mr-1">\n\t\t\t\t<img src="../img/enemy/'+p.id+'.png" class="enemy_img">\n\t\t\t</div>\n\t\t\t<div class="enemy_pattern_tr_text">\n\t\t\t\t<div class="font_size_11 text-primary">ID: '+
(p.id+1500)+"</div>\n\t\t\t\t<div>"+drawEnemyGradeColor(p.name)+"</div>\n\t\t\t</div>\n\t\t</div>\n\t\t"}}m=FORMATION.find(function(v){return v.id===l.f});g=2*Math.floor(m.correction*g);$("#enemy_pattern_anti_air").text(g);$("#enemy_pattern_formation").text(m.name);0<l.r?($("#enemy_pattern_radius_parent").removeClass("d-none"),$("#enemy_pattern_radius").removeClass("d-none"),$("#enemy_pattern_radius").text(l.r)):($("#enemy_pattern_radius_parent").addClass("d-none"),$("#enemy_pattern_radius").addClass("d-none"));
if(0===a){a="";for(g=0;g<h.length;g++)a+='\n\t\t\t<li class="nav-item font_size_12">\n\t\t\t\t<a class="nav-link '+("#000000"===mainColor?"":"nav-link-dark")+" "+(0===g?"active":"")+'" data-toggle="tab" data-disp="'+g+'" href="#">\n\t\t\t\t\t'+(h[g].d?h[g].d:"\u7de8\u6210"+(g+1))+"\n\t\t\t\t</a>\n\t\t\t</li>\n\t\t\t";$("#enemy_pattern_select").html(a)}h=getAirStatusBorder(f);$("#enemy_pattern_tbody").html(e);$("#enemy_pattern_air_power").text(f);$("#enemy_pattern_status0").text(h[0]);$("#enemy_pattern_status1").text(h[1]);
$("#enemy_pattern_status2").text(h[2]);$("#enemy_pattern_status3").text(h[3]);$("#btn_expand_enemies").prop("disabled",!1);$("#btn_continue_expand").prop("disabled",!1);6<n?($("#enemy_display_mode_parent").removeClass("d-none").addClass("d-flex"),setting.enemyDisplayImage?$("#enemy_pattern_tbody").find(".enemy_pattern_tr_text").addClass("d-none"):$("#enemy_pattern_tbody").find(".enemy_pattern_tr_image").addClass("d-none")):$("#enemy_display_mode_parent").addClass("d-none").removeClass("d-flex")}
function expandEnemy(){var a=castInt($("#map_select").val()),b=$(".node_selected").data("node"),c=castInt($("#enemy_pattern_select").find(".nav-link.active").data("disp")),d=0;200<=a&&(d=castInt($("#select_difficulty").val()));var e=ENEMY_PATTERN.filter(function(f){return f.a===a&&f.n===b&&f.l===d})[c];isDefMode||"\u7a7a\u8972"!==b?isDefMode&&"\u7a7a\u8972"!==b&&(toggleDefenseMode(!1),$(".ohuda_select").each(function(f,g){0===castInt($(g).val())&&$(g).val(-1)}),$target=$(".battle_content:first")):
(toggleDefenseMode(!0),$(".ohuda_select").each(function(f,g){$(g).val(0)}),$target=$("#air_raid_enemies"));c=isDefMode&&5!==e.t?3:e.t;$target.find(".cell_type").val(c);cell_type_Changed($target.find(".cell_type"),!1);$target.find(".formation").val(e.f);$target.find(".enemy_content").each(function(f,g){f<e.e.length?setEnemyDiv($(g),e.e[f]):clearEnemyDiv($(g))});$target.find(".enemy_range").text(e.r);$target[0].dataset.celldata=a+"_"+e.n+(e.d?"("+e.d+")":"")}
function modal_main_preset_Shown(){if(!$("#select_preset_category").html()){$("#select_preset_category").html('<option value="1">\u6d77\u57df\u30c7\u30fc\u30bf\u8aad\u8fbc\u4e2d</option>');for(var a='<option value="0">\u6307\u5b9a\u306a\u3057</option>',b=$jscomp.makeIterator(setting.presetFolders),c=b.next();!c.done;c=b.next())c=c.value,a+='<option value="'+c.id+'">'+c.name+"</option>";$("#preset_folder").html(a);loadMapData()}}
function updateMainPreset(a){a=void 0===a?!1:a;var b=encodePreset(),c=getActivePreset();c.id||(c.id=getUniqueId());c.history.histories.length?c.history.histories[c.history.index]=b:c.history.histories[0]=b;c.name=document.getElementById("input_preset_name").value.trim();b=[c.id,c.name,b,document.getElementById("preset_remarks").value.trim(),formatDate(new Date,"yyyy/MM/dd HH:mm:ss"),castInt($("#preset_folder").val())];$("#allow_upload_preset").prop("checked")&&uploadMainPreset(b);if(!a){a=!1;if($("#modal_main_preset").find(".btn_commit_preset").hasClass("rename")){var d=
getUniqueId();b[0]=d;c.id=d}d=loadLocalStorage("presets")||[];for(var e=0;e<d.length;e++)if(d[e][0]===b[0]){6<=d[e].length&&(b[5]=d[e][5]);d[e]=b;a=!0;break}a?inform_success("\u30d7\u30ea\u30bb\u30c3\u30c8\u300c"+b[1]+"\u300d\u306e\u7de8\u6210\u30c7\u30fc\u30bf\u306e\u66f4\u65b0\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002"):(d.push(b),inform_success("\u30d7\u30ea\u30bb\u30c3\u30c8\u300c"+b[1]+"\u300d\u306e\u65b0\u898f\u767b\u9332\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002"),c.memo=b[3]);
saveLocalStorage("presets",d);updateActivePreset(c);setTab()}$("#modal_main_preset").modal("hide")}
function uploadMainPreset(a){var b=castInt($("#select_preset_category").val()),c=$("#upload_user").val().trim();setting.uploadUserName=c;saveSetting();var d={id:a[0],name:a[1],data:a[2],memo:a[3],createdAt:firebase.firestore.FieldValue.serverTimestamp(),map:b,level:400<b?castInt($("#select_preset_level").val()):0,user:c};fb||initializeFB();fb?fb.runTransaction(function(e){var f=fb.collection("presets").doc();return e.get(f).then(function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){return 1==
g.nextAddress?g.yield(e.set(f,d),2):g.return(d)})})}).then(function(e){inform_success("\u30d7\u30ea\u30bb\u30c3\u30c8\u300c"+a[1]+"\u300d\u306e\u7de8\u6210\u30c7\u30fc\u30bf\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002")}).catch(function(e){console.error(e);inform_danger("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002")}):inform_danger("\u8b0e\u306e\u7406\u7531\u306b\u3088\u308a\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}
function expandMainPreset(a,b,c,d){b=void 0===b?!0:b;c=void 0===c?!0:c;d=void 0===d?!0:d;if(a)try{var e=a[0],f=!1;$(".lb_plane").each(function(z,A){if(e&&0!==e.length){var B=e[0].find(function(D){return D[4]===z});B&&0!==B.length?(B={id:B[0],prof:B[1],remodel:B[2],slot:B[3]},setLBPlaneDiv($(A),B),f=!0):b&&setLBPlaneDiv($(A))}});$(".ohuda_select").each(function(z,A){$(A).find("option").prop("disabled",!1);f&&e&&2<=e.length?(z=castInt(e[1][z],-1),$(A).val(1===z?2:z)):b&&$(A).val(-1)});if(e&&3<=e.length)for(var g=
0;2>=g;g++)document.getElementById("lb"+(g+1)+"_target_1").value=e[2][2*g],document.getElementById("lb"+(g+1)+"_target_2").value=e[2][2*g+1];5<=a.length?toggleDefenseMode(a[4]):toggleDefenseMode(!1);if(c){var h=6;a[1].length&&a[1][0]&&6<=a[1][0].length&&(h=2===a[1][0][5]?7:6,document.getElementById("union_fleet").checked=1===a[1][0][5],document.getElementById("yugeki_fleet").checked=2===a[1][0][5]);clearShipDivAll(h);var l=0,k=0;$(".ship_tab:not(.d-none)").each(function(z,A){var B=a[1].find(function(E){return E[2]===
z});if(B){A=$(A);setShipDiv(A,B[0],99,8<=B.length&&B[7]?B[7]:0);A.find(".ship_plane").each(function(E,F){F=$(F);var G=B[1].find(function(J){return J[4]===E});!G&&F.hasClass("expanded_slot")&&(G=B[1].find(function(J){return-1===J[4]}));G&&!F.hasClass("d-none")&&(setPlaneDiv(F,{id:G[0],prof:G[1],remodel:G[2],slot:G[3]},!0),6<=G.length&&G[5]&&plane_unlock_Clicked(F.find(".plane_unlock")))});if(4<=B.length){var D=A.find(".ship_disabled");B[3]?(D.addClass("disabled"),D.children().addClass("fa-eye-slash").removeClass("fa-eye no_capture"),
A.addClass("opacity4")):(D.removeClass("disabled"),D.children().removeClass("fa-eye-slash").addClass("fa-eye no_capture"),A.removeClass("opacity4"))}5<=B.length&&(B[4]?A.find(".ship_level").text(B[4]):A.find(".ship_level").text(99));7<=B.length&&0<B[6]&&A.find(".ship_luck").text(B[6]);z<h?l+=1:k+=1}});display_ship_count_Changed($("#friendFleet_item1"),Math.max(l,1),!0);display_ship_count_Changed($("#friendFleet_item2"),Math.max(k,1),!0)}document.getElementById("fleet_formation").value=1;if(4<=a.length&&
a[3]){document.getElementById("adapt_stage2").checked=!0;try{c=1;selectedFormations=[];for(var n=$jscomp.makeIterator(a[3]),m=n.next();!m.done;m=n.next()){var p=castInt(m.value);if(0>=p){document.getElementById("adapt_stage2").checked=!1;selectedFormations=[];c=1;break}else selectedFormations.push(p),c=p}document.getElementById("fleet_formation").value=c}catch(z){var q=castInt(a[3]);if(q){selectedFormations=[];for(n=0;10>n;n++)selectedFormations.push(q);document.getElementById("adapt_stage2").checked=
!0;document.getElementById("fleet_formation").value=q}}}else document.getElementById("adapt_stage2").checked=!1,selectedFormations=[];q=1;for(n=0;n<a[2].length;n++)q<a[2][n][0]+1&&(q=a[2][n][0]+1);q=Math.min(q,10);if(0!==a[2].length||d)clearEnemyDivAll(q),$("#battle_count").val(q);var v=isDefMode&&6>a.length;$(v?"#air_raid_enemies":".battle_content").each(function(z,A){var B=a[2].find(function(G){return G[0]===z});if(B){3<=B.length?$(A)[0].dataset.celldata=B[2]:$(A)[0].dataset.celldata="";if(4<=B.length){var D=
castInt(B[3]);v?$(A).find(".cell_type").val([0,5].includes(D)?5:3):$(A).find(".cell_type").val(D);cell_type_Changed($(A).find(".cell_type"),!1)}else $(A).find(".cell_type").val(1);5<=B.length?$(A).find(".formation").val(B[4]):$(A).find(".formation").val(1);6<=B.length?$(A).find(".enemy_range").text(B[5]):$(A).find(".enemy_range").text(0);D=0;B=$jscomp.makeIterator(B[1]);for(var E=B.next();!E.done;E=B.next()){E=E.value;var F=$(A).find(".enemy_content").eq(D++);0<E?setEnemyDiv(F,E):0>E?setEnemyDiv(F,
-1,-E):clearEnemyDiv(F);F.addClass("d-flex").removeClass("d-none")}}});if(6<=a.length){var t=a[5];if(t&&3===t.length){var x=$("#air_raid_enemies"),u=castInt(t[1]);x.find(".cell_type").val([0,5].includes(u)?5:3);cell_type_Changed(x.find(".cell_type"),!1);x.find(".formation").val(t[2]);d=0;for(var r=$jscomp.makeIterator(t[0]),w=r.next();!w.done;w=r.next()){var y=w.value,C=x.find(".enemy_content").eq(d++);0<y?setEnemyDiv(C,y):0>y?setEnemyDiv(C,-1,-y):clearEnemyDiv(C);C.addClass("d-flex").removeClass("d-none")}}}7<=
a.length?$("#admin_lv").val(a[6]):$("#admin_lv").val(120)}catch(z){$(".ohuda_select").val(-1),$(".lb_plane").each(function(A,B){setLBPlaneDiv($(B))}),clearShipDivAll(6),clearEnemyDivAll(1),$("#battle_count").val(1),sendErrorLog(z)}}
function encodePreset(){try{var a=castInt($("#fleet_formation").val()),b=isDefMode?0:displayBattle;selectedFormations.length>b?selectedFormations[b]=a:selectedFormations[selectedFormations.length-1]=a;var c=[createLandBasePreset(),createFriendFleetPreset(),createEnemyFleetPreset(),document.getElementById("adapt_stage2").checked?selectedFormations:null,isDefMode,createAirRaidEnemyFleetPreset(),castInt($("#admin_lv").val())],d=JSON.stringify(c),e=utf8_to_b64(d),f=b64_to_utf8(e);JSON.parse(f);return e}catch(g){return utf8_to_b64(JSON.stringify([[],
[],[]]))}}function createLandBasePreset(){for(var a=[[],[],[]],b=$jscomp.makeIterator(inputItems.landBase.landBases),c=b.next();!c.done;c=b.next()){c=c.value;for(var d=$jscomp.makeIterator(c.planes),e=d.next();!e.done;e=d.next())e=e.value,a[0].push([e.id,e.level,e.remodel,e.slot,4*(c.baseNo-1)+(e.slotNo-1)]);a[1].push(c.mode);a[2].push(c.target[0]);a[2].push(c.target[1])}return a}
function createFriendFleetPreset(){var a=[],b=getMaxShipCount(),c=0,d=document.getElementById("union_fleet").checked?1:document.getElementById("yugeki_fleet").checked?2:0;$(".ship_tab:not(.ui-draggable-dragging)").each(function(e,f){e===b&&(c=b);if(!$(f).attr("class").includes("d-none")){var g=[castInt($(f)[0].dataset.shipid),[],c,$(f).find(".ship_disabled").hasClass("disabled")?1:0,castInt($(f).find(".ship_level").text()),d,castInt($(f).find(".ship_luck").text()),castInt($(f).find(".area").text())];
$(f).find(".ship_plane:not(.ui-draggable-dragging)").each(function(h,l){var k=$(l);h=[castInt(k[0].dataset.planeid),castInt(k.find(".prof_select")[0].dataset.prof),castInt(k.find(".remodel_value")[0].textContent),castInt(k.find(".slot").text()),$(l).hasClass("expanded_slot")?-1:h,k.find(".plane_unlock").hasClass("d-none")?1:0];0!==h[0]&&g[1].push(h)});if(0!==g[0]||0!==g[1].length)a.push(g),c+=1}});return a}
function createEnemyFleetPreset(){var a=[];$(".battle_content").each(function(b,c){if(!$(c).attr("class").includes("d-none")){var d=[b,[],$(c)[0].dataset.celldata,castInt($(c).find(".cell_type").val()),castInt($(c).find(".formation").val()),castInt($(c).find(".enemy_range").text())];$(c).find(".enemy_content").each(function(e,f){var g=castInt($(f)[0].dataset.enemyid);f=castInt($(f).find(".enemy_ap").text());d[3]!==CELL_TYPE.grand&&6<=e||(0===g?d[1].push(0):0<g?d[1].push(g):0<f&&d[1].push(-f))});0!==
d[1].length&&a.push(d)}});return a}function createAirRaidEnemyFleetPreset(){var a=$("#air_raid_enemies"),b=[[],castInt(a.find(".cell_type").val()),castInt(a.find(".formation").val())];a.find(".enemy_content").each(function(c,d){c=castInt($(d)[0].dataset.enemyid);d=castInt($(d).find(".enemy_ap").text());0<=c?b[0].push(c):0<d&&b[0].push(-d)});return b}
function updatePlaneSelectedHistory(a){setting.selectedHistory[0].unshift(a);setting.selectedHistory[0]=setting.selectedHistory[0].splice(0,100);saveSetting()}function updateShipSelectedHistory(a){setting.selectedHistory[1].unshift(a);setting.selectedHistory[1]=setting.selectedHistory[1].splice(0,100);saveSetting()}
function drawResult(){$("#rate_table tbody").find(".rate_tr").addClass("d-none disabled_tr");$(".progress_area").addClass("d-none disabled_bar").removeClass("d-flex");$(".simple_lb_progress").addClass("d-none").removeClass("d-flex");$("#fleet_simple_bar").addClass("d-none");var a=castInt($("#calculate_count").val());5E4>a?($("#prev_calculate_count").text(a),$("#calculate_confirm").removeClass("d-none")):$("#calculate_confirm").addClass("d-none");var b=isDefMode?1:6,c=[],d=[],e=[];isDefMode?(c.push(resultData.defenseAirPower),
d.push(resultData.enemyAirPowers[6])):(c=resultData.landBaseAirPowers,c.push(resultData.fleetAirPower),d=resultData.enemyAirPowers,e=resultData.landBaseAirStatus);e.push(resultData.fleetAirStatus);for(var f={},g=0;g<=b;f={$jscomp$loop$prop$abbr$329:f.$jscomp$loop$prop$abbr$329,$jscomp$loop$prop$ap$330:f.$jscomp$loop$prop$ap$330,$jscomp$loop$prop$status$332:f.$jscomp$loop$prop$status$332},g++){var h=isDefMode?8:g+1,l=$("#result_bar_"+h),k=$("#rate_row_"+h);f.$jscomp$loop$prop$ap$330=c[g];var n=d[g],
m=e[g],p=getAirStatusBorder(n);f.$jscomp$loop$prop$status$332=isDefMode?getAirStatusIndex(f.$jscomp$loop$prop$ap$330,n):m.indexOf(getArrayMax(m));var q=0,v=!1;4===f.$jscomp$loop$prop$status$332?q=f.$jscomp$loop$prop$ap$330/p[3]*10:3===f.$jscomp$loop$prop$status$332?q=f.$jscomp$loop$prop$ap$330/p[2]*20:2===f.$jscomp$loop$prop$status$332?q=f.$jscomp$loop$prop$ap$330/p[1]*45:1>=f.$jscomp$loop$prop$status$332&&(q=f.$jscomp$loop$prop$ap$330/p[0]*90);if(5===f.$jscomp$loop$prop$status$332&&7!==h)f.$jscomp$loop$prop$status$332=
0,q=100;else if(5===f.$jscomp$loop$prop$status$332){f.$jscomp$loop$prop$abbr$329=$("#shoot_down_table").find(".cond.battle"+(displayBattle+1)).text();var t=AIR_STATUS.find(function(u){return function(r){return r.abbr===u.$jscomp$loop$prop$abbr$329}}(f));t&&(f.$jscomp$loop$prop$status$332=t.id);0===f.$jscomp$loop$prop$status$332&&(q=100)}q=Math.min(100,q);var x=l.data("airstatus");t="bar_status"+f.$jscomp$loop$prop$status$332;l.removeClass("bar_status"+x).addClass(t).css({width:q+"%"}).data("airstatus",
f.$jscomp$loop$prop$status$332);k.find(".rate_td_ap").text(f.$jscomp$loop$prop$ap$330);x=k.find(".rate_td_eap");x.find(".avg_eap").text(n);x.find(".eap_border").html("( "+p.slice(0,4).map(function(u){return function(r){return r<=u.$jscomp$loop$prop$ap$330?"<b>"+r+"</b>":r.toString()}}(f)).join(" / ")+" )");x=100;for(n=0;n<m.length;n++)k.find(".rate_td_status"+n).text("-"),isDefMode?k.find(".rate_td_status"+f.$jscomp$loop$prop$status$332).text("100 %"):0<m[n]&&(v=Math.floor(1E3*m[n])/10,p=0,n+1<m.length&&
0<m[n+1]?(p=v,x-=v):p=x.toFixed(1),k.find(".rate_td_status"+n).text(p+" %"),v=!0);if(v||isDefMode&&8===h)k.removeClass("d-none disabled_tr"),l.closest(".progress_area").addClass("d-flex").removeClass("d-none disabled_bar");l="bar_ex_status"+f.$jscomp$loop$prop$status$332;isDefMode&&(k=$("#simple_lb_def_bar"),n=k.find(".result_bar"),x=n.data("airstatus"),n.removeClass("bar_status"+x+" bar_ex_status"+x).addClass(t+" "+l).css({width:q+"%"}).data("airstatus",f.$jscomp$loop$prop$status$332),k.find(".simple_label").text(AIR_STATUS.find(function(u){return function(r){return r.id===
u.$jscomp$loop$prop$status$332}}(f)).abbr),k.removeClass("d-none"));7===h&&v&&-1<f.$jscomp$loop$prop$status$332&&(h=$("#fleet_simple_bar"),v=h.find(".result_bar"),x=v.data("airstatus"),v.removeClass("bar_status"+x+" bar_ex_status"+x).addClass(t+" "+l).css({width:q+"%"}).data("airstatus",f.$jscomp$loop$prop$status$332),m=AIR_STATUS.find(function(u){return function(r){return r.id===u.$jscomp$loop$prop$status$332}}(f)).abbr+"("+Math.floor(100*m[f.$jscomp$loop$prop$status$332])+"%)",h.find(".simple_label").text(m),
h.removeClass("d-none"));if(isDefMode)break}for(e=d=c=b=0;e<resultData.fleetSlots.length;e++)if(f=resultData.fleetSlots[e],g=100*f.deathRate,m=document.getElementById("s"+f.shipNo+"sl"+f.slot))q=castInt(m.getElementsByClassName("battle1")[0].textContent),m.getElementsByClassName("battle_end")[0].textContent=Math.round(f.avg),m.getElementsByClassName("battle_death")[0].textContent=0===f.deathRate?"-":10<=g?g.toFixed(1)+" %":Math.ceil(10*g)/10+" %",0<q&&(b+=5*(q-f.avg),c+=5*(q-f.max),d+=5*(q-f.min));
resultData.usedSteels?(c=resultData.usedSteels/a,$(".battle_end.fap").html()||$(".battle_end.fap").html("\u6d88\u8cbb\u4e88\u6e2c"),$(".battle_end.eap").html('\n\t\t<div><img src="../img/util/bauxite.png" class="img-size-18" alt="\u30dc\u30fc\u30ad\u30b5\u30a4\u30c8">: '+b.toFixed(1)+'</div>\n\t\t<div><img src="../img/util/steel.png" class="img-size-18" alt="\u92fc\u6750">: '+c.toFixed(1)+"</div>\n\t\t")):($(".battle_end.fap").html()||$(".battle_end.fap").html('<img src="../img/util/bauxite.png" class="img-size-18" alt="\u30dc\u30fc\u30ad\u30b5\u30a4\u30c8">\u6d88\u8cbb\u4e88\u6e2c'),
$(".battle_end.eap").html(c+" ~ "+d+" ( "+b.toFixed(1)+" )"));for(b=0;b<resultData.enemySlots.length;b++)c=resultData.enemySlots[b],d=document.getElementsByClassName("enemy_no_"+c[0]+" slot_"+c[1])[0],e=Math.floor(c[2]/a*10),d.getElementsByClassName("td_avg_slot")[0].textContent=0===e?"0":e/10,d.getElementsByClassName("td_max_slot")[0].textContent=c[3],d.getElementsByClassName("td_min_slot")[0].textContent=c[4];if(!isDefMode&&document.getElementById("adapt_stage2").checked){for(b=0;b<resultData.enemySlotAllDead.length;b++)c=
Math.round(resultData.enemySlotAllDead[b]/a*1E3)/10,document.getElementsByClassName("enemy_no_"+b+" slot_0")[0].getElementsByClassName("td_all_dead")[0].textContent=Math.floor(c)+"%";document.getElementById("enemy_slot_result_mode").textContent="\uff08\u822a\u7a7a\u6226 stage2 \u5f8c\uff09"}else document.getElementById("enemy_slot_result_mode").textContent="\uff08\u822a\u7a7a\u6226 stage1 \u5f8c\uff09";c=resultData.enemyAirPowerResults[0];b=resultData.enemyAirPowerResults[1];if(c.length)for(c=getEnemyApDistribution(c),
d=document.getElementById("enemy_ap_bf_dist_min"),e=$jscomp.makeIterator(c),c=e.next();!c.done;c=e.next())d.textContent=c.value,d=d.nextElementSibling;if(b.length)for(c=getEnemyApDistribution(b),b=document.getElementById("enemy_ap_af_dist_min"),d=$jscomp.makeIterator(c),c=d.next();!c.done;c=d.next())b.textContent=c.value,b=b.nextElementSibling;b=$jscomp.makeIterator(inputItems.landBase.landBases);for(c=b.next();!c.done;c=b.next())if(c=c.value,e=c.target[0],f=c.target[1],-1!==e&&-1!==f&&!isDefMode)for(d=
e<=f?[e,f]:[f,e],e=e<=f?[0,1]:[1,0],f={},g=0;1>=g;f={$jscomp$loop$prop$status$189$334:f.$jscomp$loop$prop$status$189$334},g++)m=c.results[d[g]].airStatusIndex[e[g]],t=c.results[d[g]].mainAirPower[e[g]]/a,h=c.results[d[g]].enemyAirPower[e[g]]/a,f.$jscomp$loop$prop$status$189$334=m.indexOf(getArrayMax(m)),q=0,h=getAirStatusBorder(h),4===f.$jscomp$loop$prop$status$189$334?q=t/h[3]*10:3===f.$jscomp$loop$prop$status$189$334?q=t/h[2]*20:2===f.$jscomp$loop$prop$status$189$334?q=t/h[1]*45:1>=f.$jscomp$loop$prop$status$189$334&&
(q=t/h[0]*90),5===f.$jscomp$loop$prop$status$189$334&&(f.$jscomp$loop$prop$status$189$334=0,q=100),h="bar_status"+f.$jscomp$loop$prop$status$189$334,v="bar_ex_status"+f.$jscomp$loop$prop$status$189$334,t=$("#simple_lb_bar_"+c.baseNo+"_"+(g+1)),l=t.find(".result_bar"),k=l.data("airstatus"),l.removeClass("bar_status"+k+" bar_ex_status"+k).addClass(h+" "+v).css({width:(100<q?100:q)+"%"}).data("airstatus",f.$jscomp$loop$prop$status$189$334),q=AIR_STATUS.find(function(u){return function(r){return r.id===
u.$jscomp$loop$prop$status$189$334}}(f)).abbr,m=Math.floor(getArrayMax(m)/a*100),m=q+"("+m+"%)"+(100===m?"":10<=m?'<span class="opacity0">1</span>':'<span class="opacity0">11</span>'),t.find(".simple_label").html(m),t.removeClass("d-none");display_result_Changed();resultData.enemyAirPowerResults=null;resultData.fleetSlots=null}
function getEnemyApDistribution(a){a.sort(function(p,q){return p-q});for(var b=a.length,c=a[0],d=a[a.length-1],e=0,f=0,g=0,h=0,l=0,k=0,n={$jscomp$loop$prop$i$336:c};n.$jscomp$loop$prop$i$336<=d;n={$jscomp$loop$prop$i$336:n.$jscomp$loop$prop$i$336},n.$jscomp$loop$prop$i$336++){var m=a.findIndex(function(p){return function(q){return q>p.$jscomp$loop$prop$i$336}}(n));0!==m&&(-1===m?m=a.length:a=a.slice(m),k+=100*m/b,!e&&50<=k&&(e=n.$jscomp$loop$prop$i$336),!f&&75<=k&&(f=n.$jscomp$loop$prop$i$336),!g&&
90<=k&&(g=n.$jscomp$loop$prop$i$336),!h&&95<=k&&(h=n.$jscomp$loop$prop$i$336),!l&&99<=k&&(l=n.$jscomp$loop$prop$i$336))}return[c,e?e:d,f?f:d,g?g:d,h?h:d,l?l:d,d]}function getAirStatusIndex(a,b){if(1E3>=a)return b<AIR_STATUS_TABLE[a].length-1?AIR_STATUS_TABLE[a][b]:4;b=getAirStatusBorder(b);for(var c=b.length,d=0;d<c;d++)if(a>=b[d])return 0!==a?d:4}function getAirStatusBorder(a){return 0===a?[0,0,0,0,0]:[3*a,Math.ceil(1.5*a),Math.floor(a/1.5)+1,Math.floor(a/3)+1,0]}
function calculate(a,b,c){b=void 0===b?!0:b;c=void 0===c?!0:c;try{if(void 0===a||a)inputItems.landBase=null;b&&(inputItems.fleet=null);c&&(inputItems.battleInfo=null);calculateInit();rateCalculate();drawResult()}catch(d){sendErrorLog(d)}}
function sendErrorLog(a){errorInfo={name:a.name,message:a.message,stack:a.stack,data:encodePreset(),createdAt:firebase.firestore.FieldValue.serverTimestamp(),remarks:"",version:"1.12.2.1"};console.log(a);a=$("#modal_confirm");a.find(".modal-body").html('\n\t\t<div>\n\t\t\t<div class="h5">\u8a08\u7b97\u51e6\u7406\u4e2d\u306b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002</div>\n\t\t\t<div class="mt-3">\n\t\t\t\t<div class="pl-3">\n\t\t\t\t\t\u30d6\u30e9\u30a6\u30b6\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u554f\u984c\u3067\u3001\u6b63\u3057\u304f\u8a08\u7b97\u304c\u51e6\u7406\u3067\u304d\u306a\u304b\u3063\u305f\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n\t\t\t\t</div>\n\t\t\t\t<div class="pl-3">\n\t\t\t\t\t\u3053\u306e\u307e\u307e\u672c\u753b\u9762\u306b\u3066\u30d6\u30e9\u30a6\u30b6\u306e\u30b9\u30fc\u30d1\u30fc\u30ea\u30ed\u30fc\u30c9\u3092\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002\n\t\t\t\t</div>\n\t\t\t\t<div class="pl-2 mt-4">\u25a0 \u30b9\u30fc\u30d1\u30fc\u30ea\u30ed\u30fc\u30c9\u3092\u884c\u3063\u305f\u304c\u6539\u5584\u3057\u306a\u3044\u5834\u5408</div>\n\t\t\t\t<div class="pl-3 mt-1">\n\t\t\t\t\t\u5927\u5909\u7533\u3057\u8a33\u3042\u308a\u307e\u305b\u3093\u3002\u304a\u624b\u6570\u3067\u3059\u304c\u3001\u76f4\u524d\u306b\u3069\u306e\u3088\u3046\u306a\u57fa\u5730\u3084\u8266\u5a18\u306e\u88c5\u5099\u306a\u3069\u306e\u64cd\u4f5c\u3092\u3057\u3088\u3046\u3068\u3057\u305f\u304b\u3092<a href="https://odaibako.net/u/noro_006" target="_blank" id="send_error">\u3053\u3061\u3089</a>\u307e\u3067\u3054\u5831\u544a\u304f\u3060\u3055\u3044\u3002\n\t\t\t\t</div>\n\t\t\t\t<div class="pl-3 mt-1">\n\t\t\t\t\t\u5831\u544a\u3092\u9802\u304d\u6b21\u7b2c\u3001\u53ef\u80fd\u306a\u9650\u308a\u65e9\u671f\u306e\u8abf\u67fb\u3001\u4fee\u6b63\u3092\u884c\u3044\u307e\u3059\u3002\u3054\u4e0d\u4fbf\u3092\u304a\u304b\u3051\u3057\u3066\u7533\u3057\u8a33\u3042\u308a\u307e\u305b\u3093\u3002\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t');confirmType=
"Error";a.modal("show")}function sendError(){fb||initializeFB();fb&&fb.runTransaction(function(a){var b=fb.collection("errors").doc();return a.get(b).then(function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){return c.yield(a.set(b,errorInfo),0)})})}).then(function(a){}).catch(function(a){})}
function calculateInit(){if(isDefMode){document.getElementById("friendFleet").classList.add("d-none");document.getElementById("normal_enemies").classList.add("d-none");document.getElementById("display_battle_tab").classList.add("d-none");document.getElementById("shoot_down_table_content").classList.add("d-none");document.getElementById("air_raid_enemies").classList.remove("d-none");document.getElementsByClassName("btn_lb_target")[0].classList.add("d-none");document.getElementsByClassName("btn_lb_target")[1].classList.add("d-none");
document.getElementsByClassName("lb_target_alert")[0].classList.add("d-none");document.getElementsByClassName("lb_target_alert")[1].classList.add("d-none");document.getElementById("result_stage2_setting").classList.add("d-none");var a=document.getElementById("battle_count_content");a.classList.add("d-none");a.classList.remove("d-flex")}else document.getElementById("friendFleet").classList.remove("d-none"),document.getElementById("normal_enemies").classList.remove("d-none"),document.getElementById("display_battle_tab").classList.remove("d-none"),
document.getElementById("shoot_down_table_content").classList.remove("d-none"),document.getElementById("air_raid_enemies").classList.add("d-none"),document.getElementsByClassName("btn_lb_target")[0].classList.remove("d-none"),document.getElementsByClassName("btn_lb_target")[1].classList.remove("d-none"),document.getElementById("result_stage2_setting").classList.remove("d-none"),document.getElementById("adapt_stage2").checked?(document.getElementById("fleet_formation").classList.remove("d-none"),document.getElementById("fleet_formation_label").classList.remove("d-none")):
(document.getElementById("fleet_formation").classList.add("d-none"),document.getElementById("fleet_formation_label").classList.add("d-none")),a=document.getElementById("battle_count_content"),a.classList.add("d-flex"),a.classList.remove("d-none");updateInputData();updateView();var b=encodePreset();a=getActivePreset();var c=a.history,d=c.histories,e=""!==a.id;e&&a.id&&d[c.index]!==b&&(0!==c.index&&d.splice(0,c.index),d.unshift(b),c.histories=d.splice(0,20),c.index=0,b=$("#fleet_tab_container .active:not(.unsaved)"),
b.find(".fleet_tab_icon").html("&#8727;"),b.addClass("unsaved"),updateActivePreset(a));e&&c.index<c.histories.length-1?(document.getElementById("btn_undo").classList.remove("disabled"),document.getElementById("menu_undo").classList.remove("disabled")):(document.getElementById("btn_undo").classList.add("disabled"),document.getElementById("menu_undo").classList.add("disabled"));e&&0<c.index?(document.getElementById("btn_redo").classList.remove("disabled"),document.getElementById("menu_redo").classList.remove("disabled")):
(document.getElementById("btn_redo").classList.add("disabled"),document.getElementById("menu_redo").classList.add("disabled"));setting.emptySlotInvisible!==document.getElementById("empty_slot_invisible").checked&&(setting.emptySlotInvisible=document.getElementById("empty_slot_invisible").checked,saveSetting());resultData={enemyAirPowers:[],enemyAirPowerResults:[],enemySlots:[],enemySlotAllDead:[],landBaseAirPowers:[],landBaseAirStatus:[],fleetAirPower:0,fleetAirStatus:[],fleetSlots:[],defenseAirPower:0,
usedSteels:0};setPreCalculateTable()}
function updateInputData(){inputItems||(inputItems=new InputData);inputItems.landBase?inputItems.landBase.clearResult():(usedItems=usedItems.filter(function(a){return"ship"===a.parent}),inputItems.landBase=createLandBaseInstance());inputItems.fleet?inputItems.fleet.clearResult():(usedShip=[],usedItems=usedItems.filter(function(a){return"lb"===a.parent}),inputItems.fleet=createFleetInstance());inputItems.battleInfo||(inputItems.battleInfo=updateEnemyFleetInfo())}
function updateView(){updateLandBaseView();updateFleetView();updateEnemyView()}
function updateLandBaseView(){for(var a=inputItems.landBase,b=[],c=[],d=$jscomp.makeIterator(a.landBases),e=d.next();!e.done;e=d.next()){e=e.value;var f=document.getElementById("lb_item"+e.baseNo),g=f.getElementsByClassName("fuel")[0],h=f.getElementsByClassName("ammo")[0],l=f.getElementsByClassName("steel")[0],k=f.getElementsByClassName("bauxite")[0],n=f.getElementsByClassName("ap")[0],m=f.getElementsByClassName("ap_detail")[0],p=f.getElementsByClassName("range")[0];isDefMode&&0!==e.mode||!isDefMode&&
2!==e.mode?f.classList.add("opacity6"):f.classList.remove("opacity6");drawChangeValue(g,castInt(g.textContent),e.getSumFuel(),!0);drawChangeValue(h,castInt(h.textContent),e.getSumAmmo(),!0);drawChangeValue(k,castInt(k.textContent),e.getSumBauxite(),!0);e.hasJet?(drawChangeValue(l,castInt(l.textContent),e.getSumSteel(),!0),l.classList.remove("d-none"),l.previousElementSibling.classList.remove("d-none")):(l.classList.add("d-none"),l.previousElementSibling.classList.add("d-none"));f=0===e.mode?e.defenseAirPower:
e.airPower;drawChangeValue(n,castInt(n.textContent),f);n=0===e.mode?e.planes.map(function(q){return q.defenseAirPower}):e.planes.map(function(q){return q.airPower});m.textContent=1<e.reconCorr?"( "+n.join(" / ")+" ) \u00d7 "+e.reconCorr:"( "+n.join(" / ")+" )";m=e.getRange();drawChangeValue(p,castInt(p.textContent),m);0<e.mode&&(p=document.getElementById("battle_container").getElementsByClassName("battle_content"),f=e.target[0],n=e.target[1],g=!1,p.length>=f&&(g=castInt(p[f].getElementsByClassName("enemy_range")[0].textContent),
f=p[f].dataset.celldata,e.hasJet&&"64_N"===f&&(g=2),g=g>m),!g&&0<=n&&p.length>=n&&(f=castInt(p[n].getElementsByClassName("enemy_range")[0].textContent),p=p[n].dataset.celldata,e.hasJet&&"64_N"===p&&(f=2),g=f>m),g&&b.push(e.baseNo));2===e.mode&&0<e.planes.length&&c.push(e.planes[0])}needAirRaidAlert=!1;if(a.landBases.some(function(q){return-1!==q.mode})){if(isDefMode&&(d=document.getElementById("def_sum_ap_all"),e=document.getElementById("def_sum_ex_ap_all"),p=document.getElementById("rocket_c"),a.updateDefenseAirPower(),
m=a.defenseAirPower,n=a.defense2AirPower,drawChangeValue(d,castInt(d.textContent),m),drawChangeValue(e,castInt(e.textContent),n),p.textContent=a.rocketBonus.toString()),document.getElementsByClassName("ng_range")[0].textContent=b.join(", "),document.getElementsByClassName("ng_range")[1].textContent=b.join(", "),b.length?(document.getElementsByClassName("lb_range_warning")[0].classList.remove("d-none"),document.getElementsByClassName("lb_range_warning")[1].classList.remove("d-none")):(document.getElementsByClassName("lb_range_warning")[0].classList.add("d-none"),
document.getElementsByClassName("lb_range_warning")[1].classList.add("d-none")),!a.landBases.some(function(q){return 0===q.mode}))for(a=$jscomp.makeIterator(c),b=a.next();!b.done;b=a.next())if(b=b.value,b.isRecon&&4===b.slot||!b.isRecon&&18===b.slot){needAirRaidAlert=!0;break}}else document.getElementsByClassName("lb_range_warning")[0].classList.add("d-none"),document.getElementsByClassName("lb_range_warning")[1].classList.add("d-none");a=$jscomp.makeIterator(document.getElementsByClassName("battle_only"));
for(b=a.next();!b.done;b=a.next())b=b.value,isDefMode?b.classList.add("d-none"):b.classList.remove("d-none");isDefMode?(document.getElementById("defense_summary").classList.remove("d-none"),document.getElementById("defense_summary").classList.add("d-flex")):(document.getElementById("defense_summary").classList.remove("d-flex"),document.getElementById("defense_summary").classList.add("d-none"))}
function updateFleetView(){var a=inputItems.fleet,b=document.getElementById("shoot_down_table"),c=document.getElementById("shoot_down_table_tbody"),d=-1;b.getElementsByTagName("tbody")[0].innerHTML="";b=$jscomp.makeIterator(b.getElementsByTagName("tfoot")[0].getElementsByClassName("td_battle"));for(var e=b.next();!e.done;e=b.next())e.value.innerHTML="";$("#fleet_formation").find("option").each(function(A,B){A=castInt($(B).val());a.isUnion&&10<A?$(B).removeClass("d-none"):!a.isUnion&&10<A&&$(B).addClass("d-none")});
$("#fleet_antiair_formation").find("option").each(function(A,B){A=castInt($(B).val());a.isUnion&&10<A?$(B).removeClass("d-none"):!a.isUnion&&10<A&&$(B).addClass("d-none")});setting.visibleAntiAirStatus?($(".anti_air_status").removeClass("d-none"),$(".anti_air_status").addClass("d-flex")):($(".anti_air_status").addClass("d-none"),$(".anti_air_status").removeClass("d-flex"));b=document.getElementsByClassName("fleet_ap")[0];e=document.getElementsByClassName("fleet_ap")[1];for(var f=document.getElementsByClassName("contact_start_rate")[0],
g=document.getElementsByClassName("contact_start_rate")[1],h=document.getElementsByClassName("night_contact_rate")[0],l=document.getElementsByClassName("night_contact_rate")[1],k={},n=$jscomp.makeIterator(a.ships),m=n.next();!m.done;k={$jscomp$loop$prop$ship$339:k.$jscomp$loop$prop$ship$339,$jscomp$loop$prop$rawShip$340:k.$jscomp$loop$prop$rawShip$340},m=n.next()){k.$jscomp$loop$prop$ship$339=m.value;d+=1;m=document.getElementById(k.$jscomp$loop$prop$ship$339.drawTabId);var p=m.getElementsByClassName("ap")[0],
q=m.getElementsByClassName("ap_detail")[0],v=m.getElementsByClassName("ship_range")[0],t=m.getElementsByClassName("can_attack_lb")[0],x=m.getElementsByClassName("rate_down")[0],u=m.getElementsByClassName("fix_down")[0],r=m.getElementsByClassName("hunshin")[0],w=m.getElementsByClassName("hunshin_rate")[0],y=m.getElementsByClassName("has_warning")[0];m=0;for(var C=$jscomp.makeIterator(k.$jscomp$loop$prop$ship$339.items),z=C.next();!z.done;z=C.next())z=z.value,z.isPlane&&0<z.slot&&(m+=1);drawChangeValue(p,
castInt(p.textContent),k.$jscomp$loop$prop$ship$339.airPower);if(k.$jscomp$loop$prop$ship$339.items.length&&k.$jscomp$loop$prop$ship$339.airPower){p=[];C=$jscomp.makeIterator(k.$jscomp$loop$prop$ship$339.items);for(z=C.next();!z.done;z=C.next())z=z.value,z.isExpanded||p.push(z.airPower);q.classList.remove("d-none");q.textContent="( "+p.join(" / ")+" )"}else q.classList.add("d-none"),q.textContent="";x.textContent=Math.floor(1E3*k.$jscomp$loop$prop$ship$339.rateDown)/10;u.textContent=k.$jscomp$loop$prop$ship$339.fixDown;
0<k.$jscomp$loop$prop$ship$339.hunshinRate?(w.textContent=(100*k.$jscomp$loop$prop$ship$339.hunshinRate).toFixed(1),r.classList.remove("d-none")):r.classList.add("d-none");k.$jscomp$loop$prop$ship$339.warningText?(y.classList.remove("d-none"),y.dataset.originalTitle=k.$jscomp$loop$prop$ship$339.warningText):y.classList.add("d-none");k.$jscomp$loop$prop$rawShip$340=k.$jscomp$loop$prop$ship$339.id?SHIP_DATA.find(function(A){return function(B){return B.id===A.$jscomp$loop$prop$ship$339.id}}(k)):null;
q=RANGES.find(function(A){return function(B){return B.id===Math.max(A.$jscomp$loop$prop$ship$339.range,A.$jscomp$loop$prop$rawShip$340?A.$jscomp$loop$prop$rawShip$340.range:0)}}(k));v.textContent=q?q.name:"\u77ed";t&&(k.$jscomp$loop$prop$rawShip$340&&[7,11,18].includes(k.$jscomp$loop$prop$rawShip$340.type)&&!k.$jscomp$loop$prop$ship$339.items.some(function(A){return TAICHI.includes(A.id)&&0<A.slot})&&k.$jscomp$loop$prop$ship$339.items.some(function(A){return[7,57].includes(A.type)&&0<A.slot})?t.classList.remove("d-none"):
t.classList.add("d-none"));if(0<m){v=document.createDocumentFragment();r=!0;t=document.getElementById("empty_slot_invisible").checked;k.$jscomp$loop$prop$rawShip$340&&!t&&(m=k.$jscomp$loop$prop$rawShip$340.slot.length);q=document.createElement("tr");for(x=0;x<k.$jscomp$loop$prop$ship$339.items.length;x++)if(w=k.$jscomp$loop$prop$ship$339.items[x],u=w.name,k.$jscomp$loop$prop$rawShip$340||w.isPlane&&0!==w.slot){if(k.$jscomp$loop$prop$rawShip$340&&x===k.$jscomp$loop$prop$rawShip$340.slot.length)break;
if(!k.$jscomp$loop$prop$rawShip$340||!t||w.isPlane&&0!==w.slot){w=getItemCss(w.itype).replace("css","shoot_table");if(r){r=document.createElement("tr");r.id="s"+k.$jscomp$loop$prop$ship$339.shipNo+"sl"+x;r.dataset.shipid=k.$jscomp$loop$prop$rawShip$340?k.$jscomp$loop$prop$rawShip$340.id:0;r.dataset.si=d;r.dataset.slot=x;r.dataset.css=w+"_hover";y=document.createElement("td");y.rowSpan=m;y.className="td_name align-middle";y.textContent=k.$jscomp$loop$prop$rawShip$340?k.$jscomp$loop$prop$rawShip$340.name:
"\u672a\u6307\u5b9a";r.appendChild(y);y=document.createElement("td");y.className="pl-1 td_plane_name align-middle "+w;y.textContent=u;r.appendChild(y);q.appendChild(y.cloneNode(!1));for(u=1;10>=u;u++)w=document.createElement("td"),w.className="td_battle battle"+u+" align-middle",r.appendChild(w),q.appendChild(w.cloneNode(!1));u=document.createElement("td");u.className="td_battle battle_end align-middle";r.appendChild(u);q.appendChild(u.cloneNode(!1));u=document.createElement("td");u.className="td_battle battle_death align-middle";
r.appendChild(u);q.appendChild(u.cloneNode(!1));v.appendChild(r)}else r=q.cloneNode(!0),r.id="s"+k.$jscomp$loop$prop$ship$339.shipNo+"sl"+x,r.dataset.shipid=k.$jscomp$loop$prop$rawShip$340?k.$jscomp$loop$prop$rawShip$340.id:0,r.dataset.si=d,r.dataset.slot=x,r.dataset.css=w+"_hover",y=r.getElementsByClassName("td_plane_name")[0],y.className="pl-1 td_plane_name align-middle "+w,y.textContent=u,v.appendChild(r);r=!1}}c.appendChild(v)}}d=[];k=$jscomp.makeIterator(a.ships);for(m=k.next();!m.done;m=k.next())d=
d.concat(m.value.items);for(k=1;4>=k;k++)n=document.getElementsByClassName("fleet_scout"+k)[0],m=document.getElementsByClassName("fleet_scout"+k)[1],n.textContent=a.scoutScores[k-1],m.textContent=a.scoutScores[k-1];document.getElementsByClassName("tp_S")[0].textContent=a.tp;document.getElementsByClassName("tp_S")[1].textContent=a.tp;document.getElementsByClassName("tp_A")[0].textContent=Math.floor(.7*a.tp);document.getElementsByClassName("tp_A")[1].textContent=Math.floor(.7*a.tp);d=createContactTable(d)[0][4];
k=Math.floor(1E3*a.nightContactRate())/10;a.isUnion?(b.textContent=""+a.airPower,f.textContent=d.toFixed(2)+"%",h.textContent=k+"%",e.textContent=""+a.escortAirPower,g.textContent=d.toFixed(2)+"%",l.textContent=k+"%"):(b=$(".friendFleet_tab.show.active")[0],b.getElementsByClassName("fleet_ap")[0].textContent=a.airPower,b.getElementsByClassName("contact_start_rate")[0].textContent=d.toFixed(2)+"%",b.getElementsByClassName("night_contact_rate")[0].textContent=k+"%");if(0===c.getElementsByTagName("tr").length){b=
document.createElement("tr");b.className="s0sl0";e=document.createElement("td");e.className="td_name align-middle";e.textContent="\u672a\u9078\u629e";b.appendChild(e);e=document.createElement("td");e.className="td_plane_name text-nowrap align-middle text-center";e.textContent="-";b.appendChild(e);for(e=1;10>=e;e++)f=document.createElement("td"),f.className="td_battle battle"+e+" align-middle",b.appendChild(f);e=document.createElement("td");e.className="td_battle battle_end align-middle";e.textContent=
"0";b.appendChild(e);c.appendChild(b)}}
function updateEnemyView(){var a=inputItems.battleInfo,b=0,c=0,d=!1,e=!1,f="",g=[],h=[];document.getElementById("enemy_shoot_down_table").getElementsByTagName("tbody")[0].innerHTML="";for(var l=isDefMode?0:displayBattle,k={},n=0;n<a.battles.length;k={$jscomp$loop$prop$battle$346:k.$jscomp$loop$prop$battle$346},n++){k.$jscomp$loop$prop$battle$346=a.battles[n];for(var m=b=0,p={},q=$jscomp.makeIterator(k.$jscomp$loop$prop$battle$346.enemies),v=q.next();!v.done;p={$jscomp$loop$prop$enemy$342:p.$jscomp$loop$prop$enemy$342},
v=q.next())if(p.$jscomp$loop$prop$enemy$342=v.value,b+=p.$jscomp$loop$prop$enemy$342.antiAirBonus,!d&&k.$jscomp$loop$prop$battle$346.hasAntiAirCI&&(d=!0),!e&&k.$jscomp$loop$prop$battle$346.containUnknown&&(e=!0),n===l&&!p.$jscomp$loop$prop$enemy$342.onlyScout&&p.$jscomp$loop$prop$enemy$342.slots.length){for(var t=v="",x=!0,u=-1,r={$jscomp$loop$prop$j$344:0};r.$jscomp$loop$prop$j$344<p.$jscomp$loop$prop$enemy$342.equipments.length;r={$jscomp$loop$prop$j$344:r.$jscomp$loop$prop$j$344},r.$jscomp$loop$prop$j$344++){var w=
ENEMY_ITEM.find(function(E,F){return function(G){return G.id===E.$jscomp$loop$prop$enemy$342.equipments[F.$jscomp$loop$prop$j$344].id}}(p,r));if(w&&PLANE_TYPE.includes(w.type)){u+=1;var y=p.$jscomp$loop$prop$enemy$342.slots[u],C=getItemCss(w.itype).replace("css","shoot_table"),z=u===p.$jscomp$loop$prop$enemy$342.slots.length-1?" last_slot":"",A="",B="",D="";v+='<img src="../img/plane/'+w.id+'.png" class="img-size-36" data-planeid="'+w.id+'">';x&&(A='\n\t\t\t\t\t<td class="td_name align-middle last_slot" rowspan="'+
p.$jscomp$loop$prop$enemy$342.slots.length+'">\n\t\t\t\t\t\t<div>'+drawEnemyGradeColor(p.$jscomp$loop$prop$enemy$342.name)+'</div>\n\t\t\t\t\t\t<div class="d-none d-md-block">xxPxx</div>\n\t\t\t\t\t</td>',D='<td class="td_all_dead align-middle last_slot" rowspan="'+p.$jscomp$loop$prop$enemy$342.slots.length+'"></td>',B='<td class="td_detail_slot align-middle last_slot" rowspan="'+p.$jscomp$loop$prop$enemy$342.slots.length+'"><i class="fas fa-file-text"></i></td>',x=!1);t+='\n\t\t\t\t<tr class="enemy_no_'+
m+" slot_"+u+'" data-rowindex="'+m+'" data-slot="'+u+'" data-css="'+C+'_hover">\n\t\t\t\t\t'+A+'\n\t\t\t\t\t<td class="pl-1 td_plane_name align-middle '+(C+z)+'">'+w.name+'</td>\n\t\t\t\t\t<td class="td_init_slot align-middle'+z+'">'+y+'</td>\n\t\t\t\t\t<td class="td_avg_slot align-middle'+z+'">'+y+'</td>\n\t\t\t\t\t<td class="td_max_slot align-middle'+z+'">'+y+'</td>\n\t\t\t\t\t<td class="td_min_slot align-middle'+z+'">'+y+"</td>\n\t\t\t\t\t"+(isDefMode?"":D)+"\n\t\t\t\t\t"+(isDefMode?"":B)+"\n\t\t\t\t</tr>"}}h.push(t.replace("xxPxx",
v));m+=1}m=isDefMode?document.getElementById("battle_content_def_mode"):document.getElementsByClassName("battle_content")[c++];m.getElementsByClassName("enemy_sum_ap")[0].textContent=k.$jscomp$loop$prop$battle$346.getAirPower();m.getElementsByClassName("enemy_sum_lbap")[0].textContent=k.$jscomp$loop$prop$battle$346.getLandBaseAirPower();p=m.getElementsByClassName("enemy_range")[0];castInt(p.textContent)?p.parentNode.classList.remove("d-none"):p.parentNode.classList.add("d-none");p=(p=FORMATION.find(function(E){return function(F){return F.id===
E.$jscomp$loop$prop$battle$346.formation}}(k)))?p.correction:1;m.getElementsByClassName("fleet_AA")[0].textContent=2*Math.floor(p*b);b=(b=m.dataset.celldata)?b.split("_"):["",""];b.length&&(f?f!==b[0]&&(f="\u6d77\u57df\u6df7\u5728"):f=b[0],1<b.length&&g.push(b[1]))}""!==f||"\u6d77\u57df\u6df7\u5728"!==f?(a=40<f.slice(0,-1)?"E-":f.slice(0,-1)+"-",document.getElementById("route").textContent=a+f.slice(-1)+" : "+g.join(" \u2192 ")):document.getElementById("route").textContent=f;!isDefMode&&needAirRaidAlert&&
AIR_RAID_MAP.includes(castInt(f))?document.getElementById("air_raid_alert").classList.remove("d-none"):document.getElementById("air_raid_alert").classList.add("d-none");(f=document.getElementById("enemy_cutin_contain"))&&(d?f.classList.remove("d-none"):f.classList.add("d-none"));(d=document.getElementById("unknown_enemy_contain"))&&(e?d.classList.remove("d-none"):d.classList.add("d-none"));h.length?document.getElementById("enemy_shoot_down_tbody").innerHTML=h.join("\r\n"):h.push('<tr><td colspan="8">\u6226\u95d8\u6a5f\u3001\u653b\u6483\u6a5f\u3092\u642d\u8f09\u3057\u305f\u6575\u8266\u304c\u3044\u306a\u3044\u6226\u95d8\u3067\u3059\u3002</td></tr>');
!isDefMode&&document.getElementById("adapt_stage2").checked?($(".td_all_dead").removeClass("d-none"),document.getElementById("enabled_manual_stage2").checked=!0,document.getElementById("aa_cutin_miss").parentElement.classList.remove("d-none")):($(".td_all_dead").addClass("d-none"),document.getElementById("enabled_manual_stage2").checked=!1,document.getElementById("aa_cutin_miss").parentElement.classList.add("d-none"));isDefMode?$(".td_detail_slot").addClass("d-none"):$(".td_detail_slot").removeClass("d-none")}
function createLandBaseInstance(){var a=new LandBaseAll;if(isDefMode){var b=castFloat(document.getElementById("defense_ap_c").value);a.manualCorr=Math.min(Math.max(b,0),10);10<b&&(document.getElementById("defense_ap_c").value=10)}b=document.getElementsByClassName("lb_tab");for(var c=0;c<b.length;c++){for(var d=b[c],e=c+1,f=new LandBase(e,-1),g=d.getElementsByClassName("lb_plane"),h={},l=0;l<g.length;h={$jscomp$loop$prop$plane$348:h.$jscomp$loop$prop$plane$348},l++){var k=g[l],n=l+1;if(4<=l)break;
var m=castInt(k.dataset.planeid),p=castInt(k.getElementsByClassName("remodel_value")[0].textContent),q=castInt(k.getElementsByClassName("prof_select")[0].dataset.prof);k=k.getElementsByClassName("slot")[0];h.$jscomp$loop$prop$plane$348=new LandBaseItem(m,castInt(k.textContent),p,q);k.textContent=h.$jscomp$loop$prop$plane$348.slot;h.$jscomp$loop$prop$plane$348.slotNo=n;0<h.$jscomp$loop$prop$plane$348.id&&(f.planes.push(h.$jscomp$loop$prop$plane$348),!f.hasJet&&h.$jscomp$loop$prop$plane$348.isJet&&
(f.hasJet=!0));(n=usedItems.find(function(v){return function(t){return t.id===v.$jscomp$loop$prop$plane$348.id}}(h)))?n.num[h.$jscomp$loop$prop$plane$348.remodel]+=1:(n={id:h.$jscomp$loop$prop$plane$348.id,num:[0,0,0,0,0,0,0,0,0,0,0],parent:"lb"},n.num[h.$jscomp$loop$prop$plane$348.remodel]+=1,usedItems.push(n))}f.planes.some(function(v){return 0<v.id})||(f.mode=-1,d.getElementsByClassName("ohuda_select")[0].value=-1);f.mode=castInt(d.getElementsByClassName("ohuda_select")[0].value);2===f.mode&&(d=
castInt(document.getElementById("lb"+e+"_target_1").value),e=castInt(document.getElementById("lb"+e+"_target_2").value),g=battleCount-1,f.target[0]=d<=g?0<=d?d:g:g,f.target[1]=e<=g?0<=e?e:g:g,f.isSeparate=f.target[0]!==f.target[1]);0===f.mode?f.updateDefenseAirPower():(f.updateAirPower(),f.fullAirPower=f.airPower);a.landBases.push(f)}return a}
function getInnerProficiency(a,b){switch(a){case 7:return initialProf120Plane.includes(Math.abs(b))?120:100;case 0:return 0;case 1:return 10;case 2:return 25;case 3:return 40;case 4:return 55;case 5:return 70;case 6:return 85;default:return 0}}
function getReconnaissancesAdjust(a,b){b=void 0===b?!1:b;if(!b&&49===a.type)return 9===a.scout?1.18:8===a.scout?1.15:1;if(b){if(49===a.type)return 9===a.scout?1.24:1.18;if(9===a.type)return 8<a.scout?1.3:1.2;if([10,41].includes(a.type))return 8<a.scout?1.16:8===a.scout?1.13:1.1}return 1}
function getContactSelectRate(a){if([8,9,10,41,49].includes(a.type)){var b=a.scout,c=a.remodel;switch(a.id){case 102:b=Math.ceil(b+.1*c);break;case 25:case 138:case 163:case 304:case 370:case 239:b=Math.ceil(b+.14*c);break;case 59:b=Math.ceil(b+.2*c);break;case 61:b=Math.ceil(b+.25*c);break;case 151:b=Math.ceil(b+.4*c)}return[b/14,b/16,b/18]}return[]}
function createFleetInstance(){var a=null,b=getMaxShipCount(),c=new Fleet;c.adminLevel=castInt($("#admin_lv").val());var d=$("#union_fleet").prop("checked");c.isUnion=d;a=c.isUnion?document.getElementsByClassName("ship_tab"):$(".friendFleet_tab.show.active")[0].getElementsByClassName("ship_tab");saveSetting();for(var e=0;e<a.length;e++){var f=a[e],g=e+1;d&&6<g&&--g;var h=castInt(f.dataset.shipid),l=castInt(f.getElementsByClassName("ship_level")[0].textContent),k=castInt(f.getElementsByClassName("area")[0].textContent);
h&&usedShip.push({id:h,lv:l,area:k});if(!(f.classList.contains("d-none")||f.getElementsByClassName("ship_disabled")[0].classList.contains("disabled")||f.classList.contains("ui-draggable-dragging"))){k=new Ship(g);k.id=h;k.name=0<h?f.getElementsByClassName("ship_name_span")[0].textContent:"";k.drawTabId=f.id;k.type=castInt(f.dataset.shiptype);k.type2=castInt(f.dataset.shiptype2);k.level=l;k.antiAir=castInt(f.getElementsByClassName("aa")[0].textContent);k.luck=castInt(f.getElementsByClassName("ship_luck")[0].textContent);
var n=castInt(f.getElementsByClassName("max_scout")[0].textContent),m=castInt(f.getElementsByClassName("min_scout")[0].textContent);k.scout=99===l&&0<n?n:0<n?Math.floor(l/99*(n-m)+m):0;n=l=0;m={};for(var p=$jscomp.makeIterator(f.getElementsByClassName("ship_plane")),q=p.next();!q.done;m={$jscomp$loop$prop$plane$350:m.$jscomp$loop$prop$plane$350},q=p.next())if(q=q.value,!q.classList.contains("ui-draggable")&&!q.classList.contains("d-none")){var v=castInt(q.dataset.planeid),t=castInt(q.getElementsByClassName("remodel_value")[0].textContent),
x=castInt(q.getElementsByClassName("prof_select")[0].dataset.prof),u=q.getElementsByClassName("slot")[0];m.$jscomp$loop$prop$plane$350=new ShipItem(v,castInt(u.textContent),t,x);u.textContent=m.$jscomp$loop$prop$plane$350.slot;m.$jscomp$loop$prop$plane$350.slotNo=n++;k.items.push(m.$jscomp$loop$prop$plane$350);k.ignoreSlot&&m.$jscomp$loop$prop$plane$350.isPlane&&(k.ignoreSlot=!1);l<m.$jscomp$loop$prop$plane$350.range&&(l=m.$jscomp$loop$prop$plane$350.range);315===m.$jscomp$loop$prop$plane$350.id&&
[396,1492,428,429,361,362,1481,1489,451,456].includes(h)&&(l=3);!c.hasJet&&m.$jscomp$loop$prop$plane$350.isJet&&(c.hasJet=!0);m.$jscomp$loop$prop$plane$350.isExpanded=q.classList.contains("expanded_slot");(q=usedItems.find(function(r){return function(w){return w.id===r.$jscomp$loop$prop$plane$350.id}}(m)))?q.num[m.$jscomp$loop$prop$plane$350.remodel]+=1:(q={id:m.$jscomp$loop$prop$plane$350.id,num:[0,0,0,0,0,0,0,0,0,0,0],parent:"ship"},q.num[m.$jscomp$loop$prop$plane$350.remodel]+=1,usedItems.push(q))}k.updateAntiAirStatus();
k.tp+=k.getTransportPower();k.isEscort=d&&g>b;0<k.id||k.items.some(function(r){return 0<r.id})?c.ships.push(k):(f.getElementsByClassName("ap")[0].textContent="-",f.getElementsByClassName("ap_detail")[0].textContent="",f.getElementsByClassName("ship_range")[0].textContent="-",f.getElementsByClassName("rate_down")[0].textContent="-",f.getElementsByClassName("fix_down")[0].textContent="-",f.getElementsByClassName("hunshin_rate")[0].textContent="-");k.updateAirPower();k.initFullAirPower();k.range<l&&
(k.range=l);[353,354,196,197].includes(k.id)&&k.items.some(function(r){return 61===r.id})&&([353,354].includes(k.id)&&2>k.range&&(k.range=2),1>k.range&&(k.range+=1),k.range+=1);k.updateEquipmentBonusScout()}}c.updateAirPower();c.initFullAirPower();c.updateStage2All();c.updateScoutScores();c.updateBonusTorpedo();c.updateTransportPower();return c}
function createContactTable(a){var b=0,c=[[],[],[]],d=[[],[],[]],e=[[],[],[]];a=$jscomp.makeIterator(a);for(var f=a.next();!f.done;f=a.next())if(f=f.value,0!==f.id&&f.selectRate.length){b+=f.contact;for(var g=0;3>g;g++)3<=f.accuracy?c[g].push(f.selectRate[g]):2===f.accuracy?d[g].push(f.selectRate[g]):e[g].push(f.selectRate[g])}b=Math.floor(b)+1;b=[Math.min(b/25,1),Math.min(b/40,1),Math.min(b/55,1)];a=[[],[],[]];var h=1;for(f=0;3>f;f++){g=b[f];if(c[f].length){h=1;for(var l=$jscomp.makeIterator(c[f]),
k=l.next();!k.done;k=l.next())h*=1-k.value;h=g*(1-h);a[f].push(h);g-=h}else a[f].push(0);if(d[f].length){h=1;l=$jscomp.makeIterator(d[f]);for(k=l.next();!k.done;k=l.next())h*=1-k.value;h=g*(1-h);a[f].push(h);g-=h}else a[f].push(0);if(e[f].length){h=1;l=$jscomp.makeIterator(e[f]);for(k=l.next();!k.done;k=l.next())h*=1-k.value;a[f].push(g*(1-h))}else a[f].push(0)}c=[[],[],[]];for(d=0;3>d;d++)c[d].push(100*b[d]),c[d]=c[d].concat(a[d].map(function(n){return 100*n})),c[d].push(Math.min(100*getArraySum(a[d]),
100));return c}
function updateEnemyFleetInfo(){for(var a=new BattleData,b=$jscomp.makeIterator(document.getElementsByClassName("battle_content")),c=b.next();!c.done;c=b.next()){c=c.value;isDefMode&&(c=document.getElementById("air_raid_enemies"));if(isDefMode&&0<a.battles.length)break;if(!c.classList.contains("d-none")){var d=new Battle,e=!0,f=castInt(c.getElementsByClassName("cell_type")[0].value);d.cellType=f;d.isUnion=f===CELL_TYPE.grand;if(f===CELL_TYPE.normal||f===CELL_TYPE.aerialCombat||d.isUnion)d.enabledStage2=!0;
f=$jscomp.makeIterator(c.getElementsByClassName("enemy_content"));for(var g=f.next();!g.done;g=f.next()){g=g.value;var h=castInt(g.dataset.enemyid),l=castInt(g.getElementsByClassName("enemy_index")[0].dataset.index);h=new Enemy(h);if(!g.classList.contains("d-none")){if(!d.isUnion&&6===d.enemies.length)break;e&&h.id&&!h.type.includes(18)&&(e=!1);h.isDead=g.classList.contains("is_dead");h.isEscort=d.isUnion&&6<l;!d.hasAntiAirCI&&ANTIAIR_CUTIN_ENEMY.includes(h.id)&&(d.hasAntiAirCI=!0);!d.containUnknown&&
UNKNOWN_ENEMY.includes(h.id)&&(d.containUnknown=!0);d.enemies.push(h)}}d.enemies.length&&(d.isAllSubmarine=e);d.formation=castInt(c.getElementsByClassName("formation")[0].value);d.createStage2Table();a.battles.push(d)}}return a}
function shootDownEnemy(a,b,c,d){c=void 0===c?!1:c;d=void 0===d?[]:d;var e=0,f=0;f=null;var g=0;c&&(e=Math.random(),f=d.findIndex(function(v){return v.border>e}),f=0<=f?d[f].table:[],g=f.length);d=b.length;for(var h=0;h<d;h++){var l=b[h],k=l.slots.length;l.airPower=0;for(var n=l.landBaseAirPower=0,m=0;m<k;m++){var p=l.slots[m];l.slots[m]-=getShootDownSlot(a,p);if(l.attackers[m]&&c&&0<g){p=l.slots[m];var q=f[Math.floor(Math.random()*g)];.5<=Math.random()&&(p-=Math.floor(q.rateDown*p));.5<=Math.random()&&
(p-=q.fixDown);p-=q.minimumDown;l.slots[m]=0<p?p:0}n+=Math.floor(l.antiAirs[m]*Math.sqrt(l.slots[m]))}l.landBaseAirPower=n;l.onlyScout||(l.airPower=n)}}function getShootDownSlot(a,b){return SHOOT_DOWN_TABLE_ENEMY[b][a][Math.floor(Math.random()*[121,81,49,25,4,1][a])]}function getShootDownSlotFF(a,b){a=[1,3,5,7,10][a];return b*(Math.floor(Math.random()*(a/3*1E3+1))/1E3+a/4)/10}
function doLandBaseJetPhase(a,b){var c=b.stage2[0][0].length;if(a.hasJet&&c&&2===a.mode){for(var d=0,e=0;e<a.planes.length;e++){var f=a.planes[e];if(f.isJet){f.slot-=Math.floor(.6*getShootDownSlotFF(0,Math.round(f.slot)));var g=Math.floor(Math.random()*c);.5<=Math.random()&&(f.slot-=Math.floor(b.stage2[f.avoid][0][g]*f.slot));.5<=Math.random()&&(f.slot-=b.stage2[f.avoid][1][g]);f.updateAirPower()}d+=f.airPower}a.airPower=Math.floor(d*a.reconCorr)}}
function doJetPhase(a,b){var c=b.stage2[0][0].length;if(!a.hasJet||!b.enabledStage2||b.isAllSubmarine||!c)return 0;for(var d=0,e=a.ships.length,f=0;f<e;f++){var g=a.ships[f],h=g.items.length;if(!g.ignoreSlot)for(var l=0;l<h;l++){var k=g.items[l];if(k.isJet){d+=Math.round(k.slot*k.cost*.2);k.slot-=Math.floor(.6*getShootDownSlotFF(0,k.slot));var n=b.stage2[k.avoid],m=Math.floor(Math.random()*c);.5<=Math.random()&&(k.slot-=Math.floor(n[0][m]*k.slot));.5<=Math.random()&&(k.slot-=n[1][m]);n=k.airPower;
k.updateAirPower();a.airPower-=n-k.airPower;a.unionAirPower-=n-k.airPower;0>a.airPower&&(a.airPower=0);0>a.unionAirPower&&(a.unionAirPower=0)}}}return d}
function shootDownFleet(a,b,c,d,e){e=void 0===e?!0:e;var f=c.stage2[0][0].length;5===a&&(a=0);for(var g=c.enabledStage2,h=b.ships.length,l=0;l<h;l++){var k=b.ships[l];if(!k.ignoreSlot){for(var n=0,m=!c.isUnion&&k.isEscort||4===c.cellType,p=k.items.length,q=0;q<p;q++){var v=k.items[q];e&&(v.results[d]+=v.slot);if(!(m||!v.canBattle||0>=v.slot)&&f){var t=getShootDownSlotFF(a,v.slot);v.slot-=Math.floor(v.isJet?.6*t:t);if(v.isAttacker&&g){t=Math.floor(Math.random()*f);var x=c.stage2[v.avoid];.5<=Math.random()&&
(v.slot-=Math.floor(x[0][t]*v.slot));.5<=Math.random()&&(v.slot-=x[1][t])}v.canBattle&&0<v.slot?v.airPower=Math.floor(v.antiAir*Math.sqrt(v.slot)+v.bonusAirPower):(0>=v.slot&&(v.slot=0),v.airPower=0)}n+=v.airPower}k.airPower=n}}b.updateAirPower()}
function shootDownLandBase(a,b,c){var d=c.stage2[0][0].length;if(d){5===a&&(a=0);for(var e=0,f=b.planes.length,g=0;g<f;g++){var h=b.planes[g];if(!(0>=h.slot)){var l=getShootDownSlotFF(a,h.slot);h.slot-=Math.floor(h.isJet?.6*l:l);if(h.isAttacker){l=Math.floor(Math.random()*d);var k=c.stage2[h.avoid];.5<=Math.random()&&(h.slot-=Math.floor(k[0][l]*h.slot));.5<=Math.random()&&(h.slot-=k[1][l])}h.updateAirPower();e+=h.airPower}}b.airPower=Math.floor(e*b.reconCorr)}}
function rateCalculate(){var a=inputItems.landBase,b=inputItems.fleet,c=inputItems.battleInfo,d=castInt($("#calculate_count").val());d=0>=d?1:d;$("#calculate_count").val(d);for(var e=b.ships.length,f=c.battles,g=isDefMode?0:displayBattle,h=[0,0,0,0,0,0],l=[],k=[],n=[],m=[],p=[[],[]],q=isDefMode?1:battleCount,v=0,t=CELL_TYPE.aerialCombat,x=[],u=$jscomp.makeIterator(f),r=u.next();!r.done;r=u.next())r=r.value,r.enemies=r.enemies.filter(function(H){return-1===H.id||0<H.slots.length});g=g<c.battles.length?
g:c.battles.length-1;for(c=0;c<q;c++)l.push(0),k.push(0);for(c=0;c<e;c++)if(u=b.ships[c],!u.ignoreSlot)for(r=0;r<u.items.length;r++)u.items[r].isPlane&&n.push(Array(d));for(c=0;c<f[g].enemies.length;c++)if(u=f[g].enemies[c],!(u.onlyScout||0>u.id)){r=0===m.length?0:m[m.length-1][0]+1;for(var w=0;w<u.slots.length;w++)m.push([r,w,0,0,999]);x.push(0)}c=f[0].cellType===CELL_TYPE.highAirRaid?a.defense2AirPower:a.defenseAirPower;resultData.defenseAirPower=c;isDefMode&&(b.fullAirPower=c,b.airPower=c,b.fullUnionAirPower=
c,b.unionAirPower=c);c=0;if(isDefMode||f[0])c=f[0].getAirPower();u=!isDefMode&&document.getElementById("adapt_stage2").checked;r=[];u&&(r=castInt($("#fleet_formation").val()),b.isUnion&&f[g].cellType===CELL_TYPE.airRaid?b.updateStage2All(r,!0):b.updateStage2All(r),r=b.allStage2);for(w=0;w<d;w++){for(var y=0;y<q;y++){var C=f[y],z=C.enemies,A=!1;A=calculateLandBase(a,C,y);v+=doJetPhase(b,C);var B=C.isUnion?b.unionAirPower:b.airPower,D=C.getAirPower(),E=getAirStatusIndex(B,D);y===g&&(h[E]+=1);l[y]+=
B;k[y]+=D;shootDownFleet(E,b,C,y);C.cellType===t&&(shootDownEnemy(E,z,u,r),A=!0,E=getAirStatusIndex(b.airPower,C.getAirPower()),shootDownFleet(E,b,C,y,!1));if(y===g){shootDownEnemy(E,z,u,r);for(E=B=A=C=0;E<z.length;E++){var F=z[E];if(!F.onlyScout&&F.id){for(var G=F.slots,J=F.attackers.concat(),M=0;M<G.length;M++){var K=G[M],L=m[C];C+=1;L[2]+=K;L[3]<K&&(L[3]=K);L[4]>K&&(L[4]=K);0===K&&(J[M]=!1)}0>J.indexOf(!0)&&(x[A]+=1);A+=1;B+=F.airPower}F.slots=F.fullSlots.concat();F.airPower=F.fullAirPower;F.landBaseAirPower=
F.fullLandBaseAirPower}p[0].push(D);p[1].push(B);A=!1}if(A)for(z=$jscomp.makeIterator(z),D=z.next();!D.done;D=z.next())D=D.value,D.slots=D.fullSlots.concat(),D.airPower=D.fullAirPower,D.landBaseAirPower=D.fullLandBaseAirPower}for(y=0;3>y;y++)if(z=a.landBases[y],0!==z.mode){for(D=0;D<z.planes.length;D++)C=z.planes[D],C.slot=C.fullSlot,C.airPower=C.fullAirPower;z.airPower=z.fullAirPower}for(z=y=0;z<e;z++)if(D=b.ships[z],!D.ignoreSlot){C=D.items.length;for(A=0;A<C;A++)B=D.items[A],B.isPlane&&(n[y++][w]=
B.slot,B.slot=B.fullSlot,B.airPower=B.fullAirPower);D.airPower=D.fullAirPower}b.airPower=b.fullAirPower;b.escortAirPower=b.fullEscortAirPower;b.unionAirPower=b.fullUnionAirPower}for(t=f=0;t<e;t++)if(u=b.ships[t],!u.ignoreSlot)for(r=0;r<u.items.length;r++)u.items[r].isPlane&&(w=n[f],y={shipNo:u.shipNo,slot:u.items[r].slotNo,max:getArrayMax(w),min:getArrayMin(w),avg:w.reduce(function(H,I){return H+I})/d,death:w.filter(function(H){return 0===H}).length,deathRate:0},y.deathRate=y.death/w.length,resultData.fleetSlots.push(y),
f+=1);e=$("#shoot_down_table");for(n=0;n<q;n++)for(f=Math.round(l[n]/d),t=Math.round(k[n]/d),u=getAirStatusIndex(f,t),e.find(".fap.battle"+(n+1)).text(f),e.find(".eap.battle"+(n+1)).text(t),e.find(".cond.battle"+(n+1)).html("<span>"+AIR_STATUS[u].abbr+"</span>").removeClass("airStatus0 airStatus1 airStatus2 airStatus3 airStatus4").addClass("airStatus"+u),f=$jscomp.makeIterator(b.ships),t=f.next();!t.done;t=f.next())if(t=t.value,!t.ignoreSlot)for(u=$jscomp.makeIterator(t.items),r=u.next();!r.done;r=
u.next())r=r.value,r.isPlane&&(w=r.results[n],$("#s"+t.shipNo+"sl"+r.slotNo).find(".battle"+(n+1)).text(Math.round(w/d)));e.find("td").removeClass("d-none");for(b=battleCount+1;10>=b;b++)e.find(".battle"+b).addClass("d-none");isDefMode||(resultData.fleetAirPower=Math.round(l[g]/d));l=[];b=$jscomp.makeIterator(a.landBases);for(q=b.next();!q.done;q=b.next())for(q=q.value,e=0;2>e;e++)l.push(q.results[displayBattle].airStatusIndex[e].map(function(H){return H/d}));a=$jscomp.makeIterator(a.landBases);for(q=
a.next();!q.done;q=a.next())b=q.value,resultData.landBaseAirPowers.push(Math.round(b.results[g].mainAirPower[0]/d)),resultData.landBaseAirPowers.push(Math.round(b.results[g].mainAirPower[1]/d)),resultData.enemyAirPowers.push(Math.round(b.results[g].enemyAirPower[0]/d)),resultData.enemyAirPowers.push(Math.round(b.results[g].enemyAirPower[1]/d));isDefMode?resultData.enemyAirPowers.push(c):resultData.enemyAirPowers.push(Math.round(k[g]/d));resultData.landBaseAirStatus=l;resultData.fleetAirStatus=h.map(function(H){return H/
d});resultData.enemySlots=m;resultData.enemyAirPowerResults=p;resultData.enemySlotAllDead=x;resultData.usedSteels=v}
function calculateLandBase(a,b,c){for(var d=b.enemies,e=!1,f=0;3>f;f++){var g=a.landBases[f],h=g.target[0],l=g.target[1];if(h===c||l===c){var k=g.results[c];if(h===c){doLandBaseJetPhase(g,b);e=g.airPower;var n=b.getLandBaseAirPower();h=0===n?0:getAirStatusIndex(e,n);k.airStatusIndex[0][h]+=1;k.mainAirPower[0]+=e;k.enemyAirPower[0]+=n;shootDownEnemy(h,d);e=!0;g.isSeparate&&shootDownLandBase(h,g,b)}l===c&&(g.isSeparate&&doLandBaseJetPhase(g,b),e=g.airPower,h=b.getLandBaseAirPower(),l=0===h?0:getAirStatusIndex(e,
h),k.airStatusIndex[1][l]+=1,k.mainAirPower[1]+=e,k.enemyAirPower[1]+=h,shootDownEnemy(l,d),e=!0,g.isSeparate&&shootDownLandBase(l,g,b))}}return e}
function detailCalculate(){var a=castInt($("#detail_info").data("base_no")),b=castInt($("#detail_info").data("slot_no"));switch($("#detail_info").data("mode")){case "enemy_slot_detail":enemySlotDetailCalculate(a,b);break;case "fleet_slot_detail":fleetSlotDetailCalculate(a,b,castInt($("#detail_info").data("ship_id")));break;case "land_base_detail":landBaseDetailCalculate(a,b)}}
function fleetSlotDetailCalculate(a,b,c){c=void 0===c?0:c;setPreCalculateTable();var d=createLandBaseInstance(),e=createFleetInstance(),f=updateEnemyFleetInfo(!1),g=castInt($("#detail_calculate_count").val()),h=[],l=e.ships[a];if(!ITEM_DATA.find(function(y){return y.id===l.items[b].id&&PLANE_TYPE.includes(y.type)}))return!1;var k=isDefMode?0:f.battles.length-1,n=castInt(document.getElementById("target_enemy").value,-1);0<=n&&n<f.battles.length&&(k=n);n=document.getElementById("adapt_stage2").checked;
var m=[];n&&(m=castInt($("#fleet_formation").val()),e.isUnion&&f.battles[k].cellType===CELL_TYPE.airRaid?e.updateStage2All(m,!0):e.updateStage2All(m),m=e.allStage2);for(var p=l.items[b],q=$jscomp.makeIterator(f.battles),v=q.next();!v.done;v=q.next())v=v.value,v.enemies=v.enemies.filter(function(y){return 0<y.slots.length});for(q=0;q<g;q++){for(v=0;v<=k;v++){var t=f.battles[v],x=t.enemies;calculateLandBase(d,t,v);doJetPhase(e,t);var u=t.cellType,r=t.isUnion?e.unionAirPower:e.airPower,w=t.getAirPower();
r=getAirStatusIndex(r,w);shootDownFleet(r,e,t,v);u===CELL_TYPE.aerialCombat&&(shootDownEnemy(r,x,n,m),r=getAirStatusIndex(e.airPower,t.getAirPower()),shootDownFleet(r,e,t,v,!1));t=$jscomp.makeIterator(x);for(x=t.next();!x.done;x=t.next())x=x.value,x.slots=x.fullSlots.concat(),x.airPower=x.fullAirPower,x.landBaseAirPower=x.fullLandBaseAirPower}for(v=0;3>v;v++){t=d.landBases[v];for(x=0;x<t.planes.length;x++)u=t.planes[x],u.slot=u.fullSlot,u.updateAirPower();t.updateAirPower()}for(v=0;v<e.ships.length;v++)for(t=
e.ships[v],x=t.items.length,u=t.airPower=0;u<x;u++)r=t.items[u],v===a&&r.slotNo===b&&h.push(r.slot),r.slot=r.fullSlot,r.updateAirPower(),t.airPower+=r.airPower;e.updateAirPower()}chartSlotDistribution=updateDetailChart(h,"\u6b8b\u6a5f\u6570 [\u6a5f]",{mode:"index",callbacks:{title:function(y,C){y=castInt(y[0].xLabel);return"\u6b8b\u6a5f\u6570\uff1a"+y+" \u6a5f\n\u822a\u7a7a\u6226\u706b\u529b\uff1a"+ShipItem.getFirePower(p,y).join(" or ")},label:function(y,C){return[y.yLabel+" %"]}}});e=SHIP_DATA.find(function(y){return y.id===
c});d="";g=0;document.getElementById("graph_title").textContent=k+1+"\u6226\u76ee\u7d42\u4e86\u6642\u70b9\u3067\u306e\u6b8b\u6a5f\u6570\u5206\u5e03";$("#land_base_detail_table").addClass("d-none");$(".detail_fire").addClass("d-none").removeClass("d-flex");$(".detail_wave").removeClass("d-none").addClass("d-flex");$("#detail_info").data("mode","fleet_slot_detail");$("#detail_info").data("ship_id",c);$("#detail_info").data("base_no",a);$("#detail_info").data("slot_no",b);$("#detail_warning").html("\n\t\t<div>\u203b \u30b0\u30e9\u30d5\u5185\u306e\u822a\u7a7a\u6226\u706b\u529b\u306f\u30ad\u30e3\u30c3\u30d7\u524d\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3001\u89e6\u63a5\u88dc\u6b63\u306a\u3057\u3002\u5c0f\u6570\u5207\u6368\u3066</div>\n\t\t<div>\u203b \u6700\u7d42\u6226\u95d8\u306e\u822a\u7a7a\u6226\u7d42\u4e86\u6642\u70b9\u3067\u306e\u6b8b\u6570\u306e\u5206\u5e03\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002</div>");
a={};k=$jscomp.makeIterator(l.items);for(h=k.next();!h.done;a={$jscomp$loop$prop$pl$352:a.$jscomp$loop$prop$pl$352},h=k.next()){a.$jscomp$loop$prop$pl$352=h.value;h=ITEM_DATA.find(function(y){return function(C){return C.id===y.$jscomp$loop$prop$pl$352.id}}(a));if(g===(e?e.slot.length:4))break;n=h?h.name:"-";m=PLANE_TYPE.includes(h?h.type:0);q="";m&&FIGHTERS.includes(h.type)?q=h.antiAir?'<span class="mx-1">\u5bfe\u7a7a: '+h.antiAir+"</span>":"":m&&RECONNAISSANCES.includes(h.type)?(q=h.antiAir?'<span class="mx-1">\u5bfe\u7a7a: '+
h.antiAir+"</span>":"",q+='<span class="mx-1">\u7d22\u6575: '+h.scout+"</span>"):m&&(q=h.torpedo?'<span class="mx-1">\u96f7\u88c5: '+h.torpedo+"</span>":"",q+=h.bomber?'<span class="mx-1">\u7206\u88c5: '+h.bomber+"</span>":"");d+='\n\t\t<div class="d-flex px-2 py-1 '+(b===g?"selected":"")+" "+(m?"general_tr btn_show_detail":"disabled_detail_slot")+'" data-slot_no="'+g+'">\n\t\t\t<div class="w_5 align-self-center font_size_11 text-right pr-1">'+(m?a.$jscomp$loop$prop$pl$352.slot:"-")+'</div>\n\t\t\t<div class="'+
(m?"w_55":"w_90")+' d-flex align-self-center font_size_12 pl-0">\n\t\t\t\t<img src="../img/type/'+(h?"icon"+h.itype:"undefined")+'.png" class="plane_img_sm align-self-center">\n\t\t\t\t<div class="align-self-center detail_item_name"><span>'+n+'</span></div>\n\t\t\t\t<div class="align-self-center ml-auto d-flex">\n\t\t\t\t\t'+(h&&a.$jscomp$loop$prop$pl$352.remodel?'<div class="align-self-center text_remodel mr-1">\u2605'+a.$jscomp$loop$prop$pl$352.remodel+"</div>":"")+"\n\t\t\t\t\t"+(h&&a.$jscomp$loop$prop$pl$352.level?
'<img class="ml-auto mr-1 h_20" alt="'+getProfString(a.$jscomp$loop$prop$pl$352.level)+'" data-prof="'+a.$jscomp$loop$prop$pl$352.level+'" src="../img/util/prof'+a.$jscomp$loop$prop$pl$352.level+'.png">':"")+"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t"+(m?'<div class="w_40 font_size_11 align-self-center">('+q+")</div>":"")+"\n\t\t</div>";g+=1}a='\n\t\t<img src="../img/ship/'+c+'.png" class="ship_img align-self-center '+(c?"":"d-none")+'">\n\t\t<span class="ml-1 align-self-center legend_name" data-shipid="'+
c+'">'+(e?e.name:"\u672a\u6307\u5b9a")+"</span>\n\t";$("#detail_legend").html(a);$("#detail_info").html(d);a=chartSlotDistribution.map(function(y){return y.slot});k=getArrayMax(a);document.getElementById("stage3_all_slot").checked&&(document.getElementById("stage3_slot").value=k);document.getElementById("stage3_all_slot_label").textContent="\u6b8b\u6a5f\u6570\u5206\u5e03\u306e\u7d50\u679c\u3092\u5229\u7528\uff08"+getArrayMin(a)+"\u6a5f ~ "+k+"\u6a5f\uff09";document.getElementById("stage3_remodel").value=
p.remodel?p.remodel:0;a='<option value="99">\u4efb\u610f</option>';f=f.battles.length-1;k=castInt(document.getElementById("target_enemy").value,-1);for(d=0;d<=f;d++)a=k===d?a+('<option value="'+d+'" selected>'+(d+1)+"\u6226\u76ee</option>"):a+('<option value="'+d+'">'+(d+1)+"\u6226\u76ee</option>");document.getElementById("target_enemy").innerHTML=a;if(0>k||k>f)document.getElementById("target_enemy").value=99;stage3PowerCalculate();return!0}
function landBaseDetailCalculate(a,b,c){c=void 0===c?!1:c;setPreCalculateTable();var d=createLandBaseInstance(),e=updateEnemyFleetInfo(!1),f=castInt($("#detail_calculate_count").val()),g=[],h=isDefMode?0:displayBattle,l=d.landBases[a].planes,k=0;c&&0===b&&!ATTACKERS.includes(l[b].type)&&l.some(function(D){return ATTACKERS.includes(D.type)})&&(b=l.findIndex(function(D){return ATTACKERS.includes(D.type)}));for(var n=0;n<l.length;n++){var m=l[n];0===l[b].id&&0!==m.id&&(b=n);k+=m.fullSlot}n=[];for(m=
0;m<f;m++){for(var p=0;p<=h;p++){for(var q=e.battles[p],v=q.enemies,t=0;3>t;t++){var x=d.landBases[t],u=x.target[0],r=x.target[1];if(u===p||r===p){if(u===p){doLandBaseJetPhase(x,q);var w=x.airPower,y=q.getLandBaseAirPower();w=0===w&&0===y?0:getAirStatusIndex(w,y);shootDownEnemy(w,v);u!==r&&shootDownLandBase(w,x,q)}r===p&&(u!==r&&doLandBaseJetPhase(x,q),u=x.airPower,r=q.getLandBaseAirPower(),u=0===u&&0===r?0:getAirStatusIndex(u,r),shootDownEnemy(u,v),shootDownLandBase(u,x,q))}}q=$jscomp.makeIterator(v);
for(v=q.next();!v.done;v=q.next())v=v.value,v.slots=v.fullSlots.concat(),v.airPower=v.fullAirPower,v.landBaseAirPower=v.fullLandBaseAirPower}for(p=0;3>p;p++){q=d.landBases[p];for(t=v=0;t<q.planes.length;t++)x=q.planes[t],a+1===q.baseNo&&b===t&&g.push(x.slot),v+=x.slot,x.slot=x.fullSlot,x.updateAirPower();a+1===q.baseNo&&n.push(v);q.updateAirPower()}}var C=l[b].id,z=l[b].remodel,A=l.find(function(D){return 312===D.id})?1.15:l.find(function(D){return 311===D.id})?1.125:1,B=e.battles[h].isUnion?1.1:
1;chartSlotDistribution=updateDetailChart(g,"\u6b8b\u6a5f\u6570 [\u6a5f]",{mode:"index",callbacks:{title:function(D,E){D=D[0].xLabel;E="\u822a\u7a7a\u6226\u706b\u529b\uff1a"+(LandBaseItem.getFirePower(C,D,z)*A*B).toFixed(1);return D?"\u6b8b\u6a5f\u6570\uff1a"+D+" \u6a5f\n"+E:"\u6b8b\u6a5f\u6570\uff1a0 \u6a5f\n\u822a\u7a7a\u6226\u706b\u529b\uff1a0"},label:function(D,E){return[D.yLabel+" %"]}}});m=h=g=0;n=$jscomp.makeIterator(n);for(p=n.next();!p.done;p=n.next())p=p.value,q=p/k,0===p?m+=1:.25>q?h+=
1:.4>q&&(g+=1);$("#status_s").text(100*g/f+" %");$("#status_m").text(100*h/f+" %");$("#status_l").text(100*m/f+" %");f="";k=0;document.getElementById("graph_title").textContent="\u51fa\u6483\u7d42\u4e86\u6642\u70b9\u3067\u306e\u6b8b\u6a5f\u6570\u5206\u5e03";$("#land_base_detail_table").removeClass("d-none");$(".detail_fire").addClass("d-none").removeClass("d-flex");$(".detail_wave").removeClass("d-none").addClass("d-flex");$("#detail_info").data("mode","land_base_detail");$("#detail_info").data("base_no",
a);$("#detail_info").data("slot_no",b);$("#detail_warning").html("\n\t\t<div>\u203b \u30b0\u30e9\u30d5\u5185\u306e\u822a\u7a7a\u6226\u706b\u529b\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u88dc\u6b63\u3001\u89e6\u63a5\u88dc\u6b63\u306a\u3057\u3067\u5bfe\u6c34\u4e0a\u8266\u306e\u5834\u5408</div>\n\t\t<div>\u203b \u5bfe\u6575\u9023\u5408\u88dc\u6b63\u3001\u9678\u5075\u88dc\u6b63\u306b\u3064\u3044\u3066\u306f\u3001\u8a72\u5f53\u3059\u308b\u6226\u95d8\u3001\u88c5\u5099\u3067\u3042\u308c\u3070\u6709\u52b9</div>");
n={};g=$jscomp.makeIterator(d.landBases[a].planes);for(h=g.next();!h.done;n={$jscomp$loop$prop$pl$354:n.$jscomp$loop$prop$pl$354},h=g.next())n.$jscomp$loop$prop$pl$354=h.value,m=(h=ITEM_DATA.find(function(D){return function(E){return E.id===D.$jscomp$loop$prop$pl$354.id}}(n)))?h.name:"-",p="",FIGHTERS.includes(h.type)?p=h.antiAir?'<span class="mx-1">\u5bfe\u7a7a: '+h.antiAir+"</span>":"":RECONNAISSANCES.includes(h.type)?(p=h.antiAir?'<span class="mx-1">\u5bfe\u7a7a: '+h.antiAir+"</span>":"",p+='<span class="mx-1">\u7d22\u6575: '+
h.scout+"</span>"):(p=h.torpedo?'<span class="mx-1">\u96f7\u88c5: '+h.torpedo+"</span>":"",p+=h.bomber?'<span class="mx-1">\u7206\u88c5: '+h.bomber+"</span>":""),p+='<span class="mx-1">\u534a\u5f84: '+h.radius+"</span>",f+='\n\t\t<div class="d-flex px-2 py-1 '+(b===k?"selected":"")+" "+(h?"general_tr btn_show_detail":"")+'" data-slot_no="'+k+'">\n\t\t\t<div class="w_5 align-self-center font_size_11 text-right pr-1">'+n.$jscomp$loop$prop$pl$354.slot+'</div>\n\t\t\t<div class="w_55 d-flex align-self-center font_size_12 pl-0">\n\t\t\t\t<img src="../img/type/'+
(h?"icon"+h.itype:"undefined")+'.png" class="plane_img_sm align-self-center">\n\t\t\t\t<div class="align-self-center detail_item_name"><span>'+m+'</span></div>\n\t\t\t\t<div class="align-self-center ml-auto d-flex">\n\t\t\t\t\t'+(h&&n.$jscomp$loop$prop$pl$354.remodel?'<div class="align-self-center text_remodel mr-1">\u2605'+n.$jscomp$loop$prop$pl$354.remodel+"</div>":"")+"\n\t\t\t\t\t"+(h&&n.$jscomp$loop$prop$pl$354.level?'<img class="ml-auto mr-1 h_20" alt="'+getProfString(n.$jscomp$loop$prop$pl$354.level)+
'" data-prof="'+n.$jscomp$loop$prop$pl$354.level+'" src="../img/util/prof'+n.$jscomp$loop$prop$pl$354.level+'.png">':"")+'\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="w_40 font_size_11 align-self-center">('+p+")</div>\n\t\t</div>",k+=1;$("#detail_legend").html("<span>\u7b2c"+(a+1)+"\u57fa\u5730\u822a\u7a7a\u968a</span>");$("#detail_info").html(f);b=chartSlotDistribution.map(function(D){return D.slot});f=getArrayMax(b);document.getElementById("stage3_all_slot").checked&&(document.getElementById("stage3_slot").value=
f);document.getElementById("stage3_all_slot_label").textContent="\u6b8b\u6a5f\u6570\u5206\u5e03\u306e\u7d50\u679c\u3092\u5229\u7528\uff08"+getArrayMin(b)+"\u6a5f ~ "+f+"\u6a5f\uff09";document.getElementById("stage3_remodel").value=z?z:0;l.some(function(D){return 311===D.id})&&(document.getElementById("enabled_rikutei").checked=!0);l.some(function(D){return 312===D.id})&&(document.getElementById("enabled_rikutei_z").checked=!0);l='<option value="99">\u4efb\u610f</option>';e=e.battles.length-1;b=castInt(document.getElementById("target_enemy").value,
-1);for(f=0;f<=e;f++)l=b===f?l+('<option value="'+f+'" selected>'+(f+1)+"\u6226\u76ee</option>"):l+('<option value="'+f+'">'+(f+1)+"\u6226\u76ee</option>");document.getElementById("target_enemy").innerHTML=l;if(0>b||b>e)document.getElementById("target_enemy").value=99;c&&(0>b||b>e)&&(document.getElementById("target_enemy").value=d.landBases[a].target[0]);stage3PowerCalculate()}
function enemySlotDetailCalculate(a,b,c){c=void 0===c?!1:c;setPreCalculateTable();var d=createLandBaseInstance(),e=createFleetInstance(),f=updateEnemyFleetInfo(!1),g=castInt($("#detail_calculate_count").val()),h=isDefMode?0:displayBattle;h=h<f.battles.length?h:f.battles.length-1;var l=[],k=[],n=f.battles[h].enemies.filter(function(z){return 0<z.slots.length&&!z.onlyScout})[a],m=ENEMY_DATA.find(function(z){return z.id===n.id}),p=m.eqp.map(function(z){return ENEMY_ITEM.find(function(A){return A.id===
z})});p=p.filter(function(z){return FIGHTERS.includes(z.type)||ATTACKERS.includes(z.type)});c&&!ATTACKERS.includes(p[b].type)&&p.some(function(z){return ATTACKERS.includes(z.type)})&&(b=p.findIndex(function(z){return ATTACKERS.includes(z.type)}));var q=new EnemyItem(p[b].id);c=$("#slot_detail").prop("checked");var v=[];if(p=document.getElementById("enabled_manual_stage2").checked){v=castInt($("#fleet_formation").val());e.isUnion&&f.battles[h].cellType===CELL_TYPE.airRaid?e.updateStage2All(v,!0):e.updateStage2All(v);
var t=document.getElementById("aa_cutin_miss").checked;document.getElementById("aa_cutin_miss").parentElement.classList.remove("d-none");v=e.allStage2;t&&(v=[v[v.length-1]])}else document.getElementById("aa_cutin_miss").parentElement.classList.add("d-none");t=$jscomp.makeIterator(f.battles);for(var x=t.next();!x.done;x=t.next())x=x.value,x.enemies=x.enemies.filter(function(z){return 0<z.slots.length});for(t=0;t<g;t++){for(x=0;x<=h;x++){var u=f.battles[x],r=u.enemies;calculateLandBase(d,u,x);doJetPhase(e,
u);var w=u.cellType,y=u.isUnion?e.unionAirPower:e.airPower,C=u.getAirPower();y=getAirStatusIndex(y,C);shootDownFleet(y,e,u,x);w===CELL_TYPE.aerialCombat&&(shootDownEnemy(y,r,p,v),y=getAirStatusIndex(e.airPower,u.getAirPower()),shootDownFleet(y,e,u,x,!1));x===h&&(shootDownEnemy(y,r,p,v),u=n.slots[b],k.push(u),c||(u=q.getFirePower(u),2===u.length?(l.push(u[0]),l.push(u[1])):l.push(u[0])));for(u=0;u<r.length;u++)w=r[u],w.onlyScout||(w.slots=w.fullSlots.concat(),w.airPower=w.fullAirPower,w.landBaseAirPower=
w.fullLandBaseAirPower)}for(x=0;3>x;x++){r=d.landBases[x];for(u=0;u<r.planes.length;u++)w=r.planes[u],w.slot=w.fullSlot,w.updateAirPower();r.updateAirPower()}for(x=0;x<e.ships.length;x++)for(r=e.ships[x],u=r.items.length,w=r.airPower=0;w<u;w++)y=r.items[w],y.slot=y.fullSlot,y.updateAirPower(),r.airPower+=y.airPower;e.updateAirPower()}chartSlotDistribution=updateDetailChart(c?k:l,c?"\u6b8b\u6a5f\u6570 [\u6a5f]":"\u822a\u7a7a\u6226\u706b\u529b",{mode:"index",callbacks:{title:function(z){z=z[0].xLabel;
if($("#slot_detail").prop("checked")){if(!z)return"\u6b8b\u6a5f\u6570\uff1a"+z+" \u6a5f\n\u822a\u7a7a\u6226\u706b\u529b\uff1a0";var A="\u822a\u7a7a\u6226\u706b\u529b\uff1a"+q.getFirePower(z).join(" or ");return"\u6b8b\u6a5f\u6570\uff1a"+z+" \u6a5f\n"+A}return"\u822a\u7a7a\u6226\u706b\u529b\uff1a"+z},label:function(z){return[z.yLabel+" %"]}}});if(!c)for(chartSlotDistribution=[],d=getArrayMax(k),f=getArrayMin(k),e=k.length,f={$jscomp$loop$prop$i$266$356:f};f.$jscomp$loop$prop$i$266$356<=d;f={$jscomp$loop$prop$i$266$356:f.$jscomp$loop$prop$i$266$356},
f.$jscomp$loop$prop$i$266$356++)(g=k.filter(function(z){return function(A){return A===z.$jscomp$loop$prop$i$266$356}}(f)).length)&&chartSlotDistribution.push({slot:f.$jscomp$loop$prop$i$266$356,rate:g/e});$("#land_base_detail_table").addClass("d-none");$(".detail_fire").removeClass("d-none").addClass("d-flex");$(".detail_wave").addClass("d-none").removeClass("d-flex");$("#detail_info").data("mode","enemy_slot_detail");$("#detail_info").data("base_no",a);$("#detail_info").data("slot_no",b);$("#detail_info").data("battle_no",
h);$("#detail_warning").text("\u203b \u30b0\u30e9\u30d5\u5185\u306e\u822a\u7a7a\u6226\u706b\u529b\u306f\u30ad\u30e3\u30c3\u30d7\u524d\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3001\u89e6\u63a5\u88dc\u6b63\u306a\u3057\u3002\u5c0f\u6570\u5207\u6368\u3066");a=document.getElementById("graph_title").textContent="";d=h=0;e={};f=$jscomp.makeIterator(m.eqp);for(g=f.next();!g.done;e={$jscomp$loop$prop$id$358:e.$jscomp$loop$prop$id$358},g=f.next())e.$jscomp$loop$prop$id$358=g.value,g=ENEMY_ITEM.find(function(z){return function(A){return A.id===
z.$jscomp$loop$prop$id$358}}(e)),l=m.slot[h],c=PLANE_TYPE.includes(g?g.type:0),p="",c&&FIGHTERS.includes(g.type)?p=g.antiAir?'<span class="mx-1">\u5bfe\u7a7a: '+g.antiAir+"</span>":"":c&&(p=g.antiAir?'<span class="mx-1">\u5bfe\u7a7a: '+g.antiAir+"</span>":"",p+=g.torpedo?'<span class="mx-1">\u96f7\u88c5: '+g.torpedo+"</span>":"",p+=g.bomber?'<span class="mx-1">\u7206\u88c5: '+g.bomber+"</span>":""),a+='\n\t\t<div class="d-flex px-2 py-1 '+(b===d?"selected":"")+" "+(c?"general_tr btn_show_detail":
"disabled_detail_slot")+'" data-slot_no="'+d+'">\n\t\t\t<div class="w_5 align-self-center font_size_11 text-right pr-2">'+(0<=l?l:"-")+'</div>\n\t\t\t<div class="'+(c?"w_55":"w_90")+' d-flex font_size_12 align-self-center">\n\t\t\t\t<img src="../img/type/icon'+g.itype+'.png" class="plane_img_sm align-self-center">\n\t\t\t\t<div class="align-self-center">'+g.name+"</div>\n\t\t\t</div>\n\t\t\t"+(c?'<div class="w_40 font_size_11 align-self-center">('+p+")</div>":"")+"\n\t\t</div>",h+=1,PLANE_TYPE.includes(g.type)&&
(d+=1);b='\n\t\t<img src="../img/enemy/'+m.id+'.png" class="ship_img align-self-center">\n\t\t<span class="ml-1 text-primary font_size_11 align-self-center">ID: '+(m.id+1500)+'</span>\n\t\t<span class="ml-1 font_size_12 align-self-center legend_name" data-enemyid="'+m.id+'">'+m.name+"</span>\n\t";$("#detail_legend").html(b);$("#detail_info").html(a);b=getArrayMax(k);document.getElementById("stage3_all_slot").checked&&(document.getElementById("stage3_slot").value=b);document.getElementById("stage3_all_slot_label").textContent=
"\u6b8b\u6a5f\u6570\u5206\u5e03\u306e\u7d50\u679c\u3092\u5229\u7528\uff08"+getArrayMin(k)+"\u6a5f ~ "+b+"\u6a5f\uff09";stage3PowerCalculate()}
function stage3PowerCalculate(){switch($("#detail_info").data("mode")){case "enemy_slot_detail":$(".friend_option").addClass("d-none");$(".land_base_option").addClass("d-none");$(".fleet_option").addClass("d-none");document.getElementById("manual_enemy").classList.remove("d-none");$(".enemy_option").removeClass("d-none");enemyStage3PowerCalculate();break;case "fleet_slot_detail":$(".fleet_option").removeClass("d-none");$(".land_base_option").addClass("d-none");$(".friend_option").removeClass("d-none");
$(".enemy_option").addClass("d-none");fleetStage3PowerCalculate();break;case "land_base_detail":$(".fleet_option").addClass("d-none"),$(".land_base_option").removeClass("d-none"),$(".friend_option").removeClass("d-none"),$(".enemy_option").addClass("d-none"),landBasePowerCalculate()}}
function updateAerialPowerSetting(){aerialSetting={item:null,a11:1,contactBonus:1,isUnion:!1,unionBonus:1,nishikiBonus:1,isCritical:!1,levelCriticalBonus:1,ammoBonus:1,isAllSlot:!1,manualSlot:-1,manualRemodel:0,targetEnemies:[]};var a=document.getElementById("ship_bonus").value;document.getElementById("ship_bonus").value=6<a.length?a.slice(0,6):a;aerialSetting.a11=0>=castFloat(a)?1:castFloat(a);aerialSetting.contactBonus=castFloat(document.getElementById("contact_bonus").value,1);aerialSetting.isCritical=
document.getElementById("critical_hit").checked;aerialSetting.ammoBonus=castFloat(document.getElementById("ammo_bonus").value,1);aerialSetting.isAllSlot=document.getElementById("stage3_all_slot").checked;aerialSetting.manualSlot=Math.min(castInt(document.getElementById("stage3_slot").value),ST3_MAX_SLOT);document.getElementById("stage3_slot").readOnly=aerialSetting.isAllSlot;aerialSetting.isAllSlot||(document.getElementById("stage3_slot").value=Math.max(aerialSetting.manualSlot,0));aerialSetting.manualRemodel=
Math.max(Math.min(castInt(document.getElementById("stage3_remodel").value),10),0);document.getElementById("stage3_remodel").value=aerialSetting.manualRemodel;aerialSetting.nishikiBonus=document.getElementById("enabled_rikutei_z").checked?1.15:document.getElementById("enabled_rikutei").checked?1.125:1}
function landBasePowerCalculate(){var a=castInt($("#detail_info").data("base_no")),b=castInt($("#detail_info").data("slot_no"));a=createLandBaseInstance().landBases[a].planes[b];b=updateEnemyFleetInfo(!1);var c=isDefMode?0:displayBattle;c=c<b.battles.length?c:b.battles.length-1;updateAerialPowerSetting();aerialSetting.item=a;var d=castInt(document.getElementById("target_enemy").value);if(99===d){document.getElementById("manual_enemy").classList.remove("d-none");var e=castInt(document.getElementById("manual_enemy_id").value);
aerialSetting.targetEnemies.push(new Enemy(e));var f=getManualEnemySearchBox();e={};f=$jscomp.makeIterator(f);for(var g=f.next();!g.done;e={$jscomp$loop$prop$text$360:e.$jscomp$loop$prop$text$360},g=f.next()){e.$jscomp$loop$prop$text$360=g.value;var h=ENEMY_DATA.filter(function(k){return function(n){return n.id+1500==k.$jscomp$loop$prop$text$360||0<=n.name.indexOf(k.$jscomp$loop$prop$text$360)}}(e));g={};h=$jscomp.makeIterator(h);for(var l=h.next();!l.done;g={$jscomp$loop$prop$enemy$362:g.$jscomp$loop$prop$enemy$362},
l=h.next())g.$jscomp$loop$prop$enemy$362=l.value,12>aerialSetting.targetEnemies.length&&!aerialSetting.targetEnemies.some(function(k){return function(n){return n.id===k.$jscomp$loop$prop$enemy$362.id}}(g))&&aerialSetting.targetEnemies.push(new Enemy(g.$jscomp$loop$prop$enemy$362.id))}}else aerialSetting.targetEnemies=b.battles[d].enemies.concat(),document.getElementById("manual_enemy").classList.add("d-none");b=99===d?document.getElementById("manual_enemy_union").checked:b.battles[c].isUnion;aerialSetting.isUnion=
b;aerialSetting.unionBonus=b?1.1:1;b=getInnerProficiency(a.level,a.type);aerialSetting.levelCriticalBonus=1+Math.floor(Math.sqrt(b)+[0,1,2,3,4,5,7,10][a.level])/100;b=aerialSetting.manualRemodel;0<=b&&(a.remodel=b);aerialSetting.ammoBonus=1;drawStage3Result()}
function fleetStage3PowerCalculate(){var a=castInt($("#detail_info").data("base_no")),b=castInt($("#detail_info").data("slot_no"));a=createFleetInstance().ships[a];b=a.items[b];var c=updateEnemyFleetInfo(!1);updateAerialPowerSetting();aerialSetting.item=b;var d=castInt(document.getElementById("target_enemy").value);if(99===d){document.getElementById("manual_enemy").classList.remove("d-none");c=castInt(document.getElementById("manual_enemy_id").value);d=new Enemy(c);aerialSetting.isUnion=document.getElementById("manual_enemy_union").checked;
aerialSetting.isUnion?(d.isEscort=document.getElementById("manual_union_escort").checked,document.getElementById("manual_union_main").parentElement.classList.remove("d-none"),document.getElementById("manual_union_escort").parentElement.classList.remove("d-none")):(document.getElementById("manual_union_main").parentElement.classList.add("d-none"),document.getElementById("manual_union_escort").parentElement.classList.add("d-none"));c=aerialSetting.isUnion&&d.isEscort;aerialSetting.targetEnemies.push(d);
var e=getManualEnemySearchBox();d={};e=$jscomp.makeIterator(e);for(var f=e.next();!f.done;d={$jscomp$loop$prop$text$364:d.$jscomp$loop$prop$text$364},f=e.next()){d.$jscomp$loop$prop$text$364=f.value;var g=ENEMY_DATA.filter(function(l){return function(k){return k.id+1500==l.$jscomp$loop$prop$text$364||0<=k.name.indexOf(l.$jscomp$loop$prop$text$364)}}(d));f={};g=$jscomp.makeIterator(g);for(var h=g.next();!h.done;f={$jscomp$loop$prop$enemy$267$366:f.$jscomp$loop$prop$enemy$267$366},h=g.next())f.$jscomp$loop$prop$enemy$267$366=
h.value,12>aerialSetting.targetEnemies.length&&!aerialSetting.targetEnemies.some(function(l){return function(k){return k.id===l.$jscomp$loop$prop$enemy$267$366.id}}(f))&&(h=new Enemy(f.$jscomp$loop$prop$enemy$267$366.id),h.isEscort=c,aerialSetting.targetEnemies.push(h))}}else aerialSetting.targetEnemies=c.battles[d].enemies.concat(),document.getElementById("manual_enemy").classList.add("d-none"),aerialSetting.isUnion=c.battles[d].isUnion;aerialSetting.levelCriticalBonus=a.getProfCriticalBonus();a=
aerialSetting.manualRemodel;0<=a&&(b.remodel=a);drawStage3Result()}
function enemyStage3PowerCalculate(){var a=castInt($("#detail_info").data("base_no")),b=castInt($("#detail_info").data("slot_no")),c=createFleetInstance(),d=updateEnemyFleetInfo(!1),e=isDefMode?0:displayBattle;e=e<d.battles.length?e:d.battles.length-1;var f=d.battles[e].enemies.filter(function(l){return 0<l.slots.length&&!l.onlyScout})[a];a=ENEMY_DATA.find(function(l){return l.id===f.id}).eqp.map(function(l){return ENEMY_ITEM.find(function(k){return k.id===l})}).filter(function(l){return FIGHTERS.includes(l.type)||
ATTACKERS.includes(l.type)})[b];a=new EnemyItem(a.id);updateAerialPowerSetting();aerialSetting.item=a;aerialSetting.ammoBonus=1;a=document.getElementById("hp_1").checked;b=document.getElementById("hp_2").checked;d=c.ships.concat();e={};for(var g=$jscomp.makeIterator(d),h=g.next();!h.done;e={$jscomp$loop$prop$ship$368:e.$jscomp$loop$prop$ship$368},h=g.next())if(e.$jscomp$loop$prop$ship$368=h.value,h=SHIP_DATA.find(function(l){return function(k){return k.id===l.$jscomp$loop$prop$ship$368.id}}(e)))e.$jscomp$loop$prop$ship$368.type=
h.type,e.$jscomp$loop$prop$ship$368.hp=100<=e.$jscomp$loop$prop$ship$368.level?h.hp2:h.hp,a&&e.$jscomp$loop$prop$ship$368.hp++,b&&e.$jscomp$loop$prop$ship$368.hp++,e.$jscomp$loop$prop$ship$368.hp>=h.max_hp&&(e.$jscomp$loop$prop$ship$368.hp=h.max_hp),e.$jscomp$loop$prop$ship$368.armor=h.max_armor,e.$jscomp$loop$prop$ship$368.sumItemArmor=getArraySum(e.$jscomp$loop$prop$ship$368.items.map(function(l){return l.armor}));aerialSetting.targetEnemies=d;aerialSetting.isUnion=c.isUnion;drawStage3Result()}
function drawStage3Result(){var a=aerialSetting.targetEnemies,b=aerialSetting.item,c=0<a.length&&a[0].hasOwnProperty("equipments"),d=b.hasOwnProperty("defenseAirPower"),e=47===b.type,f=d&&a.some(function(B){return B.type.includes(18)})&&7<=b.asw,g=Math.min(castInt(document.getElementById("stage3_slot").value),ST3_MAX_SLOT),h=aerialSetting.ammoBonus;c&&!d&&b.isJet?$(".jet_option").removeClass("d-none"):$(".jet_option").addClass("d-none");for(var l=c&&!d&&b.isJet&&document.getElementById("jet_phase").checked,
k=aerialSetting.isAllSlot,n="",m=chartSlotDistribution,p=0;p<a.length;p++){var q=a[p];if(!(0>=q.id)){var v=q.armor+q.sumItemArmor,t=[];d?q.type.includes(2)?t=getLandBaseAerialPowersLandBase(m,q):q.type.includes(18)&&f?t=getLandBaseASWPower(m):!e||86!==q.id&&120!==q.id?(q.type.includes(16)?224===b.id?t=getLandBaseAerialPowers(m,1,1,1,!0):405===b.id?t=getLandBaseAerialPowers(m,1,1,1.1):444===b.id&&(t=getLandBaseAerialPowers(m,1,1,1.15)):q.type.includes(13)?406===b.id?t=getLandBaseAerialPowers(m,1.35):
444===b.id&&(t=getLandBaseAerialPowers(m,1,1,1.15)):(q.type.includes(12)||q.type.includes(14)||q.type.includes(15)||q.type.includes(17))&&444===b.id&&(t=getLandBaseAerialPowers(m,1,1,1.15)),t.length||(t=getLandBaseAerialPowers(m))):t=getLandBaseAerialPowers(m,1,3.2):t=c?getFleetAerialPower(m,q,1,l):getEnemyAerialPowers(m,q);var x=q.hp,u=createDamageDistribution(t,v,h,c,x),r=u.map(function(B){return B.damage}),w=getArrayMin(r),y=getArrayMax(r);r=[{min:x,max:getArrayMax(u.map(function(B){return B.damage}))+
1,value:0},{min:Math.ceil(.75*x),max:x,value:0},{min:Math.ceil(.5*x),max:Math.ceil(.75*x),value:0}];t=t.map(function(B){return B.power}).some(function(B){return 0>=B});w=(1<=w?w:t?"0":"\u5272\u5408")+"~"+(1<=y?y:"\u5272\u5408");k||0!==g||(w="-");t="";y={};for(var C=0;C<r.length;y={$jscomp$loop$prop$borderMin$370:y.$jscomp$loop$prop$borderMin$370,$jscomp$loop$prop$borderMax$371:y.$jscomp$loop$prop$borderMax$371},C++){var z=r[C];y.$jscomp$loop$prop$borderMin$370=z.min;y.$jscomp$loop$prop$borderMax$371=
z.max;var A=u.filter(function(B){return function(D){return D.damage>=B.$jscomp$loop$prop$borderMin$370&&D.damage<B.$jscomp$loop$prop$borderMax$371}}(y)).map(function(B){return B.rate});A=A.length===u.length?1:getArraySum(A);z.value=A;if(b.isAttacker||!c||q.type.includes(18)&&f){if(c&&q.type.includes(18)&&!f||!c&&[13,14].includes(q.type)){t+='<td class="text-center" colspan="'+r.length+'">\u5bfe\u6f5c\u653b\u6483\u4e0d\u53ef</td>';w="";u=$jscomp.makeIterator(r);for(y=u.next();!y.done;y=u.next())y.value.value=
0;break}if(1!==A||0!==C||k)1===A?t+='<td>100 <span class="font_size_11 font_color_half">%</span></td>':(z=Math.floor(1E3*A)/10,t+="<td>"+(0===z&&0!==A?.1:z)+' <span class="font_size_11 font_color_half">%</span></td>');else{t+='<td colspan="'+r.length+'" class="text-center text_red">\u78ba\u6bba</td>';break}}else t+="<td>-</td>",w=""}u=Math.floor(1E3*(r[0].value+r[1].value))/10;y=Math.floor(1E3*(r[0].value+r[1].value+r[2].value))/10;n+='\n\t\t<tr class="stage3_calc_detail '+(90<=Math.floor(1E3*r[0].value)/
10?"tr_death":70<=u?"tr_damaged":50<=y?"tr_half_damaged":"")+'"\n\t\t\tdata-toggle="tooltip" data-html="true" title="\n\t\t<div class=\'text-left\'>\n\t\t\t<div>'+(q.name+"</div>\n\t\t\t<div class='mt-1 ml-3'>\u5927\u7834\u4ee5\u4e0a: "+u+" %</div>\n\t\t\t<div class='ml-3'>\u4e2d\u7834\u4ee5\u4e0a: "+y+' %</div>\n\t\t</div>">\n\t\t\t<td class="px-0">\n\t\t\t\t<img class="enemy_img_sm" src="../img/')+(c?"enemy":"ship")+"/"+q.id+'.png">\n\t\t\t</td>\n\t\t\t<td>'+x+"</td>\n\t\t\t<td>"+v+"</td>\n\t\t\t<td>"+
(w?w:"-")+"</td>\n\t\t\t"+t+"\n\t\t</tr>"}}$(".stage3_calc_detail").tooltip("dispose");document.getElementById("stage3_table_tbody").innerHTML=n;document.getElementById("target_plane_data").innerHTML='\n\t\t<img src="../img/type/icon'+b.itype+'.png" class="plane_img_sm align-self-center">\n\t\t<div class="ml-1 align-self-center detail_item_name"><span class="ml-1">'+b.name+"</span></div>";document.getElementById("stage3_remodel").value=b.remodel;$(".stage3_calc_detail").tooltip()}
function getLandBaseAerialPowers(a,b,c,d,e){b=void 0===b?1:b;d=void 0===d?1:d;e=void 0===e?!1:e;var f=aerialSetting.item,g=aerialSetting.isCritical,h=aerialSetting.levelCriticalBonus,l=aerialSetting.isAllSlot,k=aerialSetting.manualSlot;c=aerialSetting.nishikiBonus*aerialSetting.contactBonus*aerialSetting.unionBonus*(void 0===c?1:c);var n=[],m={};a=$jscomp.makeIterator(a);for(var p=a.next();!p.done;m={$jscomp$loop$prop$a$373:m.$jscomp$loop$prop$a$373},p=a.next()){p=p.value;var q=l?p.slot:k;q=e?LandBaseItem.getFirePower_SP(f,
q,g,h):LandBaseItem.getFirePower(f.id,q,f.remodel,g,h,b,d);p=l?p.rate:1;m.$jscomp$loop$prop$a$373=q*c;(q=n.find(function(v){return function(t){return t.power===v.$jscomp$loop$prop$a$373}}(m)))?q.rate+=p:n.push({power:m.$jscomp$loop$prop$a$373,rate:p});if(!l)break}return n}
function getLandBaseAerialPowersLandBase(a,b,c){var d=aerialSetting.item,e=aerialSetting.isCritical,f=aerialSetting.levelCriticalBonus,g=aerialSetting.isAllSlot,h=aerialSetting.manualSlot;c=aerialSetting.nishikiBonus*aerialSetting.contactBonus*aerialSetting.unionBonus*(void 0===c?1:c);var l=[],k={};a=$jscomp.makeIterator(a);for(var n=a.next();!n.done;k={$jscomp$loop$prop$a$375:k.$jscomp$loop$prop$a$375},n=a.next()){var m=n.value;n=LandBaseItem.getFirePowerLandBase(d,g?m.slot:h,e,f,b);m=g?m.rate:1;
k.$jscomp$loop$prop$a$375=n*c;(n=l.find(function(p){return function(q){return q.power===p.$jscomp$loop$prop$a$375}}(k)))?n.rate+=m:l.push({power:k.$jscomp$loop$prop$a$375,rate:m});if(!g)break}return l}
function getLandBaseASWPower(a,b){var c=aerialSetting.item,d=aerialSetting.isCritical,e=aerialSetting.levelCriticalBonus,f=aerialSetting.isAllSlot,g=aerialSetting.manualSlot;b=aerialSetting.contactBonus*(void 0===b?1:b);var h=[];a=$jscomp.makeIterator(a);for(var l=a.next();!l.done;l=a.next()){l=l.value;var k=f?l.slot:g;k=0<k?c.asw*Math.sqrt(1.8*k)+25:0;for(var n=10<=c.asw?.7:.35,m=10<=c.asw?.3:.45,p=1/(100*m+1),q={},v=0;v<=100*m;q={$jscomp$loop$prop$power$377:q.$jscomp$loop$prop$power$377},v++){var t=
f?l.rate*p:p,x=Math.floor(softCap(k*(n+v/100),AS_CAP));d&&(x=Math.floor(1.5*x*e));q.$jscomp$loop$prop$power$377=x*(47===c.type?1.8:1)*b;RECONNAISSANCES.includes(c.type)&&(q.$jscomp$loop$prop$power$377=1);(x=h.find(function(u){return function(r){return r.power===u.$jscomp$loop$prop$power$377}}(q)))?x.rate+=t:h.push({power:q.$jscomp$loop$prop$power$377,rate:t})}if(!f)break}return h}
function getFleetAerialPower(a,b,c,d){d=void 0===d?!1:d;var e=aerialSetting.item,f=aerialSetting.isCritical,g=aerialSetting.levelCriticalBonus,h=aerialSetting.isAllSlot,l=aerialSetting.manualSlot,k=aerialSetting.isUnion;c=aerialSetting.contactBonus*aerialSetting.a11*(void 0===c?1:c);var n=[];a=$jscomp.makeIterator(a);for(var m=a.next();!m.done;m=a.next()){m=m.value;var p=ShipItem.getFirePower(e,h?m.slot:l,k,b.isEscort,d),q=1/p.length;m=h?m.rate*q:q;q={};p=$jscomp.makeIterator(p);for(var v=p.next();!v.done;q=
{$jscomp$loop$prop$a$379:q.$jscomp$loop$prop$a$379},v=p.next())q.$jscomp$loop$prop$a$379=v.value*c,q.$jscomp$loop$prop$a$379=f?Math.floor(1.5*q.$jscomp$loop$prop$a$379*g):q.$jscomp$loop$prop$a$379,(v=n.find(function(t){return function(x){return x.power===t.$jscomp$loop$prop$a$379}}(q)))?v.rate+=m:n.push({power:q.$jscomp$loop$prop$a$379,rate:m});if(!h)break}return n}
function getEnemyAerialPowers(a,b,c){var d=aerialSetting.item,e=aerialSetting.isCritical,f=aerialSetting.levelCriticalBonus,g=aerialSetting.isAllSlot,h=aerialSetting.manualSlot,l=aerialSetting.isUnion;c=aerialSetting.contactBonus*(void 0===c?1:c);var k=[];a=$jscomp.makeIterator(a);for(var n=a.next();!n.done;n=a.next()){n=n.value;var m=d.getFirePower(g?n.slot:h,l,b.isEscort),p=1/m.length;n=g?n.rate*p:p;p={};m=$jscomp.makeIterator(m);for(var q=m.next();!q.done;p={$jscomp$loop$prop$a$381:p.$jscomp$loop$prop$a$381},
q=m.next())p.$jscomp$loop$prop$a$381=q.value*c,p.$jscomp$loop$prop$a$381=e?Math.floor(1.5*p.$jscomp$loop$prop$a$381*f):p.$jscomp$loop$prop$a$381,(q=k.find(function(v){return function(t){return t.power===v.$jscomp$loop$prop$a$381}}(p)))?q.rate+=n:k.push({power:p.$jscomp$loop$prop$a$381,rate:n});if(!g)break}return k}
function manual_enemy_type_Changed(){var a=castInt(document.getElementById("manual_enemy_type").value),b=document.getElementById("manual_enemy_id"),c=ENEMY_DATA.filter(function(f){return f.type.includes(a)});b.innerHTML="";c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next()){d=d.value;var e=document.createElement("option");e.value=d.id;e.textContent="id: "+(d.id+1500)+" "+d.name;b.appendChild(e)}b.options[0].selected=!0;stage3PowerCalculate()}
function getManualEnemySearchBox(){var a=document.getElementById("manual_enemy_search").value.trim();a=a.replace(/\s+/g,",");a=a.replace(/[\u3001]/g,",");var b=[];a=$jscomp.makeIterator(a.split(","));for(var c=a.next();!c.done;c=a.next())(c=c.value)&&!b.includes(c)&&b.push(c);return b}
function createDamageDistribution(a,b,c,d,e){for(var f=[],g=1/b,h=0;h<b;h++)for(var l=.7*b+.6*h,k={},n=$jscomp.makeIterator(a),m=n.next();!m.done;k={$jscomp$loop$prop$damage$385:k.$jscomp$loop$prop$damage$385},m=n.next())if(m=m.value,k.$jscomp$loop$prop$damage$385=0<m.power-l?Math.floor((m.power-l)*c):0,k.$jscomp$loop$prop$damage$385>=e&&!d)for(var p=1/e,q={},v=0;v<e;q={$jscomp$loop$prop$damage2$383:q.$jscomp$loop$prop$damage2$383},v++){q.$jscomp$loop$prop$damage2$383=Math.floor(.5*e+.3*v);var t=
g*m.rate*p,x=f.find(function(u){return function(r){return r.damage===u.$jscomp$loop$prop$damage2$383}}(q));x?x.rate+=t:f.push({damage:q.$jscomp$loop$prop$damage2$383,rate:t})}else m=g*m.rate,(p=f.find(function(u){return function(r){return r.damage===u.$jscomp$loop$prop$damage$385}}(k)))?p.rate+=m:f.push({damage:k.$jscomp$loop$prop$damage$385,rate:m});return f}
function updateDetailChart(a,b,c){for(var d=[],e=[],f=[],g=[],h=getArrayMax(a),l=getArrayMin(a),k=a.length,n=0,m=0,p=0,q=0,v=0,t={$jscomp$loop$prop$i$387:l};t.$jscomp$loop$prop$i$387<=h;t={$jscomp$loop$prop$i$387:t.$jscomp$loop$prop$i$387},t.$jscomp$loop$prop$i$387++){var x=a.filter(function(u){return function(r){return r===u.$jscomp$loop$prop$i$387}}(t)).length;x&&(d.push(t.$jscomp$loop$prop$i$387),e.push((100*x/k).toFixed(1E5<=k?5:1E4<=k?4:1E3<=k?3:2)),g.push({slot:t.$jscomp$loop$prop$i$387,rate:x/
k}),v+=100*x/k,f.push(v.toFixed(1)),!n&&50<=v&&(n=t.$jscomp$loop$prop$i$387),!m&&90<=v&&(m=t.$jscomp$loop$prop$i$387),!p&&95<=v&&(p=t.$jscomp$loop$prop$i$387),!q&&99<=v&&(q=t.$jscomp$loop$prop$i$387))}$("#detail_max").text(h);$("#detail_min").text(l);$("#detail_50").text(n);$("#detail_90").text(m);$("#detail_95").text(p);$("#detail_99").text(q);chartInstance?(chartInstance.data.labels=d,chartInstance.data.datasets[0].data=e,chartInstance.data.datasets[1].data=f,chartInstance.options.scales.xAxes[0].scaleLabel.labelString=
b,chartInstance.options.tooltips=c,chartInstance.update()):(a=document.getElementById("detailChart"),h="rgba("+hexToRGB(mainColor).join(",")+", 0.8)",chartInstance=new Chart(a,{type:"bar",data:{labels:d,datasets:[{label:"\u78ba\u7387\u5206\u5e03",data:e,borderColor:"rgb(255, 70, 100)",backgroundColor:"rgba(255, 120, 180, 0.4)",yAxisID:"y-axis-1"},{label:"\u7d2f\u7a4d\u78ba\u7387",data:f,type:"line",fill:!1,borderColor:"rgb(54, 162, 255)",yAxisID:"y-axis-2"}]},options:{responsive:!0,scales:{xAxes:[{scaleLabel:{display:!0,
labelString:b,fontColor:h},gridLines:{display:!1},ticks:{fontSize:10,fontColor:h}}],yAxes:[{id:"y-axis-1",type:"linear",position:"left",gridLines:{display:!0,color:"rgba(128, 128, 128, 0.2)"},scaleLabel:{display:!0,labelString:"\u78ba\u7387\u5206\u5e03 [\uff05]",fontColor:h},ticks:{min:0,fontColor:h}},{id:"y-axis-2",type:"linear",position:"right",gridLines:{display:!0,color:"rgba(128, 128, 128, 0.2)"},scaleLabel:{display:!0,labelString:"\u7d2f\u7a4d\u78ba\u7387 [\uff05]",fontColor:h},ticks:{max:100,
min:0,stepSize:25,fontColor:h}}]},legend:{display:!0,labels:{fontColor:h}},tooltips:c}}));return g.concat()}
function modal_Closed(a){switch(a.attr("id")){case "modal_share":a=$("#output_deck");a.val("");a.nextAll(".valid-feedback").text("");a.removeClass("is-invalid").removeClass("is-valid");a=$("#output_url");a.val("");a.nextAll(".valid-feedback").text("");a.removeClass("is-invalid").removeClass("is-valid");$target=null;calculate();break;case "modal_ship_select":case "modal_plane_select":case "modal_enemy_select":case "modal_enemy_pattern":case "modal_collectively_setting":case "modal_lb_target":case "modal_level_input":case "modal_luck_input":case "modal_fleet_antiair_input":$target=null;
calculate();break;case "modal_plane_preset":planePreset=$target=null;calculate(!0,!0,!1);break;case "modal_result_detail":setTimeout(function(){chartInstance.destroy();chartSlotDistribution=chartInstance=null;document.getElementById("target_enemy").value=-1},80);break;case "modal_contact_detail":setTimeout(function(){chartInstance.destroy();chartInstance=null;subChartInstance&&(subChartInstance.destroy(),subChartInstance=null)},80);break;case "modal_main_preset":$("#modal_main_preset").find(".btn_commit_preset").text("\u7de8\u6210\u4fdd\u5b58");
$("#modal_main_preset").find(".btn_commit_preset").removeClass("rename");$("#allow_upload_preset").prop("checked",!1);$("#btn_upload_preset").addClass("d-none");break;case "modal_preset_memo":if(a=getActivePreset())a.memo=document.getElementById("preset_memo").value.trim(),updateActivePreset(a);break;case "modal_confirm":if("Error"===confirmType)try{window.location.reload(!0)}catch(b){window.location.href="../list/"}confirmType=null;break;case "modal_ship_reserve":$target=currentReserved=null;calculate(!1,
!0,!1);break;case "modal_reference":window.history.replaceState(null,null,location.pathname);break;case "modal_include_selector":loadedDeckBuilders=[]}}
function btn_content_trade_Clicked(a){$("body,html").animate({scrollTop:0},200,"swing");$(".btn_commit_trade").addClass("d-flex").removeClass("d-none");$(".r_btn:not(.btn_commit_trade)").addClass("d-none").removeClass("d-lg-flex");$("#main").find(".collapse_content").each(function(){$(this).parent().addClass("trade_enabled");$(this).attr("class").includes("show")&&$(this).addClass("tmpHide").collapse("hide")});a.blur()}
function main_contents_Sortable_End(){setting.contentsOrder=[];$("#main > div:not(#main_footer)").each(function(a,b){a=$(b).attr("id");setting.contentsOrder.push(a)});saveSetting()}function commit_content_order(){if($("#landBase_content").hasClass("collapsing"))return!1;$(".tmpHide").collapse("show");$(".trade_enabled").removeClass("trade_enabled");$(".btn_commit_trade").addClass("d-none").removeClass("d-flex");$(".r_btn:not(.btn_commit_trade)").removeClass("d-none")}
function btn_ex_setting_Clicked(a){a=a.closest(".contents").attr("id");var b=$("#modal_collectively_setting");b.find(".btn").removeClass("d-none");b.data("target",a);switch(a){case "landBase":b.find(".modal-title").text("\u4e00\u62ec\u8a2d\u5b9a\u3000-\u57fa\u5730\u822a\u7a7a\u968a-");b.find(".btn_remove_ship_all").addClass("d-none");b.find(".btn_remove_enemy_all").addClass("d-none");b.find(".btn_slot_default").addClass("d-none");b.find(".coll_slot_range").attr("max",18).data("target",a);break;case "friendFleet":b.find(".modal-title").text("\u4e00\u62ec\u8a2d\u5b9a\u3000-\u8266\u5a18-"),
b.find(".btn_remove_enemy_all").addClass("d-none"),b.find(".coll_slot_range").attr("max",99).data("target",a)}b.modal("show")}
function display_special_Changed(a){a[0]===document.getElementById("display_special_A")?(specialOperator.update("A"),document.getElementById("disp_special_parent").classList.remove("d-none")):a[0]===document.getElementById("display_special_B")?(specialOperator.update("B"),document.getElementById("disp_special_parent").classList.remove("d-none")):(specialOperator.update(""),document.getElementById("disp_special_parent").classList.add("d-none"));expandMainPreset([createLandBasePreset(),createFriendFleetPreset(),
createEnemyFleetPreset(),document.getElementById("adapt_stage2").checked?selectedFormations:null,isDefMode,createAirRaidEnemyFleetPreset(),castInt($("#admin_lv").val())])}
function btn_air_raid_Clicked(){$(".lb_tab").each(function(a,b){$(b).find(".lb_plane").each(function(c,d){0<castInt($(d)[0].dataset.planeid)&&$(d).find(".slot").text(18)})});createLandBaseInstance();$(".lb_tab").each(function(a,b){var c=!1,d=4;$(b).find(".lb_plane").each(function(e,f){!c&&0<castInt($(f)[0].dataset.planeid)&&(e=castInt($(f).find(".slot").text()),e>d?($(f).find(".slot").text(e-d),c=!0):($(f).find(".slot").text(1),d-=e-1))})});calculate(!0,!1,!1)}
function btn_supply_Clicked(){$(".lb_tab").each(function(a,b){$(b).find(".lb_plane").each(function(c,d){0<castInt($(d)[0].dataset.planeid)&&$(d).find(".slot").text(18)})});calculate(!0,!1,!1)}
function btn_capture_Clicked(a){var b=a.closest(".contents");b.addClass("capturing");document.body.classList.contains("dark-theme")?(b.addClass("capture_dark"),document.body.classList.contains("deep_blue_theme")&&b.addClass("capture_deep_blue")):b.addClass("capture_nomal");b.find(".lb_tab").removeClass("tab-pane fade");var c=b.find(".no_capture:not(.d-none)");c.addClass("d-none");b.find("#admin_lv_capture").removeClass("d-none");b.find("#admin_lv").addClass("d-none");b.find(".btn_remove_plane").addClass("btn_remove_plane_capture");
b.find(".r_btn").addClass("d-none");b.find(".d-lg-flex").addClass("d-none_lg").removeClass("d-lg-flex");b.find(".custom-checkbox").addClass("d-none");b.find(".battle_only").removeClass("ml-auto").addClass("ml-2");b.find(".plane_name_span").each(function(e,f){"\u88c5\u5099\u3092\u9078\u629e"===$(f).text()&&$(f).text("-");"\u88dc\u5f37\u5897\u8a2d"===$(f).text()&&$(f).text("-")});b.find(".expanded_slot").each(function(e,f){0>=castInt($(f)[0].dataset.planeid)&&$(f).addClass("d-none")});b.find(".custom-select").addClass("pt-0");
b.find(".custom-select option").addClass("d-none");b.find(".form-control").addClass("pt-0");b.find(".general_box").addClass("general_box_capture");var d=window.pageYOffset;html2canvas(b[0],{onrendered:function(e){var f=e.toDataURL();if($("#clipboard_mode").prop("checked")&&"function"===typeof ClipboardItem)try{e.toBlob(function(g){var h={};navigator.clipboard.write([new ClipboardItem((h[g.type]=g,h))])})}catch(g){downloadImage(f)}else downloadImage(f);b.removeClass("capture_nomal capture_dark capture_deep_blue");
b.find(".custom-checkbox").removeClass("d-none");b.find(".r_btn:not(.btn_commit_trade)").removeClass("d-none");b.find(".d-none_lg").addClass("d-none d-lg-flex").removeClass("d-none_lg");b.find(".btn_remove_plane").removeClass("btn_remove_plane_capture");b.find(".battle_only").addClass("ml-auto").removeClass("ml-2");b.find(".plane_name_span").each(function(g,h){"-"===$(h).text()&&$(h).closest(".ship_plane").hasClass("expanded_slot")&&$(h).text("\u88dc\u5f37\u5897\u8a2d");"-"===$(h).text()&&$(h).text("\u88c5\u5099\u3092\u9078\u629e")});
b.find(".expanded_slot").removeClass("d-none");c.removeClass("d-none");b.find(".custom-select").removeClass("pt-0");b.find(".custom-select option").removeClass("d-none");b.find(".form-control").removeClass("pt-0");b.find(".general_box").removeClass("general_box_capture");b.find("#admin_lv_capture").addClass("d-none");b.find("#admin_lv").removeClass("d-none");b.removeClass("capturing");"none"===$("#lb_tab_select").css("display")||$("#lb_item1").attr("class").includes("tab-pane")||($(".lb_tab").addClass("tab-pane fade"),
$(".lb_tab:first").tab("show"));window.scrollTo(0,d)}})}function downloadImage(a){var b="screenshot_"+formatDate(new Date,"yyyyMMdd_HHmmss")+".jpg";if(window.navigator.msSaveBlob){a=atob(a.replace(/^.*,/,""));for(var c=new Uint8Array(a.length),d=0;d<a.length;d++)c[d]=a.charCodeAt(d);a=new Blob([c],["image/png"]);window.navigator.msSaveOrOpenBlob(a,b)}else c=document.getElementById("getImage"),c.href=a,c.download=b,c.click()}
function btn_reset_content_Clicked(a){switch(a.closest(".contents").attr("id")){case "landBase":$(".lb_plane").each(function(b,c){return setLBPlaneDiv($(c))});break;case "friendFleet":clearShipDivAll();break;case "enemyFleet":clearEnemyDivAll()}calculate()}function btn_remove_plane_all_Clicked(a){a=$("#"+$("#modal_collectively_setting").data("target"));clearPlaneDivAll(a)}function btn_remove_ship_all_Clicked(){clearShipDivAll();$("#modal_collectively_setting").modal("hide")}
function btn_slot_max_Clicked(a){a=$("#"+$("#modal_collectively_setting").data("target"));"landBase"===a.attr("id")?$(".coll_slot_range").val(18):"friendFleet"===a.attr("id")&&$(".coll_slot_range").val(99);coll_slot_range_Changed($(".coll_slot_range"))}function btn_slot_default_Clicked(a){a=$("#"+$("#modal_collectively_setting").data("target"));"friendFleet"===a.attr("id")&&a.find(".ship_plane").each(function(b,c){$(c).find(".slot").text($(c).find(".slot_select_parent").data("ini"))})}
function btn_slot_min_Clicked(){$(".coll_slot_range").val(0);coll_slot_range_Changed($(".coll_slot_range"))}
function coll_slot_range_Changed(a){var b=$("#"+$("#modal_collectively_setting").data("target")),c=castInt(a.val());c=c>castInt(a.attr("max"))?castInt(a.attr("max")):c;"landBase"===b.attr("id")?b.find(".lb_plane").each(function(d,e){return $(e).find(".slot").text(c)}):"friendFleet"===b.attr("id")&&b.find(".ship_plane").each(function(d,e){return $(e).find(".slot").text(c)});$(".coll_slot_input").val(c)}
function coll_slot_input_Changed(a){var b=validateInputNumber(a.val(),castInt($(".coll_slot_range").attr("max")));a.val(b);$(".coll_slot_range").val(b);coll_slot_range_Changed($(".coll_slot_range"))}
function btn_remodel_Clicked(a){var b=$("#"+$("#modal_collectively_setting").data("target")),c=castInt(a[0].dataset.remodel);"landBase"===b.attr("id")?b.find(".lb_plane").each(function(d,e){return $(e).find(".remodel_select:not(.remodel_disabled)").find(".remodel_value").text(c)}):"friendFleet"===b.attr("id")&&b.find(".ship_plane").each(function(d,e){return $(e).find(".remodel_select:not(.remodel_disabled)").find(".remodel_value").text(c)})}
function btn_fighter_prof_max_Clicked(){var a=$("#"+$("#modal_collectively_setting").data("target"));"landBase"===a.attr("id")?a.find(".lb_plane").each(function(b,c){FIGHTERS.includes(castInt($(c)[0].dataset.type2))&&setProficiency($(c).find(".prof_select"),7)}):"friendFleet"===a.attr("id")&&a.find(".ship_plane").each(function(b,c){FIGHTERS.includes(castInt($(c)[0].dataset.type))&&setProficiency($(c).find(".prof_select"),7)})}
function btn_prof_Clicked(a){var b=$("#"+$("#modal_collectively_setting").data("target")),c=a[0].dataset.prof;"landBase"===b.attr("id")?b.find(".lb_plane").each(function(d,e){2<c&&312===castInt($(e)[0].dataset.planeid)?setProficiency($(e).find(".prof_select"),2):311!==castInt($(e)[0].dataset.planeid)&&setProficiency($(e).find(".prof_select"),c)}):"friendFleet"===b.attr("id")&&b.find(".ship_plane").each(function(d,e){setProficiency($(e).find(".prof_select"),c)})}
function plane_lock_Clicked(a){a.length&&a.addClass("d-none")}function plane_unlock_Clicked(a){a.length&&a.addClass("d-none")}
function remodelSelect_Shown(a){if(a.find(".dropdown-menu").html().trim())a.find(".remodel_item_selected").removeClass("remodel_item_selected");else{for(var b="",c=0;10>c;c++)b+='<div class="remodel_item text_remodel" data-remodel="'+c+'"><i class="fas fa-star"></i>+'+c+"</div>";b+='<div class="remodel_item text_remodel" data-remodel="10"><i class="fas fa-star"></i>max</div>';a.find(".dropdown-menu").append(b)}}
function remodelSelect_Changed(a){if(a.find(".remodel_item_selected").length){var b=Math.min(castInt(a.find(".remodel_item_selected").data("remodel")),10);a.removeClass("remodel_item_selected");a.find(".remodel_value").text(b);b?a.find(".remodel_select").removeClass("zero"):a.find(".remodel_select").addClass("zero");calculate(!0,!0,!1)}}
function profSelect_Shown(a){if(!a.find(".dropdown-menu").html().trim()){for(var b="",c=7;0<=c;c--)b+='<a class="dropdown-item prof_item"><img class="prof_opt" alt="'+getProfString(c)+'" data-prof="'+c+'" src="../img/util/prof'+c+'.png"></a>';a.find(".dropdown-menu").append(b)}}
function proficiency_Changed(a,b){b=void 0===b?!1:b;var c=a.find(".prof_opt");if(c.length){a=a.parent().prev();var d=c[0].dataset.prof;a.attr("src",c.attr("src")).attr("alt",c.attr("alt"));a[0].dataset.prof=d;b||calculate(!0,!0,!1)}}function setProficiency(a,b){a.attr("src","../img/util/prof"+b+".png").attr("alt",getProfString(b));a[0].dataset.prof=b}
function init_proficiency_Changed(a){proficiency_Changed(a,!0);var b=castInt(a.find(".prof_opt")[0].dataset.prof),c=setting.defaultProf.find(function(d){return d.id===castInt(a.closest(".init_prof")[0].dataset.typeid)});c?c.prof=b:setting.defaultProf.push({id:castInt(a.closest(".init_prof")[0].dataset.typeid),prof:b});saveSetting()}
function slot_select_parent_Show(a){a.find(".dropdown-menu").html().trim()||a.find(".dropdown-menu").append('\n\t\t<span class="dropdown-header py-1 px-1 font_size_12">\u642d\u8f09\u6570\u3092\u5165\u529b</span>\n\t\t\t<div class="d-flex mb-2 justify-content-between">\n\t\t\t\t<div class="align-self-center flex-grow-1">\n\t\t\t\t\t<input type="number" class="form-control form-control-sm slot_input" value="0" min="0" max="99">\n\t\t\t\t</div>\n\t\t\t\t<div class="ml-1 align-self-center">\n\t\t\t\t\t<button type="button" data-ini="0" class="btn btn-sm btn-primary slot_ini">\n\t\t\t\t\t\t<span class="text-nowrap">\u521d\u671f\u5024</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<input type="range" class="custom-range slot_range" value="0" min="0" max="99">\n\t\t');var b=
castInt(a.find(".slot").text());a.find(".slot_input").val(b);a.find(".slot_range").val(b)}function slot_range_Changed(a){var b=a.closest(".slot_select_parent");b.find(".slot").text(a.val());b.find(".slot_input").val(a.val())}function slot_input_Changed(a){var b=validateInputNumber(a.val(),castInt(a.attr("max")));a.val(b);a.closest(".slot_select_parent").find(".slot").text(b);a.next().val(b)}
function slot_ini_Clicked(a){a=a.closest(".slot_select_parent");var b=a.data("ini");a.find(".slot").text(b);a.find(".slot_input").val(b);a.find(".slot_range").val(b)}function slot_select_parent_Close(a){var b=castInt(a.find(".slot_input").val()),c=castInt(a.find(".slot_input").attr("max"));a.find(".slot").text(b>c?c:b);calculate(!0,!0,!1)}function ship_level_input_Changed(a){var b=validateInputNumber(a.val(),castInt(a.attr("max")));a.val(b);$target.text(b?b:1);a.next().val(b)}
function ship_level_range_Changed(a){var b=$("#modal_level_input");a=castInt(a.val());b.find(".ship_level_input").val(a);$target.text(a)}function level_Clicked(a){a=castInt(a[0].dataset.level);var b=$("#modal_level_input");b.find(".ship_level_input").val(a);b.find(".ship_level_range").val(a);$target.text(a)}function ship_luck_input_Changed(a){var b=validateInputNumber(a.val(),castInt(a.attr("max")));a.val(b);var c=castInt(a.attr("min"));$target.text(b?b>=c?b:c:c);a.next().val(b)}
function ship_luck_range_Changed(a){var b=$("#modal_luck_input");a=castInt(a.val());b.find(".ship_luck_input").val(a);$target.text(a)}
function showItemToolTip(a,b){b=a.closest((void 0===b?0:b)?".lb_plane":".ship_plane");var c=0;if(b.length&&b[0].dataset.planeid&&!b.hasClass("ui-draggable-dragging")){b.closest(".ship_tab").length&&(c=castInt(b.closest(".ship_tab")[0].dataset.shipid));var d=castInt(b[0].dataset.planeid),e=castInt(b[0].getElementsByClassName("slot")[0].textContent),f=castInt(b[0].getElementsByClassName("remodel_value")[0].textContent),g=castInt(b[0].getElementsByClassName("prof_select")[0].dataset.prof);b=getItemTooltipContext(d,
b[0].classList.contains("lb_plane"),e,f,g,c);showTooltip(a[0],b,"right")}}function showPlaneBasicToolTip(a){var b=0;a.find(".plane_td_remodel").length&&(b=castInt(a.find(".plane_td_remodel")[0].dataset.remodel));var c=0,d=$target&&!$target.hasClass("ship_plane");$target&&$target.closest(".ship_tab").length&&(c=castInt($target.closest(".ship_tab")[0].dataset.shipid));b=getItemTooltipContext(castInt(a[0].dataset.planeid),d,0,b,0,c);showTooltip(a[0],b,"bottom","window")}
function getItemTooltipContext(a,b,c,d,e,f){c=void 0===c?0:c;d=void 0===d?0:d;e=void 0===e?0:e;f=void 0===f?0:f;var g=null;g=(void 0===b?0:b)?new LandBaseItem(a,c,d,e):new ShipItem(a,c,d,e);if(!g.id)return"";var h=ITEM_DATA.find(function(A){return A.id===g.id}),l=h.type;b=g.bonusAntiAir;c=Item.getBonusFire(g.id,l,d);e=Item.getBonusScout(l,d);var k=Item.getBonusTorpedo(l,d);if(f){var n=SHIP_DATA.find(function(A){return A.id===f});if(n){var m=new Ship;m.id=n.id;m.name=n.name;m.type=n.type;m.type2=n.type2;
k+=ShipItem.getAttackerBonus(g,m)}}n=Item.getBonusAccuracy(a,l,d);m=Item.getBonusBomber(a,l,d);l=Item.getBonusASW(a,l,d,h.antiAir);var p=RANGES.find(function(A){return A.id===h.range2});p=h.range2&&p?p.name:"";d=d?'<span class="text_remodel">\u2605'+d+"</span>":"";var q=b?'<span class="ml-1 text_remodel">(+'+b.toFixed(2)+")</span>":"",v=c?'<span class="ml-1 text_remodel">(+'+c.toFixed(2)+")</span>":"",t=k?'<span class="ml-1 text_remodel">(+'+k.toFixed(2)+")</span>":"",x=m?'<span class="ml-1 text_remodel">(+'+
m.toFixed(2)+")</span>":"",u=n?'<span class="ml-1 text_remodel">(+'+n.toFixed(2)+")</span>":"",r=l?'<span class="ml-1 text_remodel">(+'+l.toFixed(2)+")</span>":"",w=e?'<span class="ml-1 text_remodel">(+'+e.toFixed(2)+")</span>":"",y=0<h.avoid?AVOID_TYPE.find(function(A){return A.id===h.avoid}):null,C=g.selectRate.length?g.selectRate.map(function(A){return(100*A).toFixed(0)+"%"}):null,z=PLANE_TYPE.includes(h.type)?getRequiredgBattleCountString(h.grow):null;return('\n\t<div class="text-left m-1 item_tooltip">\n\t\t<div class="d-flex">\n\t\t\t<img src="../img/type/icon'+
h.itype+'.png" alt="'+h.itype+'" class="img-size-36 align-self-center">\n\t\t\t<div class="ml-1 align-self-center">\n\t\t\t\t<div class="font_size_12">id: '+h.id+"</div>\n\t\t\t\t<div><span>"+h.name+"</span>"+d+'</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="d-flex flex-wrap my-1">\n\t\t\t'+(g.slot?'<div class="mr-3">\u5236\u7a7a\u5024: '+g.airPower+"</div>":"")+"\n\t\t\t"+(g.defenseAirPower&&g.airPower!==g.defenseAirPower?"<div>\u9632\u7a7a\u6642: "+g.defenseAirPower+"</div>":"")+'\n\t\t</div>\n\t\t<div class="font_size_12 d-flex flex-wrap item_status_box">\n\t\t\t'+
(h.antiAir+b?'<div class="col_half"><span>\u5bfe\u7a7a: '+h.antiAir+"</span>"+q+"</div>":"")+"\n\t\t\t"+(h.fire+c?'<div class="col_half"><span>\u706b\u529b: '+h.fire+"</span>"+v+"</div>":"")+"\n\t\t\t"+(h.torpedo+k?'<div class="col_half"><span>\u96f7\u88c5: '+h.torpedo+"</span>"+t+"</div>":"")+"\n\t\t\t"+(h.bomber+m?'<div class="col_half"><span>\u7206\u88c5: '+h.bomber+"</span>"+x+"</div>":"")+"\n\t\t\t"+(h.accuracy+n?'<div class="col_half"><span>\u547d\u4e2d: '+h.accuracy+"</span>"+u+"</div>":"")+
"\n\t\t\t"+(h.asw+l?'<div class="col_half"><span>\u5bfe\u6f5c: '+h.asw+"</span>"+r+"</div>":"")+"\n\t\t\t"+(h.scout+e?'<div class="col_half"><span>\u7d22\u6575: '+h.scout+"</span>"+w+"</div>":"")+"\n\t\t\t"+(h.armor?'<div class="col_half">\u88c5\u7532: '+h.armor+"</div>":"")+"\n\t\t\t"+(h.avoid2?'<div class="col_half">\u56de\u907f: '+h.avoid2+"</div>":"")+"\n\t\t\t"+(h.antiBomber?'<div class="col_half">\u5bfe\u7206: '+h.antiBomber+"</div>":"")+"\n\t\t\t"+(h.interception?'<div class="col_half">\u8fce\u6483: '+
h.interception+"</div>":"")+"\n\t\t\t"+(h.radius?'<div class="col_half">\u534a\u5f84: '+h.radius+"</div>":"")+"\n\t\t\t"+(p?'<div class="col_half">\u5c04\u7a0b: '+p+"</div>":"")+"\n\t\t\t"+(TAICHI.includes(a)?'<div class="col_half">\u5bfe\u5730: \u53ef</div>':"")+"\n\t\t</div>\n\t\t"+(y?'<div class="font_size_12">\u5c04\u6483\u56de\u907f: '+y.name+" ( \u52a0\u91cd\u5bfe\u7a7a: "+y.adj[0]+" \u8266\u968a\u9632\u7a7a: "+y.adj[1].toFixed(1)+" )</div>":"")+"\n\t\t"+(g.antiAirWeight?'<div class="font_size_12">\u52a0\u91cd\u5bfe\u7a7a: '+
g.antiAirWeight.toFixed(2)+"</div>":"")+"\n\t\t"+(g.antiAirBonus?'<div class="font_size_12">\u8266\u968a\u9632\u7a7a: '+g.antiAirBonus.toFixed(2)+"</div>":"")+"\n\t\t"+(g.isJet&&g.slot?'<div class="font_size_12">\u92fc\u6750\u6d88\u8cbb (\u5674\u5f0f\u5f37\u8972\u767a\u751f\u6642): '+Math.round(g.slot*g.cost*.2):"")+"\n\t\t"+(C&&C.length?'<div class="font_size_12">\u89e6\u63a5\u9078\u629e\u7387(\u78ba\u4fdd\u6642): '+C[0]+"</div>":"")+"\n\t\t"+(z?'<div class="font_size_12">\u719f\u7df4\u5ea6<img class="img-size-18_lock" alt=">>" src="../img/util/prof7.png">\u307e\u3067: '+
z+"</div>":"")+"\n\t</div>").trim()}
function showEnemyStatusToolTip(a){if(a.length&&a[0].dataset.enemyid){var b=ENEMY_DATA.find(function(k){return k.id===castInt(a[0].dataset.enemyid)});if(b){for(var c=new Enemy(b.id),d="",e=0,f={},g=0;g<b.eqp.length;f={$jscomp$loop$prop$itemId$389:f.$jscomp$loop$prop$itemId$389},g++){f.$jscomp$loop$prop$itemId$389=b.eqp[g];var h=b.slot[g],l=ENEMY_ITEM.find(function(k){return function(n){return n.id===k.$jscomp$loop$prop$itemId$389}}(f));l&&(e+=l.armor,d+='\n\t\t\t<div class="d-flex">\n\t\t\t\t<div class="align-self-center enemy_tool_slot">'+(0<
h?h:0)+'</div>\n\t\t\t\t<div class="ml-1 align-self-center">\n\t\t\t\t\t<img src="../img/type/icon'+l.itype+'.png" alt="'+l.itype+'" class="img-size-30">\n\t\t\t\t</div>\n\t\t\t\t<div class="ml-1 align-self-center">\n\t\t\t\t\t<span class="font_size_11">id: '+l.id+"</span>\n\t\t\t\t\t<span> "+l.name+"</span>\n\t\t\t\t</div>\n\t\t\t</div>")}showTooltip(a[0],'<div class="text-left m-1">\n\t\t\t<div class="d-flex">\n\t\t\t\t<div class="align-self-center font_size_11">ID: '+(1500+b.id)+'</div>\n\t\t\t\t<div class="ml-2 align-self-center">'+
b.name+'</div>\n\t\t\t</div>\n\t\t\t<div class="d-flex mt-1">\n\t\t\t\t<div>HP: '+c.hp+'</div>\n\t\t\t\t<div class="ml-3">\u88c5\u7532: '+(c.armor+e)+"\uff08"+c.armor+'\uff09</div>\n\t\t\t</div>\n\t\t\t<div class="d-flex mt-1">\n\t\t\t\t'+(c.airPower?"<div>\u5236\u7a7a\u5024: "+c.airPower+"</div>":"")+"\n\t\t\t\t"+(!c.airPower&&c.landBaseAirPower?"<div>\u57fa\u5730\u5236\u7a7a\u5024: "+c.landBaseAirPower+"</div>":"")+'\n\t\t\t</div>\n\t\t\t<div class="mt-1">\n\t\t\t\t'+d+"\n\t\t\t</div>\n\t\t</div>")}}}
function showEnemyPlaneToolTip(a){if(a.length&&a[0].dataset.planeid){var b=ENEMY_ITEM.find(function(c){return c.id===castInt(a[0].dataset.planeid)});b&&showTooltip(a[0],'<div class="text-left">\n\t\t\t<div>\n\t\t\t\t<img src="../img/type/icon'+b.itype+'.png" alt="'+b.itype+'" class="img-size-25">\n\t\t\t\t<span>'+b.name+'</span>\n\t\t\t</div>\n\t\t\t<div class="font_size_12 d-flex flex-wrap item_status_box">\n\t\t\t\t'+(b.antiAir?'<div class="col_half">\u5bfe\u7a7a: '+b.antiAir+"</div>":"")+"\n\t\t\t\t"+
(b.fire?'<div class="col_half">\u706b\u529b: '+b.fire+"</div>":"")+"\n\t\t\t\t"+(b.torpedo?'<div class="col_half">\u96f7\u88c5: '+b.torpedo+"</div>":"")+"\n\t\t\t\t"+(b.bomber?'<div class="col_half">\u7206\u88c5: '+b.bomber+"</div>":"")+"\n\t\t\t\t"+(b.asw?'<div class="col_half">\u5bfe\u6f5c: '+b.asw+"</div>":"")+"\n\t\t\t\t"+(b.armor?'<div class="col_half">\u88c5\u7532: '+b.armor+"</div>":"")+"\n\t\t\t\t"+(b.scout?'<div class="col_half">\u7d22\u6575: '+b.scout+"</div>":"")+"\n\t\t\t\t"+(b.accuracy?
'<div class="col_half">\u547d\u4e2d: '+b.accuracy+"</div>":"")+"\n\t\t\t\t"+(b.avoid2?'<div class="col_half">\u56de\u907f: '+b.avoid2+"</div>":"")+"\n\t\t\t</div>\n\t\t</div>")}}function contact_detail_redraw(){var a=castInt($("#modal_contact_detail").data("dispIndex"));-1<a?btn_show_contact_rate_lb_Clicked(null,a):btn_show_contact_rate_Clicked()}
function btn_show_contact_rate_lb_Clicked(a,b){a=a?castInt(a[0].dataset.lb)-1:void 0===b?0:b;b=createLandBaseInstance();b=createContactTable(b.landBases[a].planes);var c=document.getElementById("nomal_contact_table");document.getElementsByClassName("detail_contact_chart_parent")[0].classList.add("w-75");document.getElementsByClassName("detail_contact_chart_parent")[1].classList.add("d-none");document.getElementById("grand_contact_table").classList.add("d-none");document.getElementById("land_base_contact_tips").classList.remove("d-none");
for(var d=0;3>d;d++){var e=c.getElementsByClassName("contact_status_"+d)[0];e.getElementsByClassName("td_start_contact_rate")[0].textContent=b[d][0].toFixed(1)+"%";e.getElementsByClassName("td_120_contact_rate")[0].textContent=b[d][1].toFixed(1)+"%";e.getElementsByClassName("td_117_contact_rate")[0].textContent=b[d][2].toFixed(1)+"%";e.getElementsByClassName("td_112_contact_rate")[0].textContent=b[d][3].toFixed(1)+"%";e.getElementsByClassName("td_sum_contact_rate")[0].textContent=b[d][4].toFixed(1)+
"%"}c=$("#contact_detail_0").prop("checked")?0:$("#contact_detail_1").prop("checked")?1:2;d=[b[c][1],b[c][2],b[c][3],100-b[c][4]];e=["120%\u89e6\u63a5","117%\u89e6\u63a5","112%\u89e6\u63a5","\u4e0d\u767a"];var f=["rgb(100, 180, 255, 0.7)","rgba(80, 220, 120, 0.7)","rgba(255, 160, 100, 0.7)","rgba(128, 128, 128, 0.5)"],g=document.getElementById("detail_contact_chart"),h="#000000"===mainColor?"#fff":"#333",l="rgba("+hexToRGB(mainColor).join(",")+", 0.8)";document.getElementById("detail_contact_rate_sum").textContent=
b[c][4].toFixed(1);chartInstance?(chartInstance.data.datasets[0].data=d,chartInstance.update()):chartInstance=new Chart(g,{type:"doughnut",data:{labels:e,datasets:[{backgroundColor:f,data:d,borderColor:h}]},plugins:[ChartDataLabels],options:{legend:{display:!1},title:{display:!0,text:"\u7b2c"+(a+1)+"\u57fa\u5730\u822a\u7a7a\u968a \u89e6\u63a5\u7387",fontColor:l},tooltips:{callbacks:{label:function(k,n){return n.labels[k.index]+": "+n.datasets[0].data[k.index].toFixed(1)+" %"}}},plugins:{datalabels:{color:mainColor,
formatter:function(k,n){return 0<k?k.toFixed(1)+"%":""}}}}});$("#modal_contact_detail").data("dispIndex",a);$("#modal_contact_detail").modal("show")}
function btn_show_contact_rate_Clicked(){var a=createFleetInstance(),b=[],c=[];a=$jscomp.makeIterator(a.ships);for(var d=a.next();!d.done;d=a.next()){d=d.value;for(var e=$jscomp.makeIterator(d.items),f=e.next();!f.done;f=e.next())f=f.value,0!==f.id&&(c.push(f),d.isEscort||b.push(f))}b=createContactTable(b);c=createContactTable(c);d=document.getElementById("nomal_contact_table");a=document.getElementById("grand_contact_table");document.getElementsByClassName("detail_contact_chart_parent")[0].classList.remove("w-75");
document.getElementsByClassName("detail_contact_chart_parent")[1].classList.remove("d-none");document.getElementById("grand_contact_table").classList.remove("d-none");document.getElementById("land_base_contact_tips").classList.add("d-none");for(e=0;3>e;e++)f=d.getElementsByClassName("contact_status_"+e)[0],f.getElementsByClassName("td_start_contact_rate")[0].textContent=b[e][0].toFixed(1)+"%",f.getElementsByClassName("td_120_contact_rate")[0].textContent=b[e][1].toFixed(1)+"%",f.getElementsByClassName("td_117_contact_rate")[0].textContent=
b[e][2].toFixed(1)+"%",f.getElementsByClassName("td_112_contact_rate")[0].textContent=b[e][3].toFixed(1)+"%",f.getElementsByClassName("td_sum_contact_rate")[0].textContent=b[e][4].toFixed(1)+"%";for(d=0;3>d;d++)e=a.getElementsByClassName("contact_status_"+d)[0],e.getElementsByClassName("td_start_contact_rate")[0].textContent=c[d][0].toFixed(1)+"%",e.getElementsByClassName("td_120_contact_rate")[0].textContent=c[d][1].toFixed(1)+"%",e.getElementsByClassName("td_117_contact_rate")[0].textContent=c[d][2].toFixed(1)+
"%",e.getElementsByClassName("td_112_contact_rate")[0].textContent=c[d][3].toFixed(1)+"%",e.getElementsByClassName("td_sum_contact_rate")[0].textContent=c[d][4].toFixed(1)+"%";a=$("#contact_detail_0").prop("checked")?0:$("#contact_detail_1").prop("checked")?1:2;d=[b[a][1],b[a][2],b[a][3],100-b[a][4]];e=[c[a][1],c[a][2],c[a][3],100-c[a][4]];f=["120%\u89e6\u63a5","117%\u89e6\u63a5","112%\u89e6\u63a5","\u4e0d\u767a"];var g=["rgb(100, 180, 255, 0.7)","rgba(80, 220, 120, 0.7)","rgba(255, 160, 100, 0.7)",
"rgba(128, 128, 128, 0.5)"],h=document.getElementById("detail_contact_chart"),l=document.getElementById("detail_contact_chart_2"),k="#000000"===mainColor?"#fff":"#333",n="rgba("+hexToRGB(mainColor).join(",")+", 0.8)";document.getElementById("detail_contact_rate_sum").textContent=b[a][4].toFixed(1);document.getElementById("detail_contact_rate_sum_2").textContent=c[a][4].toFixed(1);chartInstance?(chartInstance.data.datasets[0].data=d,chartInstance.update()):chartInstance=new Chart(h,{type:"doughnut",
data:{labels:f,datasets:[{backgroundColor:g,data:d,borderColor:k}]},plugins:[ChartDataLabels],options:{legend:{display:!1},title:{display:!0,text:"\u5bfe\u6575\u901a\u5e38\u8266\u968a",fontColor:n},tooltips:{callbacks:{label:function(m,p){return p.labels[m.index]+": "+p.datasets[0].data[m.index].toFixed(1)+" %"}}},plugins:{datalabels:{color:mainColor,formatter:function(m,p){return 0<m?m.toFixed(1)+"%":""}}}}});subChartInstance?(subChartInstance.data.datasets[0].data=e,subChartInstance.update()):subChartInstance=
new Chart(l,{type:"doughnut",data:{labels:f,datasets:[{backgroundColor:g,data:e,borderColor:k}]},plugins:[ChartDataLabels],options:{legend:{display:!1},title:{display:!0,text:"\u5bfe\u6575\u9023\u5408\u8266\u968a",fontColor:n},tooltips:{callbacks:{label:function(m,p){return p.labels[m.index]+": "+p.datasets[0].data[m.index].toFixed(1)+" %"}}},plugins:{datalabels:{color:mainColor,formatter:function(m,p){return 0<m?m.toFixed(1)+"%":""}}}}});$("#modal_contact_detail").data("dispIndex",-1);$("#modal_contact_detail").modal("show")}
function btn_antiair_input_Clicked(){document.getElementById("antiair_cutin_inputs").innerHTML="";updateFleetStage2Table();$("#modal_fleet_antiair_input").modal("show")}function form_ship_level_Clicked(a){$target=a.find(".ship_level");a=$("#modal_level_input");var b=castInt($target.text());a.find(".ship_level_input").val(b);a.find(".ship_level_range").val(b);a.modal("show")}
function form_ship_luck_Clicked(a){$target=a.find(".ship_luck");var b=castInt(a.closest(".ship_tab")[0].dataset.shipid),c=SHIP_DATA.find(function(g){return g.id===b});a=c?c.max_luck:99;c=c?c.luck:99;var d=$("#modal_luck_input"),e=castInt($target.text()),f=d.find(".ship_luck_input");f.val(e);f.attr("max",a);f.attr("min",c);f=d.find(".ship_luck_range");f.val(e);f.attr("max",a);f.attr("min",c);d.modal("show")}
function admin_lv_Changed(){var a=$("#admin_lv"),b=validateInputNumber(a.val(),castInt(a.attr("max")));a.val(b);$("#admin_lv_capture").text(b);a=createFleetInstance();for(b=1;4>=b;b++){var c=document.getElementsByClassName("fleet_scout"+b)[0],d=document.getElementsByClassName("fleet_scout"+b)[1];c.textContent=a.scoutScores[b-1];d.textContent=a.scoutScores[b-1]}}
function anti_air_cutin_toggle_Clicked(a){a.hasClass("disabled")?(a.removeClass("disabled"),a.find(".fa-eye-slash").removeClass("fa-eye-slash").addClass("fa-eye")):(a.addClass("disabled"),a.find(".fa-eye").addClass("fa-eye-slash").removeClass("fa-eye"));updateFleetStage2Table()}
function updateFleetStage2Table(){var a=createFleetInstance(),b=castInt($("#fleet_antiair_formation").val()),c=$("#antiair_air_raid").prop("checked");a.updateStage2All(b,c);a.isUnion?$("#antiair_air_raid").parent().removeClass("d-none"):$("#antiair_air_raid").parent().addClass("d-none");for(var d=document.getElementById("antiair_cutin_inputs"),e=[],f=$jscomp.makeIterator(d.getElementsByClassName("anti_air_cutin_toggle")),g=f.next();!g.done;g=f.next())g=g.value,g.classList.contains("disabled")&&e.push(castInt(g.dataset.cutinid,
-1));f=[];g=[];for(var h=0;h<a.ships.length;h++)f.push([]),g.push([]);h=$jscomp.makeIterator(a.allStage2);for(var l=h.next();!l.done;l=h.next())if(l=l.value,!e.includes(l.cutin.id))for(var k=0;k<l.table.length;k++){var n=l.table[k];f[k].push(n.minimumDown);g[k].push(n.fixDown)}$("#fleet_antiair").text(a.antiAirBonus.toFixed(2));h="";l=getMaxShipCount();for(k=0;k<a.ships.length;k++){n=a.ships[k];var m=n.shipNo%l;f[k].length&&g[k].length||(a.updateStage2(b,0,c),f[k].push([n.minimumDown]),g[k].push([n.fixDown]));
var p=getArrayMax(f[k]),q=getArrayMin(f[k]),v=getArrayMax(g[k]),t=getArrayMin(g[k]);h+='\n\t\t<tr class="'+(n.isEscort?"escort_fleet":"main_fleet")+'">\n\t\t\t<td class="text-left text-truncate">\n\t\t\t\t<span class="font_size_11 '+(n.isEscort?"text-primary":"text-success")+'">'+(0<m?m:l)+".</span>\n\t\t\t\t<span>"+n.name+'</span>\n\t\t\t</td>\n\t\t\t<td class="rate_shoot_down">'+Math.floor(1E4*n.rateDown)/100+' %</td>\n\t\t\t<td class="fixed_shoot_down">'+(2<=g[k].length?t+" ~ "+v:v)+'</td>\n\t\t\t<td class="minimum_shoot_down">'+
(2<=f[k].length?q+" ~ "+p:p)+"</td>\n\t\t</tr>"}$("#antiair_input_table tbody").html(h);if(!d.innerHTML){b=document.createDocumentFragment();c={};a=$jscomp.makeIterator(a.allStage2);for(l=a.next();!l.done;c={$jscomp$loop$prop$stage2$274$391:c.$jscomp$loop$prop$stage2$274$391},l=a.next())c.$jscomp$loop$prop$stage2$274$391=l.value,h=ANTIAIR_CUTIN.find(function(x){return function(u){return u.id===x.$jscomp$loop$prop$stage2$274$391.cutin.id}}(c)),k=e.includes(h.id),f=document.createElement("div"),f.className=
"general_tr d-flex px-2 anti_air_cutin_toggle"+(k?" disabled":""),f.dataset.cutinid=h.id,g=document.createElement("div"),g.className="text-truncate w_50",l=document.createElement("i"),l.className="pr-2 fa-eye"+(k?"-slash":""),k=document.createElement("span"),k.className="",k.textContent=h.name+(h.remarks?" ("+h.remarks+")":""),g.appendChild(l),g.appendChild(k),l=document.createElement("div"),l.className="text-right w_15",l.textContent=h.adj[0],k=document.createElement("div"),k.className="text-right w_15",
k.textContent=h.adj[1],h=100*c.$jscomp$loop$prop$stage2$274$391.rate,n=document.createElement("div"),n.className="text-right w_20",n.textContent=h.toFixed(1)+" %",f.appendChild(g),f.appendChild(l),f.appendChild(k),f.appendChild(n),b.appendChild(f);d.innerHTML="";d.appendChild(b)}}function hasTypeItem(a,b){return a.some(function(c){return c.type===b})}
function btn_reset_landBase_Clicked(a){a.closest(".lb_tab").find(".lb_plane").each(function(b,c){$(c).find(".slot").text(0);setLBPlaneDiv($(c))});a.blur();calculate(!0,!1,!1)}function lb_plane_DragEnd(a){a=a.closest(".lb_plane");isOut&&(clearPlaneDiv(a),a.css("opacity","0.0"),isOut=!1,calculate(!0,!1,!1));a.animate({opacity:"1.0"},500)}
function lb_plane_Drop(a,b){var c=b.draggable,d={id:castInt(c[0].dataset.planeid),remodel:castInt(c.find(".remodel_value")[0].textContent),prof:castInt(c.find(".prof_select")[0].dataset.prof),slot:castInt(c.find(".slot").text())},e={id:castInt(a[0].dataset.planeid),remodel:castInt(a.find(".remodel_value")[0].textContent),prof:castInt(a.find(".prof_select")[0].dataset.prof),slot:castInt(a.find(".slot").text())};c.find(".remodel_select").addClass("zero");a.find(".remodel_select").addClass("zero");TradeHTMLWithAnimation(c[0],
a[0],function(){setLBPlaneDiv(a,d);isCtrlPress||$("#drag_drop_copy").prop("checked")||setLBPlaneDiv(c,e);calculate(!0,!1,!1)},150)}
function btn_toggle_lb_info_Clicked(a){var b=a.closest(".lb_infomation");a.hasClass("show_resource")?(a.removeClass("show_resource"),isDefMode&&a.addClass("ml-auto"),b.find(".battle_only").addClass("ml-auto").removeClass("ml-2"),b.find(".btn_show_contact_rate_lb").removeClass("d-none"),b.find(".ap_detail").removeClass("d-none"),b.find(".resource").addClass("d-none")):(a.addClass("show_resource").removeClass("ml-auto"),b.find(".battle_only").removeClass("ml-auto").addClass("ml-2"),b.find(".btn_show_contact_rate_lb").addClass("d-none"),
b.find(".ap_detail").addClass("d-none"),b.find(".resource").removeClass("d-none"))}function toggle_def_mode_Checked(){isDefMode=document.getElementById("toggle_def_mode").checked;calculate()}function toggleDefenseMode(a){isDefMode=document.getElementById("toggle_def_mode").checked=a}
function btn_ship_create_Clicked(a){var b=a.closest(".friendFleet_tab");a=castInt(a[0].dataset.count);display_ship_count_Changed(b,a+1);ship_name_span_Clicked(b.find(".ship_tab:not(.d-none):last").find(".ship_name_span"))}function btn_reset_ship_plane_Clicked(a){a.closest(".ship_tab").find(".ship_plane").each(function(b,c){clearPlaneDiv($(c))});calculate(!1,!0,!1)}
function ship_plane_DragStart(a){$(a.helper).addClass("ship_plane "+getItemCss(castInt($(a.helper).find(".plane_img").attr("alt")))).css("width",320);$(a.helper).find(".slot_select_parent").remove();$(a.helper).find(".btn_remove_plane").remove();$(a.helper).find(".plane_lock").remove();$(a.helper).find(".plane_unlock").remove();$(a.helper).find(".item_special").remove();$(a.helper).find(".prof_select_parent").addClass("mr-2")}
function ship_plane_DragEnd(a){a=a.closest(".ship_plane");isOut&&(clearPlaneDiv(a),a.css("opacity","0.0"),isOut=!1,calculate(!1,!0,!1));a.animate({opacity:"1.0"},500)}
function ship_plane_DragOver(a,b){var c=b.draggable.closest(".ship_plane"),d=castInt(a.closest(".ship_tab")[0].dataset.shipid),e=castInt(c[0].dataset.planeid);0===e||checkInvalidItem(d,ITEM_DATA.find(function(f){return f.id===e}),castInt(a.index()))?(b.helper.stop().animate({opacity:"1.0"},100),isOut=!1):(b.helper.stop().animate({opacity:"0.2"},100),a.removeClass("plane_draggable_hover"),isOut=!0)}
function ship_plane_Drop(a,b){var c=b.draggable.closest(".ship_plane");if(c.length){var d={id:castInt(c[0].dataset.planeid),remodel:castInt(c.find(".remodel_value")[0].textContent),prof:castInt(c.find(".prof_select")[0].dataset.prof)},e={id:castInt(a[0].dataset.planeid),remodel:castInt(a.find(".remodel_value")[0].textContent),prof:castInt(a.find(".prof_select")[0].dataset.prof)};c.find(".remodel_select").addClass("zero");a.find(".remodel_select").addClass("zero");if(0<d.id&&(b=castInt(a.closest(".ship_tab")[0].dataset.shipid),
!checkInvalidItem(b,ITEM_DATA.find(function(f){return f.id===d.id}),castInt(a.index()))))return;TradeHTMLWithAnimation(c[0],a[0],function(){setPlaneDiv(a,d);isCtrlPress||$("#drag_drop_copy").prop("checked")||setPlaneDiv(c,e);calculate(!1,!0,!1)},150)}}
function cell_type_Changed(a,b){b=void 0===b?!0:b;var c=a.closest(".battle_content"),d=castInt(a.val());c.find(".enemy_content").each(function(e,f){d!==CELL_TYPE.grand&&5<e?$(f).addClass("d-none").removeClass("d-flex"):$(f).removeClass("d-none").addClass("d-flex")});d===CELL_TYPE.night?c.addClass("is_night"):c.removeClass("is_night");a=c.find(".formation");changeFormationSelectOption(a,d);b&&calculate()}
function changeFormationSelectOption(a,b){var c=castInt(a.val());a.find("option").each(function(d,e){b!==CELL_TYPE.grand&&(10>$(e).val()&&$(e).removeClass("d-none"),10<$(e).val()&&$(e).addClass("d-none"),10<c&&a.val(c-10));b===CELL_TYPE.grand&&(10>$(e).val()&&$(e).addClass("d-none"),10<$(e).val()&&$(e).removeClass("d-none"),4===c?a.val(11):a.val(c+10))})}function sortable_td_Clicked(a){if(a=a[0].dataset.sortkey)$("#plane_sort_select").val(a),sort_Changed($("#plane_sort_select"))}
function plane_type_select_Changed(a){a=void 0===a?null:a;$("#plane_type_select .item_type").removeClass("d-none");a?($("#plane_type_select .item_type").removeClass("active"),a.addClass("active")):a=$("#plane_type_select").find(".active");$("#modal_plane_select").find(".plane").tooltip("hide");var b=$("#plane_sort_select").val();switch(b){case "default":ITEM_LIST.sort(function(r,w){return r.type!==w.type?r.type-w.type:r.id-w.id});break;case "id":case "cost":ITEM_LIST.sort(function(r,w){return r[b]-
w[b]});break;case "name":ITEM_LIST.sort(function(r,w){return r.name>w.name?1:-1});break;case "land_base_power":ITEM_LIST.sort(function(r,w){return LandBaseItem.getFirePower(w.id,18,0)-LandBaseItem.getFirePower(r.id,18,0)});break;case "history":if(setting.selectedHistory[0]){var c=setting.selectedHistory[0];ITEM_LIST.sort(function(r,w){return c.filter(function(y){return y===w.id}).length-c.filter(function(y){return y===r.id}).length})}break;default:ITEM_LIST.sort(function(r,w){return w[b]-r[b]})}var d=
castInt(a.length?a[0].dataset.type:0),e=[],f=$("#plane_word").val().trim(),g=[];if($target&&$target.hasClass("ship_plane")&&$target.closest(".ship_tab")[0].dataset.shipid){var h=SHIP_DATA.find(function(r){return r.id===castInt($target.closest(".ship_tab")[0].dataset.shipid)});g=(a=SPECIAL_LINK_SHIP_ITEM.find(function(r){return r.apiShip===h.api}))?a.itemType.concat():LINK_SHIP_ITEM.find(function(r){return r.type===h.type}).e_type;var l=$target.hasClass("expanded_slot");a=[];if(l){g=g.filter(function(r){return EXPANDED_ITEM_TYPE.includes(r)});
var k=EXPANDED_SPECIAL_ITEM.filter(function(r){return r.shipApiIds.includes(h.api)});e={};k=$jscomp.makeIterator(k);for(var n=k.next();!n.done;e={$jscomp$loop$prop$sp$393:e.$jscomp$loop$prop$sp$393},n=k.next())e.$jscomp$loop$prop$sp$393=n.value,(n=ITEM_LIST.find(function(r){return function(w){return w.id===r.$jscomp$loop$prop$sp$393.itemId}}(e)))&&!g.includes(n.type)&&g.push(n.type),a.push(n);if(13===h.type||14===h.type)a.push(ITEM_LIST.find(function(r){return 442===r.id})),a.push(ITEM_LIST.find(function(r){return 443===
r.id})),g.push(32)}var m=castInt($target.index());if(0<=m){var p=FORBIDDEN_LINK_SHIP_ITEM.find(function(r){return r.shipId===h.id&&r.index.includes(m+1)});p&&(g=g.filter(function(r){return!p.itemType.includes(r)}))}g&&g.find(function(r){return convertItemType(r)===d})||(d=0);e=getItemsForIcon(d);e=e.filter(function(r){return g.includes(r.type)});18!==h.type&&(e=e.filter(function(r){return 151!==r.id}));[8,9,10].includes(h.type)?19===h.type2&&0<h.ver||37===h.type2||(e=e.filter(function(r){return 128!==
r.id&&281!==r.id})):e=e.filter(function(r){return 142!==r.id});if(1472===h.id){var q=FORBIDDEN_LINK_SHIP_ITEM.find(function(r){return r.shipId===h.id}).itemIDs;e=e.filter(function(r){return!q.includes(r.id)})}if(l){e=e.filter(function(r){return 34!==r.id&&87!==r.id});var v=a.map(function(r){return r.id});l={};a=$jscomp.makeIterator(a);for(k=a.next();!k.done;l={$jscomp$loop$prop$spItem$275$395:l.$jscomp$loop$prop$spItem$275$395},k=a.next())l.$jscomp$loop$prop$spItem$275$395=k.value,e=e.filter(function(r){return function(w){return v.includes(w.id)||
r.$jscomp$loop$prop$spItem$275$395.type!==w.type}}(l))}}else $target&&$target.hasClass("ship_plane")?(g=CB_PLANE_TYPE.concat(SP_PLANE_TYPE),g.includes(d)||(d=0),e=getItemsForIcon(d),e=e.filter(function(r){return g.includes(r.type)})):(g=PLANE_TYPE,g.includes(d)||(d=0),e=getItemsForIcon(d),e=e.filter(function(r){return g.includes(r.type)}));var t=g.map(function(r){return convertItemType(r)});$("#plane_type_select").find(".item_type").each(function(r,w){r=castInt($(w)[0].dataset.type);r===d?$(w).addClass("active"):
$(w).removeClass("active");0<r&&!t.includes(r)&&$(w).addClass("disabled d-none")});f&&(f=replaceKnji(f),e=e.filter(function(r){return r.name.includes(f)||r.id==f}));var x=$("#plane_filter_key_select").val(),u=castInt($("#plane_filter_value").val());1<=e.length&&e[0].hasOwnProperty(x)&&(e=e.filter(function(r){return r[x]>=u}));createItemTable(e,d)}function plane_word_TextChanged(){!1!==timer&&clearTimeout(timer);timer=setTimeout(function(){plane_type_select_Changed()},250)}
function fav_only_Checked_Chenged(){setting.favoriteOnly=$("#fav_only").prop("checked");saveSetting();plane_type_select_Changed()}function disp_in_stock_Checked_Chenged(){setting.inStockOnly=$("#disp_in_stock").prop("checked");saveSetting();plane_type_select_Changed()}function divide_stock_Checked_Chenged(){setting.isDivideStock=$("#divide_stock").prop("checked");saveSetting();plane_type_select_Changed()}
function disp_equipped_Checked_Chenged(){setting.visibleEquipped=$("#disp_equipped").prop("checked");saveSetting();plane_type_select_Changed()}function btn_remove_lb_plane_Clicked(a){a=a.closest(".lb_plane");clearPlaneDiv(a);a.find(".slot").text(0);a.find(".slot_input").attr("max",0);a.find(".slot_range").attr("max",0);calculate(!0,!1,!1)}
function toggle_display_type_Clicked(a){var b=a.closest(".modal");b.find(".toggle_display_type").removeClass("selected");a.addClass("selected");setting.displayMode[b.attr("id")]=a.data("mode");saveSetting()}function sort_Changed(a){a=a.closest(".modal");var b=a.find(".sort_select").val(),c=$target.closest(".contents").attr("id");c&&(setting.orderBy[c]=b,saveSetting());"modal_plane_select"===a.attr("id")&&plane_type_select_Changed()}
function plane_filter_Changed(){var a=$("#plane_filter_key_select").val(),b=castInt($("#plane_filter_value").val()),c=$target.closest(".contents").attr("id");c&&(setting.planeFilter[c]=[a,b],saveSetting());plane_type_select_Changed()}
function plane_name_Clicked(a){$target=a.closest(".lb_plane");$target.attr("class")||($target=a.closest(".ship_plane"));a=castInt($target[0].dataset.planeid);var b=castInt($("#plane_type_select").find(".active")[0].dataset.type);$("#plane_type_select").find(".item_type").each(function(d,e){$(e).removeClass("disabled d-none")});$target.hasClass("ship_plane")&&(LB_PLANE_TYPE.includes(b)&&(b=0),$("#plane_type_select").find(".item_type").each(function(d,e){d=castInt($(e)[0].dataset.type);LB_PLANE_TYPE.includes(d)&&
$(e).addClass("disabled d-none");d===b?$(e).addClass("active"):$(e).removeClass("active")}));var c=$target.closest(".contents").attr("id");c&&($("#modal_plane_select").find(".sort_select").val(setting.orderBy[c]),$("#plane_filter_key_select").val(setting.planeFilter[c][0]),$("#plane_filter_value").val(setting.planeFilter[c][1]));plane_type_select_Changed();$("#modal_plane_select").find(".btn_remove").prop("disabled",0===a);$("#modal_plane_select").modal("show")}
function modal_plane_Selected(a){a={id:castInt(a[0].dataset.planeid),remodel:castInt(a[0].dataset.remodel)};if($target.attr("class").includes("lb_plane")){setLBPlaneDiv($target,a);var b=$target.closest(".lb_tab").find(".ohuda_select");b&&0>castInt(b.val(),-1)&&b.val(isDefMode?0:2)}else $target.attr("class").includes("ship_plane")&&setPlaneDiv($target,a);a.id&&updatePlaneSelectedHistory(a.id);$("#modal_plane_select").modal("hide")}
function modal_plane_select_btn_remove_Clicked(a){if(a.prop("disabled"))return!1;clearPlaneDiv($target);$("#modal_plane_select").modal("hide")}function btn_plane_preset_Clicked(a){var b=-1;$target=a.closest(".lb_tab");$target.attr("class")||($target=a.closest(".ship_tab"),b=castInt($target[0].dataset.shipid));$("#modal_plane_preset").data("parentid",b);loadPlanePreset();$("#modal_plane_preset").modal("show");a.blur()}
function plane_preset_tr_Clicked(a){var b=planePreset.find(function(c){return c.id===castInt(a.data("presetid"))});$(".preset_tr").removeClass("preset_selected");a.addClass("preset_selected");drawPlanePresetPreview(b)}
function preset_name_Changed(a){var b=a.val().trim(),c=a.closest(".modal").find(".btn_commit_preset");50<b.length?(a.addClass("is-invalid"),c.prop("disabled",!0)):0===b.length?(a.addClass("is-invalid"),c.prop("disabled",!0)):(a.removeClass("is-invalid"),a.addClass("is-valid"),c.prop("disabled",!1))}function btn_commit_plane_preset_Clicked(a){a.prop("disabled",!0);updatePlanePreset();loadPlanePreset()}
function btn_delete_plane_preset_Clicked(a){a.prop("disabled",!0);deletePlanePreset();loadPlanePreset()}
function btn_expand_plane_preset_Clicked(){var a=castInt($(".preset_selected").data("presetid")),b=planePreset.find(function(c){return c.id===a});b&&($target.attr("class").includes("lb_tab")?($target.find(".lb_plane").each(function(c,d){var e={id:0,remodel:0};b.planes.length>c&&(e.id=b.planes[c].id,e.remodel=b.planes[c].remodel,setLBPlaneDiv($(d),e))}),$target.find(".ohuda_select").val(isDefMode?0:2)):$target.find(".ship_plane").each(function(c,d){var e={id:0,remodel:0};b.planes.length>c&&(e.id=b.planes[c].id,
e.remodel=b.planes[c].remodel,setPlaneDiv($(d),e))}));$("#modal_plane_preset").modal("hide")}function display_ship_count_Changed(a,b,c){c=void 0===c?!1:c;a.find(".ship_tab").each(function(d,e){d<b?$(e).removeClass("d-none"):$(e).addClass("d-none")});a=a.find(".btn_ship_create");a[0].dataset.count=b;b>=getMaxShipCount()?(a[0].dataset.count=getMaxShipCount(),a.addClass("d-none")):a.removeClass("d-none");c||calculate(!1,!0,!1)}
function btn_remove_ship_plane_Clicked(a){clearPlaneDiv(a.closest(".ship_plane"));calculate(!1,!0,!1)}function visible_anti_air_status_Clicked(){setting.visibleAntiAirStatus=document.getElementById("visible_anti_air_status").checked;saveSetting();calculate(!1,!1,!1)}function fleet_select_tab_Clicked(){$("#union_fleet").prop("checked")||calculate(!1,!0,!1)}
function btn_ship_toggle_Clicked(a){hideTooltip(a[0]);a=a.closest(".ship_tab");var b=new Ship(getUniqueId());b.id=castInt(a[0].dataset.shipid);b.level=castInt(a.find(".ship_level").text());b.luck=castInt(a.find(".ship_luck").text());a.find(".ship_plane:not(.ui-draggable-dragging)").each(function(c,d){d=$(d);var e=new ShipItem(castInt(d[0].dataset.planeid),castInt(d.find(".slot").text()),castInt(d.find(".remodel_value")[0].textContent),castInt(d.find(".prof_select")[0].dataset.prof));e.slotNo=c;d.hasClass("d-none")||
b.items.push(e)});$target=a;setReserveShipList(b);$("#modal_ship_reserve").modal("show")}
function setReserveShipList(a){document.getElementById("current_ship_info").innerHTML=createReserveShipHtml(a,!1);1>a.id&&0===a.items.filter(function(f){return 0<f.id}).length?document.getElementById("btn_add_reserve").disabled=!0:reserveList.find(function(f){return f.shipNo===a.shipNo})?document.getElementById("btn_add_reserve").disabled=!0:(document.getElementById("btn_add_reserve").disabled=!1,currentReserved=a);for(var b=document.createDocumentFragment(),c=$jscomp.makeIterator(reserveList),d=
c.next();!d.done;d=c.next()){d=d.value;var e=createDiv("reserve_ship general_tr m-1 p-2");e.dataset.reservedId=d.shipNo;e.innerHTML=createReserveShipHtml(d);b.appendChild(e)}document.getElementById("reserve_list").innerHTML="";document.getElementById("reserve_list").appendChild(b);saveSessionStorage("reserve_list",reserveList)}
function createReserveShipHtml(a,b){b=void 0===b?!0:b;a.updateAirPower&&a.updateAirPower();for(var c=SHIP_DATA.find(function(g){return g.id===a.id}),d="",e=0;e<a.items.length;e++){var f=a.items[e];d+='\n\t\t\t<div class="d-flex">\n\t\t\t\t<div class="ml-1 align-self-center">\n\t\t\t\t\t<img src="../img/type/'+(f.itype?"icon"+f.itype:"undefined")+'.png" alt="'+f.itype+'" class="img-size-30">\n\t\t\t\t</div>\n\t\t\t\t<div class="ml-1 align-self-center reserve_long_text">'+f.name+"</div>\n\t\t\t\t"+
(f.remodel?'<div class="align-self-center reserve_remodel"><i class="text_remodel fas fa-star"></i><span class="text_remodel">+'+f.remodel+"</span></div>":"")+"\n\t\t\t</div>"}return'<div class="d-flex">\n\t\t<div class="align-self-center">'+(c?'<img src="../img/ship/'+c.id+'.png" class="ship_img mr-1">':"")+'</div>\n\t\t<div class="align-self-center flex-grow-1">\n\t\t\t<div class="font_size_11">\n\t\t\t\t<span class=" text-primary">Lv: '+a.level+"</span>\n\t\t\t\t"+(a.airPower?'<span class="ml-2">\u5236\u7a7a\u5024: '+
a.airPower+"</span>":"")+'\n\t\t\t</div>\n\t\t\t<div class="d-flex">\n\t\t\t\t<div class="reserve_long_text">'+(c?c.name:"\u8266\u5a18\u672a\u6307\u5b9a")+"</div>\n\t\t\t</div>\n\t\t</div>\n\t\t"+(b?'<div class="btn_remove_reserve btn_icon"><i class="fas fa-times"></i></div>':"")+'\n\t\t</div>\n\t</div>\n\t<div class="mt-1">\n\t\t'+d+"\n\t</div>"}
function btn_add_reserve_Clicked(){currentReserved&&(reserveList.push(currentReserved),inform_success("\u4fdd\u7559\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3055\u308c\u307e\u3057\u305f\u3002"),setReserveShipList(currentReserved))}
function reserve_ship_Clicked(a){var b=a[0].dataset.reservedId,c=reserveList.find(function(d){return d.shipNo===b});c&&$target&&$target.hasClass("ship_tab")&&(setShipDiv($target,c.id,c.level),$target.find(".ship_plane:not(.ui-draggable-dragging)").each(function(d,e){var f=c.items.find(function(g){return g.slotNo===d});f&&setPlaneDiv($(e),{id:f.id,remodel:f.remodel,prof:f.level,slot:f.slot},!0)}));$("#modal_ship_reserve").modal("hide")}
function btn_remove_reserve_Clicked(a,b){b.stopPropagation();hideTooltip(a[0]);var c=a.closest(".reserve_ship")[0].dataset.reservedId;reserveList.find(function(d){return d.shipNo===c})&&(reserveList=reserveList.filter(function(d){return d.shipNo!==c}),inform_success("\u4fdd\u7559\u30ea\u30b9\u30c8\u304b\u3089\u524a\u9664\u3057\u307e\u3057\u305f\u3002"),setReserveShipList(currentReserved))}
function btn_reset_reserve_Clicked(){reserveList=[];inform_success("\u4fdd\u7559\u30ea\u30b9\u30c8\u60c5\u5831\u3092\u30ea\u30bb\u30c3\u30c8\u3057\u307e\u3057\u305f\u3002");setReserveShipList(currentReserved)}
function ship_disabled_Changed(a){a.hasClass("disabled")?(a.closest(".ship_tab").removeClass("opacity4"),a.removeClass("disabled"),a.children().removeClass("fa-eye-slash").addClass("fa-eye no_capture")):(a.closest(".ship_tab").addClass("opacity4"),a.addClass("disabled"),a.children().removeClass("fa-eye no_capture").addClass("fa-eye-slash"));calculate(!1,!0,!1)}
function union_fleet_Checked(){var a=$("#union_fleet").prop("checked");a&&$("#yugeki_fleet").prop("checked")&&$("#yugeki_fleet").prop("checked",!1);var b=$(".friendFleet_tab.active"),c=$(".friendFleet_tab:not(.active)");a&&6<=b.find(".ship_tab:not(.d-none)").length&&display_ship_count_Changed(b,6,!0);a&&6<=c.find(".ship_tab:not(.d-none)").length&&display_ship_count_Changed(c,6,!0);calculate(!1,!0,!1)}
function yugeki_fleet_Checked(){var a=$("#yugeki_fleet").prop("checked");a&&$("#union_fleet").prop("checked")&&$("#union_fleet").prop("checked",!1);var b=$(".friendFleet_tab.active"),c=b.find(".ship_tab:not(.d-none)").length;a&&6===c?display_ship_count_Changed(b,7,!0):!a&&6<=c&&display_ship_count_Changed(b,6,!0);b=$(".friendFleet_tab:not(.active)");c=b.find(".ship_tab:not(.d-none)").length;a&&6===c?display_ship_count_Changed(b,7,!0):!a&&6<=c&&display_ship_count_Changed(b,6,!0);calculate(!1,!0,!1)}
function ship_name_span_Clicked(a){$target=a.closest(".ship_tab");castInt($target[0].dataset.shipid)?$("#modal_ship_select").find(".btn_remove").prop("disabled",!1):$("#modal_ship_select").find(".btn_remove").prop("disabled",!0);createShipTable();$("#modal_ship_select").modal("show")}
function btn_remove_ship_Clicked(a){var b=a.closest(".fleet_tab");a=a.closest(".ship_tab");clearShipDiv(a);b=b.find(".btn_ship_create");var c=castInt(b[0].dataset.count);2<=c&&(a.addClass("d-none"),b.before(a),b.removeClass("d-none"),b[0].dataset.count=c-1);calculate(!1,!0,!1)}function ship_word_TextChanged(){!1!==timer&&clearTimeout(timer);timer=setTimeout(function(){createShipTable()},250)}
function ship_type_select_Changed(a){$("#ship_type_select").find(".ship_type").removeClass("active");a.addClass("active");createShipTable()}function modal_ship_Selected(a){var b=castFloat(a[0].dataset.shipid),c=castInt(a[0].dataset.level),d=castInt(a[0].dataset.area);a=castInt(a[0].dataset.luck);setShipDiv($target,b,c,d,a);updateShipSelectedHistory(b);$("#modal_ship_select").modal("hide")}
function modal_ship_select_btn_remove_Clicked(a){if(a.prop("disabled"))return!1;clearShipDiv($target);$("#modal_ship_select").modal("hide")}
function battle_count_Changed(a){createEnemyInput(castInt(a.val()));var b=!1;$("#lb_tab_parent").find(".ohuda_select").each(function(c,d){2===castInt($(d).val())&&($(".btn_lb_target").removeClass("btn-outline-success"),$(".btn_lb_target").addClass("btn-outline-danger"),$(".lb_target_alert").removeClass("d-none"),b=!0)});b&&inform_warning("\u6575\u8266\u3068\u306e\u4ea4\u6226\u56de\u6570\u304c\u5909\u66f4\u3055\u308c\u307e\u3057\u305f\u3002\u57fa\u5730\u822a\u7a7a\u968a\u306e\u6d3e\u9063\u5148\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002");calculate(!0,
!1,!0)}
function btn_lb_target_Clicked(){var a=createLandBaseInstance(),b=document.getElementById("land_base_target_buttons").getElementsByClassName("btn-sm"),c=$jscomp.makeIterator(b);for(b=c.next();!b.done;b=c.next())b=b.value,b.classList.remove("active"),b.getElementsByTagName("input")[0].checked=!1,b.classList.contains("btn-outline-secondary")||b.classList.remove("disabled");a=$jscomp.makeIterator(a.landBases);for(b=a.next();!b.done;b=a.next())if(c=b.value,2===c.mode){if(b=document.getElementsByName("lb"+c.baseNo+
"_target")[c.target[0]])b.parentElement.classList.add("active"),b.checked=!0;if(b=document.getElementsByName("lb"+c.baseNo+"_target2")[c.target[1]])b.parentElement.classList.add("active"),b.checked=!0}else{var d=$jscomp.makeIterator(document.getElementsByName("lb"+c.baseNo+"_target"));for(b=d.next();!b.done;b=d.next())b.value.parentElement.classList.add("disabled");c=$jscomp.makeIterator(document.getElementsByName("lb"+c.baseNo+"_target2"));for(b=c.next();!b.done;b=c.next())b.value.parentElement.classList.add("disabled")}$(".btn_lb_target").removeClass("btn-outline-danger");
$(".btn_lb_target").addClass("btn-outline-success");$(".lb_target_alert").addClass("d-none");$("#modal_lb_target").modal("show")}
function enemy_fleet_display_mode_Changed(){var a=$("#enemy_fleet_display_image").prop("checked");$(".enemy_content").each(function(b,c){a?($(c).removeClass("py-0_5").addClass("pb-0_1 min-h-31px"),$(c).find(".enemy_name_img_parent").removeClass("d-none").addClass("d-flex"),$(c).find(".enemy_name_text").addClass("d-none")):($(c).removeClass("pb-0_1 min-h-31px").addClass("py-0_5"),$(c).find(".enemy_name_img_parent").addClass("d-none").removeClass("d-flex"),$(c).find(".enemy_name_text").removeClass("d-none"))});
setting.enemyFleetDisplayImage=a;saveSetting()}function btn_reset_battle_Clicked(a){var b=isDefMode?$("#air_raid_enemies"):a.closest(".battle_content");b[0].dataset.celldata="";b.find(".enemy_content").each(function(c,d){return clearEnemyDiv($(d))});a.blur();calculate()}function enemy_word_TextChanged(){!1!==timer&&clearTimeout(timer);timer=setTimeout(function(){createEnemyTable()},250)}
function enemy_index_Clicked(a){a.closest(".enemy_content").hasClass("is_dead")?a.closest(".enemy_content").removeClass("is_dead"):a.closest(".enemy_content").addClass("is_dead");calculate(!1,!1,!0)}
function enemy_name_Clicked(a){$target=a.closest(".enemy_content");a=castInt($target[0].dataset.enemyid);$("#enemy_type_select").change();0!==a?$("#modal_enemy_select").find(".btn_remove").prop("disabled",!1):$("#modal_enemy_select").find(".btn_remove").prop("disabled",!0);$("#modal_enemy_select").modal("show")}function modal_enemy_Selected(a){setEnemyDiv($target,castInt(a[0].dataset.enemyid));$("#modal_enemy_select").modal("hide")}
function modal_enemy_select_btn_remove(a){if(a.prop("disabled"))return!1;clearEnemyDiv($target);$("#modal_enemy_select").modal("hide")}function btn_world_expand_Clicked(){$target=$(".battle_content:first");$("#expand_target").text(1);$("#btn_expand_enemies").addClass("d-none");$("#btn_continue_expand").prop("disabled",!0);$("#btn_continue_expand").removeClass("d-none");$("#expand_target_parent").removeClass("d-none");$("#enemy_pattern_tbody").html("");$("#modal_enemy_pattern").modal("show")}
function btn_enemy_preset_Clicked(a){$target=a.closest(".battle_content");isDefMode&&($target=$("#air_raid_enemies"));$("#btn_expand_enemies").removeClass("d-none");$("#btn_expand_enemies").prop("disabled",!0);$("#btn_continue_expand").addClass("d-none");$("#expand_target_parent").addClass("d-none");$("#modal_enemy_pattern").modal("show")}
function btn_stage2_Clicked(a){var b=a.closest(".battle_content");a=castInt(b.find(".battle_no").text())-1;b=castInt(b.find(".formation").val());$("#modal_stage2_detail").data("battleno",a);$("#modal_stage2_detail").data("formationid",b);calculateStage2Detail();$("#modal_stage2_detail").modal("show")}function stage2_slot_input_Changed(){var a=$("#stage2_detail_slot"),b=validateInputNumber(a.val(),castInt(a.attr("max")));a.val(b);calculateStage2Detail()}
function free_modify_input_Changed(a){var b=validateInputNumberFloat(a.val(),castFloat(a.attr("max")));a.val()!==b&&a.val(b);calculateStage2Detail()}
function calculateStage2Detail(){var a=castInt($("#modal_stage2_detail").data("battleno")),b=castInt($("#modal_stage2_detail").data("formationid"));a=updateEnemyFleetInfo().battles[a];var c=castInt($("#stage2_detail_slot").val()),d=castInt($("#stage2_detail_avoid").val()),e=0,f="",g=!1;$("#free_modify").find("input").prop("readonly",5!==d);5>d&&($("#free_anti_air_weight").val(AVOID_TYPE[d].adj[0]),$("#free_anti_air_bornus").val(AVOID_TYPE[d].adj[1]));for(var h=0,l=0;l<a.enemies.length;l++){var k=
a.enemies[l];if(0!==k.id&&!k.isDead){var n=Math.floor(c*a.stage2[d][0][h]),m=a.stage2[d][1][h],p=n+m;ANTIAIR_CUTIN_ENEMY.includes(k.id)&&(g=!0);e+=k.antiAirBonus;f+='\n\t\t<tr class="'+(p>=c?"stage2_table_death":p>=c/2?"stage2_table_half":"")+'">\n\t\t\t<td class="font_size_12 text-left td_enm_name" data-toggle="tooltip" data-html="true"\n\t\t\t\tdata-title="<div><div>\u52a0\u91cd\u5bfe\u7a7a\u5024\uff1a'+k.antiAirWeight+"</div><div>\u9632\u7a7a\u30dc\u30fc\u30ca\u30b9\uff1a"+k.antiAirBonus+'</div></div>">\n\t\t\t\t<span class="ml-2">\n\t\t\t\t\t'+
drawEnemyGradeColor(k.name)+'\n\t\t\t\t</span>\n\t\t\t</td>\n\t\t\t<td class="text-right">\n\t\t\t\t<span class="text-right">'+(100*a.stage2[d][0][h++]).toFixed(1)+"% ("+n+'\u6a5f)</span>\n\t\t\t</td>\n\t\t\t<td class="text-right">'+m+'\u6a5f</td>\n\t\t\t<td class="text-right">'+p+"\u6a5f</td>\n\t\t</tr>\n\t\t"}}c=FORMATION.find(function(q){return q.id===b});e=2*Math.floor((c?c.correction:1)*e);a.cellType!==CELL_TYPE.airRaid?$("#is_air_raid").addClass("d-none"):$("#is_air_raid").removeClass("d-none");
a.cellType!==CELL_TYPE.airRaid&&g?$("#stage2_warning").removeClass("d-none"):$("#stage2_warning").addClass("d-none");$("#stage2_table tbody").html(f);$(".td_enm_name").tooltip();$("#stage2_detail_formation").text(c.name);$("#sumfleetAntiAir").text(e)}function node_tr_Clicked(a){$(".node_tr").removeClass("node_selected");a.addClass("node_selected");createEnemyPattern()}function pattern_Changed(a){a=castInt(a.data("disp"),-1);0>a||createEnemyPattern(a)}
function enemy_display_mode_Changed(a){setting.enemyDisplayImage=a.attr("id").includes("enemy_display_image");saveSetting();a=castInt($("#enemy_pattern_select").find(".nav-link.active").data("disp"));0<a?createEnemyPattern(a):createEnemyPattern()}function node_Clicked(a){$(".node_tr").removeClass("node_selected");$('.node_tr[data-node="'+a.attr("title")+'"').addClass("node_selected");createEnemyPattern()}
function node_DoubleClicked(){$(".node_tr").hasClass("node_selected")&&($("#btn_expand_enemies").hasClass("d-none")?(btn_continue_expand_Clicked(),$(".node_tr").removeClass("node_selected")):btn_expand_enemies())}function btn_expand_enemies(){expandEnemy();$("#modal_enemy_pattern").modal("hide")}
function btn_continue_expand_Clicked(){var a=castInt($("#expand_target").text());1===a&&clearEnemyDivAll();createEnemyInput(a);$("#expand_target").text(a+1);$target=$(document.getElementsByClassName("battle_content")[a-1]);expandEnemy();$("#enemy_pattern_tbody").html("<div>"+a+" \u6226\u76ee\u306e\u6575\u8266\u968a\u304c\u633f\u5165\u3055\u308c\u307e\u3057\u305f\u3002</div><div>\u7d9a\u3051\u308b\u5834\u5408\u306f\u518d\u5ea6\u6226\u95d8\u30de\u30b9\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002<div>");
$("#enemy_pattern_select").html('<li class="nav-item"><a class="nav-link '+("#000000"===mainColor?"":"nav-link-dark")+' active" data-toggle="tab" href="#">\u7de8\u62101</a></li>');$("#enemy_pattern_air_power").text("0");$("#enemy_display_mode_parent").addClass("d-none").removeClass("d-flex");$(".node_selected").removeClass("node_selected");$("#btn_continue_expand").prop("disabled",!0);$("#lb_tab_parent").find(".ohuda_select").each(function(b,c){2===castInt($(c).val())&&($(".btn_lb_target").removeClass("btn-outline-success"),
$(".btn_lb_target").addClass("btn-outline-danger"),$(".lb_target_alert").removeClass("d-none"))});if(isDefMode||10===a)$("#modal_enemy_pattern").modal("hide"),10===a&&inform_warning("\u6575\u8266\u3068\u306e\u4ea4\u6226\u56de\u6570\u304c\u5909\u66f4\u3055\u308c\u307e\u3057\u305f\u3002\u57fa\u5730\u822a\u7a7a\u968a\u306e\u6d3e\u9063\u5148\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}
function shoot_down_table_tbody_MouseEnter(a){a=a.closest("tr");var b=a[0].dataset.css;a.addClass("bg-hover");a.find(".td_plane_name").addClass(b);$("#shoot_down_table_tbody").find('tr[data-si="'+a[0].dataset.si+'"]:first').find(".td_name").addClass("bg-hover")}
function shoot_down_table_tbody_MouseLeave(a){a=a.closest("tr");var b=a[0].dataset.css;a.removeClass("bg-hover");a.find(".td_plane_name").removeClass(b);$("#shoot_down_table_tbody").find('tr[data-si="'+a[0].dataset.si+'"]:first').find(".td_name").removeClass("bg-hover")}function progress_area_MouseEnter(a){a=a.find(".result_bar");var b=castInt(a.data("airstatus")),c=castInt(a.attr("id").replace("result_bar_",""));a.addClass("bar_ex_status"+b);$("#rate_row_"+c).addClass("bg_status"+b)}
function progress_area_MouseLeave(a){a=a.find(".result_bar");var b=castInt(a.data("airstatus")),c=castInt(a.attr("id").replace("result_bar_",""));a.removeClass("bar_ex_status"+b);$("#rate_row_"+c).removeClass("bg_status"+b)}function rate_table_MouseEnter(a){a=castInt(a.closest("tr").attr("id").replace("rate_row_",""));var b=$("#result_bar_"+a),c=castInt(b.data("airstatus"));b.addClass("bar_ex_status"+c);$("#rate_row_"+a).addClass("bg_status"+c)}
function rate_table_MouseLeave(a){a=castInt(a.closest("tr").attr("id").replace("rate_row_",""));var b=$("#result_bar_"+a),c=castInt(b.data("airstatus"));b.removeClass("bar_ex_status"+c);$("#rate_row_"+a).removeClass("bg_status"+c)}
function enemy_shoot_down_table_tbody_MouseEnter(a){a=a.closest("tr");var b=castInt(a[0].dataset.rowindex),c=a[0].dataset.css;a.addClass("bg-hover");a.find(".td_plane_name").addClass(c);$("#enemy_shoot_down_tbody").find(".enemy_no_"+b+":first").find(".td_name").addClass("bg-hover")}
function enemy_shoot_down_table_tbody_MouseLeave(a){a=a.closest("tr");var b=castInt(a[0].dataset.rowindex),c=a[0].dataset.css;a.removeClass("bg-hover");a.find(".td_plane_name").removeClass(c);$("#enemy_shoot_down_tbody").find(".enemy_no_"+b+":first").find(".td_name").removeClass("bg-hover")}
function btn_more_calc_Clicked(){var a=$("#calculate_count").val();$("#calculate_count").val(1E5);calculate(!1,!1,!1);inform_success("\u8a08\u7b97\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002(+100,000 \u56de\u51fa\u6483\u5206)");$("#calculate_count").val(a);$("#calculate_confirm").addClass("d-none")}
function display_battle_tab_Changed(a){displayBattle=castInt(a.find(".nav-link").data("disp"))-1;displayBattle<=selectedFormations.length&&(document.getElementById("fleet_formation").value=selectedFormations[displayBattle]);calculate(!1,!1,!1)}
function display_result_Changed(){if($("#display_land_base_result").prop("checked"))for(var a=1;7>a;a++)$("#rate_row_"+a+":not(.disabled_tr)").removeClass("d-none"),$("#result_bar_"+a).closest(".progress_area:not(.disabled_bar)").removeClass("d-none").addClass("d-flex");else for(a=1;7>a;a++)$("#rate_row_"+a).addClass("d-none"),$("#result_bar_"+a).closest(".progress_area").addClass("d-none").removeClass("d-flex");$("#display_fleet_result").prop("checked")?($("#rate_row_7:not(.disabled_tr)").removeClass("d-none"),
$("#result_bar_7").closest(".progress_area:not(.disabled_bar)").removeClass("d-none").addClass("d-flex")):($("#rate_row_7").addClass("d-none"),$("#result_bar_7").closest(".progress_area").addClass("d-none").removeClass("d-flex"));$("#display_bar").prop("checked")?$("#result_bar_parent").removeClass("d-none"):$("#result_bar_parent").addClass("d-none");$("#display_enemy_table").prop("checked")?$("#enemy_shoot_down_table_parent").removeClass("d-none"):$("#enemy_shoot_down_table_parent").addClass("d-none")}
function land_base_detail_Clicked(a){landBaseDetailCalculate(castInt(a.data("base_no")),0,!0);$("#modal_result_detail").modal("show")}function land_base_bar_Clicked(a){a=a.find(".result_bar");a=castInt(a.attr("id").replace("result_bar_",""));7>a&&(landBaseDetailCalculate(castInt($("#rate_row_"+a).data("base_no")),0,!0),$("#modal_result_detail").modal("show"))}
function simple_lb_progress_Clicked(a){a=a.closest(".lb_tab").attr("id");a=castInt(a.replace("lb_item",""));a=$("#rate_row_"+(2*a-1));a.length&&(landBaseDetailCalculate(castInt(a.data("base_no")),0,!0),$("#modal_result_detail").modal("show"))}
function fleet_slot_Clicked(a){var b=castInt(a[0].dataset.shipid),c=castInt(a[0].dataset.si),d=castInt(a[0].dataset.slot);"-"!==a.find(".td_plane_name").text()&&""!==a.find(".td_plane_name").text()&&fleetSlotDetailCalculate(c,d,b)&&$("#modal_result_detail").modal("show")}function enemy_slot_Clicked(a){var b=castInt(a.closest("tr")[0].dataset.rowindex);a=castInt(a.closest("tr")[0].dataset.slot);enemySlotDetailCalculate(b,a,!0);$("#modal_result_detail").modal("show")}
function innerProfSetting_Clicked(a){var b=castInt(a.find("input").attr("id").replace("prof120_",""));(a=a.find("input").prop("checked"))&&!initialProf120Plane.includes(b)?initialProf120Plane.push(b):!a&&initialProf120Plane.includes(b)&&(initialProf120Plane=initialProf120Plane.filter(function(c){return c!==b}));setting.initialProf120=initialProf120Plane.sort(function(c,d){return c-d});saveSetting();calculate(!0,!0,!1)}
function calculate_count_Changed(a){var b=validateInputNumber(a.val(),1E5);a.val(b);setting.simulateCount=b;saveSetting()}function clipboard_mode_Clicked(){"function"!==typeof ClipboardItem&&($("#clipboard_mode").prop("checked",!1),$("#cant_use_clipboard").removeClass("d-none"));setting.copyToClipboard=$("#clipboard_mode").prop("checked");saveSetting()}
function btn_reset_selected_plane_history_Clicked(){var a=$("#modal_confirm");a.find(".modal-body").html('\n\t\t<div>\u3088\u304f\u4f7f\u3046\u3068\u3057\u3066\u767b\u9332\u3055\u308c\u305f\u6a5f\u4f53\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3059\u3002</div>\n\t\t<div class="mt-3">\u3088\u308d\u3057\u3051\u308c\u3070\u3001OK\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002</div>\n\t');confirmType="deleteSelectedPlaneHistory";a.modal("show")}
function btn_reset_selected_ship_history_Clicked(){var a=$("#modal_confirm");a.find(".modal-body").html('\n\t\t<div>\u3088\u304f\u4f7f\u3046\u3068\u3057\u3066\u767b\u9332\u3055\u308c\u305f\u8266\u5a18\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3059\u3002</div>\n\t\t<div class="mt-3">\u3088\u308d\u3057\u3051\u308c\u3070\u3001OK\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002</div>\n\t');confirmType="deleteSelectedShipHistory";a.modal("show")}
function manage_manual_enemu_content_Shown(){document.getElementById("created_manual_enemies").innerHTML.trim()||drawManualEnemies()}
function drawManualEnemies(){var a=document.getElementById("created_manual_enemies");a.innerHTML="";for(var b=$jscomp.makeIterator(UNKNOWN_ENEMY),c=b.next();!c.done;c=b.next()){c=new Enemy(c.value);var d=document.createElement("div");d.className="manual_enemy_tr general_tr d-flex px-3 py-2";d.dataset.virtualid=c.id;var e=document.createElement("div");e.className="d-flex manual_enemy_head";var f=document.createElement("img");f.className="enemy_name_img d-none d-md-block";f.src="../img/enemy/"+c.id+
".png";e.appendChild(f);f=document.createElement("div");f.className="ml-1 manual_enemy_name_td";var g=document.createElement("div");g.className="text-primary font_size_11";g.textContent="ID : "+(c.id+1500);var h=document.createElement("div");h.textContent=c.name;f.appendChild(g);f.appendChild(h);e.appendChild(f);d.appendChild(e);e=document.createElement("div");e.className="manual_enemy_slots";for(f=0;f<c.equipments.length;f++){g=c.equipments[f];var l=c.rawSlots[f];if(!(0>=g.id)){h=document.createElement("div");
h.className="manual_enemy_slot d-flex";var k=document.createElement("div");k.className="mr-2 d-none d-md-inline manual_enemy_slot_count";k.textContent=0>l?0:l;l=document.createElement("img");l.className="img-size-25";l.src="../img/type/icon"+g.itype+".png";var n=document.createElement("div");n.className="ml-1";n.textContent=g.name;h.appendChild(k);h.appendChild(l);h.appendChild(n);e.appendChild(h)}}d.appendChild(e);e=document.createElement("div");e.className="manual_enemy_ap_td";e.textContent=0===
c.airPower&&c.landBaseAirPower?"("+c.landBaseAirPower+")":c.airPower;d.appendChild(e);e=document.createElement("div");e.className="manual_enemy_aaw_td";e.textContent=c.antiAirWeight;d.appendChild(e);e=document.createElement("div");e.className="manual_enemy_aabo_td";e.textContent=c.antiAirBonus;d.appendChild(e);a.appendChild(d)}}
function manul_enemy_Clicked(a){for(var b=0;4>b;b++)document.getElementsByClassName("enemy_slot")[b].value=-1,document.getElementsByClassName("enemy_slot")[b].value=0;if(b=ENEMY_DATA.find(function(d){return d.id===castInt(a[0].dataset.virtualid)})){document.getElementById("manual_enemy_img").src="../img/enemy/"+b.id+".png";document.getElementById("manual_enemy_status_id").textContent=b.id+1500;document.getElementById("manual_enemy_name").textContent=b.name;setEnemyPlaneCombobox(b);for(var c=0;c<b.slot.length&&
!(4<=c);c++)document.getElementsByClassName("enemy_slot")[c].value=0>b.slot[c]?0:b.slot[c],document.getElementsByClassName("enemy_planes")[c].value=0>b.eqp[c]?0:b.eqp[c];document.getElementById("manual_aa").value=b.aa;calculateVirtualEnemy();$("#modal_manual_enemy").modal("show")}else inform_warning("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002")}
function manual_enemy_input_Changed(a){var b=validateInputNumber(a.val(),castInt(a.attr("max")));a.val(b);calculateVirtualEnemy()}
function setEnemyPlaneCombobox(a){var b=null,c=-1;a=document.createElement("div");a.innerHTML="";var d=document.createElement("option");d.textContent="-";d.value=-1;a.appendChild(d);var e=ENEMY_ITEM.filter(function(h){return!0});d={};e=$jscomp.makeIterator(e);for(var f=e.next();!f.done;d={$jscomp$loop$prop$type$398:d.$jscomp$loop$prop$type$398},f=e.next()){f=f.value;d.$jscomp$loop$prop$type$398=Math.abs(f.type);if(c!==d.$jscomp$loop$prop$type$398){null!==b&&a.appendChild(b);c=d.$jscomp$loop$prop$type$398;
b=document.createElement("optgroup");var g=ITEM_API_TYPE.find(function(h){return function(l){return l.id===h.$jscomp$loop$prop$type$398}}(d));g?b.label=g.name:(g=OTHER_TYPE.find(function(h){return function(l){return l.id===h.$jscomp$loop$prop$type$398}}(d)),b.label=g?g.name:"\u672a\u5b9a\u7fa9")}g=document.createElement("option");g.textContent=f.id+": "+f.name;g.value=f.id;b.appendChild(g)}a.appendChild(b);b=$jscomp.makeIterator(document.getElementsByClassName("enemy_planes"));for(c=b.next();!c.done;c=
b.next())c=c.value,c.innerHTML=a.innerHTML,c.options[0].selected=!0}
function calculateVirtualEnemy(){for(var a=0,b=0,c={},d=0;4>d;c={$jscomp$loop$prop$planeId$400:c.$jscomp$loop$prop$planeId$400},d++){var e=castInt(document.getElementsByClassName("enemy_slot")[d].value);c.$jscomp$loop$prop$planeId$400=castInt(document.getElementsByClassName("enemy_planes")[d].value);var f=document.getElementsByClassName("manual_enemy_ap")[d];if(500>c.$jscomp$loop$prop$planeId$400||0>=e)f.textContent=0;else{b+=e;var g=ENEMY_ITEM.find(function(h){return function(l){return l.id===h.$jscomp$loop$prop$planeId$400}}(c));
g?(e=PLANE_TYPE.includes(g.type)?Math.floor(g.antiAir*Math.sqrt(e)):0,f.textContent=e,a+=e):(f.textContent=0,document.getElementsByClassName("enemy_planes")[d].options[0].selected=!0)}}document.getElementById("enemy_slot_sum").textContent=b;document.getElementById("manual_enemy_sumAP").textContent=a}
function commit_enemy_Clicked(){var a=castInt(document.getElementById("manual_enemy_status_id").textContent)-1500;if(UNKNOWN_ENEMY.includes(a)){var b=ENEMY_DATA.find(function(h){return h.id===a}),c={id:a,type:b.type,name:b.name,slot:[],eqp:[],orig:b.orig,aa:0};c.aa=castInt(document.getElementById("manual_aa").value);b=document.getElementById("enemy_slot_info");for(var d={},e=0;4>e;d={$jscomp$loop$prop$planeId$402:d.$jscomp$loop$prop$planeId$402},e++){var f=castInt(b.getElementsByClassName("enemy_slot")[e].value);
d.$jscomp$loop$prop$planeId$402=castInt(b.getElementsByClassName("enemy_planes")[e].value);var g=ENEMY_ITEM.find(function(h){return function(l){return l.id===h.$jscomp$loop$prop$planeId$402}}(d));g?(c.slot.push(PLANE_TYPE.includes(g.type)?f:0),c.eqp.push(g.id)):(c.slot.push(-1),c.eqp.push(-1))}b=loadLocalStorage("manual_enemies")||[];d=b.findIndex(function(h){return h.id===c.id});0>d?b.push(c):b[d]=c;d=ENEMY_DATA.findIndex(function(h){return h.id===c.id});ENEMY_DATA[d].aa=c.aa;ENEMY_DATA[d].eqp=c.eqp;
ENEMY_DATA[d].slot=c.slot;saveLocalStorage("manual_enemies",b);drawManualEnemies();inform_success("\u6575\u8266\u60c5\u5831\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002");calculate();$("#modal_manual_enemy").modal("hide")}}function rollback_enemy_Clicked(){var a=loadLocalStorage("manual_enemies"),b=castInt(document.getElementById("manual_enemy_status_id").textContent)-1500;a&&(a=a.filter(function(c){return c.id!==b}),saveLocalStorage("manual_enemies",a),location.reload())}
function btn_target_Clicked(a){var b=castInt(a[0].dataset.target)-1;a.parent().find('input[type="hidden"]').val(b)}function btn_calculate_detail(){var a=$("#calculate_count").val();$("#calculate_count").val($("#detail_calculate_count").val());detailCalculate();$("#btn_calculate_detail").prop("disabled",!0);$("#calculate_count").val(a)}function detail_slot_tab_Changed(a){a.find(".nav-link").hasClass("disabled")||($("#detail_info").data("slot_no",castInt(a.data("slot_no"))),detailCalculate())}
function btn_show_detail_Clicked(a){$("#detail_info").data("slot_no",castInt(a[0].dataset.slot_no));detailCalculate()}
function btn_output_slot_dist_Clicked(){try{var a=chartInstance.data.labels,b=chartInstance.data.datasets[0].data,c=getArrayMax(a.map(function(k){return castInt(k)})),d=$("#detail_info").data("mode");if("land_base_detail"===d)c=18;else if($("#slot_detail").prop("checked")){var e=$("#detail_legend").find(".legend_name"),f=castInt($("#detail_info").data("slot_no"));if("enemy_slot_detail"===d){var g=ENEMY_DATA.find(function(k){return k.id===castInt(e.data("enemyid"))});g&&(c=g.slot[f])}else if("fleet_slot_detail"===
d){var h=SHIP_DATA.find(function(k){return k.id===castInt(e.data("shipid"))});h&&(c=h.slot[f])}}d=[];if(0<a.length)for(;0<=c;c--){var l=a.indexOf(c);-1<l?d.push({slot:c,rate:b[l]/100}):d.push({slot:c,rate:0})}$("#dist_text").removeClass("d-none");$("#dist_text").val(JSON.stringify(d));copyInputTextToClipboard($("#dist_text"));$("#dist_text").addClass("d-none")}catch(k){inform_danger("\u51fa\u529b\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}}
function btn_output_slot_dist_table_Clicked(){try{var a=chartInstance.data.labels,b=chartInstance.data.datasets[0].data,c=getArrayMax(a.map(function(k){return castInt(k)})),d=$("#detail_info").data("mode");if("land_base_detail"===d)c=18;else if($("#slot_detail").prop("checked")){var e=$("#detail_legend").find(".legend_name"),f=castInt($("#detail_info").data("slot_no"));if("enemy_slot_detail"===d){var g=ENEMY_DATA.find(function(k){return k.id===castInt(e.data("enemyid"))});g&&(c=g.slot[f])}else if("fleet_slot_detail"===
d){var h=SHIP_DATA.find(function(k){return k.id===castInt(e.data("shipid"))});h&&(c=h.slot[f])}}d="";if(0<a.length)for(f=c;0<=f;f--){var l=a.indexOf(f);f!==c&&(d+="\r\n");d=-1<l?d+(f+"\t"+b[l]/100):d+(f+"\t0")}$("#dist_text").removeClass("d-none");$("#dist_text").val(d);copyInputTextToClipboard($("#dist_text"));$("#dist_text").addClass("d-none")}catch(k){inform_danger("\u51fa\u529b\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}}
function modal_confirm_ok_Clicked(){switch(confirmType){case "deleteLocalStorageAll":window.localStorage.clear();break;case "resetPlaneStock":deleteLocalStorage("planeStock");updateItemList();break;case "resetShipStock":deleteLocalStorage("shipStock");break;case "resetFavoritePlane":setting.favoritePlane=[];setting.favoriteOnly=!1;$("#fav_only").prop("checked",!1);saveSetting();updateItemList();break;case "resetFavoriteShip":setting.favoriteShip=[];setting.favoriteOnlyShip=!1;$("#fav_only_ship").prop("checked",
!1);saveSetting();break;case "deleteSelectedPlaneHistory":setting.selectedHistory[0]=[];saveSetting();break;case "deleteSelectedShipHistory":setting.selectedHistory[1]=[],saveSetting()}$("#modal_confirm").modal("hide")}
function btn_save_preset_Clicked(){$("#allow_upload_preset").prop("checked",!1);$("#upload_option").addClass("d-none");$("#btn_upload_preset").addClass("d-none");var a=getActivePreset();document.getElementById("preset_remarks").value=a.memo;document.getElementById("preset_remarks").classList.remove("is-valid");document.getElementById("input_preset_name").classList.remove("is-valid");var b=loadLocalStorage("presets");if(b&&(b=b.find(function(c){return c[0]===a.id}))){document.getElementById("input_preset_name").value=
b[1];document.getElementById("preset_remarks").value=b[3];updateMainPreset();inform_success("\u7de8\u6210\u306e\u4e0a\u66f8\u304d\u66f4\u65b0\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002");return}document.getElementById("input_preset_name").value="";$("#modal_main_preset").find(".btn_commit_preset").prop("disabled",!0);$("#modal_main_preset").modal("show")}
function btn_save_preset_sub_Clicked(){$("#allow_upload_preset").prop("checked",!1);$("#upload_option").addClass("d-none");$("#btn_upload_preset").addClass("d-none");var a=getActivePreset();document.getElementById("preset_remarks").value=a.memo;document.getElementById("preset_remarks").classList.remove("is-valid");if(a=loadLocalStorage("presets"))if(a=a.find(function(b){return b[0]===getActivePreset().id})){document.getElementById("input_preset_name").value=a[1];a=$("#modal_main_preset").find(".btn_commit_preset");
a.text("\u5225\u540d\u3067\u4fdd\u5b58");a.addClass("rename");a.prop("disabled",!0);$("#modal_main_preset").modal("show");return}btn_save_preset_Clicked()}
function btn_memo_Clicked(){var a=getActivePreset(),b="";a&&a.memo&&(b=a.memo);a=document.getElementById("preset_memo");a.value=b;preset_memo_Changed($(a));b=document.getElementById("modal_preset_memo").getElementsByClassName("btn_commit_preset")[0];b.classList.add("d-none");(a=loadLocalStorage("presets"))&&a.find(function(c){return c[0]===getActivePreset().id})&&b.classList.remove("d-none");$("#modal_preset_memo").modal("show")}
function fixedMenuShown(){document.getElementById("main").classList.add("mr-md-5");setting.visibleFixedMenu=!0;saveSetting()}function fixedMenuHidden(){document.getElementById("main").classList.remove("mr-md-5");setting.visibleFixedMenu=!1;saveSetting()}function btn_reference_Clicked(){initializeReference();$("#modal_reference").modal("show")}
function btn_twitter_Clicked(){var a,b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return b=a=MYURL+"?d="+encodePreset(),c=!1,d.yield(postURLData(a).then(function(e){e.error||!e.shortLink?console.log(e):(c=!0,b=e.shortLink)}).catch(function(e){return console.error(e)}),2);c?window.open("https://twitter.com/share?url="+b):inform_danger("\u5171\u6709\u30ea\u30f3\u30af\u306e\u751f\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002");d.jumpToEnd()})}
function btn_undo_Clicked(){var a=getActivePreset(),b=a.history,c=b.index+1;if(!(c>=b.histories.length||document.getElementById("btn_undo").classList.contains("disabled")||document.getElementById("menu_undo").classList.contains("disabled"))){var d=b.histories.concat();expandMainPreset(decodePreset(b.histories[c]));calculate();b.index=c;b.histories=d;updateActivePreset(a);c+1===b.histories.length&&(document.getElementById("btn_undo").classList.add("disabled"),document.getElementById("menu_undo").classList.add("disabled"));
document.getElementById("btn_redo").classList.remove("disabled");document.getElementById("menu_redo").classList.remove("disabled")}}
function btn_redo_Clicked(){var a=getActivePreset(),b=a.history,c=b.index-1;if(!(0>c||document.getElementById("btn_redo").classList.contains("disabled")||document.getElementById("menu_redo").classList.contains("disabled"))){var d=b.histories.concat();expandMainPreset(decodePreset(b.histories[b.index-1]));calculate();b.index=c;b.histories=d;updateActivePreset(a);0>c-1?(document.getElementById("btn_redo").classList.add("disabled"),document.getElementById("menu_redo").classList.add("disabled")):(document.getElementById("btn_redo").classList.remove("disabled"),
document.getElementById("menu_redo").classList.remove("disabled"))}}
function btn_url_shorten_Clicked(){var a,b,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress){a=document.getElementById("btn_url_shorten");b=document.getElementById("input_url");c=b.value.trim();hideTooltip($(a)[0]);if(a.classList.contains("shortening"))return e.return();a.classList.add("shortening");a.textContent="\u77ed\u7e2e\u4e2d";return c?c.match(/^(https?|ftp)(:\/\/[-_.!~*'()a-zA-Z0-9;\/?:@&=+\$,%#]+)$/)?c.match(/^(https:\/\/aircalc.page.link\/)([.!~*'()a-zA-Z0-9;\/?:@&=+\$,%#]+)$/)?
e.jumpTo(2):e.yield(postURLData(c).then(function(f){f.error||!f.shortLink?(b.value="",inform_danger("\u5165\u529b\u3055\u308c\u305fURL\u306e\u77ed\u7e2e\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")):(b.value=f.shortLink,inform_success("URL\u306e\u77ed\u7e2e\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002"))}).catch(function(f){b.value="";inform_danger("\u5165\u529b\u5024\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}),2):(b.value="",(d=readDeckBuilder(c))?(expandMainPreset(d,
0<d[0][0].length,!0,!1),document.getElementById("adapt_stage2").checked=!0,calculate(),showDeckSelector()&&inform_success("\u7de8\u6210\u306e\u53cd\u6620\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002")):readEquipmentJson(c)?(updateItemList(),inform_success("\u6240\u6301\u88c5\u5099\u306e\u53cd\u6620\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002")):readShipJson(c)?inform_success("\u5728\u7c4d\u8266\u5a18\u306e\u53cd\u6620\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002"):inform_danger("\u5165\u529b\u5024\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002"),
e.jumpTo(2)):(b.value="",inform_warning("URL\u3084\u30c7\u30c3\u30ad\u30d3\u30eb\u30c0\u30fc\u5f62\u5f0f\u306e\u6587\u5b57\u5217\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.jumpTo(2))}a.textContent="\u8aad\u307f\u8fbc\u307f";a.classList.remove("shortening");e.jumpToEnd()})}function preset_remarks_Changed(a){400<a.val().trim().length?a.addClass("is-invalid"):(a.removeClass("is-invalid"),a.addClass("is-valid"))}
function preset_memo_Changed(a){preset_remarks_Changed(a);a.removeClass("is-valid");var b=a.val().match(/\n/g);a.attr("rows",b&&b.length?b.length+2:2);document.getElementById("preset_memo_view").innerHTML=AutoLink(a.val().trim())}
function input_deck_Changed(a){var b=a.val().trim(),c=a.closest(".modal-body").find(".btn_load_deck");0===b.length?(a.addClass("is-invalid").removeClass("is-valid"),a.nextAll(".invalid-feedback").text("\u30c7\u30fc\u30bf\u304c\u5165\u529b\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),c.prop("disabled",!0)):(a.removeClass("is-invalid"),c.prop("disabled",!1))}
function output_data_Clicked(a){a.hasClass("is-valid")&&copyInputTextToClipboard(a)&&inform_success("\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002")}function output_data_Changed(a){a.removeClass("is-valid")}
function btn_commit_main_preset_Clicked(){var a=$("#upload_user").val().trim(),b=document.getElementById("input_preset_name").value.trim();$("#allow_upload_preset").prop("checked")&&20<a.length?inform_warning("\u6295\u7a3f\u8005\u540d\u306f20\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"):$("#allow_upload_preset").prop("checked")&&!b?inform_warning("\u7de8\u6210\u540d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"):updateMainPreset()}
function btn_commit_preset_memo_Clicked(){var a=getActivePreset().id,b=loadLocalStorage("presets")||[],c=b.findIndex(function(e){return e[0]===a});if(0<=c){var d=$("#preset_memo").val().trim();400<d.length&&(d=d.slice(0,400),$("#preset_memo").val(d));b[c][3]=d;saveLocalStorage("presets",b);inform_success("\u7de8\u6210\u30e1\u30e2\u306e\u66f4\u65b0\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002")}else inform_success("\u7de8\u6210\u30e1\u30e2\u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}
function select_preset_category_Changed(){400<castInt($("#select_preset_category").val())?($("#select_preset_level").parent().removeClass("d-none"),$("#select_preset_level").val(4)):$("#select_preset_level").parent().addClass("d-none")}
function allow_upload_preset_Clicked(){$("#allow_upload_preset").prop("checked")?($("#upload_option").removeClass("d-none"),$("#modal_main_preset").find(".btn_commit_preset").hasClass("rename")?$("#btn_upload_preset").removeClass("d-none"):$("#btn_upload_preset").addClass("d-none"),$("#upload_user").val(setting.uploadUserName)):($("#upload_option").addClass("d-none"),$("#btn_upload_preset").addClass("d-none"))}
function btn_upload_preset_Clicked(){var a=$("#upload_user").val().trim(),b=document.getElementById("input_preset_name").value.trim();20<a.length?inform_warning("\u6295\u7a3f\u8005\u540d\u306f20\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"):b?updateMainPreset(!0):inform_warning("\u7de8\u6210\u540d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}
function btn_load_deck_Clicked(){var a=$("#input_deck").val().trim();(a=readDeckBuilder(a))?(expandMainPreset(a,0<a[0][0].length,!0,!1),$("#input_deck").removeClass("is-invalid").addClass("is-valid"),document.getElementById("adapt_stage2").checked=!0,showDeckSelector()&&inform_success("\u7de8\u6210\u306e\u53cd\u6620\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002")):($("#input_deck").addClass("is-invalid").removeClass("is-valid"),inform_danger("\u7de8\u6210\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u5165\u529b\u3055\u308c\u305f\u30c7\u30fc\u30bf\u306e\u5f62\u5f0f\u304c\u6b63\u3057\u304f\u306a\u3044\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002"))}
function btn_output_url_Clicked(){var a,b,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.setCatchFinallyBlocks(2),a=$("#output_url"),c=b=MYURL+"?d="+encodePreset(),d=!1,e.yield(postURLData(b).then(function(f){f.error||!f.shortLink?console.log(f):(d=!0,c=f.shortLink)}).catch(function(f){return console.error(f)}),4);if(2!=e.nextAddress)return d?(a.val(c),a.nextAll(".valid-feedback").text("\u751f\u6210\u3057\u307e\u3057\u305f\u3002\u4e0a\u8a18URL\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3055\u308c\u307e\u3059\u3002"),
a.removeClass("is-invalid").addClass("is-valid")):(a.nextAll(".valid-feedback").text("\u751f\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002"),a.addClass("is-invalid").removeClass("is-valid")),e.leaveTryBlock(0);e.enterCatchBlock();$("#output_url").addClass("is-invalid").removeClass("is-valid");return e.return()})}
function btn_output_deck_Clicked(){var a=$("#output_deck");a.nextAll(".valid-feedback").text("");a.removeClass("is-invalid").removeClass("is-valid");var b=createFriendFleetPreset(),c=createLandBasePreset(),d=document.getElementById("without_disabled_ship").checked;b=convertToDeckBuilder(b,c,d);$("#output_deck").val(b);b?(a.nextAll(".valid-feedback").text("\u751f\u6210\u3057\u307e\u3057\u305f\u3002\u4e0a\u8a18\u6587\u5b57\u5217\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3055\u308c\u307e\u3059\u3002"),
a.removeClass("is-invalid").addClass("is-valid")):a.addClass("is-invalid").removeClass("is-valid")}function open_deckBuilder(){var a=createFriendFleetPreset(),b=createLandBasePreset(),c=document.getElementById("without_disabled_ship").checked;window.open("http://kancolle-calc.net/deckbuilder.html?predeck="+convertToDeckBuilder(a,b,c))}
function open_Jervis(){var a=createFriendFleetPreset(),b=createLandBasePreset(),c=document.getElementById("without_disabled_ship").checked;window.open("https://jervis.vercel.app/?predeck="+convertToDeckBuilder(a,b,c))}
function simulatorTab_Clicked(a){if(a[0].dataset.presetid){var b=loadLocalStorage("activePresets").presets.find(function(d){return d.id===a[0].dataset.presetid});b&&(expandMainPreset(decodePreset(b.history.histories[b.history.index])),calculate())}else{b={id:getUniqueId(),name:getMaxUntitled(),history:{index:0,histories:["Noi6BpgWgRnX4wtOC2o6ZzgAZL6HhG4QBEZ4ccpEcAZgIYA2AzgKaR7E8kQDMxLEA"]},memo:""};var c=loadLocalStorage("activePresets");c||(c={activeId:"",presets:[]});c.presets.push(b);c.activeId=
b.id;saveLocalStorage("activePresets",c);$("#fleet_tab_container .fleet_tab").tooltip("hide");$("#fleet_tab_container .fleet_tab").tooltip("dispose");setTab();expandMainPreset(decodePreset(b.history.histories[0]));calculate()}}
function simulatorActiveTab_Clicked(a){a[0].dataset.presetid&&loadLocalStorage("activePresets").presets.find(function(b){return b.id===a[0].dataset.presetid})&&(a.addClass("editting"),a.find(".fleet_name").addClass("d-none"),a.find(".fleet_name_input").removeClass("d-none"),a.find(".fleet_name_input").select())}
function fleet_name_input_Changed(a){var b=a.closest(".fleet_tab"),c=b[0].dataset.presetid,d=loadLocalStorage("presets")||[];b.removeClass("editting");b.find(".fleet_name").removeClass("d-none");b.find(".fleet_name_input").addClass("d-none");var e=d.findIndex(function(g){return g[0]===c});if(0<=e){var f=a.val().trim();f&&d[e][1]!==f&&(50<f.length&&(f=f.slice(0,50),a.val(f)),d[e][1]=f,b.find(".fleet_name").text(f),saveLocalStorage("presets",d),inform_success("\u7de8\u6210\u540d\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002"))}else b=
getActivePreset(),(d=a.val().trim())&&b?(50<d.length&&(d=d.slice(0,50),a.val(d)),b.name=d,updateActivePreset(b),setTab(),inform_success("\u7de8\u6210\u540d\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002")):inform_warning("\u7de8\u6210\u540d\u79f0\u5909\u66f4\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}
function showDeckSelector(){if(loadedDeckBuilders&&2>=loadedDeckBuilders.length)return!0;for(var a=document.createDocumentFragment(),b=0;b<loadedDeckBuilders.length;b++){var c=loadedDeckBuilders[b][0],d=loadedDeckBuilders[b][1],e=createDiv("fleet_selectable general_tr m-1 p-2");2>c&&e.classList.add("selected");3<=loadedDeckBuilders.length&&2<=c&&e.classList.add("disabled");e.dataset.dataIndex=b;var f=createDiv("deck_header ml-1 d-flex"),g=createDiv("align-self-center");g.innerHTML='<i class="fas fa-checkbox-unchecked"></i><i class="fas fa-checkbox-checked"></i>';
f.appendChild(g);g=createDiv("ml-2 align-self-center");g.textContent="\u7b2c"+(c+1)+"\u8266\u968a";f.appendChild(g);e.appendChild(f);c=createDiv("d-flex flex-wrap mt-1");for(f=0;f<d.length;f++)if(g=d[f],0<g[0]){var h=document.createElement("img");h.className="ship_image";h.width=100;h.height=25;h.src="../img/ship/"+g[0]+".png";c.appendChild(h)}e.appendChild(c);a.appendChild(e)}document.getElementById("deck_list").innerHTML="";document.getElementById("deck_list").appendChild(a);document.getElementById("btn_include_deck").disabled=
!1;$("#modal_include_selector").modal("show");return!1}function fleet_selectable_Clicked(a){var b=$(".fleet_selectable.selected");a.hasClass("selected")?(a.removeClass("selected"),$(".fleet_selectable.disabled").removeClass("disabled")):2>b.length&&a.addClass("selected");b=$(".fleet_selectable.selected");document.getElementById("btn_include_deck").disabled=0===b.length||2<b.length;2<=b.length&&$(".fleet_selectable:not(.selected)").addClass("disabled")}
function btn_include_deck_Clicked(){var a=[],b=0;$(".fleet_selectable.selected").each(function(c,d){c=castInt(d.dataset.dataIndex,-1);if(0<=c&&c<loadedDeckBuilders.length){c=loadedDeckBuilders[c][1];d=(c.length&&5<=c[0].length&&2===c[0][6]?7:6)*b++;for(var e=0;e<c.length;e++){var f=c[e];f[2]=d+e;a.push(f)}}});expandMainPreset([[],a,[]],!1,!0,!1);calculate(!1,!0,!1);inform_success("\u9078\u629e\u3055\u308c\u305f\u7de8\u6210\u30c7\u30fc\u30bf\u3092\u53d6\u308a\u8fbc\u307f\u307e\u3057\u305f\u3002");
$("#modal_include_selector").modal("hide")}function initializeReference(){createAvoidPlaneTable();createAirPowerRanking();createDefenceRanking();createRecoverPlaneTable();createFuckingEnemiesRanking()}
function createAvoidPlaneTable(){var a=document.createDocumentFragment(),b=ITEM_DATA.filter(function(g){return 0<g.avoid});b.sort(function(g,h){return g.type===h.type?g.avoid-h.avoid:g.type-h.type});var c={};b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;c={$jscomp$loop$prop$plane$404:c.$jscomp$loop$prop$plane$404},d=b.next())if(c.$jscomp$loop$prop$plane$404=d.value,c.$jscomp$loop$prop$plane$404.avoid){var e=AVOID_TYPE.find(function(g){return function(h){return h.id===g.$jscomp$loop$prop$plane$404.avoid}}(c));
d=document.createElement("tr");var f=document.createElement("td");f.className="text-left";f.innerHTML='<img class="plane_img_sm" src="../img/type/icon'+c.$jscomp$loop$prop$plane$404.itype+'.png">\n\t\t\t\t<span class="ml-1">'+c.$jscomp$loop$prop$plane$404.name+"</span>";d.appendChild(f);f=document.createElement("td");f.textContent=e.name;f.className="text-center";d.appendChild(f);f=document.createElement("td");f.textContent=e.adj[0];d.appendChild(f);f=document.createElement("td");f.textContent=e.adj[1];
d.appendChild(f);e=document.createElement("td");e.innerHTML='<a href="'+encodeWikiURL(c.$jscomp$loop$prop$plane$404.name)+'" target="_blank">wiki</a>';e.className="text-center";d.appendChild(e);a.appendChild(d)}document.getElementById("avoid_plane_table_tbody").innerHTML="";document.getElementById("avoid_plane_table_tbody").appendChild(a)}
function createAirPowerRanking(){var a=document.getElementById("anti_air_ranking_normal_registed").checked,b=loadPlaneStock(),c=ITEM_DATA.filter(function(n){return 0<n.antiAir||0<n.antiBomber||0<n.interception}),d=[],e={};c=$jscomp.makeIterator(c);for(var f=c.next();!f.done;e={$jscomp$loop$prop$plane$406:e.$jscomp$loop$prop$plane$406},f=c.next())if(e.$jscomp$loop$prop$plane$406=f.value,PLANE_TYPE.includes(e.$jscomp$loop$prop$plane$406.type))if(a){if((f=b.find(function(n){return function(m){return m.id===
n.$jscomp$loop$prop$plane$406.id}}(e)))&&!(1>getArraySum(f.num)))for(var g=0;10>=g;g++)if(f.num[g]){var h=new LandBaseItem(e.$jscomp$loop$prop$plane$406.id,18,g,7);h.actualAntiAir=Math.floor(10*h.actualAntiAir)/10;3<=h.actualAntiAir&&d.push(h)}}else f=new LandBaseItem(e.$jscomp$loop$prop$plane$406.id,18,0,7),3<=f.actualAntiAir&&d.push(f);d.sort(function(n,m){return m.airPower!==n.airPower?m.airPower-n.airPower:m.actualAntiAir!==n.actualAntiAir?m.actualAntiAir-n.actualAntiAir:m.radius-n.radius});a=
document.createDocumentFragment();b=1;c=[];for(e={$jscomp$loop$prop$ap$408:getArrayMax(d.map(function(n){return n.airPower}))};0<e.$jscomp$loop$prop$ap$408;e={$jscomp$loop$prop$ap$408:e.$jscomp$loop$prop$ap$408},e.$jscomp$loop$prop$ap$408--)f=d.filter(function(n){return function(m){return m.airPower===n.$jscomp$loop$prop$ap$408}}(e)).length,0<f&&c.push({rank:b++,airPower:e.$jscomp$loop$prop$ap$408,count:f});b=1;e={};c=$jscomp.makeIterator(c);for(f=c.next();!f.done;e={$jscomp$loop$prop$obj$410:e.$jscomp$loop$prop$obj$410},
f=c.next())for(e.$jscomp$loop$prop$obj$410=f.value,f=d.filter(function(n){return function(m){return m.airPower===n.$jscomp$loop$prop$obj$410.airPower}}(e)),g=0;g<f.length;g++){h=f[g];var l='\n\t\t\t\t<div class="d-flex">\n\t\t\t\t<img class="align-self-center plane_img_sm" src="../img/type/icon'+h.itype+'.png">\n\t\t\t\t<div class="align-self-center ml-1">'+h.name+"</div>\n\t\t\t\t\t"+(h.remodel?'<div class="align-self-center text_remodel font_size_12 ml-1"><i class="fas fa-star"></i>+'+h.remodel+
"</div>":"")+"\n\t\t\t\t</div>",k=document.createElement("tr");k.innerHTML="\n\t\t\t\t"+(0===g?'<td class="text-center" rowspan="'+e.$jscomp$loop$prop$obj$410.count+'">'+b+"\u4f4d</td>":"")+'\n\t\t\t\t<td class="text-left">'+l+"</td>\n\t\t\t\t<td>"+h.radius+"</td>\n\t\t\t\t"+(0===g?'<td rowspan="'+e.$jscomp$loop$prop$obj$410.count+'">'+h.actualAntiAir+"</td>":"")+"\n\t\t\t\t"+(0===g?'<td rowspan="'+e.$jscomp$loop$prop$obj$410.count+'">'+h.airPower+"</td>":"")+'\n\t\t\t\t<td class="text-center"><a href="'+
encodeWikiURL(h.name)+'" target="_blank">wiki</a></td>';a.appendChild(k);b++}document.getElementById("plane_aa_ranking_table_tbody").innerHTML="";document.getElementById("plane_aa_ranking_table_tbody").appendChild(a)}
function createDefenceRanking(){var a=document.getElementById("anti_air_ranking_defense_registed").checked,b=loadPlaneStock(),c=ITEM_DATA.filter(function(n){return FIGHTERS.includes(n.type)}),d=[],e={};c=$jscomp.makeIterator(c);for(var f=c.next();!f.done;e={$jscomp$loop$prop$plane$412:e.$jscomp$loop$prop$plane$412},f=c.next())if(e.$jscomp$loop$prop$plane$412=f.value,a){if((f=b.find(function(n){return function(m){return m.id===n.$jscomp$loop$prop$plane$412.id}}(e)))&&!(1>getArraySum(f.num)))for(var g=
0;10>=g;g++)if(f.num[g]){var h=new LandBaseItem(e.$jscomp$loop$prop$plane$412.id,18,g,7);d.push(h)}}else f=new LandBaseItem(e.$jscomp$loop$prop$plane$412.id,18,0,7),d.push(f);d.sort(function(n,m){return m.defenseAirPower!==n.defenseAirPower?m.defenseAirPower-n.defenseAirPower:m.antiBomber-n.antiBomber});a=1;c=[];for(b={$jscomp$loop$prop$airPower$414:300};0<b.$jscomp$loop$prop$airPower$414;b={$jscomp$loop$prop$airPower$414:b.$jscomp$loop$prop$airPower$414},b.$jscomp$loop$prop$airPower$414--)e=d.filter(function(n){return function(m){return m.defenseAirPower===
n.$jscomp$loop$prop$airPower$414}}(b)).length,0<e&&c.push({rank:a++,defenseAirPower:b.$jscomp$loop$prop$airPower$414,count:e});b=document.createDocumentFragment();a=1;e={};c=$jscomp.makeIterator(c);for(f=c.next();!f.done;e={$jscomp$loop$prop$obj$416:e.$jscomp$loop$prop$obj$416},f=c.next())for(e.$jscomp$loop$prop$obj$416=f.value,f=d.filter(function(n){return function(m){return m.defenseAirPower===n.$jscomp$loop$prop$obj$416.defenseAirPower}}(e)),g=0;g<f.length;g++){h=f[g];var l='\n      <div class="d-flex">\n        <img class="align-self-center plane_img_sm" src="../img/type/icon'+
h.itype+'.png">\n        <div class="align-self-center ml-1 '+(ROCKETS.includes(h.id)?"special_item":"")+'">'+h.name+"</div>\n        "+(h.remodel?'<div class="align-self-center text_remodel font_size_12 ml-1"><i class="fas fa-star"></i>+'+h.remodel+"</div>":"")+"\n      </div>",k=document.createElement("tr");k.innerHTML="\n\t\t\t\t"+(0===g?'<td class="text-center" rowspan="'+e.$jscomp$loop$prop$obj$416.count+'">'+a+"\u4f4d</td>":"")+'\n\t\t\t\t<td class="text-left">'+l+"</td>\n\t\t\t\t<td>"+h.antiBomber+
"</td>\n\t\t\t\t"+(0===g?'<td rowspan="'+e.$jscomp$loop$prop$obj$416.count+'">'+(h.antiAir+h.interception+2*h.antiBomber)+"</td>":"")+"\n\t\t\t\t"+(0===g?'<td rowspan="'+e.$jscomp$loop$prop$obj$416.count+'">'+h.defenseAirPower+"</td>":"")+'\n\t\t\t\t<td class="text-center"><a href="'+encodeWikiURL(h.name)+'" target="_blank">wiki</a></td>';b.appendChild(k);a++}document.getElementById("plane_defense_ranking_table_tbody").innerHTML="";document.getElementById("plane_defense_ranking_table_tbody").appendChild(b)}
function createFuckingEnemiesRanking(){if(!document.getElementById("fucking_enemie_table_tbody").innerHTML){var a=ENEMY_DATA.map(function(p){var q=new Battle;q.enemies=[new Enemy(p.id)];q.createStage2Table();return q});a.sort(function(p,q){var v=p.stage2[0][1][0],t=q.stage2[0][1][0];if(v!==t)return t-v;v=p.enemies[0].antiAirBonus;t=q.enemies[0].antiAirBonus;if(v!==t)return t-v;v=p.stage2[0][0][0];t=q.stage2[0][0][0];return v!==t?t-v:q.enemies[0].id-p.enemies[0].id});var b=document.createDocumentFragment(),
c=document.createDocumentFragment(),d=1;a=$jscomp.makeIterator(a);for(var e=a.next();!e.done;e=a.next()){e=e.value;var f=e.enemies[0].id,g=ANTIAIR_CUTIN_ENEMY.includes(f),h=document.createElement("tr"),l=document.createElement("td");l.className="text-center";l.textContent=d+"\u4f4d";var k=document.createElement("td");k.dataset.enemyid=f;k.className="text-left enemy_info_tr";k.innerHTML='\n\t\t<div class="d-flex">\n\t\t\t<div class="align-self-center"><img class="enemy_name_img" src="../img/enemy/'+
f+'.png"></div>\n\t\t\t<div class="ml-1 align-self-center">\n\t\t\t\t<div class="text-primary font_size_11">ID: '+(1500+f)+'</div>\n\t\t\t\t\t<div class="'+(g?"special_item":"")+'">\n\t\t\t\t\t\t'+drawEnemyGradeColor(e.enemies[0].name)+"\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t</div>";f=document.createElement("td");f.textContent=e.stage2[0][1];g=document.createElement("td");g.textContent=(100*e.stage2[0][0]).toFixed(1);var n=document.createElement("td");n.textContent=e.enemies[0].antiAirBonus;var m=
document.createElement("td");m.textContent=e.enemies[0].antiAirWeight;h.appendChild(l);h.appendChild(k);h.appendChild(f);h.appendChild(g);h.appendChild(n);h.appendChild(m);100>d?b.appendChild(h):c.appendChild(h);d++}document.getElementById("fucking_enemie_table_tbody").innerHTML="";document.getElementById("fucking_enemie_table_zako_tbody").innerHTML="";document.getElementById("fucking_enemie_table_tbody").appendChild(b);document.getElementById("fucking_enemie_table_zako_tbody").appendChild(c)}}
function createRecoverPlaneTable(){var a=document.createDocumentFragment(),b=ITEM_DATA.filter(function(h){return PLANE_TYPE.includes(h.type)});document.getElementById("recover_planes_fighter").checked||(b=b.filter(function(h){return!FIGHTERS.includes(h.type)}));document.getElementById("recover_planes_attacker").checked||(b=b.filter(function(h){return!ATTACKERS.includes(h.type)}));document.getElementById("recover_planes_scouter").checked||(b=b.filter(function(h){return!RECONNAISSANCES.includes(h.type)}));
b.sort(function(h,l){return h.grow===l.grow?h.type-l.type:h.grow-l.grow});for(var c=[],d={$jscomp$loop$prop$c$418:15};0<d.$jscomp$loop$prop$c$418;d={$jscomp$loop$prop$c$418:d.$jscomp$loop$prop$c$418},d.$jscomp$loop$prop$c$418--){var e=b.filter(function(h){return function(l){return l.grow===h.$jscomp$loop$prop$c$418}}(d));e.length&&c.push({c:d.$jscomp$loop$prop$c$418,planes:e})}b=$jscomp.makeIterator(c);for(c=b.next();!c.done;c=b.next())for(c=c.value,d=0;d<c.planes.length;d++){e=c.planes[d];var f=
document.createElement("tr");if(0===d){var g=document.createElement("td");g.textContent=getRequiredgBattleCountString(c.c);g.className="text-center";g.rowSpan=c.planes.length;f.appendChild(g)}g=document.createElement("td");g.className="text-left";g.innerHTML='<img class="plane_img_sm" src="../img/type/icon'+e.itype+'.png">\n\t\t\t\t<span class="ml-1">'+e.name+"</span>";f.appendChild(g);g=document.createElement("td");g.innerHTML='<a href="'+encodeWikiURL(e.name)+'" target="_blank">wiki</a>';g.className=
"text-center";f.appendChild(g);a.appendChild(f)}document.getElementById("recover_plane_table_tbody").innerHTML="";document.getElementById("recover_plane_table_tbody").appendChild(a)}function encodeWikiURL(a){"\u5929\u5c71\u4e00\u4e8c\u578b(\u6751\u7530\u968a)"===a&&(a="\u5929\u5c71(\u6751\u7530\u968a)");return WIKIURL+a.replace("/","\uff0f").replace("+","\uff0b")}
document.addEventListener("DOMContentLoaded",function(){initialize(function(){var a=getUrlParams(),b=!1;if(a.hasOwnProperty("d"))expandMainPreset(decodePreset(a.d)),b=!0;else if(a.hasOwnProperty("predeck")||a.hasOwnProperty("lb")){a.hasOwnProperty("predeck")&&(b=readDeckBuilder(a.predeck))&&(expandMainPreset(b,0<b[0][0].length,!0,!1),document.getElementById("adapt_stage2").checked=!0);if(a.hasOwnProperty("lb"))try{var c=JSON.parse(decodeURIComponent(a.lb));2<=c.length&&expandMainPreset([c,[],[]],
!0,!1,!1)}catch(d){}b=!0}else if(a.hasOwnProperty("p"))expandMainPreset(decodePreset(a.p));else if(a=getActivePreset(),a.id)try{expandMainPreset(decodePreset(a.history.histories[a.history.index]))}catch(d){deleteLocalStorage("activePresets");window.location.href="../list/";return}else{window.location.href="../list/";return}b&&(a={id:getUniqueId(),name:"\u5916\u90e8\u30c7\u30fc\u30bf",history:{index:0,histories:[]},memo:""},b=loadLocalStorage("activePresets")||{activeId:"",presets:[]},5<b.presets.filter(function(d){return"\u5916\u90e8\u30c7\u30fc\u30bf"===
d.name}).length&&4===Math.floor(5*Math.random())&&(a.name="\u304a\u305d\u3068\u30c7\u30fc\u30bf"),b.presets.push(a),b.activeId=a.id,saveLocalStorage("activePresets",b),setTab());calculate();showDeckSelector()});$(document).keyup(function(a){isCtrlPress&&17===a.keyCode&&(isCtrlPress=!1)});$(document).keydown(function(a){isCtrlPress||17!==a.keyCode||(isCtrlPress=!0);isCtrlPress&&"z"===a.key?btn_undo_Clicked():isCtrlPress&&"y"===a.key&&btn_redo_Clicked()});document.getElementById("btn_top").addEventListener("click",
function(){window.location.href="../list/"});$("#header").on("click",".fleet_tab:not(.active)",function(){simulatorTab_Clicked($(this))});$("#header").on("click",".fleet_tab.active:not(.editting)",function(){simulatorActiveTab_Clicked($(this))});$("#header").on("blur",".fleet_name_input",function(){fleet_name_input_Changed($(this))});$(".modal").on("hide.bs.modal",function(){modal_Closed($(this))});$(".modal").on("show.bs.modal",function(){$(".btn_preset").tooltip("hide")});$(".modal").on("click",
".toggle_display_type",function(){toggle_display_type_Clicked($(this))});$(".modal").on("input",".preset_name",function(){preset_name_Changed($(this))});$(".modal").on("blur",".preset_name",function(){preset_name_Changed($(this))});$(".modal.sub_modal").on("hidden.bs.modal",function(){$(document.body).addClass("modal-open")});$(".slot_select_parent").on("show.bs.dropdown",function(){slot_select_parent_Show($(this))});$(".slot_select_parent").on("hide.bs.dropdown",function(){slot_select_parent_Close($(this))});
$(".remodel_select_parent").on("hide.bs.dropdown",function(){remodelSelect_Changed($(this))});$(".remodel_select_parent").on("show.bs.dropdown",function(){remodelSelect_Shown($(this))});$(".prof_select_parent").on("show.bs.dropdown",function(){profSelect_Shown($(this))});$("#main").on("show.bs.collapse",".collapse",function(){$(this).prev().find(".fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down")});$("#main").on("hide.bs.collapse",".collapse",function(){$(this).prev().find(".fa-chevron-down").removeClass("fa-chevron-down").addClass("fa-chevron-up")});
$("#main").on("shown.bs.collapse",".collapse",function(){$(this).removeClass("tmpHide")});$("#main").on("focus",".slot_input",function(){$(this).select()});$("#main").on("input",".slot_input",function(){slot_input_Changed($(this))});$("#main").on("input",".slot_range",function(){slot_range_Changed($(this))});$("#main").on("click",".remodel_item",function(){$(this).addClass("remodel_item_selected")});$("#main").on("click",".btn_plane_preset",function(){btn_plane_preset_Clicked($(this))});$("#main").on("click",
".btn_capture",function(){btn_capture_Clicked($(this))});$("#main").on("click",".btn_reset_content",function(){btn_reset_content_Clicked($(this))});$("#main").on("click",".btn_content_trade",function(){btn_content_trade_Clicked($(this))});$("#main").on("click",".btn_commit_trade",commit_content_order);$("#main").on("click",".btn_ex_setting",function(){btn_ex_setting_Clicked($(this))});$("#main").on("click",".btn_lb_target",btn_lb_target_Clicked);$("#main").on("click",".lb_target_button",btn_lb_target_Clicked);
$("#main_header_info").on("click","input",function(){display_special_Changed($(this))});$("#site_warning").on("click",".cur_pointer",function(){$("#site_warning").removeClass("d-flex").addClass("d-none")});$("#landBase").on("click",".btn_air_raid",btn_air_raid_Clicked);$("#landBase").on("click","#alert_air_raid_button",btn_air_raid_Clicked);$("#landBase").on("click",".btn_supply",btn_supply_Clicked);$("#landBase_content").on("change",".ohuda_select",function(){calculate(!0,!1,!1)});$("#landBase_content").on("click",
".btn_remove_plane",function(){btn_remove_lb_plane_Clicked($(this))});$("#landBase_content").on("click",".btn_reset_landBase",function(){btn_reset_landBase_Clicked($(this))});$("#landBase_content").on("click",".prof_item",function(){proficiency_Changed($(this))});$("#landBase_content").on("click",".btn_show_contact_rate_lb",function(){btn_show_contact_rate_lb_Clicked($(this))});$("#landBase_content").on("click",".btn_toggle_lb_info",function(){btn_toggle_lb_info_Clicked($(this))});$("#landBase_content").on("click",
"#toggle_def_mode",toggle_def_mode_Checked);$("#landBase_content").on("click",".simple_lb_progress",function(){simple_lb_progress_Clicked($(this))});$("#landBase_content").on("click",".plane_name",function(){plane_name_Clicked($(this))});$("#landBase_content").on("touchend",".plane_name",function(){plane_name_Clicked($(this))});$("#landBase_content").on("input","#defense_ap_c",function(){calculate(!0,!1,!1)});$("#friendFleet_content").on("click",".plane_name",function(){plane_name_Clicked($(this))});
$("#friendFleet_content").on("touchend",".plane_name",function(){plane_name_Clicked($(this))});$("#friendFleet_content").on("click",".btn_ship_create",function(){btn_ship_create_Clicked($(this))});$("#friendFleet_content").on("click",".btn_reset_ship_plane",function(){btn_reset_ship_plane_Clicked($(this))});$("#friendFleet_content").on("click",".ship_name_span",function(){ship_name_span_Clicked($(this))});$("#friendFleet_content").on("click",".btn_remove_ship",function(){btn_remove_ship_Clicked($(this))});
$("#friendFleet_content").on("click",".btn_remove_plane",function(){btn_remove_ship_plane_Clicked($(this))});$("#friendFleet_content").on({mouseenter:function(){$(this).closest(".ship_tab").find(".remove_line").addClass("ready")},mouseleave:function(){$(this).closest(".ship_tab").find(".remove_line").removeClass("ready")}},".btn_reset_ship_plane");$("#friendFleet_content").on("click",".prof_item",function(){proficiency_Changed($(this))});$("#friendFleet_content").on("click",".btn_ship_toggle",function(){btn_ship_toggle_Clicked($(this))});
$("#friendFleet_content").on("click",".ship_disabled",function(){ship_disabled_Changed($(this))});$("#friendFleet_content").on("click","#union_fleet",union_fleet_Checked);$("#friendFleet_content").on("click","#yugeki_fleet",yugeki_fleet_Checked);$("#friendFleet_content").on("click","#visible_anti_air_status",visible_anti_air_status_Clicked);$('#friendFleet_content .nav-link[data-toggle="tab"]').on("shown.bs.tab",fleet_select_tab_Clicked);$("#friendFleet_content").on("click",".plane_lock",function(){plane_lock_Clicked($(this))});
$("#friendFleet_content").on("click",".plane_unlock",function(){plane_unlock_Clicked($(this))});$("#friendFleet_content").on("click",".slot_ini",function(){slot_ini_Clicked($(this))});$("#friendFleet_content").on("click",".btn_show_contact_rate",function(){btn_show_contact_rate_Clicked()});$("#friendFleet_content").on("click",".btn_antiair_input",btn_antiair_input_Clicked);$("#friendFleet_content").on("click",".form_ship_level",function(){form_ship_level_Clicked($(this))});$("#friendFleet_content").on("click",
".form_ship_luck",function(){form_ship_luck_Clicked($(this))});$("#friendFleet_content").on("input","#admin_lv",admin_lv_Changed);$("#enemyFleet_content").on("change",".cell_type",function(){cell_type_Changed($(this))});$("#enemyFleet_content").on("change",".formation",function(){calculate(!1,!1,!0)});$("#enemyFleet_content").on("click",".enemy_index",function(){enemy_index_Clicked($(this))});$("#enemyFleet_content").on("click",".enemy_name",function(){enemy_name_Clicked($(this))});$("#enemyFleet_content").on("click",
".btn_reset_battle",function(){btn_reset_battle_Clicked($(this))});$("#enemyFleet_content").on("click","#btn_world_expand",btn_world_expand_Clicked);$("#enemyFleet_content").on("click",".btn_enemy_preset",function(){btn_enemy_preset_Clicked($(this))});$("#enemyFleet_content").on("click",".btn_stage2",function(){btn_stage2_Clicked($(this))});$("#enemyFleet_content").on("change","#battle_count",function(){battle_count_Changed($(this))});$("#enemyFleet_content").on("click",'input[name="enemy_fleet_display_mode"]',
function(){enemy_fleet_display_mode_Changed($(this))});$("#result").on("click","#btn_calculate",function(){calculate(!1,!1,!1)});$("#result_content").on("click","#btn_more_calc",btn_more_calc_Clicked);$("#result_content").on("click","#display_battle_tab .nav-item",function(){display_battle_tab_Changed($(this))});$("#result_content").on("click","#empty_slot_invisible",function(){calculate(!1,!1,!1)});$("#result_content").on("click","#display_setting .custom-check",display_result_Changed);$("#result_content").on("click",
"#shoot_down_table_tbody tr",function(){fleet_slot_Clicked($(this))});$("#result_content").on("click","#rate_table .land_base_detail",function(){land_base_detail_Clicked($(this))});$("#result_content").on("click","#result_bar .progress_area",function(){land_base_bar_Clicked($(this))});$("#result_content").on("click","#enemy_shoot_down_tbody .td_detail_slot",function(){enemy_slot_Clicked($(this))});$("#result_content").on("click",".btn_antiair_input",btn_antiair_input_Clicked);$("#result_content").on("click",
"#adapt_stage2",function(){calculate(!1,!0,!1)});$("#result_content").on("change","#fleet_formation",function(){calculate(!1,!1,!1)});$("#config_content").on("focus","#calculate_count",function(){$(this).select()});$("#config_content").on("input","#calculate_count",function(){calculate_count_Changed($(this))});$("#config_content").on("click","#innerProfSetting .custom-check",function(){innerProfSetting_Clicked($(this))});$("#config_content").on("click","#clipboard_mode",clipboard_mode_Clicked);$("#config_content").on("click",
".dropdown-item",function(){init_proficiency_Changed($(this))});$("#config_content").on("click","#btn_reset_selected_plane_history",btn_reset_selected_plane_history_Clicked);$("#config_content").on("click","#btn_reset_selected_ship_history",btn_reset_selected_ship_history_Clicked);$("#ship_stock").on("click",".stock_td_fav",function(a){ship_stock_td_fav_Clicked($(this));a.stopPropagation()});$("#plane_stock").on("click",".stock_td_fav",function(a){stock_td_fav_Clicked($(this));a.stopPropagation()});
$("#manage_manual_data").on("show.bs.collapse",".collapse",manage_manual_enemu_content_Shown);$("#manage_manual_data").on("click",".manual_enemy_tr",function(){manul_enemy_Clicked($(this))});$("#modal_plane_select").on("click",".plane",function(){modal_plane_Selected($(this))});$("#modal_plane_select").on("click",".btn_remove",function(){modal_plane_select_btn_remove_Clicked($(this))});$("#modal_plane_select").on("click","#plane_type_select .item_type",function(){plane_type_select_Changed($(this))});
$("#modal_plane_select").on("click","#fav_only",fav_only_Checked_Chenged);$("#modal_plane_select").on("click","#disp_in_stock",disp_in_stock_Checked_Chenged);$("#modal_plane_select").on("click","#divide_stock",divide_stock_Checked_Chenged);$("#modal_plane_select").on("click","#disp_equipped",disp_equipped_Checked_Chenged);$("#modal_plane_select").on("click","#disp_special",function(){plane_type_select_Changed()});$("#modal_plane_select").on("input","#plane_word",plane_word_TextChanged);$("#modal_plane_select").on("change",
"#plane_sort_select",function(){sort_Changed($(this))});$("#modal_plane_select").on("change","#plane_filter_key_select",plane_filter_Changed);$("#modal_plane_select").on("change","#plane_filter_value",plane_filter_Changed);$("#modal_plane_select").on("click",".toggle_display_type",function(){plane_type_select_Changed()});$("#modal_plane_select").on("click","#plane_table_thead .sortable_td",function(){sortable_td_Clicked($(this))});$("#modal_plane_preset").on("click",".preset_tr",function(){plane_preset_tr_Clicked($(this))});
$("#modal_plane_preset").on("click",".btn_commit_preset",function(){btn_commit_plane_preset_Clicked($(this))});$("#modal_plane_preset").on("click",".btn_delete_preset",function(){btn_delete_plane_preset_Clicked($(this))});$("#modal_plane_preset").on("click",".btn_expand_preset",btn_expand_plane_preset_Clicked);$("#modal_ship_select").on("click",".ship_tr:not(.ship_tr_disabled)",function(){modal_ship_Selected($(this))});$("#modal_ship_select").on("click",".btn_remove",function(){modal_ship_select_btn_remove_Clicked($(this))});
$("#modal_ship_select").on("click","#display_final",createShipTable);$("#modal_ship_select").on("click","#frequent_ship",createShipTable);$("#modal_ship_select").on("click","#fav_only_ship",createShipTable);$("#modal_ship_select").on("click","#disp_in_stock_ship",createShipTable);$("#modal_ship_select").on("click","#disp_equipped_ship",createShipTable);$("#modal_ship_select").on("click","#disp_daihatsu_ship",createShipTable);$("#modal_ship_select").on("click","#disp_kamisha_ship",createShipTable);
$("#modal_ship_select").on("click","#disp_slot_ex_ship",createShipTable);$("#modal_ship_select").on("click","#ship_type_select .ship_type",function(){ship_type_select_Changed($(this))});$("#modal_ship_select").on("click",".toggle_display_type",createShipTable);$("#modal_ship_select").on("input","#ship_word",ship_word_TextChanged);$("#modal_enemy_select").on("click",".modal-body .enemy",function(){modal_enemy_Selected($(this))});$("#modal_enemy_select").on("click",".btn_remove",function(){modal_enemy_select_btn_remove($(this))});
$("#modal_enemy_select").on("click",".toggle_display_type",createEnemyTable);$("#modal_enemy_select").on("change","#enemy_type_select",createEnemyTable);$("#modal_enemy_select").on("input","#enemy_word",enemy_word_TextChanged);$("#modal_enemy_pattern").on("show.bs.modal",modal_enemy_pattern_Shown);$("#modal_enemy_pattern").on("click",".node_tr",function(){node_tr_Clicked($(this))});$("#modal_enemy_pattern").on("click","#btn_zoom_map",btn_zoom_map_Clicked);$("#modal_enemy_pattern").on("change","#map_select",
createNodeSelect);$("#modal_enemy_pattern").on("change","#node_select",createEnemyPattern);$("#modal_enemy_pattern").on("change","#select_difficulty",createNodeSelect);$("#modal_enemy_pattern").on("click","#btn_expand_enemies",btn_expand_enemies);$("#modal_enemy_pattern").on("click","#btn_continue_expand",btn_continue_expand_Clicked);$("#modal_enemy_pattern").on("click",".node",function(){node_Clicked($(this))});$("#modal_enemy_pattern").on("click","#enemy_pattern_select .nav-link:not(.active)",function(){pattern_Changed($(this))});
$("#modal_enemy_pattern").on("click",'input[name="enemy_display_mode"]',function(){enemy_display_mode_Changed($(this))});$("#modal_enemy_pattern").on("dblclick",".node",node_DoubleClicked);$("#modal_enemy_pattern").on("dblclick",".node_tr",node_DoubleClicked);$("#modal_enemy_pattern").on("dblclick","#enemy_pattern_select .nav-link.active",node_DoubleClicked);$("#modal_main_preset").on("show.bs.modal",modal_main_preset_Shown);$("#modal_main_preset").on("change","#select_preset_category",select_preset_category_Changed);
$("#modal_main_preset").on("click",".btn_commit_preset",btn_commit_main_preset_Clicked);$("#modal_main_preset").on("click","#allow_upload_preset",allow_upload_preset_Clicked);$("#modal_main_preset").on("click","#btn_upload_preset",btn_upload_preset_Clicked);$("#modal_main_preset").on("input","#input_preset_name",function(){preset_name_Changed($(this))});$("#modal_main_preset").on("input","#preset_remarks",function(){preset_remarks_Changed($(this))});$("#modal_share").on("click",".btn_load_deck",btn_load_deck_Clicked);
$("#modal_share").on("input","#input_deck",function(){input_deck_Changed($(this))});$("#modal_share").on("focus","#input_deck",function(){$(this).select()});$("#modal_share").on("click",".btn_output_url",btn_output_url_Clicked);$("#modal_share").on("click",".btn_output_deck",btn_output_deck_Clicked);$("#modal_share").on("focus","#output_url",function(){$(this).select()});$("#modal_share").on("focus","#output_deck",function(){$(this).select()});$("#modal_share").on("input","#output_url",function(){output_data_Changed($(this))});
$("#modal_share").on("input","#output_deck",function(){output_data_Changed($(this))});$("#modal_share").on("click","#output_url",function(){output_data_Clicked($(this))});$("#modal_share").on("click","#output_deck",function(){output_data_Clicked($(this))});$("#modal_share").on("click","#open_deckBuilder",open_deckBuilder);$("#modal_share").on("click","#open_jervis",open_Jervis);$("#modal_result_detail").on("click","#btn_calculate_detail",btn_calculate_detail);$("#modal_result_detail").on("change",
"#detail_calculate_count",function(){return $("#btn_calculate_detail").prop("disabled",!1)});$("#modal_result_detail").on("change",".custom-radio",btn_calculate_detail);$("#modal_result_detail").on("change","#target_enemy",btn_calculate_detail);$("#modal_result_detail").on("change","#enabled_manual_stage2",btn_calculate_detail);$("#modal_result_detail").on("change","#aa_cutin_miss",btn_calculate_detail);$("#modal_result_detail").on("click","#critical_hit",stage3PowerCalculate);$("#modal_result_detail").on("click",
"#stage3_all_slot",stage3PowerCalculate);$("#modal_result_detail").on("click","#enabled_rikutei",stage3PowerCalculate);$("#modal_result_detail").on("click","#enabled_rikutei_z",stage3PowerCalculate);$("#modal_result_detail").on("click","#manual_enemy_union",stage3PowerCalculate);$("#modal_result_detail").on("click","#manual_union_main",stage3PowerCalculate);$("#modal_result_detail").on("click","#manual_union_escort",stage3PowerCalculate);$("#modal_result_detail").on("click","#btn_apply_search",stage3PowerCalculate);
$("#modal_result_detail").on("click","#hp_1",stage3PowerCalculate);$("#modal_result_detail").on("click","#hp_2",stage3PowerCalculate);$("#modal_result_detail").on("click","#jet_phase",stage3PowerCalculate);$("#modal_result_detail").on("change","#contact_bonus",stage3PowerCalculate);$("#modal_result_detail").on("change","#ammo_bonus",stage3PowerCalculate);$("#modal_result_detail").on("change","#manual_enemy_type",manual_enemy_type_Changed);$("#modal_result_detail").on("change","#manual_enemy_id",stage3PowerCalculate);
$("#modal_result_detail").on("input","#stage3_slot",stage3PowerCalculate);$("#modal_result_detail").on("input","#ship_bonus",stage3PowerCalculate);$("#modal_result_detail").on("input","#stage3_remodel",stage3PowerCalculate);$("#modal_result_detail").on("focus",'input[type="number"]:not([readonly])',function(){$(this).select()});$("#modal_result_detail").on("click","#show_detail_slot .nav-item",function(){detail_slot_tab_Changed($(this))});$("#modal_result_detail").on("click",".btn_show_detail:not(.disabled)",
function(){btn_show_detail_Clicked($(this))});$("#modal_result_detail").on("click","#btn_output_slot_dist",btn_output_slot_dist_Clicked);$("#modal_result_detail").on("click","#btn_output_slot_dist_table",btn_output_slot_dist_table_Clicked);$("#modal_collectively_setting").on("click",".btn_remove_plane_all",function(){btn_remove_plane_all_Clicked($(this))});$("#modal_collectively_setting").on("click",".btn_remove_ship_all",btn_remove_ship_all_Clicked);$("#modal_collectively_setting").on("click",".btn_slot_max",
function(){btn_slot_max_Clicked($(this))});$("#modal_collectively_setting").on("click",".btn_slot_min",btn_slot_min_Clicked);$("#modal_collectively_setting").on("click",".btn_slot_default",function(){btn_slot_default_Clicked($(this))});$("#modal_collectively_setting").on("input",".coll_slot_range",function(){coll_slot_range_Changed($(this))});$("#modal_collectively_setting").on("input",".coll_slot_input",function(){coll_slot_input_Changed($(this))});$("#modal_collectively_setting").on("focus",".coll_slot_input",
function(){$(this).select()});$("#modal_collectively_setting").on("click",".btn_remodel",function(){btn_remodel_Clicked($(this))});$("#modal_collectively_setting").on("click",".btn_fighter_prof_max",btn_fighter_prof_max_Clicked);$("#modal_collectively_setting").on("click",".btn_prof",function(){btn_prof_Clicked($(this))});$("#modal_stage2_detail").on("input","#stage2_detail_slot",stage2_slot_input_Changed);$("#modal_stage2_detail").on("change","#stage2_detail_avoid",calculateStage2Detail);$("#modal_stage2_detail").on("input",
"#free_anti_air_weight",function(){free_modify_input_Changed($(this))});$("#modal_stage2_detail").on("input","#free_anti_air_bornus",function(){free_modify_input_Changed($(this))});$("#modal_contact_detail").on("change",".custom-check",contact_detail_redraw);$("#modal_fleet_antiair_input").on("change","#antiair_air_raid",updateFleetStage2Table);$("#modal_fleet_antiair_input").on("change","#fleet_antiair_formation",updateFleetStage2Table);$("#modal_fleet_antiair_input").on("click",".anti_air_cutin_toggle",
function(){anti_air_cutin_toggle_Clicked($(this))});$("#modal_manual_enemy").on("input",".enemy_slot",function(){manual_enemy_input_Changed($(this))});$("#modal_manual_enemy").on("input","#manual_aa_bonus",function(){manual_enemy_input_Changed($(this))});$("#modal_manual_enemy").on("change",".enemy_planes",calculateVirtualEnemy);$("#modal_manual_enemy").on("click","#commit_enemy",commit_enemy_Clicked);$("#modal_manual_enemy").on("click","#rollback_enemy",rollback_enemy_Clicked);$("#modal_lb_target").on("click",
".btn",function(){btn_target_Clicked($(this))});$("#modal_level_input").on("focus",".ship_level_input",function(){$(this).select()});$("#modal_level_input").on("input",".ship_level_input",function(){ship_level_input_Changed($(this))});$("#modal_level_input").on("input",".ship_level_range",function(){ship_level_range_Changed($(this))});$("#modal_level_input").on("click",".btn-sm",function(){level_Clicked($(this))});$("#modal_luck_input").on("focus",".ship_luck_input",function(){$(this).select()});
$("#modal_luck_input").on("input",".ship_luck_input",function(){ship_luck_input_Changed($(this))});$("#modal_luck_input").on("input",".ship_luck_range",function(){ship_luck_range_Changed($(this))});$("#modal_confirm").on("click",".btn_ok",modal_confirm_ok_Clicked);$("#modal_confirm").on("click","#error_str",function(){copyInputTextToClipboard($(this))&&inform_success("\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f")});$("#modal_confirm").on("click","#send_error",sendError);$("#fixed_btns").on("show.bs.collapse",
".collapse",fixedMenuShown);$("#fixed_btns").on("hide.bs.collapse",".collapse",fixedMenuHidden);$("#fixed_btns").on("click",".sub_btn.save",btn_save_preset_Clicked);$("#fixed_btns").on("click",".sub_btn.memo",btn_memo_Clicked);$("#fixed_btns").on("click",".sub_btn.share",function(){$("#modal_share").modal("show")});$("#fixed_btns").on("click",".sub_btn.undo",btn_undo_Clicked);$("#fixed_btns").on("click",".sub_btn.redo",btn_redo_Clicked);$("#fixed_btns").on("click",".sub_btn.go_back",function(){window.location.href=
"../list/"});$("#modal_preset_memo").on("input","#preset_memo",function(){preset_memo_Changed($(this))});$("#modal_preset_memo").on("click",".btn_commit_preset",function(){btn_commit_preset_memo_Clicked($(this))});$("#modal_ship_reserve").on("click","#btn_add_reserve",btn_add_reserve_Clicked);$("#modal_ship_reserve").on("click",".reserve_ship",function(){reserve_ship_Clicked($(this))});$("#modal_ship_reserve").on("click",".btn_remove_reserve",function(a){btn_remove_reserve_Clicked($(this),a)});$("#modal_ship_reserve").on("click",
".btn_reset",btn_reset_reserve_Clicked);$("#modal_include_selector").on("click",".fleet_selectable",function(){fleet_selectable_Clicked($(this))});$("#modal_include_selector").on("click","#btn_include_deck",btn_include_deck_Clicked);$("#modal_reference").on("click","#anti_air_ranking_normal_registed",createAirPowerRanking);$("#modal_reference").on("click","#anti_air_ranking_defense_registed",createDefenceRanking);$("#modal_reference").on("click","#recover_planes_checkes .custom-check",createRecoverPlaneTable);
$("#btn_save_preset").click(btn_save_preset_Clicked);$("#btn_save_preset_sub").click(btn_save_preset_sub_Clicked);$("#btn_reference").click(btn_reference_Clicked);$("#btn_twitter").click(btn_twitter_Clicked);$("#btn_share").click(function(){$("#modal_share").modal("show")});$("#btn_undo").click(btn_undo_Clicked);$("#btn_redo").click(btn_redo_Clicked);$("#input_url").click(function(){$(this).select()});$("#btn_url_shorten").click(btn_url_shorten_Clicked);$("#tool_bar").on({mouseenter:function(){showTooltip($(this)[0],
"\u30c7\u30c3\u30ad\u30d3\u30eb\u30c0\u30fc\u5f62\u5f0f\u306e\u7de8\u6210\u306e\u8aad\u307f\u8fbc\u307f\u3084\u3001URL\u306e\u77ed\u7e2e\u3001\u6240\u6301\u88c5\u5099\u3084\u5728\u7c4d\u8266\u5a18\u60c5\u5831\u306e\u53cd\u6620\u304c\u53ef\u80fd\u3067\u3059\u3002")},mouseleave:function(){hideTooltip($(this)[0])}},"#btn_url_shorten");$("#landBase_content").on({mouseenter:function(){showItemToolTip($(this).parent(),!0)},mouseleave:function(){hideTooltip($(this).parent()[0])}},".plane_img");$("#friendFleet_content").on({mouseenter:function(){showItemToolTip($(this).parent())},
mouseleave:function(){hideTooltip($(this).parent()[0])}},".plane_img");$("#friendFleet_content").on({mouseenter:function(){showTooltip($(this)[0],"\u30ed\u30c3\u30af\u3059\u308b\u3068\u3001\u304a\u307e\u304b\u305b\u914d\u5099\u4f7f\u7528\u6642\u306b\u3053\u306e\u30b9\u30ed\u30c3\u30c8\u306e\u4e0a\u66f8\u304d\u3092\u4fdd\u8b77\u3067\u304d\u307e\u3059\u3002")},mouseleave:function(){hideTooltip($(this)[0])}},".plane_unlock");$("#friendFleet_content").on({mouseenter:function(){showTooltip($(this)[0],
"\u30ed\u30c3\u30af\u4e2d\u3067\u3059\u3002\u304a\u307e\u304b\u305b\u914d\u5099\u4f7f\u7528\u6642\u3001\u3053\u306e\u30b9\u30ed\u30c3\u30c8\u306f\u5909\u66f4\u3055\u308c\u307e\u305b\u3093\u3002")},mouseleave:function(){hideTooltip($(this)[0])}},".plane_lock");$("#friendFleet_content").on({mouseenter:function(){showTooltip($(this)[0],"\u8266\u5a18\u3001\u88c5\u5099\u306f\u7dad\u6301\u3057\u305f\u307e\u307e\u8a08\u7b97\u5bfe\u8c61\u304b\u3089\u7701\u304d\u307e\u3059\u3002")},mouseleave:function(){hideTooltip($(this)[0])}},
".ship_disabled");$("#main").on({mouseenter:function(){showTooltip($(this)[0],"\u6a5f\u4f53\u30d7\u30ea\u30bb\u30c3\u30c8")},mouseleave:function(){hideTooltip($(this)[0])}},".btn_plane_preset");$("#landBase_content").on({mouseenter:function(){showTooltip($(this)[0],"\u88c5\u5099\u30ea\u30bb\u30c3\u30c8")},mouseleave:function(){hideTooltip($(this)[0])}},".btn_reset_landBase");$("#friendFleet_content").on({mouseenter:function(){showTooltip($(this)[0],"\u88c5\u5099\u30ea\u30bb\u30c3\u30c8")},mouseleave:function(){hideTooltip($(this)[0])}},
".btn_reset_ship_plane");$("#friendFleet_content").on({mouseenter:function(){showTooltip($(this)[0],"\u9589\u3058\u308b")},mouseleave:function(){hideTooltip($(this)[0])}},".btn_remove_ship");$("#friendFleet_content").on({mouseenter:function(){showTooltip($(this)[0],"\u8266\u5a18\u4fdd\u7559\u30ea\u30b9\u30c8\u306e\u767b\u9332\u3084\u524a\u9664\u3001\u4fdd\u7559\u30ea\u30b9\u30c8\u304b\u3089\u306e\u5c55\u958b\u3092\u884c\u3044\u307e\u3059\u3002")},mouseleave:function(){hideTooltip($(this)[0])}},".btn_ship_toggle");
$("#modal_ship_reserve").on({mouseenter:function(){showTooltip($(this)[0],"\u8266\u5a18\u4fdd\u7559\u30ea\u30b9\u30c8\u304b\u3089\u524a\u9664\u3057\u307e\u3059\u3002")},mouseleave:function(){hideTooltip($(this)[0])}},".btn_remove_reserve");$("#enemyFleet_content").on({mouseenter:function(){showEnemyStatusToolTip($(this))},mouseleave:function(){hideTooltip($(this)[0])}},".enemy_content");$("#fucking_enemie_table_tbody").on({mouseenter:function(){showEnemyStatusToolTip($(this))},mouseleave:function(){hideTooltip($(this)[0])}},
".enemy_info_tr");$("#result_content").on({mouseenter:function(){shoot_down_table_tbody_MouseEnter($(this))},mouseleave:function(){shoot_down_table_tbody_MouseLeave($(this))}},"#shoot_down_table_tbody td");$("#result_content").on({mouseenter:function(){progress_area_MouseEnter($(this))},mouseleave:function(){progress_area_MouseLeave($(this))}},".progress_area");$("#result_content").on({mouseenter:function(){rate_table_MouseEnter($(this))},mouseleave:function(){rate_table_MouseLeave($(this))}},"#rate_table tbody td");
$("#result_content").on({mouseenter:function(){enemy_shoot_down_table_tbody_MouseEnter($(this))},mouseleave:function(){enemy_shoot_down_table_tbody_MouseLeave($(this))}},"#enemy_shoot_down_tbody td");$("#result_content").on({mouseenter:function(){showEnemyPlaneToolTip($(this))},mouseleave:function(){hideTooltip($(this)[0])}},".img-size-36");$("#enemy_pattern_tbody").on({mouseenter:function(){showEnemyStatusToolTip($(this))},mouseleave:function(){hideTooltip($(this)[0])}},".enemy_pattern_tr");$("#modal_plane_select").on({mouseenter:function(){var a=
$(this);timer=setTimeout(function(){showPlaneBasicToolTip(a)},500)},mouseleave:function(){timer&&clearTimeout(timer);hideTooltip($(this)[0])}},".plane_tr, .plane_tr_disabled");$("#modal_plane_select").on({mouseenter:function(){showTooltip($(this)[0],$(this).find("img").attr("alt"))},mouseleave:function(){hideTooltip($(this)[0])}},".item_type");$(window).resize(function(){timer&&clearTimeout(timer);timer=setTimeout(function(){"none"===$("#lb_tab_select").css("display")||$("#lb_item1").attr("class").includes("tab-pane")?
"none"===$("#lb_tab_select").css("display")&&$("#lb_item1").attr("class").includes("tab-pane")&&($(".lb_tab").removeClass("tab-pane fade").show().fadeIn(),$(".baseNo").addClass("sortable_handle cur_move")):($(".lb_tab").addClass("tab-pane fade"),$(".lb_tab:first").tab("show"),$(".baseNo").removeClass("sortable_handle cur_move"))},50)});Sortable.create($("#main")[0],{handle:".trade_enabled",animation:200,scroll:!0,onEnd:main_contents_Sortable_End});Sortable.create($("#battle_result")[0],{handle:".drag_handle",
animation:200,scroll:!0});Sortable.create($("#lb_tab_parent")[0],{handle:".sortable_handle",animation:200,onEnd:function(){$(".lb_tab").each(function(a,b){$(b).attr("id","lb_item"+(a+1));$(b).find(".baseNo").html("<span>\u7b2c"+(a+1)+"\u57fa\u5730\u822a\u7a7a\u968a</span>");$(b).find(".simple_lb_progress").each(function(c,d){$(d).attr("id","simple_lb_bar_"+(a+1)+"_"+(c+1))});$(b).find(".btn_show_contact_rate_lb")[0].dataset.lb=a+1});inform_warning("\u57fa\u5730\u822a\u7a7a\u968a\u306e\u5165\u308c\u66ff\u3048\u304c\u884c\u308f\u308c\u307e\u3057\u305f\u3002\u57fa\u5730\u822a\u7a7a\u968a\u306e\u6d3e\u9063\u5148\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002");
$(".btn_lb_target").removeClass("btn-outline-success");$(".btn_lb_target").addClass("btn-outline-danger");$(".lb_target_alert").removeClass("d-none");calculate(!0,!1,!1)}});Sortable.create(document.getElementById("fleet_tabs_container"),{delay:80,animation:200,onEnd:function(){if("#friendFleet_item1"!==$("#fleet_tabs_container a:first").attr("href")){var a=1;$("#fleet_tabs_container a").each(function(f,g){$(g).text("\u7b2c"+(f+1)+"\u8266\u968a");$(g).attr("href","#friendFleet_item"+(f+1));$(g).hasClass("active")&&
(a=f+1)});for(var b=getMaxShipCount(),c=createFriendFleetPreset(),d=$jscomp.makeIterator(c),e=d.next();!e.done;e=d.next())e=e.value,e[2]+=e[2]>=b?-b:b;$(".friendFleet_tab").removeClass("show active");document.getElementById("friendFleet_item"+a).classList.add("show","active");expandMainPreset([[],c,[],document.getElementById("adapt_stage2").checked?selectedFormations:null,isDefMode,createAirRaidEnemyFleetPreset(),castInt($("#admin_lv").val())],!1,!0,!1);calculate(!1,!0,!1)}}});$(".ship_tab").draggable({delay:100,
helper:"clone",handle:".sortable_handle",zIndex:1E3});$(".ship_tab").droppable({accept:".ship_tab",hoverClass:"ship_tab_hover",tolerance:"pointer",drop:function(a,b){a=b.draggable;b=$(this);if(a.length&&b.length){var c=b.parent()[0],d=a[0],e=b[0],f=d.nextSibling;TradeHTMLWithAnimation(d,e,function(){c.insertBefore(d,e);c.insertBefore(e,f);calculate(!1,!0,!1)})}}});$(".lb_plane").draggable({delay:100,helper:"clone",handle:".drag_handle",zIndex:1E3,start:function(a,b){$(b.helper).css("width",320);$(b.helper).find(".dropdown-menu").remove()},
stop:function(){lb_plane_DragEnd($(this))}});$(".lb_plane").droppable({accept:".lb_plane",hoverClass:"plane_draggable_hover",tolerance:"pointer",drop:function(a,b){lb_plane_Drop($(this),b)}});$("#landBase_content_main").droppable({accept:".lb_plane",tolerance:"pointer",over:function(a,b){b.helper.animate({opacity:"1.0"},100);isOut=!1},out:function(a,b){b.helper.animate({opacity:"0.2"},100);isOut=!0}});$(".ship_plane_draggable").draggable({delay:100,helper:"clone",handle:".drag_handle",zIndex:1E3,
cursorAt:{left:55},start:function(a,b){ship_plane_DragStart(b)},stop:function(){ship_plane_DragEnd($(this))}});$(".ship_plane").droppable({accept:".ship_plane_draggable",hoverClass:"plane_draggable_hover",tolerance:"pointer",over:function(a,b){ship_plane_DragOver($(this),b)},drop:function(a,b){ship_plane_Drop($(this),b)}});$(".friendFleet_tab").droppable({accept:".ship_plane_draggable",tolerance:"pointer",over:function(a,b){isOut=!1;b.helper.stop().animate({opacity:"1.0"},100)},out:function(a,b){isOut=
!0;b.helper.stop().animate({opacity:"0.2"},100)}});Sortable.create($("#battle_container")[0],{handle:".sortable_handle",animation:150,onEnd:function(){$(".battle_content").each(function(a,b){$(b).find(".battle_no").text(a+1)});calculate()}});$("#main").fadeIn();$("#simulator_loading").remove()});
